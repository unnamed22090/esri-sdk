// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
define("require exports ./setUtils ./jsonUtils dojo/has ../../../core/Collection ../../../renderers/support/layerTemplates".split(" "),function(p,h,f,d,q,k,g){function l(e,b,a){if(a){d.readIfDefined(b,"legendEnabled",a.showLegend,a);d.readIfDefined(b,"labelsVisible",a.showLabels,a);var c=d.readIfDefined(b,"popupTemplate",a.popupInfo,a);c&&c===b.popupTemplate&&b._popupSource&&(b._popupSource.popupTemplate="portal");(a=a.layerDefinition)?(d.readIfDefined(b,"minScale",a.minScale,a),d.readIfDefined(b,
"maxScale",a.maxScale,a),d.readIfDefined(b,"elevationInfo",a.elevationInfo,a),d.readIfDefined(b,"definitionExpression",a.definitionExpression,a),c=b._accessorProps,!c||!c.properties.elevationInfo.mode||!c.properties.elevationInfo.reader?a&&a.elevationInfo&&console.warn("Data has elevation info but no reader for elevationInfo property is defined..."):f.setAsDefaultIfDefined(b,"elevationInfo",c.properties.elevationInfo.reader.call(b,a.elevationInfo)),d.readIfDefined(b,"labelingInfo",a.drawingInfo&&
a.drawingInfo.labelingInfo,a),(a=a.drawingInfo)?(d.readIfDefined(b,"opacity",a.transparency,{drawingInfo:a}),e=m(e,b,a)):e=void 0):e=void 0;return e}}function m(e,b,a){var c=a.renderer;if(c){if(g.hasContentByReference(c))return g.createRenderer(c,e.portal).then(function(a){f.setAsDefaultIfDefined(b,"legendEnabled",!1);f.setAsDefaultIfDefined(b,"renderer",a)}).otherwise(function(c){n&&console.warn("Failed to create by reference renderer:",c.toString?c.toString():c);d.readIfDefined(b,"renderer",a.renderer,
{drawingInfo:a})});d.readIfDefined(b,"renderer",a.renderer,{drawingInfo:a})}}var n=0;h.readItemOverrides=function(d,b,a,c){if(a&&Array.isArray(a.layers)){var g=(new k(a.layers)).find(function(a){return a.id===c});f.setAsDefaultIfDefined(b,"legendEnabled",a.showLegend,!!a.showLegend);f.setAsDefaultIfDefined(b,"visible",a.visibility,!!a.visibility);return l(d,b,g)}}});