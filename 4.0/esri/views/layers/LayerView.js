// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
define(["../../core/declare","../../core/Accessoire","../../core/Evented","../../core/AccessoirePromise"],function(d,e,f,g){var h=0;return d([e,f,g],{declaredClass:"esri.views.layers.LayerView",classMetadata:{properties:{refreshTimer:{readOnly:!0,dependsOn:["suspended","layer.refreshInterval"]},suspended:{dependsOn:["view","visible","layer.loaded","parent.suspended"],readOnly:!0},updating:{dependsOn:["suspended"],value:!1},visible:{dependsOn:["layer.visible"]}}},constructor:function(){this.id=Date.now().toString(16)+
"-layerview-"+h++;this._layerHandles=[];this.watch("suspended",this._suspendedWatcher.bind(this))},initialize:function(){this.addResolvingPromise(this.layer)},destroy:function(){this.layer=this.parent=null},layer:null,_layerSetter:function(a){var b=this._layerHandles;b.forEach(function(a){a.remove()});b.length=0;a&&b.push(a.on("refresh",this.refresh.bind(this)));return a},parent:null,_refreshTimerGetter:function(a){var b=this.suspended,c=this.get("layer.refreshInterval")||0;a&&(clearTimeout(a),a=
null);!b&&c&&(a=setTimeout(this.refresh.bind(this),6E4*c));return a},suspended:!0,_suspendedGetter:function(){return!this.canResume()},_updating:!1,_updatingGetter:function(){return!(!this._updating||this.suspended)},_updatingSetter:function(a){this._updating=!!a},visible:!0,_visibleSetter:function(a){this._visible=a},_visibleGetter:function(){return null!=this._visible?this._visible:this.get("layer.visible")},refresh:function(){},canResume:function(){return!this.get("parent.suspended")&&this.get("view.ready")&&
this.get("layer.loaded")&&this.visible||!1},_suspendedWatcher:function(a){a?this.emit("suspend"):this.emit("resume")}})});