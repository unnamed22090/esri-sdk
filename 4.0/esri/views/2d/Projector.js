// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
define(["../../core/Accessoire","../../geometry/Polyline"],function(r,s){var p=function(a,b){var c=a.length,m=a[0],k=a[c-1],g=0,e=0,h,l;for(h=1;h<c-1;h++){l=a[h];var d=m,n=k,f=void 0,q=void 0,f=void 0;d[0]===n[0]?f=Math.abs(l[0]-d[0]):(f=(n[1]-d[1])/(n[0]-d[0]),q=d[1]-f*d[0],f=Math.abs(f*l[0]-l[1]+q)/Math.sqrt(f*f+1));l=f;l>g&&(e=h,g=l)}g>b?(c=p(a.slice(0,e+1),b),e=p(a.slice(e),b),e=c.concat(e)):e=[m,k];return e};return r.createSubclass({_transformSetter:function(a){this._transformers=[];return a},
toScreenPoint:function(a,b,c){b=this.getTransformer(b);c||(c={x:0,y:0});b.transformPoint(a.x,a.y,function(a,b){c.x=a;c.y=b});return c},toScreenPath:function(a,b){var c=a instanceof s?a.paths:a.rings,m=this.getTransformer(b),k=[],g,e,h=function(a,b){k.push(a+","+b)};if(c){g=0;for(e=c.length;g<e;g++)k.push("M"),m.forEach(p(c[g],this.resolution),h)}return k},getTransformer:function(a){if(!this._transformers[a]){var b=this.transform,c=b[0],m=b[1],k=b[2],g=b[3],e=b[4]+a,h=b[5],l=0!==m&&0!==k,d,n,f=Math.round;
this._transformers[a]={transformPoint:function(){return l?function(a,b,d){d(f(c*a+k*b+e),f(m*a+g*b+h))}:function(a,b,d){d(f(c*a+e),f(g*b+h))}}(),forEach:function(a,b){d=0;for(n=a.length;d<n;d++)this.transformPoint(a[d][0],a[d][1],b)}}}return this._transformers[a]}})});