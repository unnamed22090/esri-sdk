// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
define(["dojo/dom-construct","../math/mat2d","../math/vec2","./cssUtils"],function(k,b,f,g){var h=function(){this._parentStack=[];this._tStack=[];this._tStackSize=0;this._tmpMat2d=b.create();this._tmpVec2=f.create();this.transform=b.create();this.viewTransform=b.create()};h.prototype={reset:function(){this._tStackSize=this._parentStack.length=0;this.child=null;b.identity(this.transform)},setSize:function(a,c){this.surface.style.width=a+"px";this.surface.style.height=c+"px"},setOpacity:function(a){this.surface.style.opacity=
a},setVisibility:function(a){this.surface.style.display=a?"block":"none"},setBlendMode:function(a){this.surface.style["mix-blend-mode"]=a?a:"normal"},setViewTransform:function(a){b.copy(this.transform,a);b.copy(this.viewTransform,a)},reflowChild:function(a,c){this.child=a;this.placeChild(a,c);a.reflow(this)},renderChild:function(a,c){this.child=a;this.surface=a.surface;this.setChildTransform(a);a.render(this)},placeChild:function(a,c){var b=this._parentStack[this._parentStack.length-1].surface,d=
b.childNodes,e=a.createSurface();d[c]?d[c]!==e&&b.insertBefore(e,d[c]):b.appendChild(e)},setChildTransform:function(a){a=a.transform;var c=null;a&&(6===a.length?(c=b.invert(this._tmpMat2d,a),b.multiply(c,this.transform,c),g.setTransform(this.surface.style,c),b.copy(this.transform,a)):2===a.length&&(c=f.transformMat2d(this._tmpVec2,a,this.transform),g.setTransform(this.surface.style,c)))},pushParent:function(a){this._parentStack.push(a)},popParent:function(){this._parentStack.pop()},pushMatrix:function(){var a=
this._tStack;a.length<this._tStackSize+1&&a.push(b.create());b.copy(a[this._tStackSize++],this.transform)},popMatrix:function(){b.copy(this.transform,this._tStack[--this._tStackSize])},emptyTrash:function(a){if(a.trash&&a.trash.children.length){a=a.trash;var c=a.children,b,d;b=0;for(d=c.length;b<d;b++)k.destroy(c[b].surface);c.length=0;a.ids={}}}};return h});