// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
define(["./DisplayObject","./bitFlagUtil"],function(e,f){return e.createSubclass({declaredClass:"esri.views.2D.engine.Container","-chains-":{childAdded:"after",childRemoved:"after"},constructor:function(){this.children=[];this.trash={children:[],ids:{}}},tag:"inherit",_stageSetter:function(a){var b=this._get("stage"),d=this.children,c,e;this.inherited(arguments);if(b!==a){if(d){c=0;for(e=d.length;c<e;c++)b=d[c],b.stage=a}return this._set("stage",a)}},_numChildrenGetter:function(){return this.children.length},
addChild:function(a){return this.addChildAt(a,this.children.length)},addChildAt:function(a,b){var d;if(this.contains(a))return a;(d=a.parent)&&d.removeChild(a);b=Math.min(this.children.length,b);this.children.splice(b,0,a);this.trash.ids[a.id]&&(this.trash.ids[a.id]=null,this.trash.children.splice(this.trash.children.indexOf(a),1));this.childAdded(a,b);this.notifyChange("numChildren");return a},childAdded:function(a,b){a.set({parent:this,stage:this.stage});this.requestRender()},removeAllChildren:function(){for(var a=
this.numChildren;a--;)this.removeChildAt(0)},removeChild:function(a){var b=this.children.indexOf(a);return-1<b?this.removeChildAt(b):a},removeChildAt:function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this.trash.ids[a.id]=a;this.trash.children.push(a);this.childRemoved(a);this.notifyChange("numChildren");return a},childRemoved:function(a){a.parent=null;a.stage=null;this.requestRender()},contains:function(a){return-1<this.getChildIndex(a)},getChildIndex:function(a){return this.children.indexOf(a)},
getChildAt:function(a){return 0>a||a>this.children.length?null:this.children[a]},setChildIndex:function(a,b){var d=this.getChildIndex(a);-1<d&&(this.children.splice(d,1),this.children.splice(b,0,a),this.requestRender())},requestChildRender:function(a){a&&a.parent===this&&this.requestRender()},reflow:function(a){var b=this.children,d=b.length,c;a.emptyTrash(this);a.pushParent(this);for(c=0;c<d;c++)a.reflowChild(b[c],c);a.popParent()},render:function(a){var b=this._flags;this._renderFlag=!1;this._flags=
0;b&&(f.isSet(b,e.SIZE)&&a.setSize(this.width,this.height),f.isSet(b,e.VISIBLE)&&a.setVisibility(this.visible),f.isSet(b,e.BLENDMODE)&&a.setBlendMode(this.blendMode),f.isSet(b,e.OPACITY)&&a.setOpacity(this.opacity));var d=(b=this.children)&&b.length||0,c;a.pushParent(this);for(c=0;c<d;c++)a.pushMatrix(),a.renderChild(b[c]),a.popMatrix();a.popParent()}})});