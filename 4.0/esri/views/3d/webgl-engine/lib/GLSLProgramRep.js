// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
define(["require","exports","./Util"],function(e,f,d){return function(){function c(){this.programsByName={};this.namesById=[];this.programRefCount=[];this.commonUniforms={model:[],modelNormal:[],lightDirection:[],proj:[],shadowMapDistance:[],viewportPixelSz:[]};this.shaderVariators={}}c.prototype.dispose=function(){for(var a in this.programsByName)this.programsByName[a].dispose();this.programRefCount=this.namesById=this.programsByName=null};c.prototype.add=function(a,b){d.assert(null==this.programsByName[a]);
this.programsByName[a]=b;this.namesById[b.getId()]=a};c.prototype.get=function(a){return this.programsByName[a]};c.prototype.getProgramsUsingUniform=function(a){return this.commonUniforms[a]||[]};c.prototype.increaseRefCount=function(a){var b=a.getId();this.programRefCount[b]?this.programRefCount[b]++:(this.programRefCount[b]=1,this.findCommonUniforms(a))};c.prototype.decreaseRefCount=function(a){var b=a.getId();1<this.programRefCount[b]?this.programRefCount[b]--:(this.forgetCommonUniforms(a),this.programRefCount[b]=
0)};c.prototype.findCommonUniforms=function(a){for(var b in this.commonUniforms)a.hasUniform(b)&&(d.assert(-1===this.commonUniforms[b].indexOf(a),"common uniforms of program have already been determined"),this.commonUniforms[b].push(a))};c.prototype.forgetCommonUniforms=function(a){for(var b in this.commonUniforms){var c=this.commonUniforms[b],d=c.indexOf(a);-1<d&&(c[d]=c[c.length-1],c.pop())}};return c}()});