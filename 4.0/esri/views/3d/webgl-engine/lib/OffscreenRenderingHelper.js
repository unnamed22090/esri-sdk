// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/views/3d/webgl-engine/materials/internal/offscreen.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsOffscreenRenderer"\x3e\x3c![CDATA[\r\n  attribute vec2 $position;\r\n  attribute vec2 $uv0;\r\n  varying vec2 vtc;\r\n\r\n  void main(void) {\r\n    gl_Position \x3d vec4(position.xy, 0.0, 1.0);\r\n    vtc \x3d $uv0.xy * 0.5 + 0.5;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsOffscreenRenderer"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n  varying vec2 vtc;\r\n\r\n  void main() {\r\n    vec4 texColor \x3d texture2D(tex, vtc);\r\n    gl_FragColor \x3d texColor;\r\n  }\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e'}});
define("require exports ./GLFBO ./GLVBO ./GLSLShader ./GLSLProgram ./VertexBufferLayout ./Util dojo/text!../materials/internal/offscreen.xml".split(" "),function(n,p,g,h,f,k,l,e,m){return function(){function c(a,b){this._enabled=!1;this.height=this.width=0;this._programRep=a;this._gl=b;this.height=this.width=this._extension=null}c.prototype.enable=function(){e.assert(!this.getEnableState());e.assert(this.getIsSupported());var a=this._gl;this._enabled=!0;this.osFBO=new g(a.RGBA,a.UNSIGNED_BYTE,!1,
a.NEAREST,a,void 0,!0);this.quadVBO=this.createQuadVBO(a)};c.prototype.disable=function(){e.assert(this.getEnableState());this._enabled=!1;this.osFBO.dispose();this.quadVBO.dispose();this.quadVBO=this.osFBO=null};c.prototype.createQuadVBO=function(a){var b=new Float32Array(16);b[0]=-1;b[1]=-1;b[2]=-1;b[3]=-1;b[4]=1;b[5]=-1;b[6]=1;b[7]=-1;b[8]=-1;b[9]=1;b[10]=-1;b[11]=1;b[12]=1;b[13]=1;b[14]=1;b[15]=1;return new h(b,l.Defaults.Pos2Tex,a)};c.prototype.getIsSupported=function(){var a=this._gl;this._extension||
(this._extension=a.getExtension("WEBGL_depth_texture"));return!!this._extension};c.prototype.setEnableState=function(a){a?this.enable():this.disable()};c.prototype.getEnableState=function(){return this._enabled};c.prototype.getColorTexture=function(){return this.osFBO.getTexture()};c.prototype.getDepthFBO=function(){return this.osFBO.getVirtualDepthFBO()};c.prototype.prepareRenderPass=function(a){e.assert(this.getEnableState());var b=this._gl;a=a.fullViewport;this.width=a[2];this.height=a[3];this.osFBO.setSize(this.width,
this.height);this.osFBO.bind();b.clearColor(0,0,0,1);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)};c.prototype.drawQuad=function(a){e.assert(this.getEnableState());a=this._gl;var b=this._programRep.get("offscreenProgram");a.bindFramebuffer(a.FRAMEBUFFER,null);a.disable(a.DEPTH_TEST);a.clear(a.COLOR_BUFFER_BIT);b.use();a.bindTexture(a.TEXTURE_2D,this.osFBO.getTexture());this.quadVBO.getLayout().enableVertexAttribArrays(a,b);this.quadVBO.bind();this.quadVBO.setPointers(b);a.drawArrays(a.TRIANGLE_STRIP,
0,this.quadVBO.getNum());a.bindBuffer(a.ARRAY_BUFFER,null);this.quadVBO.getLayout().disableVertexAttribArrays(a,b);a.useProgram(null);a.enable(a.DEPTH_TEST)};c.loadShaders=function(a,b,c,d){a._parse(m);b=new f(d.VERTEX_SHADER,a.vsOffscreenRenderer,d);a=new f(d.FRAGMENT_SHADER,a.fsOffscreenRenderer,d);d=new k([b,a],d);c.add("offscreenProgram",d)};return c}()});