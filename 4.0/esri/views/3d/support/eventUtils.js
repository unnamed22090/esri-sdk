// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
define(["../../../core/watchUtils","dojo/on","dojo/_base/lang"],function(p,m,q){function k(){this.handles=[];this.ids={}}function r(e){var b={},c;for(c in e){var f=e[c];if("function"===typeof f)b[c]=f;else for(var a in f)b[c+"."+a]=f[a]}return b}function s(e,b){var c={},f;for(f in e){var a=e[f],h={};"object"===typeof a&&(h=q.mixin({},a),delete h.handler,a=a.handler);b&&(a=function(c){return function(){c.apply(b,arguments)}}(a));var g=f.split("."),d;1===g.length?(d="",g=f[0]):(d=g.slice(0,g.length-
1).join("."),g=g[g.length-1]);c[d]||(c[d]=[]);c[d].push({eventName:g,handler:a,installer:h.pausable?m.pausable:m})}return c}k.prototype.remove=function(){this.handles.forEach(function(e){e.remove()});this.handles.length=0;this.ids={}};k.prototype.push=function(){2===arguments.length&&"string"===typeof arguments[0]?(this.handles.push(arguments[1]),this.ids[arguments[0]]=arguments[1]):this.handles.push.apply(this.handles,arguments)};k.prototype.byId=function(e){return this.ids[e]};return{Handles:k,
on:function(e,b,c,f){var a=new k,h={};if("string"===typeof b){var g={};g[b]=c;b=g;c=f}b=s(r(b),c);for(var d in b){var n=new k;h[d]=n;d?a.push(p.init(e,d,function(b,c,a){return function(d){b.remove();d&&a.forEach(function(a){b.push(c+"."+a.eventName,a.installer(d,a.eventName,a.handler))})}}(n,d,b[d]))):b[d].forEach(function(a){n.push(d+"."+a.eventName,a.installer(e,a.eventName,a.handler))})}var l=new k,m=l.remove;l.remove=function(){for(var b in h)h[b].remove();h={};a.remove();m.call(l)};l.byId=function(a){for(var b in h){var c=
h[b].byId(a);if(c)return c}return null};return l}}});