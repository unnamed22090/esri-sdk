// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
require({cache:{"esri/geometry/ScreenPoint":function(){define(["../core/declare","./Point"],function(s,q){return s(q,{declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/webscene/Environment":function(){define("require exports ../core/tsSupport/extendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupporter ../core/accessoireSupport/typescript ./Lighting".split(" "),function(s,q,n,k,h,e,c){return function(b){function g(f){b.call(this,f);this.lighting=null}n(g,b);g.prototype.getDefaults=
function(){return{lighting:{}}};g.prototype.clone=function(){return new g({lighting:this.lighting.clone()})};g.prototype.toJSON=function(){return{lighting:this.lighting.toJSON()}};g.sanitizeJSON=function(b){return{lighting:b.lighting?c.sanitizeJSON(b.lighting):(new c).toJSON()}};k([e.shared("esri.webscene.Environment")],g.prototype,"declaredClass",void 0);k([e.property({type:c})],g.prototype,"lighting",void 0);return g=k([e.subclass()],g)}(h)})},"esri/webscene/Lighting":function(){define("require exports ../core/tsSupport/extendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupporter ../core/accessoireSupport/typescript".split(" "),
function(s,q,n,k,h,e){return function(c){function b(b){c.call(this,b);this.displayUTCOffset=this.ambientOcclusionEnabled=this.directShadowsEnabled=this.date=null}n(b,c);b.prototype.clone=function(){return new b({date:null!=this.date?new Date(this.date.getTime()):null,directShadowsEnabled:this.directShadowsEnabled,ambientOcclusionEnabled:this.ambientOcclusionEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null})};b.prototype.toJSON=function(){var b={},f=this.date?this.date.getTime():
null;14264208E5!==f&&(b.datetime=f);this.directShadowsEnabled&&(b.directShadows=!0);this.ambientOcclusionEnabled&&(b.ambientOcclusion=!0);null!=this.displayUTCOffset&&(b.displayUTCOffset=this.displayUTCOffset);return b};b.sanitizeJSON=function(b){var f={datetime:b.datetime};void 0!==b.directShadows&&(f.directShadows=!!b.directShadows);void 0!==b.ambientOcclusion&&(f.ambientOcclusion=!!b.ambientOcclusion);void 0!==b.displayUTCOffset&&(f.displayUTCOffset=b.displayUTCOffset);return f};k([e.shared("esri.webscene.Lighting")],
b.prototype,"declaredClass",void 0);k([e.shared({reader:{exclude:["datetime","ambientOcclusion","directShadows"],add:["date","ambientOcclusionEnabled","directShadowsEnabled"]}})],b.prototype,"classMetadata",void 0);k([e.property({type:Date,value:null,reader:function(b,f){return null!=f.datetime&&new Date(f.datetime)||null}})],b.prototype,"date",void 0);k([e.property({value:!1,reader:function(b,f){return!!f.directShadows}})],b.prototype,"directShadowsEnabled",void 0);k([e.property({value:!1,reader:function(b,
f){return!!f.ambientOcclusion}})],b.prototype,"ambientOcclusionEnabled",void 0);k([e.property({value:null})],b.prototype,"displayUTCOffset",void 0);return b=k([e.subclass()],b)}(h)})},"esri/views/3d/environment/SceneViewEnvironment":function(){define(["dojo/_base/lang","../../../webscene/Environment","../../../webscene/Lighting","./SceneViewLighting","./SceneViewAtmosphere"],function(s,q,n,k,h){var e=q.createSubclass({declaredClass:"esri.views.3d.environment.SceneViewEnvironment",classMetadata:{properties:{atmosphere:{type:h},
atmosphereEnabled:{value:!0},starsEnabled:{value:!0},lighting:{setter:function(c){if(!c)return!this.lighting?new k:this.lighting;if(!this.lighting){if(c instanceof k)return c;if(c instanceof n){var b={directShadowsEnabled:c.directShadowsEnabled,ambientOcclusionEnabled:c.ambientOcclusionEnabled};null!=c.date&&(b.date=c.date);null!=c.displayUTCOffset&&(b.displayUTCOffset=c.displayUTCOffset);return new k(b)}return new k(c)}null!=c.date&&(this.lighting.date=c.date);null!=c.displayUTCOffset&&(this.lighting.displayUTCOffset=
c.displayUTCOffset);this.lighting.directShadowsEnabled=c.directShadowsEnabled;this.lighting.ambientOcclusionEnabled=c.ambientOcclusionEnabled;null!=c.cameraTrackingEnabled&&(this.lighting.cameraTrackingEnabled=c.cameraTrackingEnabled);return this.lighting}}},reader:{exclude:["atmosphere","atmosphereEnabled","starsEnabled"]}},getDefaults:function(){return s.mixin(this.inherited(arguments),{atmosphere:{}})},atmosphere:null,atmosphereEnabled:!0,starsEnabled:!0,clone:function(){return new e({lighting:this.lighting.clone(),
atmosphere:this.atmosphere.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled})}});return e})},"esri/views/3d/environment/SceneViewLighting":function(){define(["../../../core/Evented","../../../webscene/Lighting"],function(s,q){var n=new Date("March 15, 2015 12:00:00 UTC"),k=new Date,h={target:null,date:null},e={target:null,timezoneOffset:0};return q.createSubclass([s],{declaredClass:"esri.views.3d.environment.SceneViewLighting",classMetadata:{properties:{cameraTrackingEnabled:{value:!0},
date:{copy:function(c,b){c.setTime(b.getTime())},setter:function(c,b){if(null==c)return this.date;b||(b=new Date);"number"===typeof c?b.setTime(c):b.setTime(c.getTime());c!==n&&c!==this._autoUpdateDate&&(this.positionTimezoneInfo.autoUpdated=!1);h.target=this;b?(k.setTime(b.getTime()),h.date=k):h.date=null;this.emit("date-will-change",h);return b}}}},constructor:function(){this.positionTimezoneInfo={hours:0,minutes:0,seconds:0,autoUpdated:!0};this._autoUpdateDate=null},getDefaults:function(){return{date:n}},
_calculateTimezoneOffset:function(c){return Math.round(c.hours+c.minutes/60+c.seconds/3600)},autoUpdate:function(c,b){var g=this._calculateTimezoneOffset(this.positionTimezoneInfo);this.positionTimezoneInfo.hours=b.hours;this.positionTimezoneInfo.minutes=b.minutes;this.positionTimezoneInfo.seconds=b.seconds;this.positionTimezoneInfo.autoUpdated=!0;if(null!=c){var f=this.date&&this.date.getTime();this.date=this._autoUpdateDate=c;this._autoUpdateDate=null}var a=this._calculateTimezoneOffset(this.positionTimezoneInfo);
g!==a&&(e.target=this,e.timezoneOffset=a,this.emit("timezone-will-change",e));if(null!=c)return f!==c.getTime()}})})},"esri/views/3d/environment/SceneViewAtmosphere":function(){define(["../../../core/Accessoire"],function(s){return s.createSubclass({classMetadata:{properties:{quality:{}}},quality:"low",_qualitySetter:function(q,n){return-1!==["low","high"].indexOf(q)?q:n},clone:function(){return new this.constructor({quality:this.quality})}})})},"esri/views/3d/environment/SceneViewEnvironmentManager":function(){define("../../../core/declare ../../../core/Accessoire ../../../core/Evented ../../../core/watchUtils ../../../core/HandleRegistry ../../../geometry/Point ../../../geometry/support/webMercatorUtils ../../../geometry/SpatialReference ../support/sunUtils ../support/earthUtils ./EnvironmentRenderer".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a){var r=new Date,l={hours:0,minutes:0,seconds:0},d=[0.5773502691896258,-0.5773502691896258,0.5773502691896258];s=s([q,n],{declaredClass:"esri.views.3d.environment.SceneViewEnvironmentManager",referencePointUpdateInterval:3E3,referencePointUpdateDistThreshold:1E6,classMetadata:{properties:{updating:{dependsOn:["noReferencePositionQueries"],readOnly:!0,getter:function(){return!this.noReferencePositionQueries&&(!!this._referencePosUpdateQuery||null!=this._referencePosUpdateTimer)}},
noReferencePositionQueries:{},view:{}}},constructor:function(){this._viewHandles=new h;this._environmentRenderer=null;this._viewConnected=this._trackingEnabled=this._preserveAbsoluteDateTime=!1;this._referencePosResetPreserveAbsoluteTime=null;this._resetReferencePosition()},destroy:function(){this._viewHandles.destroy();this.disposeRendering()},disposeRendering:function(){this._environmentRenderer&&(this._environmentRenderer.destroy(),this._environmentRenderer=null);this._resetReferencePosition()},
updateReadyChange:function(a){a&&!this._viewConnected?(this._viewConnected=!0,this.connectView(this.view)):!a&&this._viewConnected&&(this._viewConnected=!1,this.disconnectView(this.view))},connectView:function(m){this._environmentRenderer=new a({view:m});this._viewHandles.add([k.on(this.view,"environment.lighting","date-will-change",this._lightingDateHandler.bind(this)),this.view.watch("interacting,stationary",this._interactingStationaryHandler.bind(this)),this.view.watch("environment.lighting.directShadowsEnabled,environment.lighting.ambientOcclusionEnabled",
this._updateRenderParamsHandler.bind(this)),this.view.watch("spatialReference",this._spatialReferenceHandler.bind(this)),k.init(this.view,"viewingMode",this._viewingModeHandler.bind(this)),k.init(this.view,"environment.lighting.cameraTrackingEnabled",this._updateCameraTracking.bind(this)),this.watch("noReferencePositionQueries",this._cameraHandler.bind(this,null))]);this._updateRenderParamsHandler();this._updateLightParams();this._cameraHandler()},_updateCameraTracking:function(a){if(this._trackingEnabled=
a)a=k.on(this,"view.navigation","currentViewChanged",this._cameraHandler.bind(this,null),this._cameraHandler.bind(this,null)),this._viewHandles.add(a,"camera");else{if(a=this.get("view.environment.lighting"))a.positionTimezoneInfo.autoUpdated=!1;this._viewHandles.remove("camera")}},disconnectView:function(a){this.disposeRendering();this._viewHandles.removeAll()},_lightingDateHandler:function(a){if(a=a.date){var b=this.view.environment.lighting;if(!b.positionTimezoneInfo.autoUpdated){this._preserveAbsoluteDateTime=
!0;if("local"===this.view.viewingMode){var d=this.view.camera.position;if(!this._referencePosMapCoords||!this._referencePosMapCoords.equals(d)){this._requestReferencePositionUpdate(d);return}}this._preupdateTracking(a);this._referencePosWGS84&&(d=f.positionToTimezone(this._referencePosWGS84,l),b.autoUpdate(null,d))}this._updateLightParams(a)}},_preupdateTracking:function(a){!this._trackingEnabled&&this.get("view.environment.lighting.cameraTrackingEnabled")&&this._cameraHandler(a)},_cameraHandler:function(a){var b=
this.view.camera;b&&("global"===this.view.viewingMode?this._cameraHandlerGlobal(b,a):this._cameraHandlerLocal(b,a))},_cameraHandlerGlobal:function(a,p){var d=a.position;this._referencePosWGS84||(this._referencePosWGS84=new e({spatialReference:b.WGS84}));d.spatialReference.isWebMercator?c.webMercatorToGeographic(d,!1,this._referencePosWGS84):(this._referencePosWGS84.x=d.x,this._referencePosWGS84.y=d.y);this._referencePosWGS84.z=d.z;this._autoUpdateTimezone(d,p)||this._updateLightParams(p)},_cameraHandlerLocal:function(a,
b){var d=a.position;(!this._referencePosMapCoords||this._exceedsReferencePosDistThreshold(d))&&this._requestReferencePositionUpdate(d,!0)},_interactingStationaryHandler:function(){!this.view.interacting&&this.view.stationary&&this._executePendingReferencePositionUpdate()},_updateLightParams:function(a){var b=this.view.environment.lighting;a=a||b.date;var b=this.view._stage,f;this._referencePosWGS84?(f=g.computeColorAndIntensity(a,this._referencePosWGS84),g.computeDirection(a,this._referencePosWGS84,
this.view.viewingMode,f.diffuse.direction)):f={diffuse:{color:[1,1,1],intensity:0.5,direction:d},ambient:{color:[1,1,1],intensity:0.5}};b.setDirectionalLight(f.diffuse);b.setAmbientLight(f.ambient)},_autoUpdateTimezone:function(a,b){if(!this.view.get("environment.lighting.cameraTrackingEnabled"))return!1;r.setTime((b||this.view.environment.lighting.date).getTime());var d=f.positionToTimezone(a,l),g=this.view.environment.lighting.positionTimezoneInfo;if(g.autoUpdated){if(g.hours===d.hours&&g.minutes===
d.minutes&&g.seconds===d.seconds)return!1}else g.hours=d.hours,g.minutes=d.minutes,g.seconds=d.seconds;var c=r.getUTCHours()-(d.hours-g.hours),u=r.getUTCMinutes()-(d.minutes-g.minutes),g=r.getUTCSeconds()-(d.seconds-g.seconds);r.setUTCHours(c);r.setUTCMinutes(u);r.setUTCSeconds(g);return b?!1:this.view.environment.lighting.autoUpdate(r,d)},_updateRenderParamsHandler:function(){var a=this.get("view._stage");a&&a.setRenderParams({shadowMap:this.view.environment.lighting.directShadowsEnabled,ssao:this.view.environment.lighting.ambientOcclusionEnabled})},
_spatialReferenceHandler:function(){this._resetReferencePosition()},_viewingModeHandler:function(a){this._resetReferencePosition()},_resetReferencePosition:function(){this._cancelReferencePosUpdates();this._referencePosWGS84=this._referencePosResetPreserveAbsoluteTime=this._referencePosMapCoordsDesired=this._referencePosMapCoords=null},_requestReferencePositionUpdate:function(a,d){this.view.mapCoordsHelper.canProject()&&!this.noReferencePositionQueries&&(this._referencePosUpdateQuery||null!=this._referencePosUpdateTimer||
this.view.interacting||!this.view.stationary?(this._referencePosMapCoordsDesired?this._referencePosMapCoordsDesired.copy(a):this._referencePosMapCoordsDesired=a.clone(),this._referencePosResetPreserveAbsoluteTime=!!d):(d&&(this._preserveAbsoluteDateTime=!1),this._referencePosMapCoords?this._referencePosMapCoords.copy(a):this._referencePosMapCoords=a.clone(),this._referencePosUpdateQuery=this.view.mapCoordsHelper.toGeographic(this._referencePosMapCoords).then(function(a){this._referencePosUpdateQuery=
null;if(!isNaN(a[0])&&!isNaN(a[1])){var m=this._referencePosMapCoords.z*this.view.mapCoordsHelper.unitInMeters;this._referencePosWGS84?(this._referencePosWGS84.x=a[0],this._referencePosWGS84.y=a[1],this._referencePosWGS84.z=m):this._referencePosWGS84=new e({x:a[0],y:a[1],z:m,spatialReference:b.WGS84});this._referencePosChanged();null==this._referencePosUpdateTimer&&this._executePendingReferencePositionUpdate()}this.notifyChange("updating")}.bind(this),function(a){this._referencePosUpdateQuery=null;
this.notifyChange("updating")}.bind(this)),this._referencePosUpdateTimer=window.setTimeout(function(){this._referencePosUpdateTimer=null;this._referencePosUpdateQuery||this._executePendingReferencePositionUpdate();this.notifyChange("updating")}.bind(this),this.referencePointUpdateInterval),this.notifyChange("updating")))},_executePendingReferencePositionUpdate:function(){var a=this._referencePosMapCoordsDesired,b=this._referencePosResetPreserveAbsoluteTime;a&&this._exceedsReferencePosDistThreshold(a)&&
(this._referencePosResetPreserveAbsoluteTime=this._referencePosMapCoordsDesired=null,this._requestReferencePositionUpdate(a,b))},_referencePosChanged:function(){this._preserveAbsoluteDateTime?this._updateLightParams():this._autoUpdateTimezone(this._referencePosWGS84)||this._updateLightParams()},_exceedsReferencePosDistThreshold:function(a){return this._referencePosMapCoords?(a=this._referencePosMapCoords.distance(a),this.view.mapCoordsHelper&&(a*=this.view.mapCoordsHelper.unitInMeters),a>this.referencePointUpdateDistThreshold):
!0},_cancelReferencePosUpdates:function(){this._referencePosUpdateQuery&&(this._referencePosUpdateQuery.cancel(),this._referencePosUpdateQuery=null);null!=this._referencePosUpdateTimer&&(window.clearTimeout(this._referencePosUpdateTimer),this._referencePosUpdateTimer=null)}});s.FIXED_LIGHT_DIRECTION=d;return s})},"esri/views/3d/support/sunUtils":function(){define(["./mathUtils","../lib/glMatrix","../lib/SunCalc"],function(s,q,n){var k=q.vec3d,h=q.mat4d,e=s.lerp,c=h.identity(),b={azimuth:0,altitude:0},
g={ambient:{color:k.create(),intensity:0},diffuse:{color:k.create(),intensity:0,direction:k.create()}},f={settings:{local:{altitude:2E3,ambientAtNight:0.2,ambientAtNoon:0.75,ambientAtTwilight:0.5,diffuseAtNoon:0.25,diffuseAtTwilight:0.5},global:{altitude:2E4,ambient:0.5,diffuse:0.5}},computeDirection:function(a,f,d,m){m||(m=k.create());var p=h.identity(c);"global"===d?(n.getPosition(a,0,0,b),k.set3(0,0,-1,m),h.rotateX(p,-b.azimuth),h.rotateY(p,-b.altitude)):(n.getPosition(a,f.y,f.x,b),k.set3(0,-1,
0,m),h.rotateZ(p,-b.azimuth),h.rotateX(p,-b.altitude));h.multiplyVec3(p,m);return m},computeColorAndIntensity:function(b,l){var d,m,p,c=l.z;m=f.settings;k.set3(1,1,1,g.ambient.color);g.ambient.intensity=m.global.ambient;k.set3(1,1,1,g.diffuse.color);g.diffuse.intensity=m.global.diffuse;c=(c-m.local.altitude)/(m.global.altitude-m.local.altitude);c=s.clamp(c,0,1);if(1>c){p=n.getTimes(b,l.y,l.x);m=b.valueOf();var h,v;p.polarException===n.POLAR_EXCEPTION.MIDNIGHT_SUN?(h=m-36E5*(b.getHours()+48)-6E4*b.getMinutes(),
v=h+432E6):p.polarException===n.POLAR_EXCEPTION.POLAR_NIGHT?(h=m-2,v=m-1):(h=p.sunrise.valueOf(),v=p.sunset.valueOf());var u=v-h;p=h+u/2;var z=u/4;d=p-z;var z=p+z,w=0.06*u,u=h-w/2;h+=w/2;var C=v-w/2,A=v+w/2;v=f.settings.local;var y=[0.01,v.ambientAtNight],B=[0.8,0.8,1],D=[0.01,0.01,0.01],F=[v.diffuseAtTwilight,v.ambientAtTwilight],H=[1,0.75,0.75],N=[0.8,0.8,1],G=[0.9*v.diffuseAtNoon,v.ambientAtNoon],O=[1,0.98,0.98],M=[0.98,0.98,1],I=[v.diffuseAtNoon,v.ambientAtNoon],Z=[1,1,1],q=[1,1,1];v=[0,0];var L=
[0,0],w=[0,0];m<u||m>A?(v=y,L=D,w=B):m<h?(w=h-u,v=a(m-u,w,y,F),L=a(m-u,w,D,H),w=a(m-u,w,B,N)):m<d?(w=d-h,v=a(m-h,w,F,G),L=a(m-h,w,H,O),w=a(m-h,w,N,M)):m<p?(w=p-d,v=a(m-d,w,G,I),L=a(m-d,w,O,Z),w=a(m-d,w,M,q)):m<z?(w=z-p,v=a(m-p,w,I,G),L=a(m-p,w,Z,O),w=a(m-p,w,q,M)):m<C?(w=C-z,v=a(m-z,w,G,F),L=a(m-z,w,O,H),w=a(m-z,w,M,N)):m<A&&(w=A-C,v=a(m-C,w,F,y),L=a(m-C,w,H,D),w=a(m-C,w,N,B));m=v[0];p=L;d=v[1];k.lerp(w,g.ambient.color,c,g.ambient.color);g.ambient.intensity=e(d,g.ambient.intensity,c);k.lerp(p,g.diffuse.color,
c,g.diffuse.color);g.diffuse.intensity=e(m,g.diffuse.intensity,c)}return g}},a=function(a,b,d,m){for(var p=[],f=0;f<d.length;f++)p[f]=(m[f]-d[f])*a/b+d[f];return p};return f})},"esri/views/3d/lib/SunCalc":function(){define([],function(){function s(u){return new Date((u+0.5-d)*l)}function q(u,a){return g(e(a)*c(t)+c(a)*e(t)*e(u))}function n(u,a){var d=r*(357.5291+0.98560028*u),m=r*(1.9148*e(d)+0.02*e(2*d)+3E-4*e(3*d)),d=d+m+102.9372*r+h;a||(a={dec:0,ra:0});a.dec=q(d,0);a.ra=f(e(d)*c(t)-b(0)*e(t),c(d));
return a}function k(u){var a=r*(134.963+13.064993*u),d=r*(93.272+13.22935*u);u=r*(218.316+13.176396*u)+6.289*r*e(a);d=5.128*r*e(d);a=385001-20905*c(a);return{ra:f(e(u)*c(t)-b(d)*e(t),c(u)),dec:q(u,d),dist:a}}var h=Math.PI,e=Math.sin,c=Math.cos,b=Math.tan,g=Math.asin,f=Math.atan2,a=Math.acos,r=h/180,l=864E5,d=2440588,m=2451545,p={dec:0,ra:0},t=23.4397*r,x={POLAR_EXCEPTION:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(u,a,C,t){C=r*-C;a*=r;var h=u.valueOf()/l-0.5+d-m;u=n(h,p);C=r*(280.16+
360.9856235*h)-C-u.ra;t||(t={azimuth:0,altitude:0});t.azimuth=f(e(C),c(C)*e(a)-b(u.dec)*c(a));t.altitude=g(e(a)*e(u.dec)+c(a)*c(u.dec)*c(C));return t}},v=[[-0.83,"sunrise","sunset"]];x.addTime=function(u,a,b){v.push([u,a,b])};var u=9E-4;x.getTimes=function(z,b,p){function f(z){z=a((e(z)-e(B)*e(N))/(c(B)*c(N)));return m+(u+(z+g)/(2*h)+t)+0.0053*e(F)-0.0069*e(2*k)}var g=r*-p,B=r*b,t=Math.round(z.valueOf()/l-0.5+d-m-u-g/(2*h));z=u+(0+g)/(2*h)+t;var F=r*(357.5291+0.98560028*z);b=r*(1.9148*e(F)+0.02*e(2*
F)+3E-4*e(3*F));var k=F+b+102.9372*r+h,N=q(k,0);z=m+z+0.0053*e(F)-0.0069*e(2*k);b={solarNoon:s(z),nadir:s(z-0.5),polarException:x.POLAR_EXCEPTION.NORMAL};var G,n,M,I;p=0;for(G=v.length;p<G;p+=1)n=v[p],M=f(n[0]*r),I=z-(M-z),b[n[1]]=s(I),b[n[2]]=s(M);b.polarException=function(u){u=(e(u)-e(B)*e(N))/(c(B)*c(N));return-1>u?x.POLAR_EXCEPTION.MIDNIGHT_SUN:1<u?x.POLAR_EXCEPTION.POLAR_NIGHT:x.POLAR_EXCEPTION.NORMAL}(v[0][0]*r);return b};x.getMoonPosition=function(u,a,p){p=r*-p;a*=r;var t=u.valueOf()/l-0.5+
d-m;u=k(t);p=r*(280.16+360.9856235*t)-p-u.ra;t=g(e(a)*e(u.dec)+c(a)*c(u.dec)*c(p));t+=0.017*r/b(t+10.26*r/(t+5.1*r));return{azimuth:f(e(p),c(p)*e(a)-b(u.dec)*c(a)),altitude:t,distance:u.dist}};x.getMoonFraction=function(u){var b=u.valueOf()/l-0.5+d-m;u=n(b);b=k(b);u=a(e(u.dec)*e(b.dec)+c(u.dec)*c(b.dec)*c(u.ra-b.ra));u=f(149598E3*e(u),b.dist-149598E3*c(u));return(1+c(u))/2};return x})},"esri/views/3d/support/earthUtils":function(){define(["dojo/_base/lang","./mathUtils","../../../geometry/Point",
"../../../geometry/SpatialReference","../../../geometry/support/webMercatorUtils"],function(s,q,n,k,h){var e=6378137,c=Math.PI*e,b=new n(0,0,k.WGS84),g={earthRadius:e,halfEarthCircumference:c,earthCircumference:2*c,metersPerDegree:c/180,getGreatCircleDistance:function(b,a,g,l){void 0===g&&(void 0===l&&s.isObject(b)&&s.isObject(a))&&(g=a.get("longitude"),l=a.get("latitude"),a=b.get("latitude"),b=b.get("longitude"));a=q.deg2rad(a);l=q.deg2rad(l);b=q.deg2rad(b);g=q.deg2rad(g);b-=g;g=Math.sin((a-l)/2);
b=Math.sin(b/2);a=2*q.asin(Math.sqrt(g*g+Math.cos(a)*Math.cos(l)*b*b))*e;return a=Math.round(1E4*a)/1E4},getGreatCircleSpanAt:function(b,a,g){var l=a.spatialReference,d=new n(a.x,b.y,l),m=new n(g.x,b.y,l);a=new n(b.x,a.y,l);b=new n(b.x,g.y,l);return{lon:this.getGreatCircleDistance(d,m),lat:this.getGreatCircleDistance(a,b)}},getLonDeltaForDistance:function(b,a,g){b=g/e;a=q.deg2rad(a);b=Math.sin(b/2);a=Math.cos(a);a=2*q.asin(Math.sqrt(b*b/(a*a)));return q.rad2deg(a)},getLatDeltaForDistance:function(b,
a,g){return q.rad2deg(g/e)},getLatLonDeltaForDistance:function(b,a,g){return{lat:this.getLatDeltaForDistance(b,a,g),lon:this.getLonDeltaForDistance(b,a,g)}},getMaxCameraAltitude:function(b){b=q.deg2rad(b/2);return(1-Math.sin(b))*e/Math.sin(b)},getViewExtentDistance:function(b,a){var g=q.deg2rad(a/2),g=(b+e)*Math.cos(g)-Math.sqrt(Math.pow(Math.cos(g)*(b+e),2)-b*b-2*b*e);return 2*q.acos((Math.pow(b+e,2)+Math.pow(e,2)-Math.pow(g,2))/(2*(b+e)*e))*e},computeCarthesianDistance:function(b,a){function g(a){var b=
q.deg2rad(a.get("latitude")),d=q.deg2rad(a.get("longitude")),f=Math.cos(b);a=e+(a.z||0);return[Math.cos(d)*f*a,Math.sin(b)*a,-Math.sin(d)*f*a]}var l=g(b),d=g(a),l=[d[0]-l[0],d[1]-l[1],d[2]-l[2]];return Math.sqrt(l[0]*l[0]+l[1]*l[1]+l[2]*l[2])},longitudeToTimezone:function(b,a){var g=b/15;a||(g=Math.round(g));return g},positionToTimezone:function(f,a){f.spatialReference.wkid!==k.WGS84.wkid?h.webMercatorToGeographic(f,!1,b):(b.x=f.x,b.y=f.y);b.z=f.z;a||(a={hours:0,minutes:0,seconds:0});a.hours=g.longitudeToTimezone(b.x,
!0);var c=a.hours%1;a.hours-=c;a.minutes=60*c;c=a.minutes%1;a.minutes-=c;a.seconds=Math.round(60*c);return a}};return g})},"esri/views/3d/environment/EnvironmentRenderer":function(){define("../support/ExternalRenderer ./MixedPanoramicAtmosphere ./PanoramicAtmosphere ./RealisticAtmosphere ./SimpleAtmosphere ./Stars ../webgl-engine/lib/RenderSlot".split(" "),function(s,q,n,k,h,e,c){return s.createSubclass({declaredClass:"esri.views.3d.environment.EnvironmentRenderer",classMetadata:{properties:{view:{},
viewingMode:{dependsOn:["view.viewingMode"],getter:function(){return this.get("view.viewingMode")||"global"}},atmosphereQuality:{dependsOn:["view.environment.atmosphereEnabled","view.environment.atmosphere.quality"],getter:function(){return this.get("view.environment.atmosphereEnabled")?this.get("view.environment.atmosphere.quality")||"none":"none"}},starsEnabled:{dependsOn:["view.environment.starsEnabled"],getter:function(){return this.get("view.environment.starsEnabled")||!1}},transparent:{dependsOn:["view.basemapTerrain.opacity",
"view.basemapTerrain.wireframe"],getter:function(){var b=this.get("view.basemapTerrain");return b&&b._renderer.isTransparent()}},needsDepthMap:{dependsOn:["_stars.needsDepthMap","_atmosphere.needsDepthMap"],getter:function(){return this._atmosphere&&this._atmosphere.needsDepthMap||this._stars&&this._stars.needsDepthMap}},needsRender:{dependsOn:["_stars.needsRender","_atmosphere.needsRender"],getter:function(){return!(!this._needsRender&&!(this._atmosphere&&this._atmosphere.needsRender||this._stars&&
this._stars.needsRender))}}}},constructor:function(){this._STANDARD_SLOT=c.BACKGROUND;this._SPECIAL_SLOT=c.POSTPROCESSING_ATMOSPHERE;this._slots=[this._STANDARD_SLOT,this._SPECIAL_SLOT];this._stars=this._atmosphere=this._atmosphereReadyPromise=this._AtmosphereClass=null;this._needsRender=!0;this.notifyChange("needsRender")},initialize:function(){this.view._stage.addExternalRenderer(this._slots,this)},destroy:function(){this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=null);this._stars&&
(this._stars.destroy(),this._stars=null);this.view&&(this.view._stage.removeExternalRenderer(this),this.view=null)},setup:function(b){this.watch("viewingMode,atmosphereQuality,transparent,visible",this._updateAtmosphere.bind(this));this._updateAtmosphere();this.watch("starsEnabled,transparent,visible",this._updateStars.bind(this));this._updateStars();this.watch("view.basemapTerrain.loaded",function(){this._needsRender=!0;this.notifyChange("needsRender")}.bind(this))},resetNeedsRender:function(){this._atmosphere&&
(this._atmosphere.resetNeedsRender?this._atmosphere.resetNeedsRender():this._atmosphere.didRender&&(this._atmosphere.needsRender=!1,this._atmosphere.didRender=!1));this._stars&&(this._stars.resetNeedsRender?this._stars.resetNeedsRender():this._stars.didRender&&(this._stars.needsRender=!1,this._stars.didRender=!1));this.didRender&&(this.didRender=this._needsRender=!1,this.notifyChange("needsRender"))},render:function(b){if(!this.get("view.basemapTerrain.loaded")&&"global"===this.viewingMode)return!1;
if(!this._stars&&!this._atmosphere)return!0;this._stars&&this._stars.render(b);this._atmosphere&&this._atmosphere.render(b);return this._stars&&this._stars.didRender||this._atmosphere&&this._atmosphere.didRender},_updateStars:function(){var b=this._getAtmosphereSlot();this.starsEnabled&&!this._stars?(this._stars=new e({view:this.view,slot:b}),this._stars.initializeRenderContext(this.renderContext)):!this.starsEnabled&&this._stars?(this._stars.destroy(),this._stars=null):this._stars&&(this._stars.slot=
b);this._needsRender=!0;this.notifyChange("needsRender")},_updateAtmosphere:function(){var b=this._getAtmosphereSlot();this._atmosphere&&(this._atmosphere.slot=b);if(this._updateAtmosphereClass()){this._needsRender=!0;this.notifyChange("needsRender");var g=function(){this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=null)}.bind(this);if(this._AtmosphereClass){this._atmosphereReadyPromise&&(this._atmosphereReadyPromise.cancel(),this._atmosphereReadyPromise=null);var f=new this._AtmosphereClass({view:this.view,
slot:b});f.initializeRenderContext(this.renderContext);this._atmosphere?this._atmosphereReadyPromise=f.then(function(){g();this._atmosphereReadyPromise=null;this._atmosphere=f}.bind(this)):this._atmosphere=f}else g()}},_updateAtmosphereClass:function(){var b=this._AtmosphereClass;this._AtmosphereClass="none"===this.atmosphereQuality?null:"high"===this.atmosphereQuality&&!this.transparent?"local"===this.viewingMode?q:k:"local"===this.viewingMode?n:h;return this._AtmosphereClass!==b},_getAtmosphereSlot:function(){return this.transparent&&
"global"===this.viewingMode?this._SPECIAL_SLOT:this._STANDARD_SLOT}})})},"esri/views/3d/support/ExternalRenderer":function(){define("../../../core/declare ../../../core/Accessoire ../../../core/AccessoirePromise dojo/Deferred dojo/aspect dojo/_base/lang".split(" "),function(s,q,n,k,h,e){return s([q,n],{"-chains-":e.mixin(q._meta.chains,{setup:"after",initializeRenderContext:"after"}),classMetadata:{properties:{gl:{readOnly:!0,getter:function(){return this._gl}},needsRender:{value:!0},visible:{value:!0},
needsDepthMap:{value:!1}}},constructor:function(){this.didRender=!1;this.renderContext=null;this.watch("visible",function(){this.needsRender=!0}.bind(this));this._contextDfd=new k},initialize:function(){this.addResolvingPromise(this._contextDfd.promise);h.around(this,"render",function(c){return function(){return this.isRejected()?this.didRender=!0:!this.isResolved()?!1:!this.visible||c.apply(this,arguments)?this.didRender=!0:!1}.bind(this)}.bind(this));this.then(function(){this._accessorProps&&this.setup(this.renderContext)}.bind(this))},
needsRender:!0,visible:!0,needsDepthMap:!1,initializeRenderContext:function(c){this.renderContext=c;this._contextDfd.resolve()},setup:function(c){},render:function(c){return!1}})})},"esri/views/3d/environment/MixedPanoramicAtmosphere":function(){define(["../support/ExternalRenderer","./RealisticAtmosphere","./PanoramicAtmosphere","../webgl-engine/lib/RenderSlot"],function(s,q,n,k){return s.createSubclass({declaredClass:"esri.views.3d.environment.MixedPanoramicAtmosphere",classMetadata:{properties:{view:{},
needsRender:{dependsOn:["_panoramicAtmosphere.needsRender","_realisticAtmosphere.needsRender"],getter:function(){return this._panoramicAtmosphere.needsRender||this._realisticAtmosphere.needsRender}},needsDepthMap:{dependsOn:["_panoramicAtmosphere.needsDepthMap","_realisticAtmosphere.needsDepthMap"],getter:function(){return this._panoramicAtmosphere.needsDepthMap||this._realisticAtmosphere.needsDepthMap}},slot:{value:k.BACKGROUND,setter:function(h){this._panoramicAtmosphere&&(this._panoramicAtmosphere.slot=
h);return h}}}},initialize:function(){this._panoramicAtmosphere=new n({view:this.view,slot:this.slot});this._realisticAtmosphere=new q({view:this.view,planar:!0});this.addResolvingPromise(this._panoramicAtmosphere);this.addResolvingPromise(this._realisticAtmosphere)},destroy:function(){this._panoramicAtmosphere&&(this._panoramicAtmosphere.destroy(),this._panoramicAtmosphere=null);this._realisticAtmosphere&&(this._realisticAtmosphere.destroy(),this._realisticAtmosphere=null)},initializeRenderContext:function(h){this._panoramicAtmosphere.initializeRenderContext(h);
this._realisticAtmosphere.initializeRenderContext(h)},render:function(h){this._panoramicAtmosphere.render(h);this._realisticAtmosphere.render(h);return this._panoramicAtmosphere.didRender||this._realisticAtmosphere.didRender},resetNeedsRender:function(){this._panoramicAtmosphere.resetNeedsRender?this._panoramicAtmosphere.resetNeedsRender():this._panoramicAtmosphere.didRender&&(this._panoramicAtmosphere.needsRender=!1,this._panoramicAtmosphere.didRender=!1);this._realisticAtmosphere.resetNeedsRender?
this._realisticAtmosphere.resetNeedsRender():this._realisticAtmosphere.didRender&&(this._realisticAtmosphere.needsRender=!1,this._realisticAtmosphere.didRender=!1)},_setEnableTestImage:function(h){this._realisticAtmosphere._setEnableTestImage(h)}})})},"esri/views/3d/environment/RealisticAtmosphere":function(){define("dojo/text!./materials/RealisticAtmosphereMaterial.xml ../../../core/watchUtils ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/VertexBufferLayout ../webgl-engine/lib/GLSLProgram ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../support/earthUtils".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a){var r=a.earthRadius,l=k.vec3d,d=k.vec2d,m=k.vec4d;return n.createSubclass({declaredClass:"esri.views.3d.environment.RealisticAtmosphere",classMetadata:{properties:{view:{},planar:{value:!1,setter:function(a){a=!!a;a!==this.planar&&this._update(this.get("view.navigation.currentCamera"));return a}},needsDepthMap:{value:!0}}},constructor:function(){this._renderer=this._skyPlanarProgram=this._skyProgram=this._hazePlanarProgram=this._hazeProgram=this._currentViewChangedHandle=
null;var a=0.02*Math.PI,b=0.0040*Math.PI,g=l.createFrom(1/Math.pow(0.65,4),1/Math.pow(0.57,4),1/Math.pow(0.475,4)),c=l.create(g);l.scale(c,a);l.add(c,l.createFrom(b,b,b));var a=r*r,b=10.25*(r/10),u=b*b,z=1/(b-r),w=z/0.25,e=z/0.05,A=-0.99999*-0.99999,h=1.5*((1-A)/(2+A)),B=0.3*(b-r)+r,D=1/(b-B);this._renderData={texDepth:d.create(),v3CameraPos:l.create(),v3CameraUp:l.create(),v3CameraRight:l.create(),v3CameraDir:l.create(),v3CameraCenter:l.create(),halfSizeNearPlane:d.create(),v2CameraCenterOffset:d.create(),
v4Viewport:m.create(),v4SphereComp:m.create(),v4AtmosParams1:m.createFrom(z,0.25,w,4),v4AtmosParams2:m.createFrom(-0.99999,0.05,e,20),v4AtmosParams3:m.createFrom(A,h,B,D),v3InvWavelength:g,v3InvWavelengthScaled:c,v4Radii:m.createFrom(r,a,b,u),fScale:z,fScaleDepth:0.25,fLowerAlphaBlendBound:B,fScaleOverScaleDepth:w,fOneOverScaleDepth:4,fScaleDepthBlue:0.05,fOneOverScaleDepthBlue:20,fScaleOverScaleDepthBlue:e,g:-0.99999,g2:A,fMiePhaseCoefficients:h,showTest:0,nearFar:d.create()};this._hazeSlot=f.POSTPROCESSING_ATMOSPHERE;
this._skySlot=f.BACKGROUND},destroy:function(){this._currentViewChangedHandle&&(this._currentViewChangedHandle.remove(),this._currentViewChangedHandle=null);this._hazeProgram&&(this._hazeProgram.dispose(),this._hazeProgram=null);this._hazePlanarProgram&&(this._hazePlanarProgram.dispose(),this._hazePlanarProgram=null);this._skyProgram&&(this._skyProgram.dispose(),this._skyProgram=null);this._skyPlanarProgram&&(this._skyPlanarProgram.dispose(),this._skyPlanarProgram=null)},setup:function(a){var d=b.createSquareGeometry(),
d={faces:d.getFaces()[0],vertexAttr:d.getVertexAttr()};this._renderer=new h(d,e.Defaults.PosTex,null,a.gl);this._currentViewChangedHandle=q.on(this,"view.navigation","currentViewChanged",function(a){this._update(a.camera)}.bind(this),function(){this._update(this.get("view.navigation.currentCamera"))}.bind(this));a.shaderSnippets.fsRealisticAtmosphere||a.shaderSnippets._parse(s);this._hazeProgram=c.fromSnippets("vsRealisticAtmosphere","fsRealisticAtmosphere",a.shaderSnippets,a.gl,["HAZE"]);this._skyProgram=
c.fromSnippets("vsRealisticAtmosphere","fsRealisticAtmosphere",a.shaderSnippets,a.gl);this._hazePlanarProgram=c.fromSnippets("vsRealisticAtmosphere","fsRealisticAtmosphere",a.shaderSnippets,a.gl,["HAZE","PLANAR"]);this._skyPlanarProgram=c.fromSnippets("vsRealisticAtmosphere","fsRealisticAtmosphere",a.shaderSnippets,a.gl,["PLANAR"])},render:function(a){if((a.slot==this._hazeSlot||a.slot==this._skySlot)&&a.pass==g.MATERIAL){var b,d=this.renderContext.gl;if(a.slot==this._hazeSlot){b=this.planar?this._hazePlanarProgram:
this._hazeProgram;b.use();b.uniform1i("tColor",1);d.activeTexture(d.TEXTURE1);d.bindTexture(d.TEXTURE_2D,a.framebufferTex);if(void 0!==a.depth)d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,a.depth.getTexture()),b.uniform4fv("v4SphereComp",this._renderData.v4SphereComp);else{var m=new Float32Array(4);m[2]=0;b.uniform4fv("v4SphereComp",m)}b.uniform1i("tDepth",0);b.uniform4fv("v4Viewport",this._renderData.v4Viewport)}a.slot==this._skySlot&&(b=this.planar?this._skyPlanarProgram:this._skyProgram,
b.use(),b.uniform4fv("v4SphereComp",this._renderData.v4SphereComp),b.uniform4fv("v4AtmosParams3",this._renderData.v4AtmosParams3));b.uniform3fv("v3InvWavelength",this._renderData.v3InvWavelength);b.uniform3fv("v3InvWavelengthScaled",this._renderData.v3InvWavelengthScaled);b.uniform3fv("v3LightDir",a.lightingData.direction);b.uniform3fv("v3CameraPos",this._renderData.v3CameraPos);b.uniform3fv("v3CameraUp",this._renderData.v3CameraUp);b.uniform3fv("v3CameraRight",this._renderData.v3CameraRight);b.uniform3fv("v3CameraDir",
this._renderData.v3CameraDir);b.uniform2fv("nearFar",this._renderData.nearFar);b.uniform2fv("halfSizeNearPlane",this._renderData.halfSizeNearPlane);b.uniform2fv("v2CameraCenterOffset",this._renderData.v2CameraCenterOffset);b.uniform4fv("v4Radii",this._renderData.v4Radii);b.uniform4fv("v4AtmosParams1",this._renderData.v4AtmosParams1);b.uniform4fv("v4AtmosParams2",this._renderData.v4AtmosParams2);b.uniform1f("showTest",this._renderData.showTest);d.disable(d.DEPTH_TEST);d.enable(d.BLEND);d.blendFunc(d.SRC_ALPHA,
d.ONE_MINUS_SRC_ALPHA);this._renderer.render(b);c.unuse(d);d.disable(d.BLEND);d.enable(d.DEPTH_TEST);return!0}},_setEnableTestImage:function(a){this._renderData.showTest=a?1:0;this.needsRender=!0},_update:function(a){if(a&&(this.planar||!(l.length(a.eye)<=r))){var b=a.viewMatrix;l.set3(b[2],b[6],b[10],this._renderData.v3CameraDir);l.normalize(this._renderData.v3CameraDir);this.planar?(b=this.view.renderCoordsHelper,this._renderData.fCameraHeight=b.getAltitude(a.eye)/b.unitInMeters+r):this._renderData.fCameraHeight=
l.length(a.eye);this._renderData.fCameraHeight2=this._renderData.fCameraHeight*this._renderData.fCameraHeight;this._renderData.fC=this._renderData.fCameraHeight2-this._renderData.v4Radii[3];this._renderData.fCSur=this._renderData.fCameraHeight2-this._renderData.v4Radii[1];this._renderData.v4SphereComp=m.createFrom(this._renderData.fCameraHeight,this._renderData.fCameraHeight2,this._renderData.fC,this._renderData.fCSur);l.set(a.eye,this._renderData.v3CameraPos);l.set(a.center,this._renderData.v3CameraCenter);
l.set(a.up,this._renderData.v3CameraUp);l.normalize(this._renderData.v3CameraUp);l.cross(a.up,this._renderData.v3CameraDir,this._renderData.v3CameraRight);l.normalize(this._renderData.v3CameraRight);d.set2(Math.tan(a.fovX/2)/(a.width/a.fullWidth),Math.tan(a.fovY/2)/(a.height/a.fullHeight),this._renderData.halfSizeNearPlane);m.set(a.fullViewport,this._renderData.v4Viewport);d.set2((a.padding[3]+a.width/2)/a.fullWidth-0.5,(a.padding[2]+a.height/2)/a.fullHeight-0.5,this._renderData.v2CameraCenterOffset);
d.set2(a.near,a.far,this._renderData.nearFar);this.needsRender=!0}}})})},"esri/views/3d/webgl-engine/lib/GeometryRenderer":function(){define(["require","exports","./GLVBO","../materials/internal/MaterialUtil"],function(s,q,n,k){return function(){function h(e,c,b,g){this._drawMode=4;this._layout=c;var f=e.faces;this._count=f.indices[f.positionKey].length;f=new Float32Array(this._count*c.getStride());(b||k.fillInterleaved)(e,void 0,void 0,null,c,f,0);this._gl=g;this._vbo=new n(f,c,g)}h.prototype.enablePointRendering=
function(e){this._drawMode=e?0:4};h.prototype.render=function(e){this._vbo.bind();this._vbo.setPointers(e);this._layout.enableVertexAttribArrays(this._gl,e);this._gl.drawArrays(this._drawMode,0,this._count);this._layout.disableVertexAttribArrays(this._gl,e);this._gl.bindBuffer(34962,null)};return h}()})},"esri/views/3d/webgl-engine/lib/GLVBO":function(){define(["require","exports"],function(s,q){return function(){function n(k,h,e){this.glName=e.createBuffer();this.num=0;this.vertexBufferLayout=h;
this.gl=e;void 0!==k&&this.setData(k,k.length,e.STATIC_DRAW);this.id=n.__GLVBO_id++}n.prototype.setData=function(k,h,e){void 0===e&&(e=35044);var c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,this.glName);c.bufferData(c.ARRAY_BUFFER,k,e);c.bindBuffer(c.ARRAY_BUFFER,null);this.num=h/this.vertexBufferLayout.getStride()};n.prototype.updateSubData=function(k,h,e){var c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,this.glName);c.bufferSubData(c.ARRAY_BUFFER,4*h,k.subarray(h,e));c.bindBuffer(c.ARRAY_BUFFER,null)};n.prototype.bind=
function(){var k=this.gl;k.bindBuffer(k.ARRAY_BUFFER,this.glName)};n.prototype.setPointers=function(k,h){this.vertexBufferLayout.setVertexAttribPointers(this.gl,k)};n.prototype.getNum=function(){return this.num};n.prototype.getId=function(){return this.id};n.prototype.getLayout=function(){return this.vertexBufferLayout};n.prototype.dispose=function(){this.gl.deleteBuffer(this.glName)};n.__GLVBO_id=0;return n}()})},"esri/views/3d/webgl-engine/materials/internal/MaterialUtil":function(){define(["../../lib/IdGen",
"../../lib/gl-matrix","../../parts/Model","../../lib/VertexBufferLayout","../../lib/Util"],function(s,q,n,k,h){var e=q.vec3d,c=q.mat4d,b=q.mat4,g=h.VertexAttrConstants,f={};f.__Material_idGen=new s;f.__GLMaterial_id=0;f.IDENTITY=c.identity();f.Layouts=k.Defaults;f.fill=function(u,a,b,d,m,p){if(void 0===m||3!==p)for(m=0;m<p;++m)b[d+m]=u[a+m];else{var g=u[a],f=u[a+1];u=u[a+2];b[d]=m[0]*g+m[4]*f+m[8]*u+m[12];b[d+1]=m[1]*g+m[5]*f+m[9]*u+m[13];b[d+2]=m[2]*g+m[6]*f+m[10]*u+m[14]}return p};var a=function(u,
a,b,d,m,p){for(var g=u.length,f=0;f<g;++f){for(var l=b*u[f],c=0;c<b;++c)d[m+c]=a[l+c];m+=p}};f.fillInterleaved=function(u,b,d,m,p,f,l,c){var e=p.getAttributes();p=p.getStride();for(var r in e){var t=l+e[r].offset;if(!(null!=c&&null==c[r])){var h;switch(r){case g.UV0:h=u.vertexAttr[r];null!=h&&a(u.faces.indices[r],h.data,h.size,f,t,p);break;case g.REGION:h=u.vertexAttr[r];var k=u.faces.indices[r],x=h.data,v=h.size;h=f;var n=p;h=new Uint16Array(h.buffer);for(var t=2*t,n=2*n,q=k.length,L=0;L<q;++L){var s=
v*k[L],E;for(E=0;E<v;++E)h[t+E]=x[s+E];t+=n}break;case g.COLOR:h=u.vertexAttr[r];if(m&&m.color){k=u.faces.indices[r];x=h.data;v=m.color;h=h.size;n=f;q=p;n=new Uint8Array(n.buffer);t*=4;q*=4;L=k.length;for(s=0;s<L;++s){E=h*k[s];var ba;for(ba=0;ba<h;++ba)n[t+ba]=x[E+ba]*v[ba];4>ba&&(n[t+3]=255*v[3]);t+=q}}else{k=u.faces.indices[r];x=h.data;v=h.size;h=f;n=p;h=new Uint8Array(h.buffer);t*=4;n*=4;q=k.length;for(L=0;L<q;++L){s=v*k[L];for(E=0;E<v;++E)h[t+E]=x[s+E];4>E&&(h[t+3]=255);t+=n}}break;default:if(h=
u.vertexAttr[r],v=r===g.POSITION?b:r===g.NORMAL?d:void 0,void 0!==v&&3===h.size){k=u.faces.indices[r];x=h.data;h=f;n=p;q=k.length;for(L=0;L<q;++L)ba=3*k[L],s=x[ba],E=x[ba+1],ba=x[ba+2],h[t]=v[0]*s+v[4]*E+v[8]*ba+v[12],h[t+1]=v[1]*s+v[5]*E+v[9]*ba+v[13],h[t+2]=v[2]*s+v[6]*E+v[10]*ba+v[14],t+=n}else a(u.faces.indices[r],h.data,h.size,f,t,p)}}}};f.triangleVertexArrayToWireframeLines=function(u,a,b,d){for(b=Math.floor(b/3)-1;0<=b;b--){var m=a+3*b*d,p=a+6*b*d+5*d;this.fill(u,m,u,p,null,d);p-=d;this.fill(u,
m+d,u,p,null,d);p-=d;this.fill(u,m+d,u,p,null,d);p-=d;this.fill(u,m+2*d,u,p,null,d);p-=d;this.fill(u,m+2*d,u,p,null,d);p-=d;this.fill(u,m,u,p,null,d)}};var r=e.create(),l=e.create(),d=e.create(),m=e.create(),p=function(u,a,b,g,f){var c=u.getCenter();e.project(c,a,b,r);var c=e.dist2(r,c),B=u.getBSRadius();if(c<B*B){var c=u.getPrimitiveIndices(),B=u.getIndices(),h=u.getPosition(),t=c?c.length:B.length/3;if(1E4<t&&(u=u.getChildren(),void 0!==u)){for(c=0;8>c;++c)void 0!==u[c]&&p(u[c],a,b,g,f);return}u=
h.size;var h=h.data,k=a[0],x=a[1];a=a[2];var v=b[0]-k,n=b[1]-x;b=b[2]-a;for(var M=0;M<t;++M){var I=c?c[M]:M,q=u*B[3*I],s=u*B[3*I+1],L=u*B[3*I+2],Y=h[q],E=h[q+1],q=h[q+2],ba=h[s],W=h[s+1],s=h[s+2],R=h[L],T=h[L+1],L=h[L+2],J=ba-Y,S=W-E,K=s-q,Q=R-Y,U=T-E,X=L-q,P=n*X-U*b,$=b*Q-X*v,ea=v*U-Q*n,ca=J*P+S*$+K*ea;if(!(ca>-g&&ca<g)){var ca=1/ca,ha=k-Y,fa=x-E,da=a-q,P=ca*(ha*P+fa*$+da*ea);0>P||1<P||($=fa*K-S*da,K=da*J-K*ha,J=ha*S-J*fa,S=ca*(v*$+n*K+b*J),0>S||1<P+S||(Q=ca*(Q*$+U*K+X*J),0<=Q&&(U=l,X=d,ca=m,e.set3(Y,
E,q,U),e.set3(ba,W,s,X),e.set3(R,T,L,ca),e.subtract(X,U,X),e.subtract(ca,U,ca),e.normalize(e.cross(X,ca,U)),f(Q,U,I))))}}}};f.intersectTriangleGeometry=function(u,a,b,d,m,g,f,l,c,e,r){h.assert("triangle"===u.getData().getFaces()[a].type);p(u.getBoundingInfo(a),f,l,e,r)};f.basicMaterialConstructor=function(u,a){var b=!0,d=0,m=f.__Material_idGen.gen(a);u.getId=function(){return m};var p;u.getParentStage=function(){return p};u.addParentStage=function(u){h.assert(void 0===p,"Material can only be added to a single Stage");
p=u};u.removeParentStage=function(u){p=void 0};u.setVisible=function(a){b!==a&&(b=a,u.notifyDirty("matChanged"))};u.isVisible=function(){return b};u.notifyDirty=function(a){p&&p.notifyDirty(n.ContentType.MATERIAL,u,a)};u.setRenderPriority=function(u){d=u;this.notifyDirty("matChanged")};u.getRenderPriority=function(){return d}};var t=f.aquireIfNotUndefined=function(u,a,b,d){return void 0===u?void 0:b.aquire(u,a,d)},x=f.releaseIfNotUndefined=function(u,a){void 0!==u&&a.release(u)},v=b.create();f.bindView=
function(u,a,d){b.translate(a,u,v);d.uniformMatrix4fv("view",v)};f.bindCamPos=function(u,a,b){b.uniform3f("camPos",a[3]-u[0],a[7]-u[1],a[11]-u[2])};f.basicGLMaterialConstructor=function(u,a){var b=f.__GLMaterial_id++;u.getId=function(){return b};u.getMaterialId=function(){return a.getId()};var d=!0;u.isVisible=function(){return d};u.updateVisibility=function(){d=a.isVisible()};u.getRenderPriority=function(){return a.getRenderPriority()}};f.singleTextureGLMaterialConstructor=function(u,a,b,d){var m=
t(b.textureId,b.initTexture,a,d);u.updateTexture=function(u){b.textureId!==u&&(x(b.textureId,a),b.textureId=u,m=t(b.textureId,b.initTexture,a,d))};u.renderTexture=function(u){var d=a.getTexture(b.textureId);d&&d.renderGl&&d.renderGl(m,u)};u.bindTexture=function(u,a){void 0!==m&&(a.uniform1i("tex",0),u.bindTexture(u.TEXTURE_2D,m))};u.dispose=function(){x(b.textureId,a)}};f.multiTextureGLMaterialConstructor=function(u,a,b,d){for(var m=d.length,p=Array(m),g=0;g<m;g++)p[g]=t(b[d[g][0]],b[d[g][1]],a);
u.updateTextures=function(u){for(var g=0;g<m;g++){var f=b[d[g][0]],l=u[d[g][0]];f!==l&&(x(f,a),b[d[g][0]]=l,p[g]=t(l,b[d[g][1]],a))}};u.bindTextures=function(u,a){for(var b=0;b<m;b++)void 0!==p[b]&&(a.uniform1i(d[b][2],b),u.activeTexture(u.TEXTURE0+b),u.bindTexture(u.TEXTURE_2D,p[b]));u.activeTexture(u.TEXTURE0)};u.bindOneTexture=function(u,a,b){a.uniform1i(d[b][2],b);u.activeTexture(u.TEXTURE0+b);u.bindTexture(u.TEXTURE_2D,p[b]);u.activeTexture(u.TEXTURE0)};u.disposeTextures=function(){for(var u=
0;u<m;u++)x(b[d[u][0]],a)}};return f})},"esri/views/3d/webgl-engine/lib/IdGen":function(){define(["require","exports"],function(s,q){return function(){function n(){this.id2count={}}n.prototype.gen=function(k){null==k&&(k="a");var h=this.id2count[k];if(null==h)return this.id2count[k]=0,k;for(;;){var e=k+"_"+h++;if(null==this.id2count[e])return this.id2count[k]=h,this.id2count[e]=0,e}};return n}()})},"esri/views/3d/webgl-engine/lib/gl-matrix":function(){define([],function(){var s={};(function(q,n){n(q,
!0);n(q,!1)})(s,function(q,n){var k={};(function(){if("undefined"!=typeof Float32Array){var u=new Float32Array(1),a=new Int32Array(u.buffer);k.invsqrt=function(b){u[0]=b;a[0]=1597463007-(a[0]>>1);var d=u[0];return d*(1.5-0.5*b*d*d)}}else k.invsqrt=function(u){return 1/Math.sqrt(u)}})();var h=Array;"undefined"!=typeof Float32Array&&(h=n?Float32Array:Array);var e={create:function(u){var a=new h(3);u?(a[0]=u[0],a[1]=u[1],a[2]=u[2]):a[0]=a[1]=a[2]=0;return a},createFrom:function(u,a,b){var d=new h(3);
d[0]=u;d[1]=a;d[2]=b;return d},set:function(u,a){a[0]=u[0];a[1]=u[1];a[2]=u[2];return a},set3:function(u,a,b,d){d[0]=u;d[1]=a;d[2]=b;return d},add:function(u,a,b){if(!b||u===b)return u[0]+=a[0],u[1]+=a[1],u[2]+=a[2],u;b[0]=u[0]+a[0];b[1]=u[1]+a[1];b[2]=u[2]+a[2];return b},subtract:function(u,a,b){if(!b||u===b)return u[0]-=a[0],u[1]-=a[1],u[2]-=a[2],u;b[0]=u[0]-a[0];b[1]=u[1]-a[1];b[2]=u[2]-a[2];return b},multiply:function(u,a,b){if(!b||u===b)return u[0]*=a[0],u[1]*=a[1],u[2]*=a[2],u;b[0]=u[0]*a[0];
b[1]=u[1]*a[1];b[2]=u[2]*a[2];return b},max:function(u,a,b){b[0]=Math.max(u[0],a[0]);b[1]=Math.max(u[1],a[1]);b[2]=Math.max(u[2],a[2]);return b},min:function(u,a,b){b[0]=Math.min(u[0],a[0]);b[1]=Math.min(u[1],a[1]);b[2]=Math.min(u[2],a[2]);return b},negate:function(u,a){a||(a=u);a[0]=-u[0];a[1]=-u[1];a[2]=-u[2];return a},scale:function(u,a,b){if(!b||u===b)return u[0]*=a,u[1]*=a,u[2]*=a,u;b[0]=u[0]*a;b[1]=u[1]*a;b[2]=u[2]*a;return b},normalize:function(u,a){a||(a=u);var b=u[0],d=u[1],m=u[2],p=Math.sqrt(b*
b+d*d+m*m);if(p){if(1===p)return a[0]=b,a[1]=d,a[2]=m,a}else return a[0]=0,a[1]=0,a[2]=0,a;p=1/p;a[0]=b*p;a[1]=d*p;a[2]=m*p;return a},cross:function(u,a,b){b||(b=u);var d=u[0],m=u[1];u=u[2];var p=a[0],g=a[1];a=a[2];b[0]=m*a-u*g;b[1]=u*p-d*a;b[2]=d*g-m*p;return b},length:function(u){var a=u[0],b=u[1];u=u[2];return Math.sqrt(a*a+b*b+u*u)},length2:function(u){var a=u[0],b=u[1];u=u[2];return a*a+b*b+u*u},dot:function(u,a){return u[0]*a[0]+u[1]*a[1]+u[2]*a[2]},direction:function(u,a,b){b||(b=u);var d=
u[0]-a[0],m=u[1]-a[1];u=u[2]-a[2];a=Math.sqrt(d*d+m*m+u*u);if(!a)return b[0]=0,b[1]=0,b[2]=0,b;a=1/a;b[0]=d*a;b[1]=m*a;b[2]=u*a;return b},lerp:function(u,a,b,d){d||(d=u);d[0]=u[0]+b*(a[0]-u[0]);d[1]=u[1]+b*(a[1]-u[1]);d[2]=u[2]+b*(a[2]-u[2]);return d},dist:function(u,a){var b=a[0]-u[0],d=a[1]-u[1],m=a[2]-u[2];return Math.sqrt(b*b+d*d+m*m)},dist2:function(u,a){var b=a[0]-u[0],d=a[1]-u[1],m=a[2]-u[2];return b*b+d*d+m*m}},c=null,b=new h(4);e.unproject=function(u,a,d,p,g){g||(g=u);c||(c=m.create());var f=
c;b[0]=2*(u[0]-p[0])/p[2]-1;b[1]=2*(u[1]-p[1])/p[3]-1;b[2]=2*u[2]-1;b[3]=1;m.multiply(d,a,f);if(!m.inverse(f))return null;m.multiplyVec4(f,b);if(0===b[3])return null;g[0]=b[0]/b[3];g[1]=b[1]/b[3];g[2]=b[2]/b[3];return g};var g=e.createFrom(1,0,0),f=e.createFrom(0,1,0),a=e.createFrom(0,0,1);e.rotationTo=function(u,b,d){d||(d=p.create());var m=e.dot(u,b),l=e.create();if(1<=m)p.set(t,d);else if(-0.999999>m)e.cross(g,u,l),1E-6>l.length&&e.cross(f,u,l),1E-6>l.length&&e.cross(a,u,l),e.normalize(l),p.fromAxisAngle(l,
Math.PI,d);else{var m=Math.sqrt(2*(1+m)),c=1/m;e.cross(u,b,l);d[0]=l[0]*c;d[1]=l[1]*c;d[2]=l[2]*c;d[3]=0.5*m;p.normalize(d)}1<d[3]?d[3]=1:-1>d[3]&&(d[3]=-1);return d};var r=e.create(),l=e.create();e.project=function(u,a,b,d){d||(d=u);e.direction(a,b,r);e.subtract(u,a,l);u=e.dot(r,l);e.scale(r,u,d);e.add(d,a,d)};e.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var d={create:function(a){var b=new h(9);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]):
b[0]=b[1]=b[2]=b[3]=b[4]=b[5]=b[6]=b[7]=b[8]=0;return b},createFrom:function(a,b,d,m,p,g,f,l,c){var e=new h(9);e[0]=a;e[1]=b;e[2]=d;e[3]=m;e[4]=p;e[5]=g;e[6]=f;e[7]=l;e[8]=c;return e},determinant:function(a){var b=a[3],d=a[4],m=a[5],p=a[6],g=a[7],f=a[8];return a[0]*(f*d-m*g)+a[1]*(-f*b+m*p)+a[2]*(g*b-d*p)},inverse:function(a,b){var m=a[0],p=a[1],g=a[2],f=a[3],l=a[4],c=a[5],e=a[6],r=a[7],h=a[8],t=h*l-c*r,k=-h*f+c*e,x=r*f-l*e,v=m*t+p*k+g*x;if(!v)return null;v=1/v;b||(b=d.create());b[0]=t*v;b[1]=(-h*
p+g*r)*v;b[2]=(c*p-g*l)*v;b[3]=k*v;b[4]=(h*m-g*e)*v;b[5]=(-c*m+g*f)*v;b[6]=x*v;b[7]=(-r*m+p*e)*v;b[8]=(l*m-p*f)*v;return b},multiply:function(a,b,d){d||(d=a);var m=a[0],p=a[1],g=a[2],f=a[3],l=a[4],c=a[5],e=a[6],r=a[7];a=a[8];var h=b[0],t=b[1],k=b[2],x=b[3],v=b[4],n=b[5],q=b[6],s=b[7];b=b[8];d[0]=h*m+t*f+k*e;d[1]=h*p+t*l+k*r;d[2]=h*g+t*c+k*a;d[3]=x*m+v*f+n*e;d[4]=x*p+v*l+n*r;d[5]=x*g+v*c+n*a;d[6]=q*m+s*f+b*e;d[7]=q*p+s*l+b*r;d[8]=q*g+s*c+b*a;return d},multiplyVec2:function(a,b,d){d||(d=b);var m=b[0];
b=b[1];d[0]=m*a[0]+b*a[3]+a[6];d[1]=m*a[1]+b*a[4]+a[7];return d},multiplyVec3:function(a,b,d){d||(d=b);var m=b[0],p=b[1];b=b[2];d[0]=m*a[0]+p*a[3]+b*a[6];d[1]=m*a[1]+p*a[4]+b*a[7];d[2]=m*a[2]+p*a[5]+b*a[8];return d},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},identity:function(a){a||(a=d.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(!b||a===b){var d=a[1],m=a[2],
p=a[5];a[1]=a[3];a[2]=a[6];a[3]=d;a[5]=a[7];a[6]=m;a[7]=p;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b},toMat4:function(a,b){b||(b=m.create());b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},m={create:function(a){var b=
new h(16);4===arguments.length?(b[0]=arguments[0],b[1]=arguments[1],b[2]=arguments[2],b[3]=arguments[3],b[4]=arguments[4],b[5]=arguments[5],b[6]=arguments[6],b[7]=arguments[7],b[8]=arguments[8],b[9]=arguments[9],b[10]=arguments[10],b[11]=arguments[11],b[12]=arguments[12],b[13]=arguments[13],b[14]=arguments[14],b[15]=arguments[15]):a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=
a[15]);return b},createFrom:function(a,b,d,m,p,g,f,l,c,e,r,t,k,x,v,n){var q=new h(16);q[0]=a;q[1]=b;q[2]=d;q[3]=m;q[4]=p;q[5]=g;q[6]=f;q[7]=l;q[8]=c;q[9]=e;q[10]=r;q[11]=t;q[12]=k;q[13]=x;q[14]=v;q[15]=n;return q},createFromMatrixRowMajor:function(a){var b=new h(16);b[0]=a[0];b[4]=a[1];b[8]=a[2];b[12]=a[3];b[1]=a[4];b[5]=a[5];b[9]=a[6];b[13]=a[7];b[2]=a[8];b[6]=a[9];b[10]=a[10];b[14]=a[11];b[3]=a[12];b[7]=a[13];b[11]=a[14];b[15]=a[15];return b},createFromMatrix:function(a){var b=new h(16);b[0]=a[0];
b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},setRowMajor:function(a,b){b[0]=a[0];b[4]=a[1];b[8]=a[2];b[12]=a[3];b[1]=a[4];b[5]=a[5];b[9]=a[6];b[13]=a[7];b[2]=a[8];b[6]=a[9];b[10]=
a[10];b[14]=a[11];b[3]=a[12];b[7]=a[13];b[11]=a[14];b[15]=a[15];return b},identity:function(a){a||(a=m.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(!b||a===b){var d=a[1],m=a[2],p=a[3],g=a[6],f=a[7],l=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=d;a[6]=a[9];a[7]=a[13];a[8]=m;a[9]=g;a[11]=a[14];a[12]=p;a[13]=f;a[14]=l;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];
b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},determinant:function(a){var b=a[0],d=a[1],m=a[2],p=a[3],g=a[4],f=a[5],l=a[6],c=a[7],e=a[8],r=a[9],h=a[10],t=a[11],k=a[12],x=a[13],v=a[14];a=a[15];return k*r*l*p-e*x*l*p-k*f*h*p+g*x*h*p+e*f*v*p-g*r*v*p-k*r*m*c+e*x*m*c+k*d*h*c-b*x*h*c-e*d*v*c+b*r*v*c+k*f*m*t-g*x*m*t-k*d*l*t+b*x*l*t+g*d*v*t-b*f*v*t-e*f*m*a+g*r*m*a+e*d*l*a-b*r*l*a-g*d*h*a+b*f*h*a},inverse:function(a,b){b||(b=a);var d=
a[0],m=a[1],p=a[2],g=a[3],f=a[4],l=a[5],c=a[6],e=a[7],r=a[8],h=a[9],t=a[10],k=a[11],x=a[12],v=a[13],n=a[14],q=a[15],s=d*l-m*f,E=d*c-p*f,ba=d*e-g*f,W=m*c-p*l,R=m*e-g*l,T=p*e-g*c,J=r*v-h*x,S=r*n-t*x,K=r*q-k*x,Q=h*n-t*v,U=h*q-k*v,X=t*q-k*n,P=s*X-E*U+ba*Q+W*K-R*S+T*J;if(!P)return null;P=1/P;b[0]=(l*X-c*U+e*Q)*P;b[1]=(-m*X+p*U-g*Q)*P;b[2]=(v*T-n*R+q*W)*P;b[3]=(-h*T+t*R-k*W)*P;b[4]=(-f*X+c*K-e*S)*P;b[5]=(d*X-p*K+g*S)*P;b[6]=(-x*T+n*ba-q*E)*P;b[7]=(r*T-t*ba+k*E)*P;b[8]=(f*U-l*K+e*J)*P;b[9]=(-d*U+m*K-g*J)*
P;b[10]=(x*R-v*ba+q*s)*P;b[11]=(-r*R+h*ba-k*s)*P;b[12]=(-f*Q+l*S-c*J)*P;b[13]=(d*Q-m*S+p*J)*P;b[14]=(-x*W+v*E-n*s)*P;b[15]=(r*W-h*E+t*s)*P;return b},toRotationMat:function(a,b){b||(b=m.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},toMat3:function(a,b){b||(b=d.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b},
toInverseMat3:function(a,b){var m=a[0],p=a[1],g=a[2],f=a[4],l=a[5],c=a[6],e=a[8],r=a[9],h=a[10],t=h*l-c*r,k=-h*f+c*e,x=r*f-l*e,v=m*t+p*k+g*x;if(!v)return null;v=1/v;b||(b=d.create());b[0]=t*v;b[1]=(-h*p+g*r)*v;b[2]=(c*p-g*l)*v;b[3]=k*v;b[4]=(h*m-g*e)*v;b[5]=(-c*m+g*f)*v;b[6]=x*v;b[7]=(-r*m+p*e)*v;b[8]=(l*m-p*f)*v;return b},multiply:function(a,b,d){d||(d=a);var m=a[0],p=a[1],g=a[2],f=a[3],l=a[4],c=a[5],e=a[6],r=a[7],h=a[8],t=a[9],k=a[10],x=a[11],v=a[12],n=a[13],q=a[14];a=a[15];var s=b[0],E=b[1],ba=
b[2],W=b[3],R=b[4],T=b[5],J=b[6],S=b[7],K=b[8],Q=b[9],U=b[10],X=b[11],P=b[12],$=b[13],ea=b[14];b=b[15];d[0]=s*m+E*l+ba*h+W*v;d[1]=s*p+E*c+ba*t+W*n;d[2]=s*g+E*e+ba*k+W*q;d[3]=s*f+E*r+ba*x+W*a;d[4]=R*m+T*l+J*h+S*v;d[5]=R*p+T*c+J*t+S*n;d[6]=R*g+T*e+J*k+S*q;d[7]=R*f+T*r+J*x+S*a;d[8]=K*m+Q*l+U*h+X*v;d[9]=K*p+Q*c+U*t+X*n;d[10]=K*g+Q*e+U*k+X*q;d[11]=K*f+Q*r+U*x+X*a;d[12]=P*m+$*l+ea*h+b*v;d[13]=P*p+$*c+ea*t+b*n;d[14]=P*g+$*e+ea*k+b*q;d[15]=P*f+$*r+ea*x+b*a;return d},multiplyVec3:function(a,b,d){d||(d=b);
var m=b[0],p=b[1];b=b[2];d[0]=a[0]*m+a[4]*p+a[8]*b+a[12];d[1]=a[1]*m+a[5]*p+a[9]*b+a[13];d[2]=a[2]*m+a[6]*p+a[10]*b+a[14];return d},multiplyVec4:function(a,b,d){d||(d=b);var m=b[0],p=b[1],g=b[2];b=b[3];d[0]=a[0]*m+a[4]*p+a[8]*g+a[12]*b;d[1]=a[1]*m+a[5]*p+a[9]*g+a[13]*b;d[2]=a[2]*m+a[6]*p+a[10]*g+a[14]*b;d[3]=a[3]*m+a[7]*p+a[11]*g+a[15]*b;return d},translate:function(a,b,d){var m=b[0],p=b[1];b=b[2];var g,f,l,c,e,r,h,t,k,x,v,n;if(!d||a===d)return a[12]=a[0]*m+a[4]*p+a[8]*b+a[12],a[13]=a[1]*m+a[5]*p+
a[9]*b+a[13],a[14]=a[2]*m+a[6]*p+a[10]*b+a[14],a[15]=a[3]*m+a[7]*p+a[11]*b+a[15],a;g=a[0];f=a[1];l=a[2];c=a[3];e=a[4];r=a[5];h=a[6];t=a[7];k=a[8];x=a[9];v=a[10];n=a[11];d[0]=g;d[1]=f;d[2]=l;d[3]=c;d[4]=e;d[5]=r;d[6]=h;d[7]=t;d[8]=k;d[9]=x;d[10]=v;d[11]=n;d[12]=g*m+e*p+k*b+a[12];d[13]=f*m+r*p+x*b+a[13];d[14]=l*m+h*p+v*b+a[14];d[15]=c*m+t*p+n*b+a[15];return d},scale:function(a,b,d){var m=b[0],p=b[1];b=b[2];if(!d||a===d)return a[0]*=m,a[1]*=m,a[2]*=m,a[3]*=m,a[4]*=p,a[5]*=p,a[6]*=p,a[7]*=p,a[8]*=b,a[9]*=
b,a[10]*=b,a[11]*=b,a;d[0]=a[0]*m;d[1]=a[1]*m;d[2]=a[2]*m;d[3]=a[3]*m;d[4]=a[4]*p;d[5]=a[5]*p;d[6]=a[6]*p;d[7]=a[7]*p;d[8]=a[8]*b;d[9]=a[9]*b;d[10]=a[10]*b;d[11]=a[11]*b;d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d},maxScale:function(a){var b=Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8]),d=Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9]);a=Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]);return Math.max(Math.max(b,d),a)},rotate:function(a,b,d,m){var p=d[0],g=d[1];d=d[2];var f=Math.sqrt(p*p+g*g+d*d),l,c,
e,r,h,t,k,x,v,n,q,s,E,ba,W,R,T,J,S,K;if(!f)return null;1!==f&&(f=1/f,p*=f,g*=f,d*=f);l=Math.sin(b);c=Math.cos(b);e=1-c;b=a[0];f=a[1];r=a[2];h=a[3];t=a[4];k=a[5];x=a[6];v=a[7];n=a[8];q=a[9];s=a[10];E=a[11];ba=p*p*e+c;W=g*p*e+d*l;R=d*p*e-g*l;T=p*g*e-d*l;J=g*g*e+c;S=d*g*e+p*l;K=p*d*e+g*l;p=g*d*e-p*l;g=d*d*e+c;m?a!==m&&(m[12]=a[12],m[13]=a[13],m[14]=a[14],m[15]=a[15]):m=a;m[0]=b*ba+t*W+n*R;m[1]=f*ba+k*W+q*R;m[2]=r*ba+x*W+s*R;m[3]=h*ba+v*W+E*R;m[4]=b*T+t*J+n*S;m[5]=f*T+k*J+q*S;m[6]=r*T+x*J+s*S;m[7]=h*
T+v*J+E*S;m[8]=b*K+t*p+n*g;m[9]=f*K+k*p+q*g;m[10]=r*K+x*p+s*g;m[11]=h*K+v*p+E*g;return m},rotateX:function(a,b,d){var m=Math.sin(b);b=Math.cos(b);var p=a[4],g=a[5],f=a[6],l=a[7],c=a[8],e=a[9],r=a[10],h=a[11];d?a!==d&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[4]=p*b+c*m;d[5]=g*b+e*m;d[6]=f*b+r*m;d[7]=l*b+h*m;d[8]=p*-m+c*b;d[9]=g*-m+e*b;d[10]=f*-m+r*b;d[11]=l*-m+h*b;return d},rotateY:function(a,b,d){var m=Math.sin(b);b=Math.cos(b);var p=a[0],g=a[1],
f=a[2],l=a[3],c=a[8],e=a[9],r=a[10],h=a[11];d?a!==d&&(d[4]=a[4],d[5]=a[5],d[6]=a[6],d[7]=a[7],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=p*b+c*-m;d[1]=g*b+e*-m;d[2]=f*b+r*-m;d[3]=l*b+h*-m;d[8]=p*m+c*b;d[9]=g*m+e*b;d[10]=f*m+r*b;d[11]=l*m+h*b;return d},rotateZ:function(a,b,d){var m=Math.sin(b);b=Math.cos(b);var p=a[0],g=a[1],f=a[2],l=a[3],c=a[4],e=a[5],r=a[6],h=a[7];d?a!==d&&(d[8]=a[8],d[9]=a[9],d[10]=a[10],d[11]=a[11],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=p*b+c*
m;d[1]=g*b+e*m;d[2]=f*b+r*m;d[3]=l*b+h*m;d[4]=p*-m+c*b;d[5]=g*-m+e*b;d[6]=f*-m+r*b;d[7]=l*-m+h*b;return d},frustum:function(a,b,d,p,g,f,l){l||(l=m.create());var c=b-a,e=p-d,r=f-g;l[0]=2*g/c;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=2*g/e;l[6]=0;l[7]=0;l[8]=(b+a)/c;l[9]=(p+d)/e;l[10]=-(f+g)/r;l[11]=-1;l[12]=0;l[13]=0;l[14]=-(2*f*g)/r;l[15]=0;return l},perspective:function(a,b,d,p,g){a=d*Math.tan(a*Math.PI/360);b*=a;return m.frustum(-b,b,-a,a,d,p,g)},ortho:function(a,b,d,p,g,f,l){l||(l=m.create());var c=b-a,
e=p-d,r=f-g;l[0]=2/c;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=2/e;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=-2/r;l[11]=0;l[12]=-(a+b)/c;l[13]=-(p+d)/e;l[14]=-(f+g)/r;l[15]=1;return l},lookAt:function(a,b,d,p){p||(p=m.create());var g,f,l,c,e,r,h,t,k=a[0],x=a[1];a=a[2];l=d[0];c=d[1];f=d[2];h=b[0];d=b[1];g=b[2];if(k===h&&x===d&&a===g)return m.identity(p);b=k-h;d=x-d;h=a-g;t=1/Math.sqrt(b*b+d*d+h*h);b*=t;d*=t;h*=t;g=c*h-f*d;f=f*b-l*h;l=l*d-c*b;(t=Math.sqrt(g*g+f*f+l*l))?(t=1/t,g*=t,f*=t,l*=t):l=f=g=0;c=d*l-h*f;e=h*g-
b*l;r=b*f-d*g;(t=Math.sqrt(c*c+e*e+r*r))?(t=1/t,c*=t,e*=t,r*=t):r=e=c=0;p[0]=g;p[1]=c;p[2]=b;p[3]=0;p[4]=f;p[5]=e;p[6]=d;p[7]=0;p[8]=l;p[9]=r;p[10]=h;p[11]=0;p[12]=-(g*k+f*x+l*a);p[13]=-(c*k+e*x+r*a);p[14]=-(b*k+d*x+h*a);p[15]=1;return p},fromRotationTranslation:function(a,b,d){d||(d=m.create());var p=a[0],g=a[1],f=a[2],l=a[3],c=p+p,e=g+g,r=f+f;a=p*c;var h=p*e,p=p*r,t=g*e,g=g*r,f=f*r,c=l*c,e=l*e,l=l*r;d[0]=1-(t+f);d[1]=h+l;d[2]=p-e;d[3]=0;d[4]=h-l;d[5]=1-(a+f);d[6]=g+c;d[7]=0;d[8]=p+e;d[9]=g-c;d[10]=
1-(a+t);d[11]=0;d[12]=b[0];d[13]=b[1];d[14]=b[2];d[15]=1;return d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},p={create:function(a){var b=new h(4);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):b[0]=b[1]=b[2]=b[3]=0;return b},createFrom:function(a,b,d,m){var p=new h(4);p[0]=a;p[1]=b;p[2]=d;p[3]=m;return p},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];
b[3]=a[3];return b},identity:function(a){a||(a=p.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}},t=p.identity();p.calculateW=function(a,b){var d=a[0],m=a[1],p=a[2];if(!b||a===b)return a[3]=-Math.sqrt(Math.abs(1-d*d-m*m-p*p)),a;b[0]=d;b[1]=m;b[2]=p;b[3]=-Math.sqrt(Math.abs(1-d*d-m*m-p*p));return b};p.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};p.inverse=function(a,b){var d=a[0],m=a[1],p=a[2],g=a[3],d=(d=d*d+m*m+p*p+g*g)?1/d:0;if(!b||a===b)return a[0]*=-d,a[1]*=-d,a[2]*=-d,a[3]*=
d,a;b[0]=-a[0]*d;b[1]=-a[1]*d;b[2]=-a[2]*d;b[3]=a[3]*d;return b};p.conjugate=function(a,b){if(!b||a===b)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};p.length=function(a){var b=a[0],d=a[1],m=a[2];a=a[3];return Math.sqrt(b*b+d*d+m*m+a*a)};p.normalize=function(a,b){b||(b=a);var d=a[0],m=a[1],p=a[2],g=a[3],f=Math.sqrt(d*d+m*m+p*p+g*g);if(0===f)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;f=1/f;b[0]=d*f;b[1]=m*f;b[2]=p*f;b[3]=g*f;return b};p.add=function(a,b,d){if(!d||
a===d)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a[3]+=b[3],a;d[0]=a[0]+b[0];d[1]=a[1]+b[1];d[2]=a[2]+b[2];d[3]=a[3]+b[3];return d};p.multiply=function(a,b,d){d||(d=a);var m=a[0],p=a[1],g=a[2];a=a[3];var f=b[0],l=b[1],c=b[2];b=b[3];d[0]=m*b+a*f+p*c-g*l;d[1]=p*b+a*l+g*f-m*c;d[2]=g*b+a*c+m*l-p*f;d[3]=a*b-m*f-p*l-g*c;return d};p.multiplyVec3=function(a,b,d){d||(d=b);var m=b[0],p=b[1],g=b[2];b=a[0];var f=a[1],l=a[2];a=a[3];var c=a*m+f*g-l*p,e=a*p+l*m-b*g,r=a*g+b*p-f*m,m=-b*m-f*p-l*g;d[0]=c*a+m*-b+e*-l-r*
-f;d[1]=e*a+m*-f+r*-b-c*-l;d[2]=r*a+m*-l+c*-f-e*-b;return d};p.scale=function(a,b,d){if(!d||a===d)return a[0]*=b,a[1]*=b,a[2]*=b,a[3]*=b,a;d[0]=a[0]*b;d[1]=a[1]*b;d[2]=a[2]*b;d[3]=a[3]*b;return d};p.toMat3=function(a,b){b||(b=d.create());var m=a[0],p=a[1],g=a[2],f=a[3],l=m+m,c=p+p,e=g+g,r=m*l,h=m*c,m=m*e,t=p*c,p=p*e,g=g*e,l=f*l,c=f*c,f=f*e;b[0]=1-(t+g);b[1]=h+f;b[2]=m-c;b[3]=h-f;b[4]=1-(r+g);b[5]=p+l;b[6]=m+c;b[7]=p-l;b[8]=1-(r+t);return b};p.toMat4=function(a,b){b||(b=m.create());var d=a[0],p=a[1],
g=a[2],f=a[3],l=d+d,c=p+p,e=g+g,r=d*l,h=d*c,d=d*e,t=p*c,p=p*e,g=g*e,l=f*l,c=f*c,f=f*e;b[0]=1-(t+g);b[1]=h+f;b[2]=d-c;b[3]=0;b[4]=h-f;b[5]=1-(r+g);b[6]=p+l;b[7]=0;b[8]=d+c;b[9]=p-l;b[10]=1-(r+t);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};p.slerp=function(a,b,d,m){m||(m=a);var p=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3],g,f;if(1<=Math.abs(p))return m!==a&&(m[0]=a[0],m[1]=a[1],m[2]=a[2],m[3]=a[3]),m;g=Math.acos(p);f=Math.sqrt(1-p*p);if(0.0010>Math.abs(f))return m[0]=0.5*a[0]+0.5*b[0],m[1]=0.5*a[1]+
0.5*b[1],m[2]=0.5*a[2]+0.5*b[2],m[3]=0.5*a[3]+0.5*b[3],m;p=Math.sin((1-d)*g)/f;d=Math.sin(d*g)/f;m[0]=a[0]*p+b[0]*d;m[1]=a[1]*p+b[1]*d;m[2]=a[2]*p+b[2]*d;m[3]=a[3]*p+b[3]*d;return m};p.fromRotationMatrix=function(a,b){b||(b=p.create());var d=a[0]+a[4]+a[8],m;if(0<d)m=Math.sqrt(d+1),b[3]=0.5*m,m=0.5/m,b[0]=(a[7]-a[5])*m,b[1]=(a[2]-a[6])*m,b[2]=(a[3]-a[1])*m;else{m=p.fromRotationMatrix.s_iNext=p.fromRotationMatrix.s_iNext||[1,2,0];d=0;a[4]>a[0]&&(d=1);a[8]>a[3*d+d]&&(d=2);var g=m[d],f=m[g];m=Math.sqrt(a[3*
d+d]-a[3*g+g]-a[3*f+f]+1);b[d]=0.5*m;m=0.5/m;b[3]=(a[3*f+g]-a[3*g+f])*m;b[g]=(a[3*g+d]+a[3*d+g])*m;b[f]=(a[3*f+d]+a[3*d+f])*m}return b};d.toQuat4=p.fromRotationMatrix;(function(){var a=d.create();p.fromAxes=function(b,d,m,g){a[0]=d[0];a[3]=d[1];a[6]=d[2];a[1]=m[0];a[4]=m[1];a[7]=m[2];a[2]=b[0];a[5]=b[1];a[8]=b[2];return p.fromRotationMatrix(a,g)}})();p.identity=function(a){a||(a=p.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};p.fromAngleAxis=function(a,b,d){d||(d=p.create());a*=0.5;var m=Math.sin(a);
d[3]=Math.cos(a);d[0]=m*b[0];d[1]=m*b[1];d[2]=m*b[2];return d};p.toAngleAxis=function(a,b){b||(b=a);var d=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<d?(b[3]=2*Math.acos(a[3]),d=k.invsqrt(d),b[0]=a[0]*d,b[1]=a[1]*d,b[2]=a[2]*d):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};p.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var x={create:function(a){var b=new h(4);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):b[0]=b[1]=b[2]=b[3]=0;return b},createFrom:function(a,b,d,m){var p=new h(4);p[0]=a;p[1]=b;p[2]=
d;p[3]=m;return p},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},identity:function(a){a||(a=x.create());a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,b){if(!b||a===b){var d=a[1];a[1]=a[2];a[2]=d;return a}b[0]=a[0];b[1]=a[2];b[2]=a[1];b[3]=a[3];return b},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},inverse:function(a,b){b||(b=a);var d=a[0],m=a[1],p=a[2],g=a[3],f=d*g-p*m;if(!f)return null;f=1/f;b[0]=g*f;b[1]=-m*f;b[2]=-p*f;b[3]=d*f;return b},multiply:function(a,
b,d){d||(d=a);var m=a[0],p=a[1],g=a[2];a=a[3];d[0]=m*b[0]+p*b[2];d[1]=m*b[1]+p*b[3];d[2]=g*b[0]+a*b[2];d[3]=g*b[1]+a*b[3];return d},rotate:function(a,b,d){d||(d=a);var m=a[0],p=a[1],g=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);d[0]=m*b+p*f;d[1]=m*-f+p*b;d[2]=g*b+a*f;d[3]=g*-f+a*b;return d},multiplyVec2:function(a,b,d){d||(d=b);var m=b[0];b=b[1];d[0]=m*a[0]+b*a[1];d[1]=m*a[2]+b*a[3];return d},scale:function(a,b,d){d||(d=a);var m=a[1],p=a[2],g=a[3],f=b[0];b=b[1];d[0]=a[0]*f;d[1]=m*b;d[2]=p*f;d[3]=
g*b;return d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}},v=n?"":"d";q["glMath"+v]=k;q["vec2"+v]={create:function(a){var b=new h(2);a?(b[0]=a[0],b[1]=a[1]):(b[0]=0,b[1]=0);return b},createFrom:function(a,b){var d=new h(2);d[0]=a;d[1]=b;return d},add:function(a,b,d){d||(d=b);d[0]=a[0]+b[0];d[1]=a[1]+b[1];return d},subtract:function(a,b,d){d||(d=b);d[0]=a[0]-b[0];d[1]=a[1]-b[1];return d},multiply:function(a,b,d){d||(d=b);d[0]=a[0]*b[0];d[1]=a[1]*b[1];return d},divide:function(a,
b,d){d||(d=b);d[0]=a[0]/b[0];d[1]=a[1]/b[1];return d},scale:function(a,b,d){d||(d=a);d[0]=a[0]*b;d[1]=a[1]*b;return d},dist:function(a,b){var d=b[0]-a[0],m=b[1]-a[1];return Math.sqrt(d*d+m*m)},dist2:function(a,b){var d=b[0]-a[0],m=b[1]-a[1];return d*d+m*m},set:function(a,b){b[0]=a[0];b[1]=a[1];return b},set2:function(a,b,d){d[0]=a;d[1]=b;return d},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];return b},normalize:function(a,b){b||(b=a);var d=a[0]*a[0]+a[1]*a[1];0<d?(d=Math.sqrt(d),b[0]=a[0]/
d,b[1]=a[1]/d):b[0]=b[1]=0;return b},cross:function(a,b,d){a=a[0]*b[1]-a[1]*b[0];if(!d)return a;d[0]=d[1]=0;d[2]=a;return d},length:function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]},direction:function(a,b,d){d||(d=a);var m=a[0]-b[0];a=a[1]-b[1];b=m*m+a*a;if(!b)return d[0]=0,d[1]=0,d[2]=0,d;b=1/Math.sqrt(b);d[0]=m*b;d[1]=a*b;return d},lerp:function(a,b,d,m){m||(m=a);m[0]=a[0]+d*(b[0]-a[0]);m[1]=a[1]+d*(b[1]-a[1]);return m},str:function(a){return"["+
a[0]+", "+a[1]+"]"}};q["vec3"+v]=e;q["vec4"+v]={create:function(a){var b=new h(4);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):(b[0]=0,b[1]=0,b[2]=0,b[3]=0);return b},createFrom:function(a,b,d,m){var p=new h(4);p[0]=a;p[1]=b;p[2]=d;p[3]=m;return p},add:function(a,b,d){d||(d=b);d[0]=a[0]+b[0];d[1]=a[1]+b[1];d[2]=a[2]+b[2];d[3]=a[3]+b[3];return d},subtract:function(a,b,d){d||(d=b);d[0]=a[0]-b[0];d[1]=a[1]-b[1];d[2]=a[2]-b[2];d[3]=a[3]-b[3];return d},multiply:function(a,b,d){d||(d=b);d[0]=a[0]*b[0];d[1]=
a[1]*b[1];d[2]=a[2]*b[2];d[3]=a[3]*b[3];return d},divide:function(a,b,d){d||(d=b);d[0]=a[0]/b[0];d[1]=a[1]/b[1];d[2]=a[2]/b[2];d[3]=a[3]/b[3];return d},scale:function(a,b,d){d||(d=a);d[0]=a[0]*b;d[1]=a[1]*b;d[2]=a[2]*b;d[3]=a[3]*b;return d},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},set4:function(a,b,d,m,p){p[0]=a;p[1]=b;p[2]=d;p[3]=m;return p},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];
b[3]=-a[3];return b},lerp:function(a,b,d,m){m||(m=a);m[0]=a[0]+d*(b[0]-a[0]);m[1]=a[1]+d*(b[1]-a[1]);m[2]=a[2]+d*(b[2]-a[2]);m[3]=a[3]+d*(b[3]-a[3]);return m},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};q["mat2"+v]=x;q["mat3"+v]=d;q["mat4"+v]=m;q["quat4"+v]=p});return s})},"esri/views/3d/webgl-engine/parts/Model":function(){define("require exports dojo/string ../lib/lights ../lib/ModelContentType ../lib/ModelDirtySet ../lib/RenderGeometry ../lib/Util ../lib/gl-matrix".split(" "),
function(s,q,n,k,h,e,c,b,g){var f=b.assert,a=b.verify,r=g.vec3d,l=g.mat4d,d=b.logWithBase;return function(){function b(){this.dirtySet=new e(this);this.ambientLight=new k.AmbientLight([1,1,1],0.3);this.directionalLight=new k.DirectionalLight([1,1,1],0.7,r.normalize([1,1,1]));this._uniqueName2idx={};this._uniqueIdx=0;this._id2origin={};this._modelListeners=[];this.content={};for(var a in h)this.content[h[a]]={}}b.prototype.getAll=function(a){a=this.content[a];f(void 0!==a);return a};b.prototype.get=
function(a,b){return this.getAll(a)[b]};b.prototype.add=function(a,b){var d=this.content[a];f(void 0!==d);var m=b.getId();f(null==d[m],"Model/Stage already contains object to be added");d[m]=b;a===h.LAYER&&this.notifyDirty(a,b,"layerAdded");this._notifyContentAdded(a,b)};b.prototype.remove=function(a,b){var d=this.content[a];f(void 0!==d);var m=d[b];f(void 0!==m,"Model/Stage doesn't contain object to be removed");delete d[b];a===h.TEXTURE&&m.unload();a===h.LAYER&&this.notifyDirty(a,m,"layerRemoved");
this._notifyContentRemoved(a,m);return m};b.prototype.getDirtySet=function(){return this.dirtySet};b.prototype.notifyDirty=function(a,b,d,m){this.dirtySet.handleUpdate(b,d,m)};b.prototype.getAmbientLight=function(){return this.ambientLight};b.prototype.setAmbientLight=function(a){this.ambientLight.set(a)};b.prototype.getDirectionalLight=function(){return this.directionalLight};b.prototype.setDirectionalLight=function(a){this.directionalLight.set(a)};b.prototype.getSelection=function(){return this.selection};
b.prototype.setSelection=function(a,b){this.selection=a;this.selectionFaceRange=b};b.prototype.getSelectionFaceRange=function(){return this.selectionFaceRange};b.prototype.getOrigin=function(a,b,m){void 0===m&&(m=10);var g=0;b=b*m/1E4;1<b&&(g=Math.ceil(d(b,2)));b=1E4*Math.pow(2,g);m=Math.round(a[0]/b);var f=Math.round(a[1]/b);a=Math.round(a[2]/b);var g=g+"_"+m+"_"+f+"_"+a,l=this._id2origin[g];null==l&&(l={vec3:r.createFrom(m*b,f*b,a*b),id:g},this._id2origin[g]=l);return l};b.prototype.getGeometryRenderGeometries=
function(a,b,d){for(var m=a.getId(),g=b.geometry,f=g.getData(),e=!!g.singleUse,r=f.getFaces(),h=f.getVertexAttr(),f=f.getId(),k=b.materials,B=b.instanceParameters,D=a.getCombinedTransformation(b),F=l.maxScale(D),H=b.origin,n=a.getVisibleIndexRanges(b),G=0,O=g.getNumGroups();G<O;++G){var M=g.getBoundingInfo(G),I=b.getId()+"#"+G,q=this._uniqueName2idx[I];null==q&&(q=this._uniqueIdx++,this._uniqueName2idx[I]=q);var s={},L;for(L in r[G].indices)s[L]=h[L];M=new c({faces:r[G],vertexAttr:s,id:f+"#"+G},M,
k[G],D,F,a.getCastShadow(),e,m,I,q,G);M.origin=H||this.getOrigin(M.center,M.bsRadius);M.displayedIndexRange=n?n[G]:null;M.instanceParameters=B?b.instanceParameters[G]:null;d.push(M)}};b.prototype.formatDebugInfo=function(a){var b=[];if(a){b[0]="\x3ctable\x3e";for(var d in h)a=h[d],b[0]+="\x3ctr\x3e\x3ctd\x3e"+a+'\x3c/td\x3e\x3ctd style\x3d"text-align: right"\x3e'+Object.keys(this.getAll(a)).length+"\x3c/td\x3e\x3c/tr\x3e";b[0]+="\x3c/table\x3e";b[1]=this.dirtySet.formatDebugInfo(!0)}else{b[0]="";
for(d in h)a=h[d],b[0]+=n.pad(String(Object.keys(this.getAll(a)).length),6," ")+" "+a+", ";b[1]=this.dirtySet.formatDebugInfo(!1)}return b};b.prototype.validateContent=function(){var a=this.getAll(h.OBJECT),b;for(b in a)this.validateObject(a[b]);a=this.getAll(h.LAYER);for(name in a)this.validateLayer(a[name]);a=this.getAll(h.MATERIAL);for(name in a)this.validateMaterial(a[name])};b.prototype.validateObject=function(b){b=b.geometryRecords;for(var d=0;d<b.length;++d){var m=b[d];f(null!=this.get(h.GEOMETRY,
m.geometry.id));var g=m.geometry.numGroups;f(g<=m.materials.length,"object materials do not match geometry groups");a(g===m.materials.length,"object materials do not match geometry groups");for(var l=0;l<g;++l)f(null!=this.get(h.MATERIAL,m.materials[l].getId()))}};b.prototype.validateLayer=function(a){a=a.getObjects();for(var b=0;b<a.length;++b){var d=this.get(h.OBJECT,a[b].getId());f(null!=d)}};b.prototype.validateMaterial=function(a){a=a.getAllTextureIds();for(var b=0;b<a.length;++b){var d=this.get(h.TEXTURE,
a[b]);f(null!=d)}};b.prototype.addModelListener=function(a){f(-1===this._modelListeners.indexOf(a));this._modelListeners.push(a)};b.prototype.removeModelListener=function(a){a=this._modelListeners.indexOf(a);f(-1!==a);this._modelListeners.splice(a,a)};b.prototype._notifyContentAdded=function(a,b){this._modelListeners.forEach(function(d){d.contentAdded&&d.contentAdded(a,b)})};b.prototype._notifyContentRemoved=function(a,b){this._modelListeners.forEach(function(d){d.contentRemoved&&d.contentRemoved(a,
b)})};b.ContentType=h;return b}()})},"esri/views/3d/webgl-engine/lib/lights":function(){define(["require","exports"],function(s,q){var n=function(){function k(h,e){this.color=h;this.intensity=e}k.prototype.set=function(h){void 0!==h.color&&(this.color=h.color);void 0!==h.intensity&&(this.intensity=h.intensity)};return k}();q.AmbientLight=n;n=function(){function k(h,e,c){this.color=h;this.intensity=e;this.direction=c}k.prototype.set=function(h){void 0!==h.color&&(this.color=h.color);void 0!==h.intensity&&
(this.intensity=h.intensity);void 0!==h.direction&&(this.direction=h.direction)};return k}();q.DirectionalLight=n})},"esri/views/3d/webgl-engine/lib/ModelContentType":function(){define(["require","exports"],function(s,q){return function(){function n(){}n.LAYER="layers";n.OBJECT="objects";n.GEOMETRY="geometries";n.MATERIAL="materials";n.TEXTURE="textures";return n}()})},"esri/views/3d/webgl-engine/lib/ModelDirtySet":function(){define(["require","exports","./ModelContentType","./ModelDirtyTypesTs",
"./Util"],function(s,q,n,k,h){var e=h.objectEmpty,c=h.assert;return function(){function b(b){this._residentGeomRecords={};this._dirtyGeomRecords={};this._dirtyMaterials={};this._model=b}b.prototype._getResidentGeometryRecords=function(){return this._residentGeomRecords};b.prototype._getDirtyGeometryRecords=function(){return this._dirtyGeomRecords};b.prototype.getDirtyMaterials=function(){return e(this._dirtyMaterials)?null:this._dirtyMaterials};b.prototype.clearDirtyMaterials=function(){this._dirtyMaterials=
{}};b.prototype.hasDirtyGeometryRecords=function(){for(var b in this._dirtyGeomRecords)for(var f in this._dirtyGeomRecords[b]){var a=this._dirtyGeomRecords[b][f];if(a&&!e(a))return!0}return!1};b.prototype.handleUpdate=function(b,f,a){c(this[f],"ModelDirtySet doesn't know how to process "+f);return this[f](b,a)};b.prototype.getAddRemoveUpdateList=function(b){return this.getAddRemoveUpdateListFilteredByLayers(Object.keys(this._dirtyGeomRecords),b)};b.prototype.getAddRemoveUpdateListFilteredByLayers=
function(b,f){for(var a=[],e=[],l=[],d=0;d<b.length;d++){var m=b[d];if(m in this._dirtyGeomRecords)for(var p in this._dirtyGeomRecords[m]){var h=this._dirtyGeomRecords[m][p];if(h){var k=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,m,p),v;for(v in h){var u=h[v],z=u[0],w=u[1],u=u[2],C=w&2&&u&1;if(w&4||C){var A=k[v];A?e.push.apply(e,A[1]):4===w&&c(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid remove");f&&A&&delete k[v]}if(w&1||C){var A=[z,[]],y=this._model.get(n.OBJECT,
p);this._model.getGeometryRenderGeometries(y,z,A[1]);a.push.apply(a,A[1]);f&&(k[v]=A)}if(w&2&&!C)if(A=k[v],y=this._model.get(n.OBJECT,p),A){w=A[1];C=w.length;if(u&2)for(var A=y.getVisibleIndexRanges(z),B=0;B<C;B++){var D=w[B];D.displayedIndexRange=A?A[D.componentIdx]:void 0}if(u&16)for(B=0;B<C;B++)D=w[B],y.getCombinedTransformation(z,D.transformation),D.updateTransformation(D.transformation);for(B=0;B<C;B++)D=w[B],l.push({renderGeometry:D,updateType:u})}else c(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid update")}}}f&&
delete this._dirtyGeomRecords[m]}return[a,e,l]};b.prototype.getResidentRenderGeometries=function(){return this.getResidentRenderGeometriesFilteredByLayers(Object.keys(this._residentGeomRecords))};b.prototype.getResidentRenderGeometriesFilteredByLayers=function(b){for(var f=[],a=0;a<b.length;a++){var c=b[a];if(c in this._residentGeomRecords)for(var l in this._residentGeomRecords[c]){var d=this._residentGeomRecords[c][l];if(d)for(var m in d)f.push.apply(f,d[m][1])}}return f};b.prototype.hideFaceRange=
function(b,f,a){a=a||this._getParentLayerId(b);this._updateOrCreateDirtyRecord(b,f,a,2,0,0,2,5,2)};b.prototype.unhideAllFaceRange=function(b,f){for(var a=0;a<b.getGeometryRecords().length;a++)this._updateOrCreateDirtyRecord(b,b.getGeometryRecords()[a],f,2,0,0,2,5,2)};b.prototype.vertexAttrsUpdated=function(b,f,a){this._updateOrCreateDirtyRecord(b,f,a,2,0,0,2,5,4)};b.prototype.colorAttrsUpdated=function(b,f,a){this._updateOrCreateDirtyRecord(b,f,a,2,0,0,2,5,8)};b.prototype.matChanged=function(b){this._dirtyMaterials[b.getId()]=
!0};b.prototype.layerAdded=function(b){for(var f=b.getObjects(),a=0;a<f.length;a++)this.layObjectAdded(b,f[a])};b.prototype.layerRemoved=function(b){for(var f=b.getObjects(),a=0;a<f.length;a++)this.layObjectRemoved(b,f[a])};b.prototype.layObjectAdded=function(b,f){for(var a=b.getId(),c=f.getGeometryRecords(),l=0;l<c.length;l++)this.objGeometryAdded(f,c[l],a)};b.prototype.layObjectRemoved=function(b,f){for(var a=b.getId(),c=f.getGeometryRecords(),l=0;l<c.length;l++)this.objGeometryRemoved(f,c[l],a)};
b.prototype.layObjectReplaced=function(b,f){this.layObjectRemoved(b,f[0]);this.layObjectAdded(b,f[1])};b.prototype.objDirty=function(b,f){f=f||this._getParentLayerId(b);var a=b.getId(),a=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,f,a),c;for(c in a)this._updateOrCreateDirtyRecord(b,a[c][0],f,2,0,2,0,5,1)};b.prototype.objTransformation=function(b,f){f=f||this._getParentLayerId(b);var a=b.getId(),a=this._createObjectRecordObjIfNonexistent(this._residentGeomRecords,f,a),c;for(c in a)this._updateOrCreateDirtyRecord(b,
a[c][0],f,2,0,0,2,5,16)};b.prototype.objGeometryAdded=function(b,f,a){this._updateOrCreateDirtyRecord(b,f,a,1,4,0,0,0)};b.prototype.objGeometryRemoved=function(b,f,a){this._updateOrCreateDirtyRecord(b,f,a,4,1,2,0,0)};b.prototype.objGeometryReplaced=function(b,f){this.objGeometryRemoved(b,f[0]);this.objGeometryAdded(b,f[1])};b.prototype.objGeometryTransformation=function(b,f){this.objGeometryReplaced(b,f)};b.prototype._updateOrCreateDirtyRecord=function(b,f,a,e,l,d,m,p,h){a=a||this._getParentLayerId(b);
var k=b.getId();b=f.getId();a=this._createObjectRecordObjIfNonexistent(this._dirtyGeomRecords,a,k);(k=a[b])?(f=k[1],f&l?delete a[b]:f&d?(k[1]=e,k[2]=h):f&m?k[2]|=h:f&p||c(!1,"ModelDirtySet.objGeometryAdded: inconsistent state")):a[b]=[f,e,h]};b.prototype._createObjectRecordObjIfNonexistent=function(b,f,a){b[f]||(b[f]={});b[f][a]||(b[f][a]={});return b[f][a]};b.prototype._getParentLayerId=function(b){return b.parentLayer.id};b.prototype.formatDebugInfo=function(b){var f=["ADD","UPD",void 0,"REM"];
if(b)return"";b="";for(var a in this._dirtyGeomRecords)for(var c in this._dirtyGeomRecords[a]){var l=this._dirtyGeomRecords[a][c];if(l){0<b.length&&(b+="\n");b+=a+"."+c;var d=[],m;for(m in l){var p=l[m][1];d[p]||(d[p]=[]);d[p].push(l[m][0].geometry.id)}for(l=0;l<d.length;l++)if(d[l]){b+=" "+f[l-1]+": ";for(p=0;p<d[l].length;p++)b+=d[l][p]+", "}}}return b};return b}()})},"esri/views/3d/webgl-engine/lib/ModelDirtyTypesTs":function(){define(["require","exports"],function(s,q){})},"esri/views/3d/webgl-engine/lib/Util":function(){define(["./gl-matrix"],
function(s){function q(a){this.message=a}var n=s.vec2d,k=s.vec3d,h=s.vec4d,e=s.mat4d,c=e.create(),b=[h.createFrom(-1,-1,-1,1),h.createFrom(1,-1,-1,1),h.createFrom(1,1,-1,1),h.createFrom(-1,1,-1,1),h.createFrom(-1,-1,1,1),h.createFrom(1,-1,1,1),h.createFrom(1,1,1,1),h.createFrom(-1,1,1,1)],g=h.create(),f=Array(8);for(s=0;8>s;++s)f[s]=k.create();var a=k.create(),r=k.create(),l=k.create(),d=k.create(),m=k.create(),p=k.create(),t=k.create(),x=k.create(),v=k.create(),u=k.create(),z=k.create(),w=k.create(),
C=k.create(),A=k.create();q.prototype.toString=function(){return"AssertException: "+this.message};var y={EARTH_RADIUS:6378137,METER2FEET:3.28084,ECCENTRICITY_SQUARED:0.0066943799901414,AssertException:q,VertexAttrConstants:{POSITION:"position",NORMAL:"normal",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",SIZE:"size",REGION:"region"},assert:function(a,b){if(!a){var d=Error("dummy");d.stack&&console.log(d.stack);throw new q(b);}},verify:function(a,b){a||(console.log("Verify failed: "+
b),console.log(Error("dummy").stack))},createQuadVertexUvBuffer:function(a){a=a||Float32Array;a=new a(20);a[0]=-1;a[1]=-1;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=-1;a[7]=0;a[8]=1;a[9]=0;a[10]=-1;a[11]=1;a[12]=0;a[13]=0;a[14]=1;a[15]=1;a[16]=1;a[17]=0;a[18]=1;a[19]=1;return a},isPowerOfTwo:function(a){return 0===(a&a-1)},lerp:function(a,b,d){return a+(b-a)*d},clamp:function(a,b,d){return a<b?b:a>d?d:a},fallbackIfUndefined:function(a,b){return void 0===a?b:a},hex2rgb:function(a){a=Math.floor(a);return[(a>>
16&255)/255,(a>>8&255)/255,(a&255)/255]},rgb2hex:function(a){var b=y.clamp(Math.round(255*a[0]),0,255),d=y.clamp(Math.round(255*a[1]),0,255);a=y.clamp(Math.round(255*a[2]),0,255);return"0x"+((b<<16)+(d<<8)+a).toString(16)},dec2hex:function(a){a=a.toString(16);return"00000000".substr(0,8-a.length)+a},deg2rad:function(a){return a/180*Math.PI},rad2deg:function(a){return 180*a/Math.PI},azimuthElevationAngle2Direction:function(a,b){var d=1.5*Math.PI-a,m=0.5*Math.PI-b,p=Math.cos(d)*Math.sin(m),f=Math.cos(m),
d=Math.sin(d)*Math.sin(m);return[p,f,d]},rayPlane:function(a,b,d,m){var p=k.dot(d,b);if(0===p)return!1;d=-(k.dot(d,a)+d[3])/p;k.add(a,k.scale(b,d,m),m);return!0},raySphereClosestPositive:function(a,b,d,m){var p=k.dot(b,b),f=2*k.dot(b,a);d=k.dot(a,a)-d*d;d=f*f-4*p*d;if(0>d)return!1;var g=Math.sqrt(d);d=(-f-g)/(2*p);p=(-f+g)/(2*p);if(0>d||p<d&&0<p)d=p;return 0<d?(k.add(a,k.scale(b,d,m),m),!0):!1},rayTriangle3D:function(a,b,d,m,p,f,g,l,c){c||(c=k.create());var e=m[g]-d[f],r=m[g+1]-d[f+1],h=m[g+2]-d[f+
2];m=p[l]-d[f];g=p[l+1]-d[f+1];p=p[l+2]-d[f+2];var t=b[1]*p-g*b[2],u=b[2]*m-p*b[0],x=b[0]*g-m*b[1];l=e*t+r*u+h*x;if(-1E-5<l&&1E-5>l)return!1;l=1/l;var w=a[0]-d[f],A=a[1]-d[f+1];a=a[2]-d[f+2];c[1]=l*(w*t+A*u+a*x);if(0>c[1]||1<c[1])return!1;d=A*h-r*a;a=a*e-h*w;e=w*r-e*A;c[2]=l*(b[0]*d+b[1]*a+b[2]*e);if(0>c[2]||1<c[1]+c[2])return!1;c[0]=l*(m*d+g*a+p*e);return!0},rayBoxTest:function(a,b,d,m){var p,f=(d[0]-a[0])/b[0],g=(m[0]-a[0])/b[0];f>g&&(p=f,f=g,g=p);var l=(d[1]-a[1])/b[1],c=(m[1]-a[1])/b[1];l>c&&
(p=l,l=c,c=p);if(f>c||l>g)return!1;l>f&&(f=l);c<g&&(g=c);d=(d[2]-a[2])/b[2];a=(m[2]-a[2])/b[2];d>a&&(p=d,d=a,a=p);if(f>a||d>g)return!1;a<g&&(g=a);return 0>g?!1:!0},rayRay2D:function(a,b,d,m,p,f){f||(f=n.create());var g=(m[p]-d[p])*(b[0]-a[0])-(m[0]-d[0])*(b[p]-a[p]);if(0===g)return!1;d=((m[0]-d[0])*(a[p]-d[p])-(m[p]-d[p])*(a[0]-d[0]))/g;f[0]=a[0]+d*(b[0]-a[0]);f[1]=a[p]+d*(b[p]-a[p]);return!0},matrix2frustum:function(a,d,m){e.multiply(d,a,c);e.inverse(c);for(a=0;8>a;++a)e.multiplyVec4(c,b[a],g),k.set3(g[0]/
g[3],g[1]/g[3],g[2]/g[3],m[a])},matrix2frustumPlanes:function(a,b,d,m){void 0===m&&(m=d,d=f);y.matrix2frustum(a,b,d);y.point2plane(d[4],d[0],d[3],m[0]);y.point2plane(d[1],d[5],d[6],m[1]);y.point2plane(d[4],d[5],d[1],m[2]);y.point2plane(d[3],d[2],d[6],m[3]);y.point2plane(d[0],d[1],d[2],m[4]);y.point2plane(d[5],d[4],d[7],m[5])},point2plane:function(b,d,m,p){k.subtract(b,d,a);k.subtract(m,d,r);k.cross(r,a,p);k.normalize(p);p[3]=-k.dot(p,b)},project:function(a,b,d,m,p){p||(p=a);g[0]=a[0];g[1]=a[1];g[2]=
a[2];g[3]=1;e.multiplyVec4(b,g);2<p.length&&(p[2]=-g[2]);e.multiplyVec4(d,g);y.assert(0!==g[3]);p[0]=g[0]/g[3];p[1]=g[1]/g[3];p[2]=g[2]/g[3];p[0]=(0.5*p[0]+0.5)*m[2]+m[0];p[1]=(0.5*p[1]+0.5)*m[3]+m[1]},geodeticToGeocentricLatidude:function(a){return Math.atan((1-y.ECCENTRICITY_SQUARED)*Math.tan(a))},latLon2positionWGS84Ellipsoid:function(a,b,d,m){var p=6378137/Math.sqrt(1-y.ECCENTRICITY_SQUARED*Math.pow(Math.sin(a),2)),f=Math.cos(a);m[0]=(p+d)*Math.cos(b)*f;m[1]=(p*(1-y.ECCENTRICITY_SQUARED)+d)*Math.sin(a);
m[2]=-(p+d)*Math.sin(b)*f},pos2latLon:function(a,b){var d=k.length(a);b[0]=Math.asin(y.clamp(a[1]/d,-1,1));var m=Math.cos(b[0]);b[1]=(0>a[2]?1:-1)*Math.acos(y.clamp(a[0]/(m*d),-1,1));b[0]=y.rad2deg(b[0]);b[1]=y.rad2deg(b[1]);b[2]=d},pos2latLonWGS84Ellipsoid:function(a,b){var d=a[0],m=-a[2],p=a[1],f=Math.sqrt(Math.pow(6378137,2)*(1-y.ECCENTRICITY_SQUARED)),g=Math.sqrt((Math.pow(6378137,2)-Math.pow(f,2))/Math.pow(f,2)),l=Math.sqrt(Math.pow(d,2)+Math.pow(m,2)),c=Math.atan2(6378137*p,f*l),d=Math.atan2(m,
d),p=Math.atan2(p+Math.pow(g,2)*f*Math.pow(Math.sin(c),3),l-6378137*y.ECCENTRICITY_SQUARED*Math.pow(Math.cos(c),3)),f=6378137/Math.sqrt(1-y.ECCENTRICITY_SQUARED*Math.pow(Math.sin(p),2)),l=l/Math.cos(p)-f+y.EARTH_RADIUS;b[0]=p;b[1]=d;b[2]=l},computeGlobeTransformation:function(a,b,d){var m=y.deg2rad(a[0]);a=y.deg2rad(a[1]);y.latLon2position(m,a,l,b);e.translate(d,l);e.rotateY(d,0.5*Math.PI+a);e.rotateX(d,0.5*Math.PI-m);return d},readUInt16:function(a,b){return a[b]+(a[b+1]<<8)},readUInt32:function(a,
b){return a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24)},setIfDefined:function(a,b,d){void 0!==b[a]&&(d[a]=b[a])},array2object:function(a,b){var d={},m,p;if(void 0!==b){m=0;for(p=a.length;m<p;++m)d[b(a[m])]=a[m]}else{m=0;for(p=a.length;m<p;++m)d[a[m]]=a[m]}return d},object2array:function(a){var b=[],d;for(d in a)b.push(a[d]);return b},mergeObjects:function(a,b,d){void 0===d&&(d={});var m;if(d!==a)for(m in a)d[m]=a[m];if(d!==b)for(m in b)d[m]=b[m];return d},subtractObjects:function(a,b){var d={},m;for(m in a)void 0===
b[m]&&(d[m]=a[m]);return d},intersectObjects:function(a,b){var d={},m;for(m in a)void 0!==b[m]&&(d[m]=a[m]);return d},getFirstObjectKey:function(a){for(var b in a)return b},getFirstObjectValue:function(a){return a[y.getFirstObjectKey(a)]},objectEmpty:function(a){for(var b in a)return!1;return!0},arraysEqual:function(a,b){if(a.length!==b.length)return!1;for(var d=0,m=a.length;d<m;++d)if(a[d]!==b[d])return!1;return!0},byteBuffer2base64image:function(a,b,d,m,p){var f=4*b;y.assert(a.length===f*d,"buffer length must match image resolution");
var g=document.createElement("canvas");g.width=b;g.height=d;var l=g.getContext("2d");b=l.getImageData(0,0,b,d);for(var c=b.data,e=0;e<d;++e)for(var r=e*f,h=(d-1-e)*f,t=0;t<f;++t)c[r++]=a[h++];l.putImageData(b,0,0);return g.toDataURL(m,p)},cround:function(a){return Math.round(100*a)/100},logWithBase:function(a,b){return Math.log(a)/Math.log(b)},setMatrixTranslation:function(a,b){a[12]=b[0];a[13]=b[1];a[14]=b[2]},setMatrixTranslation3:function(a,b,d,m){a[12]=b;a[13]=d;a[14]=m},getMatrixTranslation:function(a,
b){b=b||k.create();b[0]=a[12];b[1]=a[13];b[2]=a[14];return b},createTranslationMatrix:function(a,b){a=e.identity(a);y.setMatrixTranslation(a,b);return a},fovx2fovy:function(a,b,d){return 2*Math.atan(d*Math.tan(0.5*a)/b)},fovy2fovx:function(a,b,d){return 2*Math.atan(b*Math.tan(0.5*a)/d)},fovx2fovd:function(a,b,d){return 2*Math.atan(Math.sqrt(b*b+d*d)*Math.tan(0.5*a)/b)},fovy2fovd:function(a,b,d){return 2*Math.atan(Math.sqrt(b*b+d*d)*Math.tan(0.5*a)/d)},fovd2fovx:function(a,b,d){return 2*Math.atan(b*
Math.tan(0.5*a)/Math.sqrt(b*b+d*d))},fovd2fovy:function(a,b,d){return 2*Math.atan(d*Math.tan(0.5*a)/Math.sqrt(b*b+d*d))},nextHighestPowerOfTwo:function(a){--a;for(var b=1;32>b;b<<=1)a|=a>>b;return a+1},resampleHermite:function(a,b,d,m,p,f,g){var l=b/p;d/=f;for(var c=Math.ceil(l/2),e=Math.ceil(d/2),r=0;r<f;r++)for(var h=0;h<p;h++){for(var t=4*(h+(g?f-r-1:r)*p),u=0,k=0,x=0,w=0,A=0,C=0,v=0,y=(r+0.5)*d,z=Math.floor(r*d);z<(r+1)*d;z++)for(var n=Math.abs(y-(z+0.5))/e,X=(h+0.5)*l,n=n*n,P=Math.floor(h*l);P<
(h+1)*l;P++){var q=Math.abs(X-(P+0.5))/c,u=Math.sqrt(n+q*q);-1<=u&&1>=u&&(u=2*u*u*u-3*u*u+1,0<u&&(q=4*(P+z*b),v+=u*a[q+3],x+=u,255>a[q+3]&&(u=u*a[q+3]/250),w+=u*a[q],A+=u*a[q+1],C+=u*a[q+2],k+=u))}m[t]=w/k;m[t+1]=A/k;m[t+2]=C/k;m[t+3]=v/x}},linelineDistance3D:function(a,b,f,g){var l,c,e;d[0]=a[0]-f[0];d[1]=a[1]-f[1];d[2]=a[2]-f[2];m[0]=g[0]-f[0];m[1]=g[1]-f[1];m[2]=g[2]-f[2];if(1E-4>Math.abs(m.x)&&1E-4>Math.abs(m.y)&&1E-4>Math.abs(m.z))return[!1];p[0]=b[0]-a[0];p[1]=b[1]-a[1];p[2]=b[2]-a[2];if(1E-4>
Math.abs(p.x)&&1E-4>Math.abs(p.y)&&1E-4>Math.abs(p.z))return[!1];b=d[0]*m[0]+d[1]*m[1]+d[2]*m[2];g=m[0]*p[0]+m[1]*p[1]+m[2]*p[2];l=d[0]*p[0]+d[1]*p[1]+d[2]*p[2];c=m[0]*m[0]+m[1]*m[1]+m[2]*m[2];e=(p[0]*p[0]+p[1]*p[1]+p[2]*p[2])*c-g*g;if(1E-4>Math.abs(e))return[!1];l=(b*g-l*c)/e;b=(b+g*l)/c;t[0]=a[0]+l*p[0];t[1]=a[1]+l*p[1];t[2]=a[2]+l*p[2];x[0]=f[0]+b*m[0];x[1]=f[1]+b*m[1];x[2]=f[2]+b*m[2];return[!0,k.dist(t,x),t,x]},projectVectorVector2D:function(a,b,d){w[0]=b[0]-a[0];w[1]=b[1]-a[1];w[2]=0;C[0]=d[0]-
a[0];C[1]=d[1]-a[1];C[2]=0;A[0]=d[0];A[1]=d[1];A[2]=0;b=k.dot(C,w);d=k.length(w);b/=d*d;z[0]=w[0]*b;z[1]=w[1]*b;v[0]=a[0]+z[0];v[1]=a[1]+z[1];k.subtract(A,v,u);a=k.length(u);b=k.length(C);d=k.length(w);var m=k.length(z);if(m>b||m>d)a=Number.MAX_VALUE;return a}};y.performance=window.performance||{};y.performance.now=y.performance.now||y.performance.mozNow||y.performance.msNow||y.performance.oNow||y.performance.webkitNow||function(){return(new Date).getTime()};return y})},"esri/views/3d/webgl-engine/lib/RenderGeometry":function(){define(["require",
"exports","./gl-matrix"],function(s,q,n){var k=n.vec3d,h=n.mat4d;return function(){function e(c,b,g,f,a,e,l,d,m,p,h){this.data=c;this.boundingInfo=b;this.material=g;this.origin=null;this.center=k.create();this.bsRadius=0;this.transformation=null;f&&this.updateTransformation(f,a);this.castShadow=e;this.singleUse=l;this.name=d;this.uniqueName=m;this.idx=p;this.canBeMerged=!0;this.componentIdx=h;this.instanceParameters=this.displayedIndexRange=void 0}e.prototype.updateTransformation=function(c,b){b=
b||h.maxScale(c);this.transformation=c;h.multiplyVec3(c,this.boundingInfo.getCenter(),this.center);this.bsRadius=this.boundingInfo.getBSRadius()*b};return e}()})},"esri/views/3d/webgl-engine/lib/VertexBufferLayout":function(){define(["require","exports","./Util"],function(s,q,n){function k(a){switch(a){case 5126:return 4;case 5120:case 5121:return 1;default:return 2}}var h=n.assert;s=n.VertexAttrConstants;var e=s.POSITION,c=s.NORMAL,b=s.UV0,g=s.COLOR,f=s.REGION;return function(){function a(a,b,d){this.stride=
0;this.attributes={};this.attrNames=a;this.attrSizes=b;this.attrTypes=d;this.init()}a.prototype.init=function(){var a=this.attrNames.length;h(this.attrSizes.length===a);if(this.attrTypes)h(this.attrTypes.length===a);else{this.attrTypes=Array(this.attrNames.length);for(var b=0;b<this.attrTypes.length;b++)this.attrTypes[b]=5126}for(b=0;b<a;b++){var d={offset:this.stride,size:this.attrSizes[b],type:this.attrTypes[b]};h(0===d.size*k(this.attrTypes[b])%4,"attribute byte length must be a multiple of 4");
this.stride+=this.attrSizes[b]*k(this.attrTypes[b])/4;this.attributes[this.attrNames[b]]=d}};a.prototype.getStride=function(){return this.stride};a.prototype.getAttributes=function(){return this.attributes};a.prototype.hasAttribute=function(a){return a in this.attributes};a.prototype.enableVertexAttribArrays=function(a,b,d){for(var m=0;m<this.attrNames.length;++m){var p=this.attrNames[m],f=this.attributes[p],p=b.getAttribLocation(p);if(-1<p)if(16===f.size)for(f=0;4>f;f++)a.enableVertexAttribArray(p+
f),d&&d.vertexAttribDivisorANGLE(p+f,1);else a.enableVertexAttribArray(p),d&&d.vertexAttribDivisorANGLE(p,1)}};a.prototype.disableVertexAttribArrays=function(a,b,d){for(var m=0;m<this.attrNames.length;++m){var p=this.attrNames[m],f=this.attributes[p],p=b.getAttribLocation(p);if(-1<p)if(16===f.size)for(f=0;4>f;f++)a.disableVertexAttribArray(p+f),d&&d.vertexAttribDivisorANGLE(p+f,0);else a.disableVertexAttribArray(p),d&&d.vertexAttribDivisorANGLE(p,0)}};a.prototype.setVertexAttribPointers=function(a,
b){for(var d=0;d<this.attrNames.length;++d){var m=this.attrNames[d],p=this.attributes[m],f=p.size,g=4*p.offset,p=p.type,m=b.getAttribLocation(m);if(-1<m)if(16===f)for(f=0;4>f;f++)a.vertexAttribPointer(m+f,4,p,!1,4*this.stride,g+16*f);else a.vertexAttribPointer(m,f,p,!1,4*this.stride,g)}};a.Defaults={Pos:new a([e],[3],void 0),Pos2:new a([e],[2],void 0),PosNorm:new a([e,c],[3,3],void 0),PosTex:new a([e,b],[3,2],void 0),PosColor:new a([e,g],[3,4],[5126,5121]),Pos2Tex:new a([e,b],[2,2],void 0),PosNormTex:new a([e,
c,b],[3,3,2],void 0),PosNormCol:new a([e,c,g],[3,3,4],[5126,5126,5121]),PosNormTexCol:new a([e,c,b,g],[3,3,2,4],[5126,5126,5126,5121]),PosNormTexRegion:new a([e,c,b,f],[3,3,2,4],[5126,5126,5126,5123]),PosNormTexRegionCol:new a([e,c,b,f,g],[3,3,2,4,4],[5126,5126,5126,5123,5121]),Model:new a(["model","modelNormal"],[16,16],void 0),ModelCol:new a(["model","modelNormal","instanceColor"],[16,16,4],void 0)};return a}()})},"esri/views/3d/webgl-engine/lib/GLSLProgram":function(){define(["require","exports",
"./GLSLShader","./gl-matrix"],function(s,q,n,k){var h=k.vec2d,e=k.vec3d,c=k.vec4d,b=k.mat4d;return function(){function g(b,a){this.gl=a;this.shaders=b;this.globalIndex=g.nextGlobalProgramIndex++;this.glName=void 0;this.name2uniformLoc={};this.name2attribLoc={};this.name2uniform1={};this.name2uniform2={};this.name2uniform3={};this.name2uniform4={};this.name2uniformMatrix4={}}g.prototype.init=function(){if(void 0===this.glName){this.glName=this.gl.createProgram();for(var b=0;b<this.shaders.length;++b)this.gl.attachShader(this.glName,
this.shaders[b].getGLName());this.linkShaders()}};g.prototype.linkShaders=function(){if(null!=this.glName){var b=this.gl;b.linkProgram(this.glName);b.getProgramParameter(this.glName,this.gl.LINK_STATUS)||console.error("Could not initialize shader\nVALIDATE_STATUS: "+b.getProgramParameter(this.glName,b.VALIDATE_STATUS)+", gl error ["+b.getError()+"]infoLog: "+b.getProgramInfoLog(this.glName));this.name2uniformLoc={};this.name2attribLoc={}}};g.prototype.clearLookupTables=function(){this.name2uniformLoc=
{};this.name2attribLoc={};this.name2uniform1={};this.name2uniform2={};this.name2uniform3={};this.name2uniform4={};this.name2uniformMatrix4={}};g.prototype.getId=function(){return this.globalIndex};g.prototype.getShader=function(b){return this.shaders["vertex"===b?0:1]};g.prototype.changeShaderDefines=function(b,a){this.shaders[b].changeDefines(a)&&this.linkShaders()};g.prototype.use=function(){g.lastUsedProgram!==this&&(this.init(),this.gl.useProgram(this.glName),g.lastUsedProgram=this)};g.prototype.getLocation=
function(b){this.init();null==this.name2uniformLoc[b]&&(this.name2uniformLoc[b]=this.gl.getUniformLocation(this.glName,b));return this.name2uniformLoc[b]};g.prototype.hasUniform=function(b){return null!==this.getLocation(b)};g.prototype.getAttribLocation=function(b){this.init();null==this.name2attribLoc[b]&&(this.name2attribLoc[b]=this.gl.getAttribLocation(this.glName,b));return this.name2attribLoc[b]};g.prototype.uniform1i=function(b,a){var g=this.name2uniform1[b];if(null==g||a!==g)this.use(),this.gl.uniform1i(this.getLocation(b),
a),this.name2uniform1[b]=a};g.prototype.uniform1f=function(b,a){var g=this.name2uniform1[b];if(null==g||a!==g)this.use(),this.gl.uniform1f(this.getLocation(b),a),this.name2uniform1[b]=a};g.prototype.uniform2f=function(b,a,g){var l=this.name2uniform2[b];if(null==l||a!==l[0]||g!==l[1])this.use(),this.gl.uniform2f(this.getLocation(b),a,g),null==l?this.name2uniform2[b]=h.createFrom(a,g):h.set2(a,g,l)};g.prototype.uniform2fv=function(b,a){var g=this.name2uniform2[b];if(2<a.length||null==g||a[0]!==g[0]||
a[1]!==g[1])this.use(),this.gl.uniform2fv(this.getLocation(b),a),null==g?this.name2uniform2[b]=h.create(a):h.set(a,g)};g.prototype.uniform3f=function(b,a,g,l){var d=this.name2uniform3[b];if(null==d||a!==d[0]||g!==d[1]||l!==d[2])this.use(),this.gl.uniform3f(this.getLocation(b),a,g,l),null==d?this.name2uniform3[b]=e.createFrom(a,g,l):e.set3(a,g,l,d)};g.prototype.uniform3fv=function(b,a){var g=this.name2uniform3[b];if(3<a.length||null==g||a[0]!==g[0]||a[1]!==g[1]||a[2]!==g[2])this.use(),this.gl.uniform3fv(this.getLocation(b),
a),null==g?this.name2uniform3[b]=e.create(a):e.set(a,g)};g.prototype.uniform4f=function(b,a,g,l,d){var m=this.name2uniform4[b];if(null==m||a!==m[0]||g!==m[1]||l!==m[2]||d!==m[3])this.use(),this.gl.uniform4f(this.getLocation(b),a,g,l,d),null==m?this.name2uniform4[b]=c.createFrom(a,g,l,d):c.set4(a,g,l,d,m)};g.prototype.uniform4fv=function(b,a){var g=this.name2uniform4[b];if(4<a.length||null==g||a[0]!==g[0]||a[1]!==g[1]||a[2]!==g[2]||a[3]!==g[3])this.use(),this.gl.uniform4fv(this.getLocation(b),a),null==
g?this.name2uniform4[b]=c.create(a):c.set(a,g)};g.prototype.uniformMatrix4fv=function(g,a){var c=this.name2uniformMatrix4[g];if(16<a.length||null==c||!(c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]&&c[4]===a[4]&&c[5]===a[5]&&c[6]===a[6]&&c[7]===a[7]&&c[8]===a[8]&&c[9]===a[9]&&c[10]===a[10]&&c[11]===a[11]&&c[12]===a[12]&&c[13]===a[13]&&c[14]===a[14]&&c[15]===a[15]))this.use(),this.gl.uniformMatrix4fv(this.getLocation(g),!1,a),null==c?this.name2uniformMatrix4[g]=b.create(a):b.set(a,c)};g.prototype.dispose=
function(){if(null!=this.glName){for(var b=0;b<this.shaders.length;++b){var a=this.shaders[b].getGLName();this.gl.detachShader(this.glName,a);this.gl.deleteShader(a)}this.gl.deleteProgram(this.glName)}};g.fromSnippets=function(b,a,c,l,d){var m=[];b=Array.isArray(b)?b:[b];a=Array.isArray(a)?a:[a];for(var p=0;p<b.length;p++)m.push(new n(l.VERTEX_SHADER,c[b[p]],l,d));for(p=0;p<a.length;p++)m.push(new n(l.FRAGMENT_SHADER,c[a[p]],l,d));return new g(m,l)};g.unuse=function(b){g.lastUsedProgram=null;b.useProgram(null)};
g.nextGlobalProgramIndex=0;g.lastUsedProgram=null;return g}()})},"esri/views/3d/webgl-engine/lib/GLSLShader":function(){define(["require","exports"],function(s,q){function n(k){var h=2;return k.replace(/\n/g,function(){var e;e=h++;e=1E3>e?("  "+e).slice(-3):""+e;return"\n"+e+":"})}return function(){function k(h,e,c,b){this.glName=void 0;this.defines=b;this.gl=c;this.type=h;this.source=e}k.prototype.init=function(){void 0===this.glName&&(this.glName=this.gl.createShader(this.type),this.loadShader())};
k.prototype.loadShader=function(){var h=this.source,e=this.defines,c=this.gl;if(void 0!==e){for(var b="",g=0;g<e.length;g++)b+="#define "+e[g]+"\n";h=b+h}c.shaderSource(this.glName,h);c.compileShader(this.glName);c.getShaderParameter(this.glName,c.COMPILE_STATUS)||(console.error(c.getShaderInfoLog(this.glName)),console.error(n(h)))};k.prototype.changeDefines=function(h){if(JSON.stringify(this.defines)===JSON.stringify(h))return!1;this.defines=h;void 0!==this.glName&&this.loadShader();console.log("updating shader");
return!0};k.prototype.getGLName=function(){this.init();return this.glName};return k}()})},"esri/views/3d/webgl-engine/lib/GeometryUtil":function(){define(["./GeometryData","./BufferVectorMath","./Util","./gl-matrix"],function(s,q,n,k){function h(a,b,p,g,f){if(Math.abs(c.dot(b,a))>f)return!1;c.cross(a,b,p);c.normalize(p);c.cross(p,a,g);c.normalize(g);return!0}function e(a,b,p,g,f,l,c){return h(a,b,f,l,c)||h(a,p,f,l,c)||h(a,g,f,l,c)}var c=k.vec3,b=k.vec3d,g=n.VertexAttrConstants,f=q.Vec3Compact,a=b.create(),
r=b.create(),l={createSphereGeometry:function(a,b,p,f,l,e,r){a=a||50;f=void 0!==f?f:-Math.PI;l=void 0!==l?l:2*Math.PI;e=void 0!==e?e:0.5*-Math.PI;r=void 0!==r?r:Math.PI;var h=Math.max(3,Math.floor(b)||8),k=Math.max(2,Math.floor(p)||6),C=(h+1)*(k+1);p=new Float32Array(3*C);b=new Float32Array(3*C);var C=new Float32Array(2*C),A,y,B=[],D=c.create(),F=0;for(y=0;y<=k;y++){var H=[],N=y/k,G=e+N*r,O=Math.cos(G);for(A=0;A<=h;A++){var q=A/h,I=f+q*l,Z=Math.cos(I)*O*a,V=Math.sin(G)*a,I=-Math.sin(I)*O*a;p[3*F]=
Z;p[3*F+1]=V;p[3*F+2]=I;c.set3(Z,V,I,D);c.normalize(D);b[3*F]=D[0];b[3*F+1]=D[1];b[3*F+2]=D[2];C[2*F]=q;C[2*F+1]=N;H.push(F);++F}B.push(H)}a=new Uint32Array(3*2*h*(k-1));for(y=F=0;y<k;y++)for(A=0;A<h;A++)f=B[y][A],l=B[y][A+1],e=B[y+1][A+1],r=B[y+1][A],0===y?(a[F++]=f,a[F++]=e,a[F++]=r):y===k-1?(a[F++]=f,a[F++]=l,a[F++]=e):(a[F++]=f,a[F++]=l,a[F++]=e,a[F++]=e,a[F++]=r,a[F++]=f);n.assert(F===a.length);h={};h[g.POSITION]=a;h[g.NORMAL]=a;h[g.UV0]=a;k={};k[g.POSITION]={size:3,data:p};k[g.NORMAL]={size:3,
data:b};k[g.UV0]={size:2,data:C};return new s([{type:"triangle",indices:h,positionKey:g.POSITION}],k)},createPolySphereGeometry:function(a,b,p){function l(b,m){b>m&&(b=m+(m=b,0));var p=b.toString()+"."+m.toString();if(r[p])return r[p];var g=e.length;e.length+=3;f.add(e,3*b,e,3*m,e,g);f.scale(e,g,a/f.length(e,g));g/=3;return r[p]=g}var c=a,e;p?(e=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],c=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]):(p=c*(1+Math.sqrt(5))/2,e=[-c,p,0,c,p,0,-c,-p,0,c,-p,0,0,-c,
p,0,c,p,0,-c,-p,0,c,-p,p,0,-c,p,0,c,-p,0,-c,-p,0,c],c=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]);for(p=0;p<e.length;p+=3)f.scale(e,p,a/f.length(e,p));var r={};for(p=0;p<b;p++){for(var h=c.length,k=Array(4*h),C=0;C<h;C+=3){var A=c[C],y=c[C+1],B=c[C+2],D=l(A,y),n=l(y,B),H=l(B,A),N=4*C;k[N]=A;k[N+1]=D;k[N+2]=H;k[N+3]=y;k[N+4]=n;k[N+5]=D;k[N+6]=B;k[N+7]=H;k[N+8]=n;k[N+9]=D;k[N+10]=n;k[N+11]=H}c=k;r={}}b=new Float32Array(e);
for(p=0;p<b;p+=3)f.normalize(b,p);e=new Float32Array(e);p={};p[g.POSITION]=c;p[g.NORMAL]=c;c={};c[g.POSITION]={size:3,data:e};c[g.NORMAL]={size:3,data:b};return new s([{type:"triangle",indices:p,positionKey:g.POSITION}],c)},createPointGeometry:function(a,b,p,f,l,c,e){var r=new Float32Array(3);r[0]=b?b[0]:0;r[1]=b?b[1]:0;r[2]=b?b[2]:0;b=new Float32Array(3);b[0]=a?a[0]:0;b[1]=a?a[1]:0;b[2]=a?a[2]:1;if(null==e)a=new Float32Array(2),a[0]=0,a[1]=0;else{a=new Float32Array(e.length);for(var h=0;h<e.length;h++)a[h]=
e[h]}e=new Uint8Array(4);e[0]=p?255*p[0]:255;e[1]=p?255*p[1]:255;e[2]=p?255*p[2]:255;e[3]=p&&3<p.length?255*p[3]:255;p=new Float32Array(2);p[0]=null!=f&&2==f.length?f[0]:1;p[1]=null!=f&&2==f.length?f[1]:1;if(null!=c){var k=new Float32Array(4);k[0]=c[0];k[1]=c[1];k[2]=c[2];k[3]=c[3]}h=new Uint32Array(1);h[0]=0;f={};f[g.POSITION]=h;f[g.NORMAL]=h;f[g.UV0]=h;f[g.COLOR]=h;f[g.SIZE]=h;null!=c&&(f[g.AUXPOS1]=h);h={};h[g.POSITION]={size:3,data:r};h[g.NORMAL]={size:3,data:b};h[g.UV0]={size:a.length,data:a};
h[g.COLOR]={size:4,data:e};h[g.SIZE]={size:2,data:p};null!=c&&(h[g.AUXPOS1]={size:4,data:k});c=[{type:"point",indices:f,positionKey:g.POSITION}];return l?{faces:c[0],vertexAttr:h,id:s.getNewId().toString()}:new s(c,h)},createPointArrayGeometry:function(a,b){for(var p=new Float32Array(3*a.length),f=new Float32Array(b?3*a.length:3),c=new Uint32Array(a.length),l=new Uint32Array(a.length),e=0;e<a.length;e++)p[3*e]=a[e][0],p[3*e+1]=a[e][1],p[3*e+2]=a[e][2],b&&(f[3*e]=b[e][0],f[3*e+1]=b[e][1],f[3*e+2]=
b[e][2]),c[e]=e,l[e]=0;b||(f[0]=0,f[1]=1,f[2]=0);e=new Float32Array(2);e[0]=0;e[1]=0;var r={};r[g.POSITION]=c;r[g.NORMAL]=b?c:l;r[g.UV0]=l;c={};c[g.POSITION]={size:3,data:p};c[g.NORMAL]={size:3,data:f};c[g.UV0]={size:2,data:e};return new s([{type:"point",indices:r,positionKey:g.POSITION}],c)},createTriangleGeometry:function(){var a=new Float32Array(9);a[0]=0;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=100;a[6]=100;a[7]=0;a[8]=0;var b=new Uint32Array(3);b[0]=0;b[1]=1;b[2]=2;var p=new Float32Array(3);p[0]=0;p[1]=
1;p[2]=0;var f=new Uint32Array(3);f[0]=0;f[1]=0;f[2]=0;var c=new Float32Array(2);c[0]=0;c[1]=0;var l=new Uint32Array(3);l[0]=0;l[1]=0;l[2]=0;var e={};e[g.POSITION]=b;e[g.NORMAL]=f;e[g.UV0]=l;b={};b[g.POSITION]={size:3,data:a};b[g.NORMAL]={size:3,data:p};b[g.UV0]={size:2,data:c};return new s([{type:"triangle",indices:e,positionKey:g.POSITION}],b)},createSquareGeometry:function(a,b){var p,f,c=new Float32Array(12);if(a)for(p=0;4>p;p++)for(f=0;3>f;f++)c[3*p+f]=a[p][f];else c[0]=-1,c[1]=-1,c[2]=0,c[3]=
1,c[4]=-1,c[5]=0,c[6]=1,c[7]=1,c[8]=0,c[9]=-1,c[10]=1,c[11]=0;var l=new Uint32Array(6);l[0]=0;l[1]=1;l[2]=2;l[3]=2;l[4]=3;l[5]=0;f=new Float32Array(3);f[0]=0;f[1]=0;f[2]=1;var e=new Uint32Array(6);for(p=0;6>p;p++)e[p]=0;p=new Float32Array(8);p[0]=0;p[1]=0;p[2]=1;p[3]=0;p[4]=1;p[5]=1;p[6]=0;p[7]=1;var r={};r[g.POSITION]=l;r[g.NORMAL]=e;r[g.UV0]=l;l={};l[g.POSITION]={size:3,data:c};l[g.NORMAL]={size:3,data:f};l[g.UV0]={size:2,data:p};c=[{type:"triangle",indices:r,positionKey:g.POSITION}];return b?{faces:c[0],
vertexAttr:l,id:s.getNewId().toString()}:new s(c,l)},createBoxGeometry:function(){var a,b,p=[[-0.5,-0.5,0.5],[0.5,-0.5,0.5],[0.5,0.5,0.5],[-0.5,0.5,0.5],[-0.5,-0.5,-0.5],[0.5,-0.5,-0.5],[0.5,0.5,-0.5],[-0.5,0.5,-0.5]],f=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],c=[0,0,1,0,1,1,0,1],l=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],e=Array(36);for(a=0;6>a;a++)for(b=0;6>b;b++)e[6*a+b]=a;var r=Array(36);for(a=0;6>a;a++)r[6*a+0]=0,r[6*a+1]=1,r[6*a+2]=2,r[6*a+3]=2,r[6*a+4]=3,r[6*
a+5]=0;return function(a){var b;Array.isArray(a)||(a=[a,a,a]);var d=new Float32Array(24);for(b=0;8>b;b++)d[3*b]=p[b][0]*a[0],d[3*b+1]=p[b][1]*a[1],d[3*b+2]=p[b][2]*a[2];a={};a[g.POSITION]=new Uint8Array(l);a[g.NORMAL]=new Uint8Array(e);a[g.UV0]=new Uint8Array(r);b={};b[g.POSITION]={size:3,data:d};b[g.NORMAL]={size:3,data:new Float32Array(f)};b[g.UV0]={size:2,data:new Float32Array(c)};return new s([{type:"triangle",indices:a,positionKey:g.POSITION}],b)}}(),createDiamondGeometry:function(){var a=[[-0.5,
0,-0.5],[0.5,0,-0.5],[0.5,0,0.5],[-0.5,0,0.5],[0,-0.5,0],[0,0.5,0]],b=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],p=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],f=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];return function(c){var l;Array.isArray(c)||(c=[c,c,c]);var e=new Float32Array(18);for(l=0;6>l;l++)e[3*l]=a[l][0]*c[0],e[3*l+1]=a[l][1]*c[1],e[3*l+2]=a[l][2]*c[2];c={};c[g.POSITION]=new Uint8Array(p);c[g.NORMAL]=new Uint8Array(f);l={};l[g.POSITION]={size:3,data:e};l[g.NORMAL]=
{size:3,data:new Float32Array(b)};return new s([{type:"triangle",indices:c,positionKey:g.POSITION}],l)}}(),createTetrahedronGeometry:function(){var a=c.createFrom(-0.5,0,-0.5),b=c.createFrom(0.5,0,-0.5),p=c.createFrom(0,0,0.5),f=c.createFrom(0,0.5,0),l=c.create(),e=c.create(),r=c.create(),h=c.create(),k=c.create();c.subtract(a,f,l);c.subtract(a,b,e);c.cross(l,e,r);c.normalize(r,r);c.subtract(b,f,l);c.subtract(b,p,e);c.cross(l,e,h);c.normalize(h,h);c.subtract(p,f,l);c.subtract(p,a,e);c.cross(l,e,k);
c.normalize(k,k);var C=[a,b,p,f],A=[0,-1,0,r[0],r[1],r[2],h[0],h[1],h[2],k[0],k[1],k[2]],y=[0,1,2,3,1,0,3,2,1,3,0,2],B=[0,0,0,1,1,1,2,2,2,3,3,3];return function(a){var b;Array.isArray(a)||(a=[a,a,a]);var d=new Float32Array(12);for(b=0;4>b;b++)d[3*b]=C[b][0]*a[0],d[3*b+1]=C[b][1]*a[1],d[3*b+2]=C[b][2]*a[2];a={};a[g.POSITION]=new Uint8Array(y);a[g.NORMAL]=new Uint8Array(B);b={};b[g.POSITION]={size:3,data:d};b[g.NORMAL]={size:3,data:new Float32Array(A)};return new s([{type:"triangle",indices:a,positionKey:g.POSITION}],
b)}}(),createConeGeometry:function(a,b,p,f){var l=0,e=c.createFrom(0,l,0),r=c.createFrom(0,l+a,0),h=c.createFrom(0,-1,0),k=c.createFrom(0,1,0);f&&(l=a,r=c.createFrom(0,0,0),e=c.createFrom(0,l,0),h=c.createFrom(0,1,0),k=c.createFrom(0,-1,0));var e=[r,e],h=[h,k],k=p+2,C=0,r=Math.sqrt(a*a+b*b);if(f)for(f=p-1;0<=f;f--)C=f*(2*Math.PI/p),A=c.createFrom(Math.cos(C)*b,l,Math.sin(C)*b),e.push(A),C=c.createFrom(a*Math.cos(C)/r,-b/r,a*Math.sin(C)/r),h.push(C);else for(f=0;f<p;f++){var C=f*(2*Math.PI/p),A=c.createFrom(Math.cos(C)*
b,l,Math.sin(C)*b);e.push(A);C=c.createFrom(a*Math.cos(C)/r,b/r,a*Math.sin(C)/r);h.push(C)}a=new Uint32Array(6*(p+2));p=new Uint32Array(6*(p+2));l=b=0;for(f=3;f<e.length;f++)a[b++]=1,a[b++]=f-1,a[b++]=f,p[l++]=0,p[l++]=0,p[l++]=0;a[b++]=e.length-1;a[b++]=2;a[b++]=1;p[l++]=0;p[l++]=0;p[l++]=0;for(f=3;f<e.length;f++)a[b++]=f,a[b++]=f-1,a[b++]=0,p[l++]=f,p[l++]=f-1,p[l++]=1;a[b++]=0;a[b++]=2;a[b++]=e.length-1;p[l++]=1;p[l++]=2;p[l++]=h.length-1;l=1;Array.isArray(l)||(l=[l,l,l]);b=new Float32Array(3*
k);for(f=0;f<k;f++)b[3*f]=e[f][0]*l[0],b[3*f+1]=e[f][1]*l[1],b[3*f+2]=e[f][2]*l[2];e=new Float32Array(3*k);for(f=0;f<k;f++)e[3*f]=h[f][0],e[3*f+1]=h[f][1],e[3*f+2]=h[f][2];h={};h[g.POSITION]=a;h[g.NORMAL]=p;k={};k[g.POSITION]={size:3,data:b};k[g.NORMAL]={size:3,data:e};return new s([{type:"triangle",indices:h,positionKey:g.POSITION}],k)},createCylinderGeometry:function(a,b,p,f,l,e){f||(f=c.createFrom(1,0,0));l||(l=c.createFrom(0,0,0));e=void 0===e?!0:e;var r=c.create();c.normalize(f,r);f=c.create();
c.scale(r,Math.abs(a),f);var h=c.create();c.scale(f,-0.5,h);c.add(h,l);var k=c.createFrom(0,1,0);Math.abs(0.2>1-c.dot(r,k))&&c.set3(0,0,1,k);var C=c.create();c.cross(r,k,C);c.normalize(C);c.cross(C,r,k);var A=2*p+(e?2:0),y=p+(e?2:0);l=new Float32Array(3*A);a=new Float32Array(3*y);var B=new Float32Array(2*A),D=new Uint32Array(3*p*(e?4:2)),n=new Float32Array(3*p*(e?4:2));e&&(l[3*(A-2)+0]=h[0],l[3*(A-2)+1]=h[1],l[3*(A-2)+2]=h[2],B[2*(A-2)]=0,B[2*(A-2)+1]=0,l[3*(A-1)+0]=l[3*(A-2)+0]+f[0],l[3*(A-1)+1]=
l[3*(A-2)+1]+f[1],l[3*(A-1)+2]=l[3*(A-2)+2]+f[2],B[2*(A-1)]=1,B[2*(A-1)+1]=1,a[3*(y-2)+0]=-r[0],a[3*(y-2)+1]=-r[1],a[3*(y-2)+2]=-r[2],a[3*(y-1)+0]=r[0],a[3*(y-1)+1]=r[1],a[3*(y-1)+2]=r[2]);for(var H,N=0,G=c.create(),O=c.create(),r=0;r<p;r++){H=r*(2*Math.PI/p);c.scale(k,Math.sin(H),G);c.scale(C,Math.cos(H),O);c.add(G,O);a[3*r+0]=G[0];a[3*r+1]=G[1];a[3*r+2]=G[2];c.scale(G,b);c.add(G,h);l[3*r+0]=G[0];l[3*r+1]=G[1];l[3*r+2]=G[2];B[2*r+0]=r/p;B[2*r+1]=0;l[3*(r+p)+0]=l[3*r+0]+f[0];l[3*(r+p)+1]=l[3*r+1]+
f[1];l[3*(r+p)+2]=l[3*r+2]+f[2];B[2*(r+p)+0]=r/p;B[2*r+1]=1;H=(r+1)%p;var q=function(a,b,d){D[a]=b;n[a]=d};e&&(q(N++,A-2,y-2),q(N++,r,y-2),q(N++,H,y-2));q(N++,r,r);q(N++,r+p,r);q(N++,H,H);q(N++,H,H);q(N++,r+p,r);q(N++,H+p,H);e&&(q(N++,r+p,y-1),q(N++,A-1,y-1),q(N++,H+p,y-1))}b={};b[g.POSITION]=D;b[g.NORMAL]=n;b[g.UV0]=D;p={};p[g.POSITION]={size:3,data:l};p[g.NORMAL]={size:3,data:a};p[g.UV0]={size:2,data:B};return new s([{type:"triangle",indices:b,positionKey:g.POSITION}],p)},createTubeGeometry:function(a,
b,f,g,c){f=f||10;g=null!=g?g:!0;n.assert(1<a.length);for(var e=[],r=[],h=0;h<f;h++){e.push([0,-h-1,-((h+1)%f)-1]);var k=2*(h/f)*Math.PI;r.push([Math.cos(k)*b,Math.sin(k)*b])}return l.createPathExtrusionGeometry(r,a,[[0,0,0]],e,g,c)},createSquareTubeGeometry:function(a,b,f){f=f||!0;n.assert(1<a.length);b*=Math.SQRT2;return l.createPathExtrusionGeometry([[b,b],[-b,b],[-b,-b],[b,-b]],a,[],[[-1,-2,-3],[-3,-4,-1]],f,[[0,1],[-1,0],[0,-1],[1,0]])},createPathExtrusionGeometry:function(a,b,f,l,r,h,k){var n,
w=a.length,C=new Float32Array(3*b.length*w+(6*f.length||0)),A=new Float32Array(b.length*w+(2*f.length||0)),y=new Float32Array(3*b.length*w+(f?6:0)),B=0,D=0,F=0,H=65535<C.length/3?Uint32Array:Uint16Array,N=6*(b.length-1)*w+6*l.length,G=new H(N),H=new H(N),O=N=0,q=c.create(),I=c.create(),Z=c.create(),V=c.create(),L=c.create(),Y=c.create(),E=c.create(),ba=c.create(),W=c.create(),R=c.create(),T=c.create(),J=c.create();c.set3(0,1,0,J);c.subtract(b[1],b[0],I);c.normalize(I);r?(c.add(b[0],h,T),c.normalize(T,
Z)):c.set3(0,0,1,Z);e(I,Z,J,J,Y,Z,0.99619469809);c.set(Z,V);for(n=0;n<f.length;n++)c.scale(Y,f[n][0],W),c.scale(Z,f[n][2],T),c.add(W,T),c.add(W,b[0]),C[B++]=W[0],C[B++]=W[1],C[B++]=W[2],A[F++]=0;y[D++]=-I[0];y[D++]=-I[1];y[D++]=-I[2];for(n=0;n<l.length;n++)G[N++]=0<l[n][0]?l[n][0]:-l[n][0]-1+f.length,G[N++]=0<l[n][1]?l[n][1]:-l[n][1]-1+f.length,G[N++]=0<l[n][2]?l[n][2]:-l[n][2]-1+f.length,H[O++]=0,H[O++]=0,H[O++]=0;var S=f.length;n=f.length-1;for(var K,Q=0;Q<b.length;Q++){K=!1;0<Q&&(r?(c.add(b[Q],
h,T),c.normalize(T,Z)):c.set3(0,0,1,Z),c.set(I,q),c.set(q,T),Q<b.length-1?(c.subtract(b[Q+1],b[Q],I),c.normalize(I),c.add(T,I)):K=!0,e(T,Z,V,J,Y,Z,0.99619469809),c.set(Z,V));k&&(e(I,Z,V,J,ba,E,0.99619469809),c.set(E,L));for(var U=0;U<w;U++)if(c.scale(Y,a[U][0],W),c.scale(Z,a[U][1],T),c.add(W,T),k?(c.scale(ba,k[U][0],R),c.scale(E,k[U][1],T),c.add(R,T),c.normalize(R),c.scale(R,-1)):c.normalize(W,R),y[D++]=R[0],y[D++]=R[1],y[D++]=R[2],c.add(W,b[Q]),C[B++]=W[0],C[B++]=W[1],C[B++]=W[2],A[F++]=a[U][1],
!K){var X=(U+1)%w;G[N++]=S+U;G[N++]=S+w+U;G[N++]=S+X;G[N++]=S+X;G[N++]=S+w+U;G[N++]=S+w+X;if(k)for(X=0;6>X;X++)H[O++]=S-n+U;else for(X=0;6>X;X++)H[O++]=G[N-6+X]-n}S+=w}K=b[b.length-1];for(n=0;n<f.length;n++)c.scale(Y,f[n][0],W),c.scale(Z,f[n][1],T),c.add(W,T),c.add(W,K),C[B++]=W[0],C[B++]=W[1],C[B++]=W[2],A[F++]=0;a=D/3;y[D++]=I[0];y[D++]=I[1];y[D++]=I[2];w=S-w;for(n=0;n<l.length;n++)G[N++]=0<=l[n][0]?S+l[n][0]:-l[n][0]-1+w,G[N++]=0<=l[n][2]?S+l[n][2]:-l[n][2]-1+w,G[N++]=0<=l[n][1]?S+l[n][1]:-l[n][1]-
1+w,H[O++]=a,H[O++]=a,H[O++]=a;l={};l[g.POSITION]=G;l[g.NORMAL]=H;G={};G[g.POSITION]={size:3,data:C};G.zOffset={size:1,data:A};G[g.NORMAL]={size:3,data:y};return new s([{type:"triangle",indices:l,positionKey:g.POSITION}],G)},createPolylineGeometry:function(a,b){n.assert(1<a.length,"createPolylineGeometry(): polyline needs at least 2 points");n.assert(3===a[0].length,"createPolylineGeometry(): malformed vertex");for(var f=new Float32Array(3*a.length),l=new Uint32Array(2*(a.length-1)),c=0,e=0,r=0;r<
a.length;r++){for(var h=0;3>h;h++)f[c++]=a[r][h];0<r&&(l[e++]=r-1,l[e++]=r)}e={};c={};e[g.POSITION]=l;c[g.POSITION]={size:3,data:f};f=[{type:"line",indices:e,positionKey:g.POSITION}];return b?{faces:f[0],vertexAttr:c,id:s.getNewId().toString()}:new s(f,c)},addVertexColors:function(a,b,f){var l,c,e;if(f){var r={};f=a.getVertexAttr();for(e in f)r[e]=f[e];a=a.getFaces();f=Array(a.length);for(c=0;c<a.length;c++){l={};for(e in a[c].indices)l[e]=a[c].indices[e];f[c]={type:a[c].type,indices:l,positionKey:a[c].positionKey}}a=
new s(f,r)}b=b||[1,1,1,1];e=new Uint8Array(4);e[0]=255*b[0];e[1]=255*b[1];e[2]=255*b[2];e[3]=255*(3<b.length?b[3]:1);a.getVertexAttr()[g.COLOR]={size:4,data:e};f=a.getFaces();for(c=0;c<f.length;c++)b=f[c],l=new Uint32Array(b.indices[b.positionKey].length),b.indices[g.COLOR]=l;return a},addNormals:function(d){var m=d.getVertexAttr();d=d.getFaces();for(var f=q.Vec3Compact.subtract,l=d.map(function(a){return a.indices.position.length/3}).reduce(function(a,b){return a+b}),l=new Float32Array(3*l),g=m.position.data,
c=0,e=0;e<d.length;e++){for(var h=d[e].indices.position,k=new Uint32Array(h.length),C=0;C<h.length;C+=3){f(g,3*h[C],g,3*h[C+2],r,0);f(g,3*h[C],g,3*h[C+1],a,0);b.cross(a,r);b.normalize(a);var A=c/3;l[c++]=a[0];l[c++]=a[1];l[c++]=a[2];k[C]=A;k[C+1]=A;k[C+2]=A}d[e].indices.normal=k}m.normal={size:3,data:l}},cgToGIS:function(a){var b=a.getVertexAttr();a=b.position.data;var b=b.normal.data,f,l;if(b)for(f=0;f<b.length;f+=3)l=b[f+1],b[f+1]=-b[f+2],b[f+2]=l;if(a)for(f=0;f<a.length;f+=3)l=a[f+1],a[f+1]=-a[f+
2],a[f+2]=l}};return l})},"esri/views/3d/webgl-engine/lib/GeometryData":function(){define(["require","exports"],function(s,q){return function(){function n(k,h){this.id=n.getNewId();this.faces=k;this.vertexAttributes=h}n.prototype.estimateGpuMemoryUsage=function(){for(var k=0,h=0;h<this.faces.length;h++){var e=3;this.faces[h].indices.normal&&(e+=3);this.faces[h].indices.uv0&&(e+=2);this.faces[h].indices.color&&e++;k+=4*this.faces[h].indices.position.length*e}return k};n.prototype.getId=function(){return this.id};
n.prototype.getFaces=function(){return this.faces};n.prototype.getVertexAttr=function(){return this.vertexAttributes};n.getNewId=function(){return n._id++};n._id=0;n.AxisOrder={CG:0,GIS:1};return n}()})},"esri/views/3d/webgl-engine/lib/BufferVectorMath":function(){define(["require","exports"],function(s,q){(function(n){n.length=function(k,h){var e=k[h],c=k[h+1],b=k[h+2];return Math.sqrt(e*e+c*c+b*b)};n.normalize=function(k,h){var e=k[h],c=k[h+1],b=k[h+2],e=1/Math.sqrt(e*e+c*c+b*b);k[h]*=e;k[h+1]*=
e;k[h+2]*=e};n.scale=function(k,h,e){k[h]*=e;k[h+1]*=e;k[h+2]*=e};n.add=function(k,h,e,c,b,g){void 0===g&&(g=h);b=b||k;b[g]=k[h]+e[c];b[g+1]=k[h+1]+e[c+1];b[g+2]=k[h+2]+e[c+2]};n.subtract=function(k,h,e,c,b,g){void 0===g&&(g=h);b=b||k;b[g]=k[h]-e[c];b[g+1]=k[h+1]-e[c+1];b[g+2]=k[h+2]-e[c+2]}})(q.Vec3Compact||(q.Vec3Compact={}))})},"esri/views/3d/webgl-engine/lib/RenderPass":function(){define(["require","exports"],function(s,q){var n,k=n||(n={});k[k.MATERIAL=0]="MATERIAL";k[k.MATERIAL_DEPTH=1]="MATERIAL_DEPTH";
k[k.MATERIAL_NORMAL=2]="MATERIAL_NORMAL";k[k.MATERIAL_DEPTH_SHADOWMAP=3]="MATERIAL_DEPTH_SHADOWMAP";k[k.MATERIAL_HIGHLIGHT=4]="MATERIAL_HIGHLIGHT";k[k.MAX_PASS=5]="MAX_PASS";return n})},"esri/views/3d/webgl-engine/lib/RenderSlot":function(){define(["require","exports"],function(s,q){var n,k=n||(n={});k[k.BACKGROUND=0]="BACKGROUND";k[k.INTERNAL_MATERIAL=1]="INTERNAL_MATERIAL";k[k.OPAQUE_TERRAIN=2]="OPAQUE_TERRAIN";k[k.OPAQUE_MATERIAL=3]="OPAQUE_MATERIAL";k[k.OPAQUE_EXTERNAL=4]="OPAQUE_EXTERNAL";k[k.TRANSPARENT_MATERIAL=
5]="TRANSPARENT_MATERIAL";k[k.TRANSPARENT_EXTERNAL=6]="TRANSPARENT_EXTERNAL";k[k.TRANSPARENT_TERRAIN=7]="TRANSPARENT_TERRAIN";k[k.POSTPROCESSING_HIGHLIGHT=8]="POSTPROCESSING_HIGHLIGHT";k[k.POSTPROCESSING_ATMOSPHERE=9]="POSTPROCESSING_ATMOSPHERE";k[k.OVERLAY=10]="OVERLAY";k[k.MAX_SLOTS=11]="MAX_SLOTS";return n})},"esri/views/3d/environment/PanoramicAtmosphere":function(){define("dojo/text!./materials/SimpleAtmosphereMaterial.xml dojo/Deferred ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/VertexBufferLayout ../webgl-engine/lib/Texture ../webgl-engine/lib/Util ../webgl-engine/lib/GLSLProgram ../webgl-engine/lib/GLTextureRep ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ./resources/SimpleAtmosphereTexture".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d){var m=k.vec2d,p=k.vec3d,t=k.mat4d,x=g.VertexAttrConstants,v=t.create();return n.createSubclass({declaredClass:"esri.views.3d.environment.PanoramicAtmosphere",classMetadata:{properties:{view:{},slot:{value:l.BACKGROUND,setter:function(a){this.needsRender=!0;return a}}}},constructor:function(){this._renderData={texV:m.create(),silCircleCenter:p.create(),silCircleV1:p.create(),silCircleV2:p.create()};this._textureRep=this._texture=null;this.slot=l.BACKGROUND},initialize:function(){this._textureDfd=
new q;this.addResolvingPromise(this._textureDfd.promise)},destroy:function(){this._textureRep&&(this._texture&&(this._textureRep.release("SimpleAtmosphere"),this._textureRep.getTexture("SimpleAtmosphere").unload()),this._textureRep=null);this._program&&(this._program.dispose(),this._program=null);this._textureDfd&&(this._textureDfd.cancel(),this._textureDfd=null)},initializeRenderContext:function(f){this._textureRep=new a({SimpleAtmosphere:new b(d,"SimpleAtmosphere",{wrapClamp:!0})},f.programRep,
function(){return this.view._stage.getCamera().viewport}.bind(this),f.gl);this._texture=this._textureRep.aquire("SimpleAtmosphere",void 0,void 0,function(){this._textureDfd.resolve();this._textureDfd=null}.bind(this))},setup:function(a){var b=this._createGeometryData();this._renderer=new h(b,c.Defaults.Pos,null,a.gl);a.shaderSnippets.vsSimpleAtmosphere||a.shaderSnippets._parse(s);this._program=f.fromSnippets("vsSimpleAtmosphere","fsSimpleAtmosphere",a.shaderSnippets,a.gl,["PANORAMIC"])},render:function(a){if(a.slot!==
this.slot||a.pass!==r.MATERIAL||!this._textureRep.getIsLoaded("SimpleAtmosphere"))return!1;var b=this.renderContext.gl,d=this._program;d.use();b.bindTexture(b.TEXTURE_2D,this._texture);d.uniform1i("tex",0);d.uniformMatrix4fv("proj",a.camera.projectionMatrix);t.toRotationMat(a.camera.viewMatrix,v);d.uniformMatrix4fv("view",v);d.uniform4f("color",1,1,1,1);d.uniform3fv("lightDirection",a.lightingData.direction);b.web3DDefaultState.cullEnabled||b.enable(b.CULL_FACE);b.web3DDefaultState.depthFunc!==b.LEQUAL&&
b.depthFunc(b.LEQUAL);b.enable(b.BLEND);b.depthMask(!1);this._renderer.render(this._program);f.unuse(b);b.depthMask(!0);b.disable(b.BLEND);b.web3DDefaultState.depthFunc!==b.LEQUAL&&b.depthFunc(b.web3DDefaultState.depthFunc);b.web3DDefaultState.cullEnabled||b.disable(b.CULL_FACE);return!0},_createGeometryData:function(){for(var a=e.createPolySphereGeometry(1,2),b=a.getFaces(),d=b[0].indices[x.POSITION],f=0;f<d.length;f+=3){var m=d[f];d[f]=d[f+2];d[f+2]=m}a=a.getVertexAttr();d=a[x.NORMAL].data;for(f=
0;f<d.length;f++)d[f]=-d[f];return{faces:b[0],vertexAttr:a}}})})},"esri/views/3d/webgl-engine/lib/Texture":function(){define("require exports ./IdGen ./Util ./GLUtil ./DDSUtil".split(" "),function(s,q,n,k,h,e){function c(b,g,f,a,c,l,d,m){d=!1!==d;var p=new Image;p.src=b;p.onerror=function(){l();p.onerror=void 0;p.onload=void 0};p.onload=function(){f.isTexture(g)&&h.texImage2D(p,g,f,a,c,d,!0,m);l();p.onerror=void 0;p.onload=void 0}}return function(){function b(g,f,a){this.data=g;this.id=b.idGen.gen(f);
this.unloadFunc=void 0;this.params=a||{};this.params.wrapClamp=this.params.wrapClamp||!1;this.params.mipmap=!1!==this.params.mipmap;this.params.noUnpackFlip=this.params.noUnpackFlip||!1;this.estimatedTexMemRequiredMB=b.estimateTexMemRequiredMB(this.data,this.params)}b.estimateTexMemRequiredMB=function(b,f){return null==b?0:b instanceof ArrayBuffer||b instanceof Uint8Array?b.byteLength/1E6:4*1.3*f.width*f.height/1E6};b.prototype.getId=function(){return this.id};b.prototype.getEstimatedTexMemRequiredMB=
function(){return this.estimatedTexMemRequiredMB};b.prototype.dispose=function(){this.data=void 0};b.prototype.deferredLoading=function(){return"string"===typeof this.data};b.prototype.getWidth=function(){return this.params.width};b.prototype.getHeight=function(){return this.params.height};b.prototype.loadDDS=function(b,f){var a=e.uploadDDSLevels(b,f,this.params.mipmap);null!==a&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,1<a.mipmapCount?
b.LINEAR_MIPMAP_LINEAR:b.LINEAR),this.params.width=a.width,this.params.height=a.height)};b.prototype.loadGl=function(g,f,a,e,l){var d=this.data;if("string"===typeof d)c(d,f,a,e,l,g,this.params.mipmap,this.params.noUnpackFlip);else if(d instanceof Image||d instanceof ImageData||d instanceof HTMLCanvasElement)this.params.width=d.width,this.params.height=d.height,h.texImage2D(this.data,f,a,e,l,this.params.mipmap,this.params.mipmap||!this.params.wrapClamp,this.params.noUnpackFlip);else if(d instanceof
ArrayBuffer&&this.params.encoding===b.DDS_ENCODING)this.loadDDS(a,d);else if(d instanceof Uint8Array&&this.params.encoding===b.DDS_ENCODING)this.loadDDS(a,d.buffer);else if(d instanceof Uint8Array)!0===this.params.noUnpackFlip&&a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),k.assert(0<this.params.width&&0<this.params.height),g=a.RGBA,1===this.params.components&&(g=a.LUMINANCE),a.texImage2D(a.TEXTURE_2D,0,g,this.params.width,this.params.height,0,g,a.UNSIGNED_BYTE,d),this.params.mipmap?(a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR),a.generateMipmap(a.TEXTURE_2D)):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),!0===this.params.noUnpackFlip&&a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0);else if(null!==d)throw console.warn("Unsupported image data"),Error("Unsupported image data");a._isTracingEnabled&&(f._debugTracingType="Texture");this.data=void 0};b.prototype.setUnloadFunc=function(b){this.unloadFunc=b};b.prototype.unload=function(){void 0!==this.unloadFunc&&(this.unloadFunc(this.id),
this.unloadFunc=void 0)};b.idGen=new n;b.DDS_ENCODING="image/vnd-ms.dds";return b}()})},"esri/views/3d/webgl-engine/lib/GLUtil":function(){define(["./GLVBO","./VertexBufferLayout","./Util","./gl-matrix","./webgl-debug"],function(s,q,n,k,h){var e=k.mat4d,c={texImage2D:function(b,g,f,a,e,l,d,m){n.assert(1<=b.width&&1<=b.height);!0===m&&f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!1);d&&(!n.isPowerOfTwo(b.width)||!n.isPowerOfTwo(b.height))?(c.makePotTexture(b,g,f,a,e),f.bindTexture(f.TEXTURE_2D,g)):(f.bindTexture(f.TEXTURE_2D,
g),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,b));l?(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR_MIPMAP_LINEAR),f.generateMipmap(f.TEXTURE_2D)):f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR);f.bindTexture(f.TEXTURE_2D,null);!0===m&&f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!0);return g},copyTextureToTexture:function(b,g,f,a,e,l,d,m,p){var h=p.createFramebuffer();p.bindFramebuffer(p.FRAMEBUFFER,h);p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,
b,0);c.checkFramebufferStatus(p.FRAMEBUFFER,p);p.bindTexture(p.TEXTURE_2D,g);p.copyTexSubImage2D(p.TEXTURE_2D,0,e,l,f,a,d,m);p.generateMipmap(p.TEXTURE_2D);p.bindFramebuffer(p.FRAMEBUFFER,null);p.deleteFramebuffer(h)},makePotTexture:function(b,c,f,a,r){var l=n.nextHighestPowerOfTwo(b.width),d=n.nextHighestPowerOfTwo(b.height);n.assert(l!==b.width||d!==b.height);var m=f.createFramebuffer();f.bindFramebuffer(f.FRAMEBUFFER,m);f.bindTexture(f.TEXTURE_2D,c);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,l,d,0,f.RGBA,
f.UNSIGNED_BYTE,null);f.generateMipmap(f.TEXTURE_2D);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,c,0);c=f.createTexture();f.bindTexture(f.TEXTURE_2D,c);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,b);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);b=q.Defaults.PosTex;var p=new s(n.createQuadVertexUvBuffer(),b,f);void 0===
r&&(r=f.getParameter(f.VIEWPORT));f.viewport(0,0,l,d);a=a.get("texOnly");a.use();l=e.identity();a.uniformMatrix4fv("model",l);a.uniformMatrix4fv("view",l);a.uniformMatrix4fv("proj",l);a.uniform4fv("color",[1,1,1,1]);a.uniform1i("tex",0);b.enableVertexAttribArrays(f,a);p.bind();p.setPointers(a);f.disable(f.DEPTH_TEST);f.drawArrays(f.TRIANGLE_STRIP,0,p.getNum());f.enable(f.DEPTH_TEST);b.disableVertexAttribArrays(f,a);f.viewport(r[0],r[1],r[2],r[3]);p.dispose();f.deleteTexture(c);f.bindFramebuffer(f.FRAMEBUFFER,
null);f.deleteFramebuffer(m)},createEmptyTexture:function(b){var c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,4,4,0,b.RGBA,b.UNSIGNED_BYTE,null);return c},checkError:function(b,c){var f=c.getError();f!=c.NO_ERROR&&alert(b+": gl error "+f)},checkFramebufferStatus:function(b,c){var f=c.checkFramebufferStatus(b);f!=c.FRAMEBUFFER_COMPLETE&&console.log("Framebuffer error 0x"+
f)},handleError:function(b,c,f){alert(h.glEnumToString(b)+" was caused by call to: "+c+"("+h.glFunctionArgsToString(c,f)+")")},validateNoneOfTheArgsAreUndefined:function(b,c){for(var f=0;f<c.length;++f)void 0===c[f]&&console.error("undefined passed to gl."+b+"("+h.glFunctionArgsToString(b,c)+")")}};return c})},"esri/views/3d/webgl-engine/lib/webgl-debug":function(){define([],function(){function s(a){if(null==g){g={};f={};for(var b in a)"number"==typeof a[b]&&(g[a[b]]=b,f[b]=a[b])}}function q(){if(null==
g)throw"WebGLDebugUtils.init(ctx) not called";}function n(a){q();var b=g[a];return void 0!==b?"gl."+b:"/*UNKNOWN WebGL ENUM*/ 0x"+a.toString(16)+""}function k(a,c,l,d){a=b[a];if(void 0!==a&&(a=a[c],void 0!==a&&a[l])){if("object"===typeof a[l]&&void 0!==a[l].enumBitwiseOr){c=a[l].enumBitwiseOr;l=0;a=[];for(var m=0;m<c.length;++m){var p=f[c[m]];0!==(d&p)&&(l|=p,a.push(n(p)))}return l===d?a.join(" | "):n(d)}return n(d)}return null===d?"null":void 0===d?"undefined":d.toString()}function h(a,b,f){a.__defineGetter__(f,
function(){return b[f]});a.__defineSetter__(f,function(a){b[f]=a})}function e(a,b,f,d){function m(a,m){return function(){f&&f(m,arguments);var g=a[m].apply(a,arguments),e=d.getError();0!=e&&(c[e]=!0,b(e,m,arguments));return g}}d=d||a;s(a);b=b||function(a,b,d){for(var f="",m=d.length,l=0;l<m;++l)f+=(0==l?"":", ")+k(b,m,l,d[l]);a="WebGL error "+n(a)+" in "+b+"("+f+")";window.console&&window.console.error?window.console.error(a):window.console&&window.console.log&&window.console.log(a)};var c={},g={},
x;for(x in a)if("function"==typeof a[x])if("getExtension"!=x)g[x]=m(a,x);else{var v=m(a,x);g[x]=function(){var m=v.apply(a,arguments);return e(m,b,f,d)}}else h(g,a,x);g.getError=function(){for(var b in c)if(c.hasOwnProperty(b)&&c[b])return c[b]=!1,b;return a.NO_ERROR};return g}function c(a){var b=a.getParameter(a.MAX_VERTEX_ATTRIBS),f=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,f);for(var d=0;d<b;++d)a.disableVertexAttribArray(d),a.vertexAttribPointer(d,4,a.FLOAT,!1,0,0),a.vertexAttrib1f(d,0);a.deleteBuffer(f);
b=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);for(d=0;d<b;++d)a.activeTexture(a.TEXTURE0+d),a.bindTexture(a.TEXTURE_CUBE_MAP,null),a.bindTexture(a.TEXTURE_2D,null);a.activeTexture(a.TEXTURE0);a.useProgram(null);a.bindBuffer(a.ARRAY_BUFFER,null);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindRenderbuffer(a.RENDERBUFFER,null);a.disable(a.BLEND);a.disable(a.CULL_FACE);a.disable(a.DEPTH_TEST);a.disable(a.DITHER);a.disable(a.SCISSOR_TEST);a.blendColor(0,0,0,0);a.blendEquation(a.FUNC_ADD);
a.blendFunc(a.ONE,a.ZERO);a.clearColor(0,0,0,0);a.clearDepth(1);a.clearStencil(-1);a.colorMask(!0,!0,!0,!0);a.cullFace(a.BACK);a.depthFunc(a.LESS);a.depthMask(!0);a.depthRange(0,1);a.frontFace(a.CCW);a.hint(a.GENERATE_MIPMAP_HINT,a.DONT_CARE);a.lineWidth(1);a.pixelStorei(a.PACK_ALIGNMENT,4);a.pixelStorei(a.UNPACK_ALIGNMENT,4);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);a.UNPACK_COLORSPACE_CONVERSION_WEBGL&&a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,
a.BROWSER_DEFAULT_WEBGL);a.polygonOffset(0,0);a.sampleCoverage(1,!1);a.scissor(0,0,a.canvas.width,a.canvas.height);a.stencilFunc(a.ALWAYS,0,4294967295);a.stencilMask(4294967295);a.stencilOp(a.KEEP,a.KEEP,a.KEEP);a.viewport(0,0,a.canvas.width,a.canvas.height);for(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT|a.STENCIL_BUFFER_BIT);a.getError(););}var b={enable:{1:{"0":!0}},disable:{1:{"0":!0}},getParameter:{1:{"0":!0}},drawArrays:{3:{"0":!0}},drawElements:{4:{"0":!0,2:!0}},createShader:{1:{"0":!0}},
getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{"0":!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{"0":!0}},activeTexture:{1:{"0":!0}},getTexParameter:{2:{"0":!0,1:!0}},texParameterf:{3:{"0":!0,1:!0}},texParameteri:{3:{"0":!0,1:!0,2:!0}},texImage2D:{9:{"0":!0,2:!0,6:!0,7:!0},6:{"0":!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{"0":!0,6:!0,7:!0},7:{"0":!0,4:!0,5:!0}},copyTexImage2D:{8:{"0":!0,2:!0}},copyTexSubImage2D:{8:{"0":!0}},
generateMipmap:{1:{"0":!0}},compressedTexImage2D:{7:{"0":!0,2:!0}},compressedTexSubImage2D:{8:{"0":!0,6:!0}},bindBuffer:{2:{"0":!0}},bufferData:{3:{"0":!0,2:!0}},bufferSubData:{3:{"0":!0}},getBufferParameter:{2:{"0":!0,1:!0}},pixelStorei:{2:{"0":!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{"0":!0}},bindFramebuffer:{2:{"0":!0}},checkFramebufferStatus:{1:{"0":!0}},framebufferRenderbuffer:{4:{"0":!0,1:!0,2:!0}},framebufferTexture2D:{5:{"0":!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{"0":!0,
1:!0,2:!0}},getRenderbufferParameter:{2:{"0":!0,1:!0}},renderbufferStorage:{4:{"0":!0,1:!0}},clear:{1:{"0":{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{"0":!0}},blendFunc:{2:{"0":!0,1:!0}},blendFuncSeparate:{4:{"0":!0,1:!0,2:!0,3:!0}},blendEquation:{1:{"0":!0}},blendEquationSeparate:{2:{"0":!0,1:!0}},stencilFunc:{3:{"0":!0}},stencilFuncSeparate:{4:{"0":!0,1:!0}},stencilMaskSeparate:{2:{"0":!0}},stencilOp:{3:{"0":!0,1:!0,2:!0}},stencilOpSeparate:{4:{"0":!0,
1:!0,2:!0,3:!0}},cullFace:{1:{"0":!0}},frontFace:{1:{"0":!0}},drawArraysInstancedANGLE:{4:{"0":!0}},drawElementsInstancedANGLE:{5:{"0":!0,2:!0}},blendEquationEXT:{1:{"0":!0}}},g=null,f=null;return{init:s,mightBeEnum:function(a){q();return void 0!==g[a]},glEnumToString:n,glFunctionArgToString:k,glFunctionArgsToString:function(a,b){for(var f="",d=b.length,m=0;m<d;++m)f+=(0==m?"":", ")+k(a,d,m,b[m]);return f},makeDebugContext:e,makeLostContextSimulatingCanvas:function(a){function b(a){return"function"==
typeof a?a:function(b){a.handleEvent(b)}}function f(){for(var a=Object.keys(H),b=0;b<a.length;++b)delete H[a]}function d(){++B;C||y==B&&a.loseContext()}function m(a,b){var f=a[b];return function(){d();if(!C)return f.apply(a,arguments)}}function p(a){return{statusMessage:a,preventDefault:function(){D=!0}}}function g(a){for(var b in a)"function"==typeof a[b]?k[b]=m(a,b):h(k,a,b);k.getError=function(){d();if(!C)for(var a;a=e.getError();)H[a]=!0;for(a in H)if(H[a])return delete H[a],a;return k.NO_ERROR};
var f="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");for(b=0;b<f.length;++b){var l=f[b];k[l]=function(b){return function(){d();if(C)return null;var f=b.apply(a,arguments);f.__webglDebugContextLostId__=w;A.push(f);return f}}(a[l])}f="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");
for(b=0;b<f.length;++b)l=f[b],k[l]=function(b){return function(){d();return C?null:b.apply(a,arguments)}}(k[l]);f="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(b=0;b<f.length;++b)l=f[b],k[l]=function(b){return function(){d();return C?!1:b.apply(a,arguments)}}(k[l]);k.checkFramebufferStatus=function(b){return function(){d();return C?k.FRAMEBUFFER_UNSUPPORTED:b.apply(a,arguments)}}(k.checkFramebufferStatus);k.getAttribLocation=function(b){return function(){d();
return C?-1:b.apply(a,arguments)}}(k.getAttribLocation);k.getVertexAttribOffset=function(b){return function(){d();return C?0:b.apply(a,arguments)}}(k.getVertexAttribOffset);k.isContextLost=function(){return C};return k}var e,k,u=[],n=[];k={};var w=1,C=!1,A=[],y=0,B=0,D=!1,F=0,H={};a.getContext=function(b){return function(){var d=b.apply(a,arguments);if(d instanceof WebGLRenderingContext){if(d!=e){if(e)throw"got different context";e=d;k=g(e)}return k}return d}}(a.getContext);(function(a){var d=a.addEventListener;
a.addEventListener=function(f,m,l){switch(f){case "webglcontextlost":u.push(b(m));break;case "webglcontextrestored":n.push(b(m));break;default:d.apply(a,arguments)}}})(a);a.loseContext=function(){if(!C){C=!0;y=0;for(++w;e.getError(););f();H[e.CONTEXT_LOST_WEBGL]=!0;var b=p("context lost"),d=u.slice();setTimeout(function(){for(var f=0;f<d.length;++f)d[f](b);0<=F&&setTimeout(function(){a.restoreContext()},F)},0)}};a.restoreContext=function(){C&&n.length&&setTimeout(function(){if(!D)throw"can not restore. webglcontestlost listener did not call event.preventDefault";
for(var a=0;a<A.length;++a){var b=A[a];b instanceof WebGLBuffer?e.deleteBuffer(b):b instanceof WebGLFramebuffer?e.deleteFramebuffer(b):b instanceof WebGLProgram?e.deleteProgram(b):b instanceof WebGLRenderbuffer?e.deleteRenderbuffer(b):b instanceof WebGLShader?e.deleteShader(b):b instanceof WebGLTexture&&e.deleteTexture(b)}c(e);C=!1;B=0;D=!1;for(var a=n.slice(),b=p("context restored"),d=0;d<a.length;++d)a[d](b)},0)};a.loseContextInNCalls=function(a){if(C)throw"You can not ask a lost contet to be lost";
y=B+a};a.getNumCalls=function(){return B};a.setRestoreTimeout=function(a){F=a};return a},resetToInitialState:c}})},"esri/views/3d/webgl-engine/lib/DDSUtil":function(){define(["require","exports"],function(s,q){function n(c){return c.charCodeAt(0)+(c.charCodeAt(1)<<8)+(c.charCodeAt(2)<<16)+(c.charCodeAt(3)<<24)}var k=n("DXT1"),h=n("DXT3"),e=n("DXT5");q.uploadDDSLevels=function(c,b,g){var f=new Int32Array(b,0,31);if(542327876!==f[0])return console.error("Invalid magic number in DDS header"),null;if(!(f[20]&
4))return console.error("Unsupported format, must contain a FourCC code"),null;var a=f[21],r;switch(a){case k:a=8;r=33776;break;case h:a=16;r=33778;break;case e:a=16;r=33779;break;default:return console.error("Unsupported FourCC code:",String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)),null}var l=1;f[2]&131072&&!1!==g&&(l=Math.max(1,f[7]));g=f[4];for(var d=f[3],m=f[1]+4,p,t,n=0;;++n){n<l&&(t=Math.floor((g+3)/4)*Math.floor((d+3)/4)*a,p=new Uint8Array(b,m,t));c.compressedTexImage2D(c.TEXTURE_2D,
n,r,g,d,0,p);m+=t;if(1===g&&1===d||1===l)break;g=Math.max(1,g>>1);d=Math.max(1,d>>1)}return{mipmapCount:l,width:f[4],height:f[3]}}})},"esri/views/3d/webgl-engine/lib/GLTextureRep":function(){define(["require","exports","./Util","./GLUtil"],function(s,q,n,k){var h=function(){function e(c){this.glName=c.createTexture();this.refCount=0}e.prototype.incRefCnt=function(){++this.refCount};e.prototype.decRefCnt=function(){--this.refCount;n.assert(0<=this.refCount)};e.prototype.getRefCnt=function(){return this.refCount};
e.prototype.getGLName=function(){return this.glName};return e}();return function(){function e(c,b,g,f){this.NUM_PARALLEL=8;this.textures=c;this.programRep=b;this.getViewportToRestore=g;this.gl=f;this.NUM_PARALLEL=8;this.id2textureRef={};this.loading={};this.queue=[];this.listeners=[];this.maxMaxAnisotropy=(this.afExt=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))?f.getParameter(this.afExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT):
1;this.maxAnisotropy=Math.min(8,this.maxMaxAnisotropy);this._needsRender=!0;this.initBuffer=new Uint8Array(256);this.initBufferTransparent=new Uint8Array(256);c=0;for(b=this.initBuffer.length;c<b;++c)this.initBuffer[c]=255,this.initBufferTransparent[c]=0!==(c+1)%4?255:0}e.prototype.unload=function(c){var b=this.id2textureRef[c];void 0!==b&&(this.gl.deleteTexture(b.getGLName()),delete this.id2textureRef[c])};e.prototype.resetNeedsRender=function(){this._needsRender=!1};e.prototype.needsRender=function(){return this._needsRender};
e.prototype.aquire=function(c,b,g,f){var a=this,e=this.id2textureRef[c];if(null==e){e=new h(this.gl);n.assert(null==this.id2textureRef[c]);this.id2textureRef[c]=e;var l=this.textures[c];n.assert(void 0!==l);l.setUnloadFunc(this.unload.bind(this));var d=e.getGLName();this.initializeTexture(d,l,b,g);l.renderGl?(l.renderGl(d,this.gl),f&&f(e)):l.deferredLoading()?this.getLoadingCount()<this.NUM_PARALLEL?this.loadImage(c,d,f):this.queue.push([c,d,f]):l.loadGl(function(){a._needsRender=!0;f&&f(e)},d,this.gl,
this.programRep,this.getViewportToRestore());this._needsRender=!0}e.incRefCnt();return e.getGLName()};e.prototype.release=function(c){c=this.id2textureRef[c];void 0!==c&&(c.decRefCnt(),n.assert(0<=c.getRefCnt()))};e.prototype.getLoadingCount=function(){return Object.keys(this.loading).length};e.prototype.getIsLoaded=function(c){if(null==this.id2textureRef[c]||void 0!==this.loading[c])return!1;for(var b=0,g=this.queue.length;b<g;++b)if(this.queue[b][0]===c)return!1;return!0};e.prototype.addTextureListener=
function(c){n.assert(-1===this.listeners.indexOf(c));this.listeners.push(c)};e.prototype.removeTextureListener=function(c){c=this.listeners.indexOf(c);n.assert(-1!==c);this.listeners.splice(c,1)};e.prototype.getTexture=function(c){return this.textures[c]};e.prototype.setMaxAnisotropy=function(c){if(this.afExt&&(c=n.clamp(c,1,this.maxMaxAnisotropy),c!==this.maxAnisotropy)){this.maxAnisotropy=c;for(var b in this.id2textureRef)c=this.id2textureRef[b].getGLName(),this.gl.bindTexture(this.gl.TEXTURE_2D,
c),this.gl.texParameterf(this.gl.TEXTURE_2D,this.afExt.TEXTURE_MAX_ANISOTROPY_EXT,this.maxAnisotropy)}};e.prototype.getMaxAnisotropy=function(){return this.maxAnisotropy};e.prototype.initializeTexture=function(c,b,g,f){var a=this.gl;a.bindTexture(a.TEXTURE_2D,c);b.params&&b.params.wrapClamp&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE));if(void 0!==g)if(Array.isArray(g.id)){c=g.num;n.assert(g.id.length===c*c);a.texImage2D(a.TEXTURE_2D,
0,a.RGBA,256*c,256*c,0,a.RGBA,a.UNSIGNED_BYTE,null);f=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,f);for(var e=0;e<c;e++)for(var l=0;l<c;l++)a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.id2textureRef[g.id[e*c+l]].getGLName(),0),k.checkFramebufferStatus(a.FRAMEBUFFER,a),a.copyTexSubImage2D(a.TEXTURE_2D,0,256*l,256*e,0,0,256,256);a.generateMipmap(a.TEXTURE_2D);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR);a.bindFramebuffer(a.FRAMEBUFFER,
null);a.deleteFramebuffer(f)}else a.texImage2D(a.TEXTURE_2D,0,a.RGBA,g.width,g.height,0,a.RGBA,a.UNSIGNED_BYTE,null),k.copyTextureToTexture(this.id2textureRef[g.id].getGLName(),c,g.x,g.y,0,0,g.width,g.height,a);else a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),void 0!==f&&f?a.texImage2D(a.TEXTURE_2D,0,a.RGBA,8,8,0,a.RGBA,a.UNSIGNED_BYTE,this.initBufferTransparent):a.texImage2D(a.TEXTURE_2D,0,a.RGBA,8,8,0,a.RGBA,a.UNSIGNED_BYTE,this.initBuffer);this.afExt&&(b.params&&b.params.mipmap)&&
a.texParameterf(a.TEXTURE_2D,this.afExt.TEXTURE_MAX_ANISOTROPY_EXT,this.maxAnisotropy)};e.prototype.next=function(c){if(c in this.loading){delete this.loading[c];var b=Object.keys(this.id2textureRef),g=Object.keys(this.loading);this.listeners.forEach(function(f){f(c,b,g)});this.processQueue()}};e.prototype.loadImage=function(c,b,g){var f=this;n.assert(null==this.loading[c]);this.loading[c]=!0;var a=this.textures[c];n.assert(void 0!==a);setTimeout(function(){var e=f.id2textureRef[c];e&&e.getRefCnt()&&
a.loadGl(function(){f.next(c);f._needsRender=!0;var a=f.id2textureRef[c];a&&a.getRefCnt()&&g&&g(a)},b,f.gl,f.programRep,f.getViewportToRestore())},0)};e.prototype.processQueue=function(){for(var c=[],b=0,g=this.queue.length;b<g;++b){var f=this.queue[b][0],a=this.id2textureRef[f];void 0!==a&&(0===a.getRefCnt()?(this.gl.deleteTexture(a.getGLName()),delete this.id2textureRef[f]):c.push(this.queue[b]))}this.queue=c;c=Math.min(this.NUM_PARALLEL-Object.keys(this.loading).length,this.queue.length);for(b=
0;b<c;++b)this.loadImage(this.queue[b][0],this.queue[b][1],this.queue[b][2]);this.queue.splice(0,c)};return e}()})},"esri/views/3d/environment/resources/SimpleAtmosphereTexture":function(){define([],function(){return"data:image/png;base64,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"})},
"esri/views/3d/environment/SimpleAtmosphere":function(){define("dojo/text!./materials/SimpleAtmosphereMaterial.xml dojo/Deferred ../../../core/watchUtils ../support/ExternalRenderer ../lib/glMatrix ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/VertexBufferLayout ../webgl-engine/lib/Texture ../webgl-engine/lib/Util ../webgl-engine/lib/GLSLProgram ../webgl-engine/lib/GLTextureRep ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ./resources/SimpleAtmosphereTexture ../support/earthUtils".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m){var p=m.earthRadius,t=h.vec3d,x=h.vec2d,v=h.mat4d,u=g.VertexAttrConstants,z=(p-1E4)/p,w=(p+3E5)/p,C=-1E4/3E5,A=1-C;return k.createSubclass({declaredClass:"esri.views.3d.environment.SimpleAtmosphere",classMetadata:{properties:{view:{},slot:{value:l.BACKGROUND,setter:function(a){this.needsRender=!0;return a}}}},constructor:function(){this._renderData={texV:x.create(),silCircleCenter:t.create(),silCircleV1:t.create(),silCircleV2:t.create()};this._textureRep=this._texture=
null},initialize:function(){this._textureDfd=new q;this.addResolvingPromise(this._textureDfd.promise)},destroy:function(){this._currentViewChangedHandle&&(this._currentViewChangedHandle.remove(),this._currentViewChangedHandle=null);this._textureRep&&(this._texture&&(this._textureRep.release("SimpleAtmosphere"),this._textureRep.getTexture("SimpleAtmosphere").unload()),this._textureRep=null);this._program&&(this._program.dispose(),this._program=null);this._textureDfd&&(this._textureDfd.cancel(),this._textureDfd=
null)},initializeRenderContext:function(f){this._textureRep=new a({SimpleAtmosphere:new b(d,"SimpleAtmosphere",{wrapClamp:!0})},f.programRep,function(){return this.view._stage.getCamera().viewport}.bind(this),f.gl);this._texture=this._textureRep.aquire("SimpleAtmosphere",void 0,void 0,function(){this._textureDfd.resolve();this._textureDfd=null}.bind(this))},setup:function(a){var b=this._createRibbonGeometryData();this._renderer=new e(b,c.Defaults.Pos,null,a.gl);this._currentViewChangedHandle=n.on(this,
"view.navigation","currentViewChanged",function(a){this._update(a.camera)}.bind(this),function(){this._update(this.get("view.navigation.currentCamera"))}.bind(this));a.shaderSnippets.vsSimpleAtmosphere||a.shaderSnippets._parse(s);this._program=f.fromSnippets("vsSimpleAtmosphere","fsSimpleAtmosphere",a.shaderSnippets,a.gl)},render:function(a){if(a.slot!==this.slot||a.pass!==r.MATERIAL)return!1;var b=this.renderContext.gl,d=this._program;d.use();d.uniform4f("color",1,1,1,1);d.uniformMatrix4fv("proj",
a.camera.projectionMatrix);d.uniformMatrix4fv("view",a.camera.viewMatrix);d.uniform3fv("silCircleCenter",this._renderData.silCircleCenter);d.uniform3fv("silCircleV1",this._renderData.silCircleV1);d.uniform3fv("silCircleV2",this._renderData.silCircleV2);d.uniform2fv("texV",this._renderData.texV);b.bindTexture(b.TEXTURE_2D,this._texture);d.uniform1i("tex",0);d.uniform3fv("lightDirection",a.lightingData.direction);b.web3DDefaultState.depthFunc!==b.LEQUAL&&b.depthFunc(b.LEQUAL);b.depthMask(!1);b.enable(b.BLEND);
this._renderer.render(this._program);f.unuse(b);b.depthMask(!0);b.disable(b.BLEND);b.web3DDefaultState.depthFunc!==b.LEQUAL&&b.depthFunc(b.web3DDefaultState.depthFunc);return!0},_update:function(a){if(!(t.length(a.eye)<=p)){var b=t.create(),d=t.create(),f=t.create(),m=this.view.renderCoordsHelper.getAltitude(a.eye);t.scale(a.eye,(p+50)/t.length(a.eye),f);this._computeSilhouetteCircle(f,a.center,a.up,p);t.add(this._renderData.silCircleCenter,this._renderData.silCircleV2,b);t.scale(b,w,d);var f=this._computeScreenRimWidth(f,
a.up,b,d),l=0,c=1,e=1;50>m?(l=0.001953125,c=0.1015625):500>m?(e=(m-50)/450,l=0.001953125*(1-e)+0.001953125*e,c=0.1015625*(1-e)+0.21875*e):5E3>m?(e=(m-500)/4500,l=0.001953125*(1-e)+0.001953125*e,c=0.21875*(1-e)+0.51171875*e):5E4>m&&(e=(m-5E3)/45E3,l=0.001953125*(1-e)+0.001953125*e,c=0.51171875*(1-e)+0.4140625*e);m=C+l*A;e=C+f*c*A;50<t.length(a.eye)-p&&(this._computeSilhouetteCircle(a.eye,a.center,a.up,p),t.add(this._renderData.silCircleCenter,this._renderData.silCircleV2,b),t.scale(b,w,d),a=this._computeScreenRimWidth(a.eye,
a.up,b,d),a=g.clamp((a-1.5)/(f-1.5),0,1),m=C+a*l*A,e=C+g.lerp(1,f*c,a)*A);x.set2(m,e,this._renderData.texV);this.needsRender=!0}},_computeSilhouetteCircle:function(a,b,d,f){var m=t.length(a),l=Math.sqrt(m*m-f*f),l=f*l/m;f=Math.sqrt(f*f-l*l);var c=this._renderData.silCircleV1,p=this._renderData.silCircleV2;t.scale(a,f/m,this._renderData.silCircleCenter);t.cross(a,b,c);1>t.length2(c)&&t.cross(a,d,c);t.scale(c,l/t.length(c));t.cross(c,a,p);t.scale(p,l/t.length(p));return l},_computeScreenRimWidth:function(a,
b,d,f){var m=v.create();v.lookAt(a,d,b,m);a=this.view.navigation.currentCamera;g.project(d,m,a.projectionMatrix,a.viewport);g.project(f,m,a.projectionMatrix,a.viewport);return t.dist(d,f)/a.height},_createRibbonGeometryData:function(){for(var a=new Float32Array(768),b=new Uint32Array(768),d=0;128>d;d++){var f=6*d;a[f+0]=d;a[f+1]=z;a[f+2]=0;a[f+3]=d;a[f+4]=w;a[f+5]=1;var m=2*d,l=127===d?0:m+2;b[f+0]=m;b[f+1]=m+1;b[f+2]=l+1;b[f+3]=l+1;b[f+4]=l;b[f+5]=m}d={};d[u.POSITION]=b;b={};b[u.POSITION]={size:3,
data:a};return{faces:{type:"triangle",indices:d,positionKey:u.POSITION},vertexAttr:b}}})})},"esri/views/3d/environment/Stars":function(){define("dojo/text!./materials/StarMaterial.xml require ../../../request ../../../core/watchUtils ../../../core/promiseUtils ../lib/glMatrix ../support/ExternalRenderer ../webgl-engine/lib/GeometryRenderer ../webgl-engine/lib/Util ../webgl-engine/lib/VertexBufferLayout ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/lib/GLSLProgram ../webgl-engine/lib/webglConstants ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m){var p=e.mat4d;e=e.mat3d;var t=g.VertexAttrConstants,x="9bb2ff;9eb5ff;aabfff;bbccff;ccd8ff ;dae2ff;e4e9ff;eeefff;f8f6ff;fff9fb;fff5ef;fff1e5;ffeddb;ffe9d2;ffe6ca;ffe3c3;ffe0bb;ffddb4;ffdaad;ffd6a5;ffd29c;ffcc8f;ffc178;ffa94b;ff7b00".split(";"),v=e.toMat4(e.createFrom(1,0,0,0,0.9174771405229186,0.39778850739794974,0,-0.39778850739794974,0.9174771405229186)),u=e.toMat4(e.createFrom(1,0,0,0,0.9174771405229186,-0.39778850739794974,0,0.39778850739794974,0.9174771405229186)),
z=null;return c.createSubclass({classMetadata:{properties:{view:{},numBinaryFloats:{value:2},numBinaryUInt8:{value:1},bytesPerStar:{value:9},slot:{value:m.BACKGROUND,setter:function(a){this.needsRender=!0;return a}}}},constructor:function(){this._renderData={model:p.identity()};this.slot=m.BACKGROUND;this._vertexBufferLayout=new f([t.POSITION,t.COLOR,t.SIZE],[3,4,1],[l.FLOAT,l.UNSIGNED_BYTE,l.FLOAT])},initialize:function(){this._loadDataPromise=this._loadBrightStarCatalogue();this.addResolvingPromise(this._loadDataPromise)},
destroy:function(){this._loadDataPromise.isFulfilled()||this._loadDataPromise.cancel("Atmosphere has been removed.");this._dateHandle&&(this._dateHandle.remove(),this._dateHandle=null);this._program&&this._program.dispose()},setup:function(a){this._numStars=this._starData.byteLength/this.bytesPerStar;var d=new Float32Array(this._starData,0,this._numStars*this.numBinaryFloats),f=new Uint8Array(this._starData,4*this._numStars*this.numBinaryFloats,this._numStars*this.numBinaryUInt8),d=this._createStarGeometryData(d,
f);this._renderer=new b(d,this._vertexBufferLayout,this._fillInterleaved,a.gl);this._renderer.enablePointRendering(!0);this._dateHandle=k.init(this,"view.environment.lighting.date",this._update.bind(this));a.shaderSnippets.vertexShaderStar||a.shaderSnippets._parse(s);this._program=r.fromSnippets("vertexShaderStar","fragmentShaderStar",a.shaderSnippets,a.gl)},render:function(a){if(a.slot!==this.slot||a.pass!==d.MATERIAL)return!1;var b=this.renderContext.gl,f=this._program;f.use();f.uniformMatrix4fv("view",
a.camera.viewMatrix);f.uniformMatrix4fv("proj",a.camera.projectionMatrix);f.uniform4fv("viewport",a.camera.fullViewport);f.uniformMatrix4fv("model",this._renderData.model);b.web3DDefaultState.depthFunc!==b.LEQUAL&&b.depthFunc(b.LEQUAL);b.enable(b.BLEND);b.depthMask(!1);this._renderer.render(this._program);r.unuse(b);b.depthMask(!0);b.disable(b.BLEND);b.web3DDefaultState.depthFunc!==b.LEQUAL&&b.depthFunc(b.web3DDefaultState.depthFunc);return!0},_fillInterleaved:function(b,d,f,m,l,c,p){f=l.getStride();
var g=4*f,e=a.fill;l=l.getAttributes();var h=b.faces.indices[t.POSITION],r=b.vertexAttr[t.POSITION].data;m=p+l[t.POSITION].offset;for(var k=0;k<h.length;++k){var u=3*h[k];e(r,u,c,m,d,3);m+=f}d=b.faces.indices[t.COLOR];h=b.vertexAttr[t.COLOR].data;m=4*(p+l[t.COLOR].offset);r=new Uint8Array(c.buffer);for(k=0;k<d.length;++k)u=4*d[k],e(h,u,r,m,null,4),m+=g;g=b.faces.indices[t.SIZE];b=b.vertexAttr[t.SIZE].data;m=p+l[t.SIZE].offset;for(k=0;k<g.length;++k)c[m]=b[g[k]],m+=f},_computeDayDuration:function(a){var b=
new Date(a.getFullYear(),0,1,11,58,56),d=new Date(a.getFullYear()+1,0,1,11,58,55);return(a-b)/(d-b)},_update:function(a){if(a){var b=a.getHours()/12,d=a.getMinutes()/60*(2/24),f=a.getSeconds()/60*(2/1440),b=(b+d+f-0.9972222)%2;a=2*this._computeDayDuration(a);d=p.create(u);p.rotateZ(d,-a*Math.PI);p.multiply(v,d,d);p.rotateZ(d,-b*Math.PI);this._renderData.model=d;this.needsRender=!0}},_hexToRGB:function(a){return[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),
16)]},_unpackUint8Attributes:function(a){return 192<=a?[2.9,a-192]:160<=a?[2.5,a-160]:128<=a?[2,a-128]:96<=a?[1.5,a-96]:64<=a?[1,a-64]:32<=a?[0.7,a-32]:[0.4,a]},_createStarGeometryData:function(a,b){for(var d=new Float32Array(3*this._numStars),f=new Uint8Array(4*this._numStars),m=new Float32Array(this._numStars),l=new Uint32Array(this._numStars),c=0;c<this._numStars;c++){var p=2*c,g=3*c,e=4*c,h=a[p+0],p=a[p+1];d[g+0]=-Math.cos(h)*Math.sin(p);d[g+1]=-Math.sin(h)*Math.sin(p);d[g+2]=-Math.cos(p);g=this._unpackUint8Attributes(b[c]);
h=this._hexToRGB(x[g[1]]);f[e+0]=255*h[0];f[e+1]=255*h[1];f[e+2]=255*h[2];f[e+3]=255;m[c]=g[0];l[c]=c}c={};c[t.POSITION]=l;c[t.NORMAL]=l;c[t.UV0]=l;c[t.COLOR]=l;c[t.SIZE]=l;l={};l[t.POSITION]={size:3,data:d};l[t.COLOR]={size:4,data:f};l[t.SIZE]={size:1,data:m};return{faces:{type:"point",indices:c,positionKey:t.POSITION},vertexAttr:l}},_loadBrightStarCatalogue:function(){return z?(this._starData=z,h.resolve()):n(q.toUrl("./resources/stars.wsv"),{responseType:"array-buffer",failOk:!0}).then(function(a){if(a=
a.data)this._starData=z=a;else throw Error("no data received");}.bind(this)).otherwise(function(a){console.error("Failed to load star data:",a);throw a;})}})})},"esri/views/3d/webgl-engine/lib/webglConstants":function(){define([],function(){return{ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALPHA:6406,ALPHA_BITS:3413,ALWAYS:519,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,
ATTACHED_SHADERS:35717,BACK:1029,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BROWSER_DEFAULT_WEBGL:37444,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_BUFFER_BIT:16384,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,COMPILE_STATUS:35713,
COMPRESSED_TEXTURE_FORMATS:34467,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_LOST_WEBGL:37442,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH_ATTACHMENT:36096,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DONT_CARE:4352,
DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,FASTEST:4353,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,
FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GREATER:516,GREEN_BITS:3411,HIGH_FLOAT:36338,HIGH_INT:36341,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,
INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE_ALPHA:6410,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_RENDERBUFFER_SIZE:34024,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,
MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIRRORED_REPEAT:33648,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NUM_COMPRESSED_TEXTURE_FORMATS:34466,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,
POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,RED_BITS:3410,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,REPEAT:10497,REPLACE:7681,RGB:6407,RGB5_A1:32855,RGB565:36194,RGBA:6408,
RGBA4:32854,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SHADER_COMPILER:36346,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,
STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_CLEAR_VALUE:2961,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,
TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34E3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,TEXTURE_2D:3553,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_CUBE_MAP:34068,
TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,UNPACK_ALIGNMENT:3317,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNSIGNED_BYTE:5121,
UNSIGNED_INT:5125,UNSIGNED_INT_24_8_WEBGL:34042,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VIEWPORT:2978,ZERO:0}})},"esri/views/3d/constraints/SceneViewConstraints":function(){define("../../../core/declare ../../../core/Accessoire ./SceneViewAltitudeConstraint ./SceneViewClipDistanceConstraint ./SceneViewTiltConstraint ./SceneViewCollisionConstraint".split(" "),
function(s,q,n,k,h,e){return s([q],{declaredClass:"esri.views.3d.constraints.SceneViewConstraints",classMetadata:{properties:{tilt:{type:h},altitude:{type:n},clipDistance:{type:k},collision:{type:e}}},getDefaults:function(c){var b={};c.tilt||(b.tilt={});c.altitude||(b.altitude={});c.clipDistance||(b.clipDistance={});c.collision||(b.collision={});return b},scale:function(c){this.tilt.scale(c);this.altitude.scale(c);this.clipDistance.scale(c)}})})},"esri/views/3d/constraints/SceneViewAltitudeConstraint":function(){define(["../../../core/declare",
"../../../core/Accessoire","../support/earthUtils"],function(s,q,n){var k=4*n.earthRadius;s=s([q],{declaredClass:"esri.views.3d.constraints.SceneViewAltitudeConstraint",classMetadata:{properties:{mode:{},min:{},max:{}}},constructor:function(){this._min=-Infinity;this._max=k},mode:"auto",autoUpdate:function(h,e){"auto"===this.mode&&(this._min!==h&&(this._min=h,this.notifyChange("min")),this._max!==e&&(this._max=e,this.notifyChange("max")))},_minSetter:function(h){this.mode="manual";this._min=h;this.max<
h&&(this.max=h)},_minGetter:function(){return this._min},_maxSetter:function(h){this.mode="manual";this._max=h;this.min>h&&(this.min=h)},_maxGetter:function(){return this._max},scale:function(h){this._max*=h;this.notifyChange("max");this._min*=h;this.notifyChange("min")}});s.MIN_DEFAULT=-Infinity;s.MAX_DEFAULT=k;return s})},"esri/views/3d/constraints/SceneViewClipDistanceConstraint":function(){define(["../../../core/declare","../../../core/Accessoire"],function(s,q){return s([q],{declaredClass:"esri.views.3d.constraints.SceneViewClipDistanceConstraint",
classMetadata:{properties:{near:{},far:{},mode:{}}},constructor:function(){this._far=this._near=0},near:0,far:0,mode:"auto",autoUpdate:function(n,k){"auto"===this.mode&&(this._near!==n&&(this._near=n,this.notifyChange("near")),this._far!==k&&(this._far=k,this.notifyChange("far")))},_nearGetter:function(){return this._near},_nearSetter:function(n){this.mode="manual";this._near=Math.max(1E-8,n);this._near>=this._far&&(this.far=this._near+1E-9)},_farGetter:function(){return this._far},_farSetter:function(n){this.mode=
"manual";this._far=Math.max(1E-8,n);this._far<=this._near&&(this.near=this._far-1E-9)},scale:function(n){this._near*=n;this.notifyChange("near");this._far*=n;this.notifyChange("far")}})})},"esri/views/3d/constraints/SceneViewTiltConstraint":function(){define(["../../../core/declare","../../../core/Accessoire","../support/mathUtils"],function(s,q,n){s=s([q],{declaredClass:"esri.views.3d.constraints.SceneViewTiltConstraint",classMetadata:{properties:{mode:{},max:{}}},constructor:function(){this._max=
0.5},max:0.5,mode:"auto",autoUpdate:function(k){"auto"===this.mode&&this._max!==k&&(this._max=k,this.notifyChange("max"))},_maxSetter:function(k){this.mode="manual";this._max=n.clamp(k,0.5,179.5)},_maxGetter:function(){return this._max},scale:function(k){}});s.MAX_DEFAULT=0.5;s.MIN_DEFAULT=179.5;return s})},"esri/views/3d/constraints/SceneViewCollisionConstraint":function(){define(["../../../core/declare","../../../core/Accessoire"],function(s,q){return s([q],{declaredClass:"esri.views.3d.constraints.SceneViewCollisionConstraint",
classMetadata:{properties:{enabled:{}}},enabled:!0})})},"esri/views/3d/support/cameraUtils":function(){define("dojo/_base/lang ../../../geometry/SpatialReference ../../../config ../../../geometry/Point ../../../geometry/support/webMercatorUtils ../../../Camera ../lib/glMatrix ./mathUtils ./earthUtils ./projectionUtils ./cameraUtilsPlanar ./cameraUtilsSpherical".split(" "),function(s,q,n,k,h,e,c,b,g,f,a,r){function l(b,d){return"global"===b.viewingMode?r[d]:a[d]}function d(a,d,m){var l=a.renderSpatialReference,
c=d.computeDirection(y),c=x(a,d.eye,c,d.up,B);a=a.spatialReference||q.WGS84;f.vectorToVector(d.eye,l,C,a)||(a=q.WGS84,f.vectorToVector(d.eye,l,C,a));return m?(m.position.x=C[0],m.position.y=C[1],m.position.z=C[2],m.position.spatialReference=a,m.heading=c.heading,m.tilt=c.tilt,m.fov=b.rad2deg(d.fov),m):new e(new k(C,a),c.heading,c.tilt,b.rad2deg(d.fov))}function m(a,d,f){var m=a.navigation.currentCamera,l=m.fovX,m=m.width/2;"global"===a.viewingMode&&null!=f&&(d*=Math.cos(b.deg2rad(f)));d/=a.renderCoordsHelper.unitInMeters;
return m/(n.screenDPI*z/d)/Math.tan(l/2)}function p(a,d,f){var m=a.navigation.currentCamera;d*=Math.tan(m.fovX/2);m=n.screenDPI*z/(m.width/2/d);"global"===a.viewingMode&&(m/=Math.cos(b.deg2rad(f)));return m*=a.renderCoordsHelper.unitInMeters}function t(a,b,d,m,l,c){var p=a.renderSpatialReference;b=v(a,m.heading,m.tilt,b,d,l);a=f.vectorToPoint(b.eye,p,a.spatialReference||q.WGS84);if(!a)return null;if(!c)return new e(a,b.heading,b.tilt,m.fov);c.position=a;c.heading=b.heading;c.tilt=b.tilt;c.fov=m.fov;
return c}function x(a,b,d,f,m){return l(a,"directionToHeadingTilt")(b,d,f,m)}function v(a,b,d,m,c,p){var g=u.create(),e=a.renderSpatialReference;if(m&&m instanceof k){var h=m;f.pointToVector(h,g,a.renderSpatialReference);null==h.z&&("global"===a.viewingMode?a._pickRay([0,0,0],g):a._pickRay([g[0],g[1]-1,g[2]],g),null!=a.basemapTerrain&&(h=a.basemapTerrain.getElevation(h),null!=h&&a.renderCoordsHelper.setAltitude(h,g)))}else m?u.set(m,g):u.set(a.navigation.currentCamera.center,g);if(!m||!(m instanceof
k))m=f.vectorToPoint(g,e,a.spatialReference||q.WGS84);c=Math.max(c,a.navigation.minPoiDist);e=d;d=c;if(h=!p||!p.noReset)var r=m,h=a.engineToScreen(a.navigation.currentCamera.center),B=a.toScreen(r),r=h.x-B.x,h=h.y-B.y,h=Math.sqrt(r*r+h*h),r=Math.max(a.width,a.height),h=h>w*r;h?(b=0,e=a.navigation.constraints.tilt.min(d)):(e=l(a,"eyeTiltToLookAtTilt")(g,d,e),e=a.navigation.constraints.tilt.apply(e,d),e=l(a,"lookAtTiltToEyeTilt")(g,d,e));b=l(a,"eyeForCenterWithHeadingTilt")(g,c,b,e);b.center=g;if((!p||
!p.noReset)&&"global"===a.viewingMode)if(g=a.renderCoordsHelper.fromRenderCoords(b.eye,D,a.spatialReference)?a.basemapTerrain&&(a.basemapTerrain.getElevation(D)||0)>D.z-1:!1,g)return g=a.navigation.constraints.tilt.min(c),v(a,0,g,m,c,s.mixin({noReset:!0},p));return b}var u=c.vec3d,z=39.37,w=5,C=u.create(),A=u.create(),y=u.create(),B={heading:0,tilt:0},D=new k,F=new b.Cyclical(-2.0037508342788905E7,2.0037508342788905E7);return{externalToInternal:function(a,d){var m=a.renderSpatialReference,c=l(a,"headingTiltToDirectionUp"),
g=u.create();return f.pointToVector(d.position,g,m)?(m=c(g,d.heading,d.tilt),u.add(m.direction,g),g=a.navigation.getCameraIntersectTerrain(g,m.direction,m.up),g.fov=b.deg2rad(d.fov),g):null},internalToExternal:d,scaleToDistance:m,distanceToScale:p,fromExtent:function(a,b,d,m,l){m instanceof e&&(l=m,m={});var c="global"===a.viewingMode,p=a.renderSpatialReference,r=a.spatialReference||q.WGS84,B=q.WebMercator,t=b.spatialReference||B,u,A=0;null!=b.zmax&&null!=b.zmin&&(u=(b.zmax+b.zmin)/2,A=b.zmax-b.zmin);
if(c){var c=new k(b.xmin,b.ymin,t),D=new k(b.xmax,b.ymax,t),c=h.project(c,B),D=h.project(D,B);if(null===c||null===D)return;b=new k(F.center(c.x,D.x),(D.y+c.y)/2,B);null!=u&&(b.z=u);t=g.getGreatCircleSpanAt(b,c,D);B=t.lon;t=t.lat;F.diff(c.x,D.x)>F.range/2&&(B+=g.halfEarthCircumference);B=Math.min(B,g.halfEarthCircumference);t=Math.min(t,g.halfEarthCircumference)}else h.canProject(b,r)&&(b=h.project(b,r)),B=b.xmax-b.xmin,t=b.ymax-b.ymin,b=new k({x:b.xmin+0.5*B,y:b.ymin+0.5*t,z:u,spatialReference:r});
D=a.navigation.currentCamera;u=1/Math.tan(D.fovX/2);c=1/Math.tan(D.fovY/2);D=1/Math.tan(D.fov/2);A=Math.max(0.5*B*u,0.5*t*c,0.5*A*D)/1;d=v(a,d.heading,d.tilt,b,A,m);p=f.vectorToPoint(d.eye,p,r);if(!p)return null;l||(l=new e);l.position=p;l.heading=d.heading;l.tilt=d.tilt;l.fov=a.camera.fov;return l},toExtent:function(b,m,l,c,p){var e=b.renderSpatialReference;m||(l||(l=b.navigation.currentCamera),m=d(b,l,p));if(l)p=f.vectorToPoint(l.center,e,b.spatialReference||q.WGS84),m=l.distance;else{p=b.toMap(b.screenCenter);
if(!p)return null;m=g.computeCarthesianDistance(m.position,p)}l||(l=b.navigation.currentCamera);e=Math.tan(l.fovX/2);l=Math.tan(l.fovY/2);e=1*2*m*e;l=1*2*m*l;return"global"===b.viewingMode?r.toExtent(b,p,e,l,c):a.toExtent(b,p,e,l,c)},fromCenterScale:function(a,b,d,f,l,c){d=m(a,d,b.latitude);return t(a,b,d,f,l,c)},fromCenterDistance:t,directionToHeadingTilt:x,eyeHeadingTiltForCenterPointAtDistance:v,scaleToZoom:function(a,b){var d=a.get("basemapTerrain.tilingScheme");return d?d.levelAtScale(b):void 0},
zoomToScale:function(a,b){var d=a.get("basemapTerrain.tilingScheme");return d?d.scaleAtLevel(b):void 0},computeScale:function(a,b,d){var m=a.renderSpatialReference;b||(b=a.navigation.currentCamera);var l;l=q.WGS84;b.center?(f.vectorToVector(b.center,m,A,l),l=A[1],b=b.distance):(l=b.position.latitude,f.pointToVector(b.position,C,m),f.pointToVector(d,A,m),b=u.dist(C,A));return p(a,b,l)}}})},"esri/views/3d/support/projectionUtils":function(){define("../../../geometry/SpatialReference ../../../geometry/Point ./mathUtils ./earthUtils ../lib/glMatrix ../webgl-engine/lib/BufferVectorMath".split(" "),
function(s,q,n,k,h,e){var c=h.vec3d,b=h.mat4d,g=e.Vec3Compact,f=c.create(),a=c.create(),r=c.create(),l=n.deg2rad(1),d=n.rad2deg(1),m=new s({wkt:'      GEOCCS["Spherical geocentric",        DATUM["Not specified",          SPHEROID["Sphere",'+k.earthRadius+',0]],        PRIMEM["Greenwich",0.0,          AUTHORITY["EPSG","8901"]],        UNIT["m",1.0],        AXIS["Geocentric X",OTHER],        AXIS["Geocentric Y",EAST],        AXIS["Geocentric Z",NORTH]      ]    '}),p=k.earthRadius,t=function(a){return a===
m?1:a.isWGS84?2:a.isWebMercator?3:0};s=function(a,b,d,f){d[f++]=a[b++];d[f++]=a[b++];d[f]=a[b]};var x=function(a,b,d,f){var m=0.4999999*Math.PI,c=l*a[b+1],c=n.clamp(c,-m,m),m=Math.sin(c);d[f++]=l*a[b]*p;d[f++]=p/2*Math.log((1+m)/(1-m));d[f]=a[b+2]},v=function(a,b,d,f){var m=p+a[b+2],c=l*a[b+1];a=l*a[b];b=Math.cos(c);d[f++]=Math.cos(a)*b*m;d[f++]=Math.sin(a)*b*m;d[f]=Math.sin(c)*m},u=[void 0,v,s,x],z=[void 0,function(a,b,f,m){var l=g.length(a,b),c=n.asin(a[b+2]/l),e=Math.cos(c);a=(0<a[b+1]?1:-1)*n.acos(a[b]/
(e*l));f[m++]=d*a;f[m++]=d*c;f[m]=l-p},s,function(a,b,f,m){f[m++]=d*(a[b++]/p);f[m++]=d*(Math.PI/2-2*Math.atan(Math.exp(-1*a[b++]/p)));f[m]=a[b]}];return{SphericalRenderSpatialReference:m,vectorToVector:function(a,b,d,m){2===a.length?(f[0]=a[0],f[1]=a[1],f[2]=0,a=f):a===d&&(c.set(a,f),a=f);return this.bufferToBuffer(a,b,0,d,m,0,1)},pointToVector:function(a,b,d){f[0]=a.x;f[1]=a.y;f[2]=a.z||0;return this.bufferToBuffer(f,a.spatialReference,0,b,d,0,1)},vectorToPoint:function(a,b,d,m){"esri.SpatialReference"===
d.declaredClass?(m=d,d=new q({spatialReference:m})):m=m||d.spatialReference;return this.bufferToBuffer(a,b,0,f,m,0,1)?(d.x=f[0],d.y=f[1],d.z=f[2],d.spatialReference=m,d):null},xyzToVector:function(a,b,d,m,l,c){f[0]=a;f[1]=b;f[2]=d;return this.bufferToBuffer(f,m,0,l,c,0,1)},bufferToBuffer:function(b,d,f,m,l,c,g){g=g||1;var p=t(d),e=t(l);g=f+3*g;if(p===e&&(0!==p||d.equals(l))){if(m!==b||f!==c)for(;f<g;f++,c++)m[c]=b[f]}else if(0<p&&0<e)if(2!==e)if(l=u[e],2!==p)for(p=z[p];f<g;f+=3,c+=3)p(b,f,a,0,d.wkid),
l(a,0,m,c);else for(;f<g;f+=3,c+=3)l(b,f,m,c);else for(p=z[p];f<g;f+=3,c+=3)p(b,f,m,c,d.wkid);else return!1;return!0},convertExtent:function(a,b){if(null==a)return null;var d=[0,0,0],f=[0,0,0],m=this.xyzToVector(a.xmin,a.ymin,a.zmin||0,a.spatialReference,d,b),m=m&&this.xyzToVector(a.xmax,a.ymax,a.zmax||0,a.spatialReference,f,b);return!m?null:[d,f]},computeLinearTransformation:function(d,f,m,c){var p=t(d),g=t(c);if(p===g&&(0!==p||d.equals(c)))return b.identity(m),b.translate(m,f),!0;if(1===g){if(c=
z[p])return c(f,0,a,0,d.wkid),v(a,0,r,0),c=l*a[0],f=l*a[1],d=Math.sin(c),c=Math.cos(c),p=Math.sin(f),f=Math.cos(f),m[0]=-d,m[4]=-p*c,m[8]=f*c,m[12]=r[0],m[1]=c,m[5]=-p*d,m[9]=f*d,m[13]=r[1],m[2]=0,m[6]=f,m[10]=p,m[14]=r[2],m[3]=0,m[7]=0,m[11]=0,m[15]=1,!0}else if(3===g&&(2===p||1===p))return z[p](f,0,a,0,d.wkid),d=l*a[1],x(a,0,r,0),b.identity(m),b.translate(m,r),d=1/Math.cos(d),b.scale(m,[d,d,1]),!0;return!1},mbsToMbs:function(b,d,f,m){var c=t(d),g=t(m);if(c===g&&(0!==c||d.equals(m)))return f[0]=
b[0],f[1]=b[1],f[2]=b[2],f[3]=b[3],!0;if(1===g){if(m=z[c])return m(b,0,a,0,d.wkid),v(a,0,f,0),f[3]=b[3],!0}else if(3===g&&(2===c||1===c))return z[c](b,0,a,0,d.wkid),d=l*a[1],d=Math.abs(d)+Math.asin(b[3]/(p+b[2])),x(a,0,f,0),d>0.9999*Math.PI?f[3]=Number.MAX_VALUE:(d=1/Math.cos(d),f[3]=d*b[3]),!0;return!1},extentToBoundingBox:function(a,b,d){if(null==a)return!1;var m;f[0]=null!=a.xmin?a.xmin:0;f[1]=null!=a.ymin?a.ymin:0;f[2]=null!=a.zmin?a.zmin:0;m=this.bufferToBuffer(f,a.spatialReference,0,b,d,0,1);
f[0]=null!=a.xmax?a.xmax:0;f[1]=null!=a.ymax?a.ymax:0;f[2]=null!=a.zmax?a.zmax:0;m=m&&this.bufferToBuffer(f,a.spatialReference,0,b,d,3,1);null==a.xmin&&(b[0]=-Infinity);null==a.ymin&&(b[1]=-Infinity);null==a.zmin&&(b[2]=-Infinity);null==a.xmax&&(b[3]=Infinity);null==a.ymax&&(b[4]=Infinity);null==a.zmax&&(b[5]=Infinity);return m},extentToBoundingRect:function(a,b,d){if(null==a)return!1;var m;f[0]=null!=a.xmin?a.xmin:0;f[1]=null!=a.ymin?a.ymin:0;f[2]=null!=a.zmin?a.zmin:0;m=this.bufferToBuffer(f,a.spatialReference,
0,f,d,0,1);b[0]=f[0];b[1]=f[1];f[0]=null!=a.xmax?a.xmax:0;f[1]=null!=a.ymax?a.ymax:0;f[2]=null!=a.zmax?a.zmax:0;m=m&&this.bufferToBuffer(f,a.spatialReference,0,f,d,0,1);b[2]=f[0];b[3]=f[1];null==a.xmin&&(b[0]=-Infinity);null==a.ymin&&(b[1]=-Infinity);null==a.xmax&&(b[2]=Infinity);null==a.ymax&&(b[3]=Infinity);return m},webMercator:{x2lon:function(a){return a/p},y2lat:function(a){return Math.PI/2-2*Math.atan(Math.exp(-1*a/p))},lon2x:function(a){return a*p},lat2y:function(a){a=Math.sin(a);return p/
2*Math.log((1+a)/(1-a))}}}})},"esri/views/3d/support/cameraUtilsPlanar":function(){define(["../../../geometry/Extent","./mathUtils","./projectionUtils","../lib/glMatrix","./cameraUtilsInternal"],function(s,q,n,k,h){function e(d,l,c){d=b.create();var e=b.create();g.identity(r);g.rotateZ(r,-q.deg2rad(l));g.rotateX(r,q.deg2rad(c));g.multiplyVec3(r,a,d);b.scale(d,-1);g.multiplyVec3(r,f,e);return{direction:d,up:e}}var c={headingTiltToDirectionUp:e,directionToHeadingTilt:function(b,d,l,c){return h.directionToHeadingTilt(d,
l,c,a,f)},eyeForCenterWithHeadingTilt:function(a,d,f,l){var c=e(a,f,l);a=b.add(b.scale(c.direction,-d,b.create()),a);return{up:c.up,eye:a,heading:f,tilt:l}},lookAtTiltToEyeTilt:function(a,b,d){return q.rad2deg(d)},eyeTiltToLookAtTilt:function(a,b,d){return q.deg2rad(d)},toExtent:function(a,b,f,c,g){var e=a.renderSpatialReference;a=a.map&&a.spatialReference||b.spatialReference;n.pointToVector(b,l,e);n.pointToVector(b,d,e);l[0]-=f/2;d[0]+=f/2;l[1]-=c/2;d[1]+=c/2;n.vectorToVector(l,e,l,a);n.vectorToVector(d,
e,d,a);g?(g.xmin=l[0],g.ymin=l[1],g.xmax=d[0],g.ymax=d[1],g.spatialReference=a):g=new s(l[0],l[1],d[0],d[1],a);return g}},b=k.vec3d,g=k.mat4d,f=b.createFrom(0,1,0),a=b.createFrom(0,0,1),r=g.create(),l=b.create(),d=b.create();return c})},"esri/views/3d/support/cameraUtilsInternal":function(){define(["./mathUtils","../lib/glMatrix"],function(s,q){var n=q.vec3d,k=n.create(),h=n.create();return{directionToHeadingTilt:function(e,c,b,g,f){var a=k;n.normalize(e,a);var r=Math.abs(n.dot(a,g));0.99<r&&(r=Math.abs(n.dot(c,
g)),0.99>r?n.set(c,a):a=null);c=0;a&&(n.scale(g,n.dot(g,a),h),n.subtract(a,h),c=n.dot(a,f)/(n.length(a)*n.length(f)),n.cross(a,f,h),c=(0<n.dot(h,g)?1:-1)*s.rad2deg(s.acos(c)));e=s.rad2deg(s.acos(-n.dot(g,e)/n.length(e)));return b?(b.heading=c,b.tilt=e,b):{heading:c,tilt:e}}}})},"esri/views/3d/support/cameraUtilsSpherical":function(){define("../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/support/webMercatorUtils ./mathUtils ./earthUtils ../lib/glMatrix ./cameraUtilsInternal".split(" "),
function(s,q,n,k,h,e,c){function b(a,b,f){var c=r.create(),g=r.create();r.cross(a,d,x);0===r.dot(x,x)&&r.cross(a,m,x);l.identity(t);l.rotate(t,-k.deg2rad(b),a);l.rotate(t,-k.deg2rad(f),x);r.cross(x,a,g);r.normalize(g);l.multiplyVec3(t,g);r.normalize(a,c);l.multiplyVec3(t,r.negate(c));return{direction:c,up:g}}function g(a){var b=a[1];a[1]=-a[2];a[2]=b}function f(a,d){var f=b(d,a.heading,a.tilt);a.up=f.up;return a}var a={headingTiltToDirectionUp:b,directionToHeadingTilt:function(a,b,f,l){var g=x,p=
v;r.normalize(a,g);r.cross(g,d,v);0===r.dot(v,v)&&r.cross(g,m,v);r.cross(v,g,p);return c.directionToHeadingTilt(b,f,l,g,p)},eyeForCenterWithHeadingTilt:function(a,b,d,m){var c={eye:r.create(),tilt:m,heading:d},l=x;l[0]=a[0];l[1]=a[2];l[2]=-a[1];d=k.deg2rad(d);var p=k.deg2rad(m);m=Math.sin(d);d=Math.cos(d);var e=Math.sin(p),h=Math.cos(p),t=r.length(l);if(1E-8>Math.abs(p))p=b+t;else var n=t/e,v=k.asin(b/n),p=n*Math.sin(Math.PI-p-v);var n=e*b,h=h*b,q=d*n,v=p-h,M=v*v,I=b*b*e*e,e=d*d*I,I=m*m*I,s=l[1]*
v,V=e*(e+M-l[1]*l[1]);if(0>V)return r.scale(l,p/t,c.eye),c.tilt=0,c;var L=Math.sqrt(V),V=e+M,s=0<d?-L+s:L+s;if(1E-8>Math.abs(V))return 1E-8>t?(c.eye[0]=0,c.eye[1]=0,c.eye[2]=b):r.scale(l,p/t,c.eye),c.tilt=0,g(c.eye),f(c,a);c.eye[1]=s/V;b=c.eye[1]*c.eye[1];V=q*c.eye[1];q=1-b;s=Math.sqrt(q);b=e*b+I-2*V*s*v+q*M;if(1E-8>Math.abs(b))return r.scale(l,p/t,c.eye),c.tilt=0,g(c.eye),f(c,a);c.eye[0]=(q*(p*l[0]-h*l[0])-n*s*(l[0]*c.eye[1]*d+l[2]*m))/b;c.eye[2]=(q*(p*l[2]-h*l[2])-n*s*(l[2]*c.eye[1]*d-l[0]*m))/
b;r.scale(c.eye,p);g(c.eye);return f(c,a)},lookAtTiltToEyeTilt:function(a,b,d){a=r.length(a);a=Math.sqrt(b*b+a*a-2*b*a*Math.cos(Math.PI-d));b=k.asin(b/(a/Math.sin(d)));return k.rad2deg(d-b)},eyeTiltToLookAtTilt:function(a,b,d){d=k.deg2rad(d);a=r.length(a);return k.asin(b/(a/Math.sin(d)))+d},toExtent:function(a,b,d,f,m){var c,l=b.latitude;b=b.longitude;c=h.getLonDeltaForDistance(b,l,d)/2;d=b-c;b+=c;c=k.deg2rad(l);l=h.earthRadius;c=(1+Math.sin(c))/(1-Math.sin(c));var g=c+1,e=Math.tan(f/l/2),g=g*e;c=
1.5*Math.PI-2*Math.atan(0.5*(g+Math.sqrt(4*c+g*g)));f=c+f/l;l=function(a){var b=Math.PI/2;a=k.cyclical2PI.normalize(a,-b);a>b&&(a=Math.PI-a);return a};c=l(c);f=l(f);f<c&&(l=f,f=c,c=l);c=Math.max(k.rad2deg(c),-90);f=Math.min(k.rad2deg(f),90);b=p.monotonic(d,b);180<b-d&&(l=(b-d-180)/2,d+=l,b-=l);m?(m.xmin=d,m.ymin=c,m.xmax=b,m.ymax=f,m.spatialReference=s.WGS84):m=new q(d,c,b,f,s.WGS84);a.spatialReference&&a.spatialReference.isWebMercator&&n.geographicToWebMercator(m,!1,m);return m}},r=e.vec3d,l=e.mat4d,
d=r.createFrom(0,0,1),m=r.normalize(r.createFrom(1,1,1)),p=new k.Cyclical(-180,180),t=l.create(),x=r.create(),v=r.create();return a})},"esri/views/3d/support/viewpointUtils":function(){define("../../../geometry/SpatialReference ../../../geometry/Geometry ../../../geometry/Point ../../../geometry/Extent ../../../geometry/support/webMercatorUtils ../../../core/Error ../../../core/promiseUtils ../../../Camera ../../../Viewpoint ../../../Graphic ../lib/glMatrix ./mathUtils ./projectionUtils ./cameraUtils ./aaBoundingBox ./aaBoundingRect ./intersectionUtils".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t){function x(a){return 360-r.cyclicalDeg.normalize(a)}function v(a){return r.cyclicalDeg.normalize(360-a)}function u(a,f,m){if(!f)return null;var c=a.spatialReference||s.WGS84,g;if(f.camera){g=f.get("camera.position.spatialReference");if(!h.canProject(g,c))return null;f=f.camera.clone();g.equals(c)||(a=h.project(f.position,c),a.z=f.position.z,f.position=a);return f}if((g=f.get("targetGeometry.spatialReference"))&&!h.canProject(g,c))return null;var p=a.navigation.currentCamera;
g=d.internalToExternal(a,p);var e={noReset:!1};null!=f.rotation&&(g.heading=x(f.rotation),e.noReset=!0);null!=m&&(g.tilt=m);if(f.targetGeometry instanceof n){var r=f.targetGeometry;m=f.targetGeometry.clone();f=null!=f.scale?d.scaleToDistance(a,f.scale,r.latitude):p.distance;f=d.eyeHeadingTiltForCenterPointAtDistance(a,g.heading,g.tilt,m,f,e);a=l.vectorToPoint(f.eye,a.renderSpatialReference,c);return new b(a,f.heading,f.tilt,g.fov)}return d.fromExtent(a,f.targetGeometry.extent,g,e)}function z(a,b,
f,m){var c=f.scale;null==c&&null!=f.zoom&&(c=d.zoomToScale(a,f.zoom));null==c&&null!=f.distance&&(b=b.center||b,c=d.distanceToScale(a,f.distance,b.latitude));null==c&&m&&(c="function"===typeof m?m():m);return c}function w(a,b,f,m,c){if(!(b&&f.position||b&&f.direction||f.position&&f.direction))return!1;var g=a.spatialReference||s.WGS84,p=a.renderSpatialReference,e=f.direction;b&&f.position&&(e=null);f.position&&l.pointToVector(f.position,L,p);b&&l.pointToVector(b,Y,p);if(e){var h=new n(f.position||
b);h.x+=e[0];h.y+=e[1];2<e.length&&(h.z+=e[2]);l.pointToVector(h,E,p);I.subtract(E,f.position?L:Y)}f.position&&e?(c.camera.position=new n(f.position),d.directionToHeadingTilt(a,L,E,m.up,c.camera),I.add(L,E,Y),a.navigation.getCenterIntersectTerrain(L,Y,Y),c.targetGeometry=l.vectorToPoint(Y,p,g),c.scale=d.distanceToScale(a,I.dist(L,Y),c.targetGeometry.latitude)):b&&e?(c.targetGeometry=new n(b),c.scale=z(a,c.targetGeometry,f,function(){return d.computeScale(a,m)}),b=d.scaleToDistance(a,c.scale,b.latitude),
I.scale(E,b/I.length(E),L),I.add(L,Y),c.camera.position=l.vectorToPoint(L,p,g),d.directionToHeadingTilt(a,L,E,m.up,c.camera)):(c.targetGeometry=new n(b),c.camera.position=new n(f.position),I.subtract(Y,L,E),d.directionToHeadingTilt(a,L,E,m.up,c.camera),c.scale=d.distanceToScale(a,I.dist(L,Y),c.targetGeometry.latitude));c.rotation=v(c.camera.heading);return!0}function C(a,b){var d=!1;null!=b.heading?(a.heading=b.heading,d=!0):null!=b.rotation&&(a.heading=x(b.rotation),d=!0);null!=b.tilt&&(a.tilt=b.tilt,
d=!0);null!=b.fov&&(a.fov=b.fov);return d}function A(a,b,f){var m=a.spatialReference||s.WGS84;b=b||d.externalToInternal(a,f.camera);f.targetGeometry=l.vectorToPoint(b.center,a.renderSpatialReference,m);f.scale=d.computeScale(a,b);f.rotation=v(f.camera.heading);return f}function y(a,b,d){if(b){var f=[];if(!b.hasZ&&a.basemapTerrain){var c;c=b.isInstanceOf(n)?b:b.centroid||b.center;W[2]=c?a.basemapTerrain.getElevation(c)||0:0}Q[b.declaredClass](b,function(a){f.push(a[0],a[1],a[2])},W);var g=f.length/
3;if(0!==g&&(c=Array(f.length),l.bufferToBuffer(f,b.spatialReference,0,c,a.spatialReference,0,g))){b.hasZ&&(d.hasZ=!0);for(a=0;a<c.length;a+=3)b.hasZ?(W[0]=c[a+0],W[1]=c[a+1],W[2]=c[a+2]):(W[0]=c[a+0],W[1]=c[a+1]),m.expand(d.boundingBox,W)}}}function B(a,b,d){return a.whenViewForGraphic(b).then(function(a){if(a&&a.whenGraphicBounds)return a.whenGraphicBounds(b)}).then(function(a){m.expand(d.boundingBox,a);isFinite(a[2])&&(d.hasZ=!0)}).otherwise(function(){y(a,b.geometry,d)})}function D(a,b,d){if(Array.isArray(b)&&
2===b.length&&"number"===typeof b[0]&&"number"===typeof b[1])K.x=b[0],K.y=b[1],K.z=void 0,K.spatialReference=s.WGS84,y(a,K,d);else{if(b&&b.forEach){var m=c.resolve();b.forEach(function(b){m=m.then(function(){return D(a,b,d)})});return m}if(b instanceof q)y(a,b,d);else if(b instanceof f)return B(a,b,d)}return c.resolve()}function F(a,b,d,f){if(b.camera)return H(a,d,b.camera,f);f.scale=b.scale;f.rotation=b.rotation;f.targetGeometry=b.targetGeometry?b.targetGeometry.clone():null;f.camera=null;null!=
d.heading?f.rotation=v(d.heading):null!=d.rotation&&(f.rotation=d.rotation);b=z(a,f.targetGeometry,d);null!=b&&(f.scale=b);f.camera=u(a,f,d.tilt);return f}function H(a,b,d,f){f.camera=d.clone();f.camera.fov=a.camera.fov;b=a.spatialReference;d=f.camera.position.spatialReference;if(!h.canProject(d,b))return null;d.equals(b)||(b=h.project(f.camera.position,b),b.z=f.camera.position.z,f.camera.position=b);return A(a,null,f)}function N(a,b,f,m){if(!f)return null;m.targetGeometry=f.clone();var c=a.navigation.getCameraIntersectTerrain();
if(w(a,m.targetGeometry,b,c,m))return m;d.internalToExternal(a,c,m.camera);var g={noReset:!1};C(m.camera,b)&&(g.noReset=!0);m.scale=z(a,m.targetGeometry,b);null==m.scale&&(l.pointToVector(f,W,a.renderSpatialReference),t.frustumPoint(c.frustumPlanes,W)?m.scale=d.distanceToScale(a,I.dist(c.eye,W),f.latitude):m.scale=d.computeScale(a,c));return!d.fromCenterScale(a,m.targetGeometry,m.scale,m.camera,g,m.camera)?null:m}function G(a,b,f,m){m.targetGeometry=f.clone();var c=a.navigation.getCameraIntersectTerrain();
d.internalToExternal(a,c,m.camera);c={noReset:!1};C(m.camera,b)&&(c.noReset=!0);return!d.fromExtent(a,f,m.camera,c,m.camera)?null:m}function O(a,b){if(!b||!a.spatialReference)return null;var d={};if(null==b.declaredClass&&!Array.isArray(b)){for(var f in b)d[f]=b[f];b.center&&!d.target&&(d.target=b.center)}else d.target=b;return d}function M(a){a&&(a.rotation=v(a.camera.heading));return c.resolve(a)}var I=a.vec3d,Z=a.mat3d,V=a.mat4d,L=I.create(),Y=I.create(),E=I.create(),ba={heading:0,tilt:0},W=I.create(),
R=V.create(),T=Z.create(),J=m.create(),S=p.create(),K=new n,Q={"esri.geometry.Point":function(a,b,d){d[0]=a.x;d[1]=a.y;a.hasZ&&(d[2]=a.z);b(d)},"esri.geometry.Polygon":function(a,b,d){for(var f=a.hasZ,m=0;m<a.rings.length;m++)for(var c=a.rings[m],l=0;l<c.length;l++)d[0]=c[l][0],d[1]=c[l][1],f&&(d[2]=c[l][2]),b(d)},"esri.geometry.Polyline":function(a,b,d){for(var f=a.hasZ,m=0;m<a.paths.length;m++)for(var c=a.paths[m],l=0;l<c.length;l++)d[0]=c[l][0],d[1]=c[l][1],f&&(d[2]=c[l][2]),b(d)},"esri.geometry.Multipoint":function(a,
b,d){var f=a.points;a=a.hasZ;for(var m=0;m<f.length;m++)d[0]=f[m][0],d[1]=f[m][1],a&&(d[2]=f[m][2]),b(d)},"esri.geometry.Extent":function(a,b,d){a.hasZ?(b(I.set3(a.xmin,a.ymin,a.zmin,d)),b(I.set3(a.xmax,a.ymin,a.zmin,d)),b(I.set3(a.xmin,a.ymax,a.zmin,d)),b(I.set3(a.xmax,a.ymax,a.zmin,d)),b(I.set3(a.xmin,a.ymin,a.zmax,d)),b(I.set3(a.xmax,a.ymin,a.zmax,d)),b(I.set3(a.xmin,a.ymax,a.zmax,d)),b(I.set3(a.xmax,a.ymax,a.zmax,d))):(b(I.set3(a.xmin,a.ymin,d[2],d)),b(I.set3(a.xmax,a.ymin,d[2],d)),b(I.set3(a.xmin,
a.ymax,d[2],d)),b(I.set3(a.xmax,a.ymax,d[2],d)))}},U={create:function(a,f){var h=O(a,f);if(!h)return c.reject(new e("viewpointutils-create:no-target","Missing target for creating viewpoint"));var r=new g({camera:new b({fov:a.camera.fov})}),t=null!=h.scale||null!=h.zoom||null!=h.distance;if(h.target instanceof g)return M(F(a,h.target,h,r));if(h.target instanceof b)return M(H(a,h,h.target,r));if(h.target instanceof k)return t?M(N(a,h,h.target.center,r)):M(G(a,h,h.target,r));var B={boundingBox:m.create(m.NEGATIVE_INFINITY),
spatialReference:a.spatialReference,hasZ:!1};return D(a,h.target,B).then(function(){if(isFinite(B.boundingBox[0])){m.center(B.boundingBox,W);K.x=W[0];K.y=W[1];K.z=W[2];K.spatialReference=a.spatialReference;var b;!isFinite(K.z)||!B.hasZ?(K.z=void 0,b=p.isPoint(m.toRect(B.boundingBox,S))):b=m.isPoint(B.boundingBox);if(t||b)return N(a,h,K,r);var f=K,c=B.boundingBox,g=U.DEFAULT_FRAME_COVERAGE;r.targetGeometry=f.clone();b=a.navigation.getCameraIntersectTerrain();var e=0;f.hasZ?e=f.z:a.basemapTerrain&&
(e=a.basemapTerrain.getElevation(f));I.set3(f.x,f.y,e,W);l.computeLinearTransformation(a.spatialReference,W,R,a.renderSpatialReference);V.toMat3(R,T);Z.transpose(T);m.set(J,m.NEGATIVE_INFINITY);for(var f=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],k=0;k<f.length;k++){var u=f[k],D=c[u[2]];isFinite(D)||(D=e);I.set3(c[u[0]],c[u[1]],D,W);l.vectorToVector(W,a.spatialReference,W,a.renderSpatialReference);m.expand(J,Z.multiplyVec3(T,W))}c=m.width(J);e=m.height(J);f=m.depth(J);u=1/Math.tan(b.fovX/
2);k=1/Math.tan(b.fovY/2);u=0.5*Math.sqrt(c*c+f*f)*Math.max(k,u)+0.5*e;c=0.5*e*k+0.5*Math.max(c,f);g=Math.max(u,c)/g;d.internalToExternal(a,b,r.camera);b={noReset:!1};C(r.camera,h)&&(b.noReset=!0);r.scale=d.distanceToScale(a,g,r.targetGeometry.latitude);b=d.fromCenterScale(a,r.targetGeometry,r.scale,r.camera,b,r.camera)?r:null;return b}b=a.navigation.getCameraIntersectTerrain();w(a,null,h,b,r)?b=r:h.position?(b.computeDirection(E),d.directionToHeadingTilt(a,b.eye,E,b.up,ba),r.camera.position=new n(h.position),
b=r.camera,g=ba.heading,c=h.heading,null==c&&null!=h.rotation&&(c=x(h.rotation)),null==c&&g&&(c="function"===typeof g?g():g),b.heading=c,b=r.camera,g=ba.tilt,g=null!=h.tilt?h.tilt:null!=g?"function"===typeof g?g():g:void 0,b.tilt=g,b=A(a,null,r)):(b=l.vectorToPoint(b.center,a.renderSpatialReference,K,a.spatialReference),b=N(a,h,b,r));return b}).then(function(a){return M(a)})},rotationToHeading:x,headingToRotation:v,toCamera:u,fromCamera:function(a,b,d){d||(d=new g);d.camera=b.clone();return A(a,null,
d)},fromInternalCamera:function(a,f,m){m||(m=new g({camera:new b}));d.internalToExternal(a,f,m.camera);return A(a,f,m)},DEFAULT_FRAME_COVERAGE:0.66};return U})},"esri/views/3d/support/aaBoundingBox":function(){define(["require","exports","./aaBoundingRect"],function(s,q,n){function k(b){return b[0]>=b[3]?0:b[3]-b[0]}function h(b){return b[1]>=b[4]?0:b[4]-b[1]}function e(b){return b[2]>=b[5]?0:b[5]-b[2]}function c(b){return 6===b.length}q.create=function(b){void 0===b&&(b=q.ZERO);return[b[0],b[1],
b[2],b[3],b[4],b[5]]};q.fromExtent=function(b){return[b.xmin,b.ymin,b.zmin,b.xmax,b.ymax,b.zmax]};q.expand=function(b,g,f){void 0===f&&(f=b);var a=g.declaredClass;"esri.geometry.Extent"===a?(f[0]=Math.min(b[0],g.xmin),f[1]=Math.min(b[1],g.ymin),f[3]=Math.max(b[3],g.xmax),f[4]=Math.max(b[4],g.ymax),g.hasZ&&(f[2]=Math.min(b[2],g.zmin),f[5]=Math.max(b[5],g.zmax))):"esri.geometry.Point"===a?(f[0]=Math.min(b[0],g.x),f[1]=Math.min(b[1],g.y),f[3]=Math.max(b[3],g.x),f[4]=Math.max(b[4],g.y),g.hasZ&&(f[2]=
Math.min(b[2],g.z),f[5]=Math.min(b[5],g.z))):c(g)?(f[0]=Math.min(b[0],g[0]),f[1]=Math.min(b[1],g[1]),f[2]=Math.min(b[2],g[2]),f[3]=Math.max(b[3],g[3]),f[4]=Math.max(b[4],g[4]),f[5]=Math.max(b[5],g[5])):n.is(g)?(f[0]=Math.min(b[0],g[0]),f[1]=Math.min(b[1],g[1]),f[3]=Math.max(b[3],g[2]),f[4]=Math.max(b[4],g[3])):Array.isArray(g)&&(2===g.length?(f[0]=Math.min(b[0],g[0]),f[1]=Math.min(b[1],g[1]),f[3]=Math.max(b[3],g[0]),f[4]=Math.max(b[4],g[1])):3===g.length&&(f[0]=Math.min(b[0],g[0]),f[1]=Math.min(b[1],
g[1]),f[2]=Math.min(b[2],g[2]),f[3]=Math.max(b[3],g[0]),f[4]=Math.max(b[4],g[1]),f[5]=Math.max(b[5],g[2])));return f};q.allFinite=function(b){for(var c=0;6>c;c++)if(!isFinite(b[c]))return!1;return!0};q.width=k;q.depth=h;q.height=e;q.center=function(b,c){void 0===c&&(c=[0,0,0]);c[0]=b[0]+k(b)/2;c[1]=b[1]+h(b)/2;c[2]=b[2]+e(b)/2;return c};q.contains=function(b,c){return c[0]>=b[0]&&c[1]>=b[1]&&c[2]>=b[2]&&c[0]<=b[3]&&c[1]<=b[4]&&c[2]<=b[5]};q.containsWithMargin=function(b,c,f){return c[0]>=b[0]-f&&
c[1]>=b[1]-f&&c[2]>=b[2]-f&&c[0]<=b[3]+f&&c[1]<=b[4]+f&&c[2]<=b[5]+f};q.offset=function(b,c,f,a,e){void 0===e&&(e=b);e[0]=b[0]+c;e[1]=b[1]+f;e[2]=b[2]+a;e[3]=b[3]+c;e[4]=b[4]+f;e[5]=b[5]+a;return e};q.setMin=function(b,c,f){void 0===f&&(f=b);f[0]=c[0];f[1]=c[1];f[2]=c[2];f!==b&&(f[3]=b[3],f[4]=b[4],f[5]=b[5]);return f};q.setMax=function(b,c,f){void 0===f&&(f=b);f[3]=c[0];f[4]=c[1];f[5]=c[2];f!==b&&(f[0]=b[0],f[1]=b[1],f[2]=b[2]);return b};q.set=function(b,c){b[0]=c[0];b[1]=c[1];b[2]=c[2];b[3]=c[3];
b[4]=c[4];b[5]=c[5];return b};q.toRect=function(b,c){c||(c=n.create());c[0]=b[0];c[1]=b[1];c[2]=b[3];c[3]=b[4];return c};q.fromRect=function(b,c){b[0]=c[0];b[1]=c[1];b[3]=c[2];b[4]=c[3];return b};q.is=c;q.isPoint=function(b){return 0===k(b)&&0===h(b)&&0===e(b)};q.equals=function(b,g,f){if(null==b||null==g)return b===g;if(!c(b)||!c(g))return!1;if(f)for(var a=0;a<b.length;a++){if(!f(b[a],g[a]))return!1}else for(a=0;a<b.length;a++)if(b[a]!==g[a])return!1;return!0};q.POSITIVE_INFINITY=[-Infinity,-Infinity,
-Infinity,Infinity,Infinity,Infinity];q.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];q.ZERO=[0,0,0,0,0,0]})},"esri/views/3d/support/aaBoundingRect":function(){define(["require","exports"],function(s,q){function n(e){return e[0]>=e[2]?0:e[2]-e[0]}function k(e){return e[1]>=e[3]?0:e[3]-e[1]}function h(e){return 4===e.length}q.create=function(e){void 0===e&&(e=q.ZERO);return[e[0],e[1],e[2],e[3]]};q.fromExtent=function(e){return[e.xmin,e.ymin,e.xmax,e.ymax]};q.expand=function(e,
c,b){void 0===b&&(b=e);var g=c.declaredClass;if("esri.geometry.Extent"===g)b[0]=Math.min(e[0],c.xmin),b[1]=Math.min(e[1],c.ymin),b[2]=Math.max(e[2],c.xmax),b[3]=Math.max(e[3],c.ymax);else if("esri.geometry.Point"===g)b[0]=Math.min(e[0],c.x),b[1]=Math.min(e[1],c.y),b[2]=Math.max(e[2],c.x),b[3]=Math.max(e[3],c.y);else if(h(c))b[0]=Math.min(e[0],c[0]),b[1]=Math.min(e[1],c[1]),b[2]=Math.max(e[2],c[2]),b[3]=Math.max(e[3],c[3]);else if(Array.isArray(c)&&(2===c.length||3===c.length))b[0]=Math.min(e[0],c[0]),
b[1]=Math.min(e[1],c[1]),b[2]=Math.max(e[2],c[0]),b[3]=Math.max(e[3],c[1]);return b};q.allFinite=function(e){for(var c=0;4>c;c++)if(!isFinite(e[c]))return!1;return!0};q.width=n;q.height=k;q.center=function(e,c){void 0===c&&(c=[0,0]);c[0]=e[0]+n(e)/2;c[1]=e[1]+k(e)/2;return c};q.contains=function(e,c){return c[0]>=e[0]&&c[1]>=e[1]&&c[0]<=e[2]&&c[1]<=e[3]};q.containsWithMargin=function(e,c,b){return c[0]>=e[0]-b&&c[1]>=e[1]-b&&c[0]<=e[2]+b&&c[1]<=e[3]+b};q.offset=function(e,c,b,g){void 0===g&&(g=e);
g[0]=e[0]+c;g[1]=e[1]+b;g[2]=e[2]+c;g[3]=e[3]+b;return g};q.setMin=function(e,c,b){void 0===b&&(b=e);b[0]=c[0];b[1]=c[1];b!==e&&(b[2]=e[2],b[3]=e[3]);return b};q.setMax=function(e,c,b){void 0===b&&(b=e);b[2]=c[0];b[3]=c[1];b!==e&&(b[0]=e[0],b[1]=e[1]);return e};q.set=function(e,c){e[0]=c[0];e[1]=c[1];e[2]=c[2];e[3]=c[3];return e};q.is=h;q.isPoint=function(e){return(0===n(e)||!isFinite(e[0]))&&(0===k(e)||!isFinite(e[1]))};q.equals=function(e,c,b){if(null==e||null==c)return e===c;if(!h(e)||!h(c))return!1;
if(b)for(var g=0;g<e.length;g++){if(!b(e[g],c[g]))return!1}else for(g=0;g<e.length;g++)if(e[g]!==c[g])return!1;return!0};q.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];q.ZERO=[0,0,0,0]})},"esri/views/3d/support/intersectionUtils":function(){define(["../lib/glMatrix"],function(s){function q(c,b,g,f){f.clip[0]=0;f.clip[1]=g?f.len:Number.MAX_VALUE;for(g=0;g<c.length;g++){var a;var e=c[g],l=b;a=f;var d=k.dot(e,a.dir),e=-k.dot(l,e)-e[3];0>e&&0<=d?a=!1:-1E-6<d&&1E-6>d?a=!0:(0>e||0>d)&&!(0>
e&&0>d)?a=!0:(e/=d,0<d?e<a.clip[1]&&(a.clip[1]=e):e>a.clip[0]&&(a.clip[0]=e),a=a.clip[0]<=a.clip[1]);if(!a)return!1}return!0}function n(c,b,g,f){c?(g&&f&&(h.len=k.dist(b,g)),k.set(c,h.dir)):f?(h.len=k.dist(b,g),k.scale(k.subtract(g,b,h.dir),1/h.len)):k.normalize(k.subtract(g,b,h.dir));return h}var k=s.vec3d;s=s.vec2d;var h={dir:k.create(),len:0,clip:s.create()},e={planeSphere:function(c,b,g){return c[0]*b[0]+c[1]*b[1]+c[2]*b[2]+c[3]<g},frustumSphere:function(c,b,g){for(var f=0;6>f;f++)if(!e.planeSphere(c[f],
b,g))return!1;return!0},frustumRay:function(c,b,g,f){g=n(f,b,g,!1);return q(c,b,null,g)},frustumPoint:function(c,b){for(var g=0;6>g;g++)if(0>-k.dot(b,c[g])-c[g][3])return!1;return!0},frustumLineSegment:function(c,b,g,f){f=n(f,b,g,!0);return q(c,b,g,f)}};return e})},"esri/views/3d/support/eventUtils":function(){define(["../../../core/watchUtils","dojo/on","dojo/_base/lang"],function(s,q,n){function k(){this.handles=[];this.ids={}}function h(c){var b={},g;for(g in c){var f=c[g];if("function"===typeof f)b[g]=
f;else for(var a in f)b[g+"."+a]=f[a]}return b}function e(c,b){var g={},f;for(f in c){var a=c[f],e={};"object"===typeof a&&(e=n.mixin({},a),delete e.handler,a=a.handler);b&&(a=function(a){return function(){a.apply(b,arguments)}}(a));var l=f.split("."),d;1===l.length?(d="",l=f[0]):(d=l.slice(0,l.length-1).join("."),l=l[l.length-1]);g[d]||(g[d]=[]);g[d].push({eventName:l,handler:a,installer:e.pausable?q.pausable:q})}return g}k.prototype.remove=function(){this.handles.forEach(function(c){c.remove()});
this.handles.length=0;this.ids={}};k.prototype.push=function(){2===arguments.length&&"string"===typeof arguments[0]?(this.handles.push(arguments[1]),this.ids[arguments[0]]=arguments[1]):this.handles.push.apply(this.handles,arguments)};k.prototype.byId=function(c){return this.ids[c]};return{Handles:k,on:function(c,b,g,f){var a=new k,r={};if("string"===typeof b){var l={};l[b]=g;b=l;g=f}b=e(h(b),g);for(var d in b){var m=new k;r[d]=m;d?a.push(s.init(c,d,function(a,b,d){return function(f){a.remove();f&&
d.forEach(function(d){a.push(b+"."+d.eventName,d.installer(f,d.eventName,d.handler))})}}(m,d,b[d]))):b[d].forEach(function(a){m.push(d+"."+a.eventName,a.installer(c,a.eventName,a.handler))})}var p=new k,t=p.remove;p.remove=function(){for(var b in r)r[b].remove();r={};a.remove();t.call(p)};p.byId=function(a){for(var b in r){var d=r[b].byId(a);if(d)return d}return null};return p}}})},"esri/views/3d/webgl-engine/Stage":function(){define("require exports ./parts/Model ./parts/View ./lib/Selector ./lib/Camera ./lib/gl-matrix ./lib/Util ./lib/ModelContentType".split(" "),
function(s,q,n,k,h,e,c,b,g){s=c.vec2d;q=c.vec2;var f=c.vec3d;c=function(){function c(a,b){this._intersectTolerance=h.DEFAULT_TOLERANCE;this._viewContent=[];this._externalIntersectionHandlers=[];this.onSelectionChange=function(){};this.onGeometryPicked=function(){};this.container=a;this.model=new n;this.view=new k(a,this,this.model.getDirtySet(),b);this.view.setLights(this.model.getAmbientLight(),this.model.getDirectionalLight())}c.prototype.setNeedsRender=function(){this.view.setNeedsRender()};c.prototype.dispose=
function(){this.view.dispose();this.model=this.view=null};c.prototype.setSelectionObject=function(a,b,d){this.model.setSelection(a,d);this.view.setSelectionObject(void 0!==a?a.getId():void 0,d);if(!b)this.onSelectionChange(a,d)};c.prototype.getSelectionObject=function(){return this.model.getSelection()};c.prototype.frame=function(a,b){void 0===b&&(b=0);var d=Math.max(1E-6,a.getBSRadius());b=Math.max(2,b+2);var c=d*b,d=this.getCamera(),m=d.computeDirection(),c=1.5*c/Math.tan(d.fov);f.scale(m,-c);f.set(a.getCenter(),
d.center);f.add(d.center,m,d.eye);d=new e(d.eye,d.center,d.up);this.setCamera(d)};c.prototype.beginMod=function(){c.DebugSettings.fineGrainedContentValidation&&this.model.validateContent()};c.prototype.endMod=function(a){void 0===a&&(a=!1);c.DebugSettings.fineGrainedContentValidation&&!a&&this.model.validateContent()};c.prototype.add=function(a,b){this.model.add(a,b);"function"===typeof b.addParentStage&&b.addParentStage(this)};c.prototype.remove=function(a,b){var d=this.model.remove(a,b);"function"===
typeof d.removeParentStage&&d.removeParentStage(this);return d};c.prototype.notifyDirty=function(a,b,d,f){this.model.notifyDirty(a,b,d,f)};c.prototype.processDirty=function(){var a=this.model.getDirtySet(),b=a.getDirtyMaterials();if(a.hasDirtyGeometryRecords()||b){c.DebugSettings.endFrameContentValidation&&this.model.validateContent();c.DebugSettings.logDirtySet&&console.log("Dirty set: "+this.model.getDirtySet().formatDebugInfo(!1));var d=a.getAddRemoveUpdateListFilteredByLayers(this._viewContent,
!0);(0<d[0].length+d[1].length+d[2].length||b)&&this.view.modify(d[0],d[1],d[2],b);c.DebugSettings.logDirtySet&&(console.log("RGs add: "+d[0].map(function(a){return a.uniqueName})),console.log("RGs remove: "+d[1].map(function(a){return a.uniqueName})));a.getAddRemoveUpdateList(!0);a.clearDirtyMaterials();this.view.setNeedsRender()}};c.prototype.processDirtyLayer=function(a){var b=this.model.getDirtySet(),d=b.getDirtyMaterials();a=b.getAddRemoveUpdateListFilteredByLayers([a],!0);(0<a[0].length+a[1].length+
a[2].length||d)&&this.view.modify(a[0],a[1],a[2],d);b.clearDirtyMaterials()};c.prototype.get=function(a,b){return this.model.get(a,b)};c.prototype.getAll=function(a){return this.model.getAll(a)};c.prototype.addTextureListener=function(a){this.view.addTextureListener(a)};c.prototype.removeTextureListener=function(a){this.view.removeTextureListener(a)};c.prototype.getContainer=function(){return this.container};c.prototype.getCamera=function(){return this.view.getCamera()};c.prototype.setCamera=function(a){this.view.setCamera(a)};
c.prototype.getViewParams=function(a){return this.view.getViewParams(a)};c.prototype.setViewParams=function(a){this.view.setViewParams(a)};c.prototype.getLayers=function(){return this.model.getAll(g.LAYER)};c.prototype.getAmbientLight=function(){return this.model.getAmbientLight()};c.prototype.getDirectionalLight=function(){return this.model.getDirectionalLight()};c.prototype.setAmbientLight=function(a){this.model.setAmbientLight(a);this.view.setLights(this.model.getAmbientLight(),this.model.getDirectionalLight())};
c.prototype.setDirectionalLight=function(a){this.model.setDirectionalLight(a);this.view.setLights(this.model.getAmbientLight(),this.model.getDirectionalLight())};c.prototype.getCanvas=function(){return this.view.getCanvas()};c.prototype.setRenderParams=function(a){this.view.setRenderParams(a)};c.prototype.getRenderParams=function(){return this.view.getRenderParams()};c.prototype.has=function(a){return this.view.has(a)};c.prototype.getViewContent=function(){return this._viewContent.slice(0)};c.prototype.setViewContent=
function(a){var d=b.array2object(this._viewContent),f=b.array2object(a),c=b.subtractObjects(f,d),d=b.subtractObjects(d,f);this.processDirty();f=this.model.getDirtySet();c=f.getResidentRenderGeometriesFilteredByLayers(b.object2array(c));d=f.getResidentRenderGeometriesFilteredByLayers(b.object2array(d));this.view.modify(c,d,[]);this._viewContent=a.slice(0)};c.prototype.addToViewContent=function(a){for(var b=[],d=0;d<a.length;d++)-1===this._viewContent.indexOf(a[d])&&b.push(a[d]);0<a.length&&(this.processDirty(),
a=this.model.getDirtySet().getResidentRenderGeometriesFilteredByLayers(b),this.view.modify(a,[],[]),this._viewContent.push.apply(this._viewContent,b))};c.prototype.removeFromViewContent=function(a){this.processDirty();for(var b=this.model.getDirtySet(),d=this._viewContent,f=[],c=0;c<a.length;c++){var m=d.indexOf(a[c]);-1<m&&(d[m]=d[d.length-1],d.pop(),f.push(a[c]))}a=b.getResidentRenderGeometriesFilteredByLayers(f);this.view.modify([],a,[])};c.prototype.getViewFrustumObjects=function(){return this.view.getFrustumObjects()};
c.prototype.getLocalOrigin=function(a,b,d){return this.model.getOrigin(a,b,d)};c.prototype.addModelListener=function(a){return this.model.addModelListener(a)};c.prototype.removeModelListener=function(a){this.model.removeModelListener(a)};c.prototype.getFrameTask=function(){return this.view.getFrameTask()};c.prototype.requestScreenCapture=function(a,b){this.view.requestScreenCapture(a,b)};c.prototype.getAllTexturesLoaded=function(){return this.view.getAllTexturesLoaded()};c.prototype.getTextureLoaded=
function(a){return this.view.getTextureLoaded(a)};c.prototype.addExternalRenderer=function(a,b){"function"===typeof b.intersect&&this._externalIntersectionHandlers.push(b);return this.view.addExternalRenderer(a,b)};c.prototype.removeExternalRenderer=function(a){var b=this._externalIntersectionHandlers.indexOf(a);-1<b&&this._externalIntersectionHandlers.splice(b,1);return this.view.removeExternalRenderer(a)};c.prototype.getContentDebugStrings=function(a){return this.model.formatDebugInfo(a)};c.prototype.getRenderStats=
function(){return this.view.getCombinedStats()};c.prototype.getRenderStatString=function(a){var b=this.getRenderStats(),d="";if(a){var d=d+"\x3ctable\x3e",f;for(f in b)d+="\x3ctr\x3e\x3ctd\x3e"+f+'\x3c/td\x3e\x3ctd style\x3d"text-align: right"\x3e'+Math.round(b[f])+"\x3c/td\x3e\x3c/tr\x3e";d+="\x3c/table\x3e"}else for(f in b)d+=f+": "+b[f]+"\n";return d};c.prototype.pick=function(a,b,d,c){var m=f.create(),l=f.create();this.view.getPickRay(a,m,l);return this.pickRay(m,l,a,a,b,d,c)};c.prototype.pickRayWithBeginPoint=
function(a,b,d,f,c){this.view.pickRayWithBeginPoint(a,b,d,f,c)};c.prototype.pickRay=function(b,f,c,m,g,e,p){m=this.view.getCamera();c||(c=a,m.projectPoint(f,c));var k;if(g){k=Array(g.length);for(var y=0;y<k.length;y++)k[y]=this.model.get(n.ContentType.LAYER,g[y])}else{k=[];g=this.getViewContent();for(var B=this.model.getAll(n.ContentType.LAYER),y=0;y<g.length;y++){var D=B[g[y]];D&&"VISIBLE"===D.getState()&&k.push(D)}}p?p.init(k,b,f,c,m,this._intersectTolerance,e):p=new h(k,b,f,c,m,this._intersectTolerance,
e);for(y=0;y<this._externalIntersectionHandlers.length;y++)this._externalIntersectionHandlers[y].intersect(p,b,f,c);if(p.getHudResults().length){y=p.getHudResults();y.sort(function(a,b){return b.dist-a.dist});f=y[y.length-1];c=r;m.projectPoint(f.center,c);c[0]=Math.round(c[0]);c[1]=Math.round(c[1]);e=l;this.view.getPickRay(c,b,e);d.init(k,b,e,c,m,this._intersectTolerance,!1);for(y=0;y<this._externalIntersectionHandlers.length;y++)this._externalIntersectionHandlers[y].intersect(d,b,e,c);if(null==d.getMinResult().dist||
f.dist<=d.getMinResult().dist)p.getMinResult().set(f.object,f.name,f.dist,f.normal,f.priority),p.getMinResult().setIntersector("stage")}return p};c.prototype.getIntersectTolerance=function(){return this._intersectTolerance};c.prototype.setIntersectTolerance=function(a){void 0===a&&(a=1E-5);this._intersectTolerance=a};c.prototype.select=function(a){var b=this.pick(a,null,!0,m).getMinResult(),d=b.object;this.onGeometryPicked(d,a,b);if(d&&(a=d.getParentLayer(),d===this.model.getSelection()||a&&"PICKABLE"!==
a.getInteraction()))b=d.getFaceRangeFromTriangleNr(b.triangleNr),null==b||null!=this.model.getSelectionFaceRange()&&(JSON.stringify(b),JSON.stringify(this.model.getSelectionFaceRange()))};c.prototype.getTextureGraphicsRenderer=function(){return this.view.getTextureGraphicsRenderer()};c.prototype.debugHideFaceRange=function(a,b){var d=this.getAll("objects")[a];d.hideFaceRange(d.getGeometryRecords()[0],[d.getMetadata().faceRanges[b]])};c.prototype.debugHideAllFaceRange=function(a){a=this.getAll("objects")[a];
for(var b in a.getMetadata().faceRanges)a.hideFaceRange(a.getGeometryRecords()[0],[a.getMetadata().faceRanges[b]])};c.prototype.debugUnhideFaceRange=function(a,b){this.getAll("objects")[a].unhideAllFaceRange()};c.DebugSettings={fineGrainedContentValidation:!1,endFrameContentValidation:!1,logDirtySet:!1};c.ModelContentType=g;return c}();var a=s.create(),r=q.create(),l=f.create(),d=new h,m=new h;m.mode="select";return c})},"esri/views/3d/webgl-engine/parts/View":function(){define("require exports ../lib/GLTextureRep ../lib/GLSLProgramRep ../lib/GLMaterialRep ../lib/ShaderSnippets ../lib/GLSLShaderRep ../lib/GLVBORep ../lib/TextureRenderer ../lib/Util ../lib/gl-matrix ../lib/webgl-utils ../lib/GLDefaultState ./Model ./Viewport ../materials/repository ../lib/SSAOHelperObscurance ../lib/HighlightHelper ../lib/OffscreenRenderingHelper ../../../../core/sniff ../lib/tracer".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u,z){var w=a.vec3d,C=a.vec4d;s=function(){function a(f,c,l,e){var p=this;this._backgroundColor=C.createFrom(1,1,1,1);this._lightDirection=w.createFrom(0,1,0);this._didRender=!1;this._idleSuspend=this._needsRender=!0;this._shouldRender=!1;this._screenCaptureQueue=[];this._container=f;this._stage=c;this._initializeContext(e);this._initializeShaders();this._vboRep=new b;this._textureRep=new n(c.getAll(d.ContentType.TEXTURE),this._programRep,function(){return p._viewport.getCamera().viewport},
this._gl);this._materialRep=new h(this._textureRep,this._programRep);this._viewport=new m(this._programRep,this._vboRep,this._materialRep,this._textureRep,this._gl);this._initializeViewportCamera();this._textureRenderer=new g(this._gl,this._canvas,this._programRep,this._materialRep,this._textureRep,l);this._initializeFrameTask()}a.prototype._initializeFrameTask=function(){var a=this;this._frameTask={preRender:function(){z.begin();a._stage.processDirty();a.needsRender()?(a._shouldRender=!0,a._viewport.getCamera().setGLViewport(a._gl),
a._gl.clearColor.apply(a._gl,a._backgroundColor),a._gl.clear(16640)):a._shouldRender=!1},render:function(){a._shouldRender&&(a._didRender=!0,a._gl.web3DDefaultState.apply(),a._viewport.render(a._lightDirection,null))},postRender:function(){z.end()},update:function(){a._performScreenCaptures();a.resetNeedsRender()}}};a.prototype._initializeViewportCamera=function(){var a=this._container.getBoundingClientRect(),b=this._viewport.getCamera();b.viewport[2]=a.width;b.viewport[3]=a.height;this._viewport.setCamera(b)};
a.prototype._initializeContext=function(a){this._canvas=a.canvas;this._canvas||(this._canvas=document.createElement("canvas"));this._canvas.setAttribute("style","width: 100%; height:100%; display:block;");var b={alpha:a.alpha||!1};null!=a.antialias&&(b.antialias=a.antialias,u("ff")&&!1===a.antialias&&(b.stencil=!0));a=r.setupWebGL(this._canvas,b);this._gl=z.instrumentContext(a[0]);this._gl.pixelStorei(37440,!0);this._gl.web3DDefaultState=new l(this._gl);this._container.appendChild(this._canvas)};
a.prototype._initializeShaders=function(){this._shaderSnippets=new e;this._shaderRep=new c;this._programRep=new k;p.initializeShaders(this._shaderSnippets,this._shaderRep,this._programRep,this._gl);x.loadShaders(this._shaderSnippets,this._shaderRep,this._programRep,this._gl);t.loadShaders(this._shaderSnippets,this._shaderRep,this._programRep,this._gl);v.loadShaders(this._shaderSnippets,this._shaderRep,this._programRep,this._gl)};a.prototype.dispose=function(){this._viewport.dispose();this._viewport=
null;this._textureRenderer.dispose();this._textureRenderer=null;this._programRep.dispose();this._programRep=null;this._container.contains(this._canvas)&&this._container.removeChild(this._canvas);this._gl=this._canvas=this._container=null};a.prototype.getCombinedStats=function(){return this._viewport.getCombinedStats()};a.prototype.setNeedsRender=function(){this._didRender=!1;this._needsRender=!0};a.prototype.resetNeedsRender=function(){this._didRender&&(this._didRender=this._needsRender=!1);this._viewport.resetNeedsRender();
this._textureRep.resetNeedsRender()};a.prototype.needsRender=function(){return this._needsRender||!this._idleSuspend||this._viewport.needsRender()||this._textureRep.needsRender()};a.prototype.getFrameTask=function(){return this._frameTask};a.prototype.setLights=function(a,b){w.set(b.direction,this._lightDirection);C.set4(a.color[0],a.color[1],a.color[2],a.intensity,A.ambient);C.set4(b.color[0],b.color[1],b.color[2],b.intensity,A.diffuse);C.set4(b.color[0],b.color[1],b.color[2],Math.min(b.intensity+
a.intensity,1),A.specular);w.set(b.direction,A.direction);this._viewport.setLightingData(A);this._needsRender=!0};a.prototype.getViewParams=function(a){var b=this._viewport.getViewParams(a);if(!a||a.backgroundColor)b.backgroundColor=this._backgroundColor;return b};a.prototype.setViewParams=function(a){this._needsRender=!0;a.backgroundColor&&(this._backgroundColor=a.backgroundColor);this._viewport.setViewParams(a)};a.prototype.setRenderParams=function(a){this._needsRender=!0;"anisotropicFiltering"in
a&&this._textureRep.setMaxAnisotropy(a.anisotropicFiltering);"backfaceCulling"in a&&(this._gl.web3DDefaultState.cullEnabled=a.backfaceCulling);void 0!==a.idleSuspend&&(this._idleSuspend=!!a.idleSuspend);this._viewport.setRenderParams(a)};a.prototype.getRenderParams=function(){var a=this._viewport.getRenderParams();a.anisotropicFiltering=this._textureRep.getMaxAnisotropy();a.backfaceCulling=this._gl.web3DDefaultState.cullEnabled;a.idleSuspend=this._idleSuspend;return a};a.prototype.has=function(a){return"s3tc"===
a?!!this._gl.getExtension("WEBGL_compressed_texture_s3tc"):!1};a.prototype.getFrustumObjects=function(){return this._viewport.getFrustumObjects()};a.prototype.modify=function(a,b,d,f){this._viewport.modify(a,b,d,f)};a.prototype.setSelectionObject=function(a,b){this._viewport.setSelectionObject(a,b)};a.prototype.setCamera=function(a){this._viewport.setCamera(a)};a.prototype.getCamera=function(){return this._viewport.getCamera()};a.prototype.getPickRay=function(a,b,d){this._viewport.getPickRay(a,b,
d)};a.prototype.pickRayWithBeginPoint=function(a,b,d,f,c){this._viewport.pickRayWithBeginPoint(a,b,d,f,c)};a.prototype.getCanvas=function(){return this._canvas};a.prototype.getTextureGraphicsRenderer=function(){return this._textureRenderer};a.prototype.requestScreenCapture=function(a,b){this._screenCaptureQueue.push({settings:a||{},callback:b});this._needsRender=!0};a.prototype.getAllTexturesLoaded=function(){return 0===this._textureRep.getLoadingCount()};a.prototype.getTextureLoaded=function(a){return this._textureRep.getIsLoaded(a)};
a.prototype.addTextureListener=function(a){this._textureRep.addTextureListener(a)};a.prototype.removeTextureListener=function(a){this._textureRep.removeTextureListener(a)};a.prototype.addExternalRenderer=function(a,b){return this._viewport.addExternalRenderer(a,b)?(b.initializeRenderContext({gl:this._gl,shaderSnippets:this._shaderSnippets,shaderRep:this._shaderRep,programRep:this._programRep,textureRep:this._textureRep}),!0):!1};a.prototype.removeExternalRenderer=function(a){return this._viewport.removeExternalRenderer(a)};
a.prototype._performScreenCaptures=function(){if(0!==this._screenCaptureQueue.length){for(var a=0;a<this._screenCaptureQueue.length;a++){var b=this._screenCaptureQueue[a],d=0,c=0,m=this._canvas.width,l=this._canvas.height,g=this._canvas.width,e=this._canvas.height;if(g=b.settings.area)d=g.x,c=g.y,m=g.width,l=g.height;void 0!==b.settings.width&&void 0!==b.settings.height?(g=b.settings.width/b.settings.height,l*g<m?(g*=l,d+=Math.floor((m-g)/2),m=Math.floor(g)):(g=m/g,c+=Math.floor((l-g)/2),l=Math.floor(g)),
g=b.settings.width,e=b.settings.height):(g=m,e=l);var p=this._canvas;if(0!==d||0!==c||m!==this._canvas.width||l!==this._canvas.height||g!==this._canvas.width||e!==this._canvas.height){this._resizeCanvas||(this._resizeCanvas=document.createElement("canvas"));this._resizeCanvas.width=g;this._resizeCanvas.height=e;var p=this._resizeCanvas.getContext("2d"),h=new Uint8Array(4*m*l);this._gl.readPixels(d,this._canvas.height-(c+l),m,l,6408,5121,h);d=p.getImageData(0,0,g,e);f.resampleHermite(h,m,l,d.data,
g,e,!0);p.putImageData(d,0,0);p=this._resizeCanvas}m={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"}[b.settings.format?b.settings.format.toLowerCase():"png"];l=1;void 0!==b.settings.quality&&(l=b.settings.quality/100);m=p.toDataURL(m,l);b.callback({dataURL:m,x:0,y:0,width:g,height:e})}this._screenCaptureQueue=[]}};return a}();var A={ambient:C.create(),diffuse:C.create(),specular:C.create(),direction:w.create()};return s})},"esri/views/3d/webgl-engine/lib/GLSLProgramRep":function(){define(["require",
"exports","./Util"],function(s,q,n){return function(){function k(){this.programsByName={};this.namesById=[];this.programRefCount=[];this.commonUniforms={model:[],modelNormal:[],lightDirection:[],proj:[],shadowMapDistance:[],viewportPixelSz:[]};this.shaderVariators={}}k.prototype.dispose=function(){for(var h in this.programsByName)this.programsByName[h].dispose();this.programRefCount=this.namesById=this.programsByName=null};k.prototype.add=function(h,e){n.assert(null==this.programsByName[h]);this.programsByName[h]=
e;this.namesById[e.getId()]=h};k.prototype.get=function(h){return this.programsByName[h]};k.prototype.getProgramsUsingUniform=function(h){return this.commonUniforms[h]||[]};k.prototype.increaseRefCount=function(h){var e=h.getId();this.programRefCount[e]?this.programRefCount[e]++:(this.programRefCount[e]=1,this.findCommonUniforms(h))};k.prototype.decreaseRefCount=function(h){var e=h.getId();1<this.programRefCount[e]?this.programRefCount[e]--:(this.forgetCommonUniforms(h),this.programRefCount[e]=0)};
k.prototype.findCommonUniforms=function(h){for(var e in this.commonUniforms)h.hasUniform(e)&&(n.assert(-1===this.commonUniforms[e].indexOf(h),"common uniforms of program have already been determined"),this.commonUniforms[e].push(h))};k.prototype.forgetCommonUniforms=function(h){for(var e in this.commonUniforms){var c=this.commonUniforms[e],b=c.indexOf(h);-1<b&&(c[b]=c[c.length-1],c.pop())}};return k}()})},"esri/views/3d/webgl-engine/lib/GLMaterialRep":function(){define(["require","exports","./Util"],
function(s,q,n){var k=function(){function h(e){this.refCnt=0;this.glMaterial=e}h.prototype.incRefCnt=function(){++this.refCnt};h.prototype.decRefCnt=function(){--this.refCnt;n.assert(0<=this.refCnt)};h.prototype.getRefCnt=function(){return this.refCnt};h.prototype.getGLMaterial=function(){return this.glMaterial};return h}();return function(){function h(e,c){this.textureRep=e;this.programRep=c;this.id2glMaterialRef={}}h.prototype.aquire=function(e){return this.aquireExt(e,"color")};h.prototype.aquireDepthShadowMap=
function(e){return this.aquireExt(e,"depthShadowMap")};h.prototype.aquireDepth=function(e){return this.aquireExt(e,"depth")};h.prototype.aquireNormal=function(e){return this.aquireExt(e,"normal")};h.prototype.aquireHighlight=function(e){return this.aquireExt(e,"highlight")};h.prototype.aquireExt=function(e,c){var b;b=e.getId()+"_"+c;var g=this.id2glMaterialRef[b],f;null==g?(f=(g=e.getGLMaterials()[c])?new g(e,this.programRep,this.textureRep):void 0,g=new k(f),this.id2glMaterialRef[b]=g):f=g.getGLMaterial();
g.incRefCnt();f&&this.increaseProgramReferences(f);return f};h.prototype.release=function(e){this.releaseExt(e,"color")};h.prototype.releaseDepth=function(e){this.releaseExt(e,"depth")};h.prototype.releaseNormal=function(e){this.releaseExt(e,"normal")};h.prototype.releaseDepthShadowMap=function(e){this.releaseExt(e,"depthShadowMap")};h.prototype.releaseHighlight=function(e){this.releaseExt(e,"highlight")};h.prototype.releaseExt=function(e,c){var b=e+"_"+c,g=this.id2glMaterialRef[b];g.decRefCnt();
if(0===g.getRefCnt()){if(g=g.getGLMaterial())this.decreaseProgramReferences(g),void 0!==g.dispose&&g.dispose();delete this.id2glMaterialRef[b]}};h.prototype.updateMaterialParameters=function(e){var c=this.id2glMaterialRef[e+"_color"];c&&c.getGLMaterial()&&this.updateParamsForMat(c.getGLMaterial());(c=this.id2glMaterialRef[e+"_depth"])&&c.getGLMaterial()&&this.updateParamsForMat(c.getGLMaterial());(e=this.id2glMaterialRef[e+"_normal"])&&e.getGLMaterial()&&this.updateParamsForMat(e.getGLMaterial())};
h.prototype.updateParamsForMat=function(e){e.updateVisibility();e.updateParameters&&e.updateParameters()};h.prototype.increaseProgramReferences=function(e){if(e.getAllPrograms){e=e.getAllPrograms();for(var c=0;c<e.length;c++)this.programRep.increaseRefCount(e[c])}else this.programRep.increaseRefCount(e.getProgram())};h.prototype.decreaseProgramReferences=function(e){if(e.getAllPrograms){e=e.getAllPrograms();for(var c=0;c<e.length;c++)this.programRep.decreaseRefCount(e[c])}else this.programRep.decreaseRefCount(e.getProgram())};
return h}()})},"esri/views/3d/webgl-engine/lib/ShaderSnippets":function(){define(["require","exports","./Util","dojox/xml/parser"],function(s,q,n,k){return function(){function h(){var e=n.VertexAttrConstants,c;for(c in e)this[e[c]]=n.VertexAttrConstants[c]}h.prototype._parse=function(e){e=k.parse(e).getElementsByTagName("snippet");for(var c=/\$[a-zA-Z0-9]+[ \t]*/,b=/[\$\s]+/g,g=0;g<e.length;g++){var f=e[g].getAttribute("name");n.assert(null==this[f]);for(var a=e[g].textContent,h=void 0;null!==(h=
a.match(c));){var l=this[h[0].replace(b,"")];n.assert(void 0!==l);a=a.replace(h[0],l)}this[f]=a}};return h}()})},"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(s){s.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(q,n){var k=s.doc,h;n=n||"text/xml";if(q&&s.trim(q)&&"DOMParser"in s.global){h=(new DOMParser).parseFromString(q,n);k=h.documentElement;if("parsererror"==k.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==
k.namespaceURI){var e=k.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext")[0];e&&(e=e.firstChild.data);throw Error("Error parsing text "+k.firstChild.data+" \n"+e);}return h}if("ActiveXObject"in s.global){k=function(b){return"MSXML"+b+".DOMDocument"};k=["Microsoft.XMLDOM",k(6),k(4),k(3),k(2)];s.some(k,function(b){try{h=new ActiveXObject(b)}catch(c){return!1}return!0});if(q&&h&&(h.async=!1,h.loadXML(q),k=h.parseError,0!==k.errorCode))throw Error("Line: "+k.line+
"\nCol: "+k.linepos+"\nReason: "+k.reason+"\nError Code: "+k.errorCode+"\nSource: "+k.srcText);if(h)return h}else if(k.implementation&&k.implementation.createDocument){if(q&&s.trim(q)&&k.createElement){e=k.createElement("xml");e.innerHTML=q;var c=k.implementation.createDocument("foo","",null);s.forEach(e.childNodes,function(b){c.importNode(b,!0)});return c}return k.implementation.createDocument("","",null)}return null};dojox.xml.parser.textContent=function(q,n){if(1<arguments.length)return dojox.xml.parser.replaceChildren(q,
(q.ownerDocument||s.doc).createTextNode(n)),n;if(void 0!==q.textContent)return q.textContent;var k="";q&&s.forEach(q.childNodes,function(h){switch(h.nodeType){case 1:case 5:k+=dojox.xml.parser.textContent(h);break;case 3:case 2:case 4:k+=h.nodeValue}});return k};dojox.xml.parser.replaceChildren=function(q,n){var k=[];s.isIE&&s.forEach(q.childNodes,function(h){k.push(h)});dojox.xml.parser.removeChildren(q);s.forEach(k,s.destroy);s.isArray(n)?s.forEach(n,function(h){q.appendChild(h)}):q.appendChild(n)};
dojox.xml.parser.removeChildren=function(q){for(var n=q.childNodes.length;q.hasChildNodes();)q.removeChild(q.firstChild);return n};dojox.xml.parser.innerXML=function(q){return q.innerXML?q.innerXML:q.xml?q.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(q):null};return dojox.xml.parser})},"esri/views/3d/webgl-engine/lib/GLSLShaderRep":function(){define(["require","exports","./Util"],function(s,q,n){return function(){function k(){this.shaders={}}k.prototype.add=function(h,
e){n.assert(null==this.shaders[h]);this.shaders[h]=e};k.prototype.get=function(h){n.assert(void 0!==this.shaders[h]);return this.shaders[h]};return k}()})},"esri/views/3d/webgl-engine/lib/GLVBORep":function(){define(["require","exports","./Util"],function(s,q,n){return function(){function k(){this._vbos={}}k.prototype.add=function(h,e){n.assert(null==this._vbos[h]);this._vbos[h]=e};k.prototype.get=function(h){return this._vbos[h]};return k}()})},"esri/views/3d/webgl-engine/lib/TextureRenderer":function(){define("require exports ./Renderer ./GLFBO ./GLVBO ./VertexBufferLayout ./Camera ./Util ./gl-matrix ../materials/internal/TexOnlyGLMaterial".split(" "),
function(s,q,n,k,h,e,c,b,g,f){var a=g.vec3d,r=g.vec4d,l=g.mat4d;s=function(){function c(a,b,d,f,m,l){this._acquiredTextures={};this._clearColor=r.createFrom(0,0,0,0);this._id2origin={};this._gl=a;this._canvas=b;this._programRep=d;this._materialRep=f;this._textureRep=m;this._modelDirtySet=l;this._renderer=new n(d,void 0,f,m,a,!0);this._renderer.setLightingData({ambient:[1,1,1,1],diffuse:[0,0,0,0],specular:[0,0,0,0],direction:[0,-1,0]})}c.prototype.dispose=function(){for(var a in this._acquiredTextures)this._acquiredTextures[a].fbo.dispose(),
this._textureRep.release(a);this._acquiredTextures=null;this._renderer.dispose();this._renderer=null};c.prototype.addRenderGeometries=function(a){var b=this;a.forEach(function(a){null==a.origin&&(a.origin=b.getOrigin(a.center,a.bsRadius))});this._renderer.modify(a,[])};c.prototype.removeRenderGeometries=function(a){this._renderer.modify([],a)};c.prototype.updateRenderGeometries=function(a,b){var d=a.map(function(a){return{renderGeometry:a,updateType:b}});this._renderer.modify([],[],d,{})};c.prototype.updateRenderOrder=
function(a){0<Object.keys(a).length&&this._renderer.modifyRenderOrder(a)};c.prototype.setBackgroundColor=function(a){this._clearColor=a};c.prototype.isEmpty=function(){return this._renderer.isEmpty()};c.prototype.processDirtyMaterials=function(){var a=this._modelDirtySet.getDirtyMaterials();a&&this._renderer.modify([],[],[],a);this._modelDirtySet.clearDirtyMaterials()};c.prototype.draw=function(a,b){this.processDirtyMaterials();var f=a.getId(),c,g=this._gl;if(this._acquiredTextures[f])c=this._acquiredTextures[f].fbo;
else{var e=this._textureRep.aquire(f);c=new k(6408,5121,!1,9728,g,e);var h=Object.keys(this._acquiredTextures).length;this._acquiredTextures[f]={glName:e,fbo:c,idx:h}}e=b.width;h=b.height;if(c.getWidth()!==e||c.getHeight()!==h)c.setSize(e,h),g.texParameteri(3553,10241,9729),g.texParameteri(3553,10240,9729);t.near=1;t.far=1E4;c.bind();g.disable(2929);g.blendFuncSeparate(770,771,1,771);g.clearColor.apply(g,this._clearColor);g.clear(16384);this._renderer.setPixelRatio(b.pixelRatio||1);for(c=0;c<b.views.length;c++){var r=
b.views[c];t.viewport=r.viewport;l.ortho(0,r.extent[2]-r.extent[0],0,r.extent[3]-r.extent[1],t.near,t.far,t.projectionMatrix);l.identity(t.viewMatrix);l.translate(t.viewMatrix,[-r.extent[0],-r.extent[1],0]);t.setGLViewport(g);d&&this._drawTestTexture(e,h,m[this._acquiredTextures[f].idx%m.length]);this._renderer.render(t,p)}g.enable(g.DEPTH_TEST);g.blendFunc(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA);g.bindFramebuffer(g.FRAMEBUFFER,null);g.viewport(0,0,this._canvas.width,this._canvas.height)};c.prototype._drawTestTexture=
function(a,b,d){var c=this._gl;if(!this._testPatternMat){for(var m=new Uint8Array(4*a*b),g=0,p=0;p<b;p++)for(var r=0;r<a;r++){var k=Math.floor(r/10),t=Math.floor(p/10);2>k||2>t||10*k>a-20||10*t>b-20?(m[g++]=255,m[g++]=255,m[g++]=255,m[g++]=255):(m[g++]=255,m[g++]=255,m[g++]=255,k&1&&t&1?m[g++]=r&1^p&1?0:255:m[g++]=k&1^t&1?0:128)}g=c.createTexture();c.bindTexture(c.TEXTURE_2D,g);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);
c.texImage2D(c.TEXTURE_2D,0,c.RGBA,a,b,0,c.RGBA,c.UNSIGNED_BYTE,m);this._testPatternMat=new f(this._programRep,g,[1,1,1,1],!0,c.ALWAYS);this._testPatternBindParams={proj:l.identity(),view:l.identity(),nearFar:[-1,1],origin:[0,0,0]};a=new Float32Array(20);a[0]=-1;a[1]=-1;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=-1;a[7]=0;a[8]=1;a[9]=0;a[10]=-1;a[11]=1;a[12]=0;a[13]=0;a[14]=1;a[15]=1;a[16]=1;a[17]=0;a[18]=1;a[19]=1;this._quadVBO=new h(a,e.Defaults.PosTex,c)}this._testPatternMat.setColor([d[0],d[1],d[2],1]);
this._testPatternMat.bind(c,this._testPatternBindParams);this._testPatternMat.bindView(c,this._testPatternBindParams);this._quadVBO.bind();this._quadVBO.setPointers(this._testPatternMat.getProgram());c.drawArrays(c.TRIANGLE_STRIP,0,this._quadVBO.getNum());this._testPatternMat.release(c)};c.prototype.getOrigin=function(d,c){var f=0,m=10*c/1E4;1<m&&(f=Math.ceil(b.logWithBase(m,2)));var m=1E4*Math.pow(2,f),l=Math.round(d[0]/m),g=Math.round(d[1]/m),e=Math.round(d[2]/m),f=f+"_"+l+"_"+g+"_"+e,p=this._id2origin[f];
null==p&&(p={vec3:a.createFrom(l*m,g*m,e*m),id:f},this._id2origin[f]=p);return p};return c}();var d=!1,m=[[1,0.5,0.5],[0.5,0.5,1],[0.5,1,0.5]],p={get:function(){return!0}},t=new c;return s})},"esri/views/3d/webgl-engine/lib/Renderer":function(){define("require exports ./IntervalUtilities ./ModelDirtyTypesTs ./Float32ArrayList ./InstanceBufferData ./VertexBufferLayout ./Lighting ../materials/internal/SimpleGLMaterial ../materials/internal/TexOnlyGLMaterial ./GLVBO ./GLSLProgram ./LinearDepthTextureHelper ./NormalTextureHelper ./HighlightTextureHelper ./RenderPass ./RenderSlot ./RenderContext ./ExternalRendererContainer ./BitSet ./Util ./gl-matrix".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u,z,w){var C=z.assert,A=z.array2object,y=z.objectEmpty,B=z.getFirstObjectValue,D=z.setMatrixTranslation3;s=w.vec2d;q=w.vec3d;var F=w.vec4d,H=w.mat4d,N=z.VertexAttrConstants,G=H.identity();z=q.create();var O=1535,M={proj:G,view:G,nearFar:[-1,1],origin:z};z=function(){function k(a,c,f,e,p,h){this._lighting=new b;this._mat2dataMerged={};this._mat2dataInstanced={};this._renderOrder=[];this._externalRenderers=new v;this._renderContext=new x;this._framesRendered=
0;this._isRendering=!1;this._pixelRatio=1;this._threshold=O;this._needsRender=!0;this._stats=new I;this.offscreenRenderingEnabled=this.ssaoEnabled=!1;this._programRep=a;this._vboRep=c;this._materialRep=f;this._textureRep=e;this._orderedRendering=h;this._gl=p;this._selectionMaterial=new g(a,F.createFrom(0.1,0.2,0.9,0.4),p.EQUAL);this._selectionMaterialLines=new g(a,F.createFrom(0.1,0.2,0.9,0.4),p.EQUAL,p.LINES);this._renderContext.lightingData=this._lighting.get();p.enable(p.DEPTH_TEST);p.enable(p.CULL_FACE);
p.disable(p.BLEND);p.blendFunc(p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA);this._bindParameters={view:null,proj:null,viewInvTransp:null,nearFar:null,lightingData:null,viewport:null,framebufferTex:null,shadowMap:null,origin:null,pixelRatio:null,instanceParameters:null,depthFBO:null,normalFBO:null,extensions:{angleInstancedArrays:p.getExtension("ANGLE_instanced_arrays")}};this._linearDepthTextureHelper=new l(p);this._normalTextureHelper=new d(p);this._highlightTextureHelper=new m(p);this._initializeFramebufferTexture();
this._initializeQuadVBO();this._initializeIeTextureFix()}k.prototype._initializeQuadVBO=function(){this._quadVBO=new a(new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,-1,1,0,0,1,1,1,0,1,1]),c.Defaults.PosTex,this._gl)};k.prototype._initializeFramebufferTexture=function(){var a=this._gl,b=a.getContextAttributes().alpha?a.RGBA:a.RGB,d=a.createTexture();a.bindTexture(3553,d);a.texParameteri(3553,10241,9728);a.texParameteri(3553,10240,9728);a.texParameteri(3553,10242,33071);a.texParameteri(3553,10243,33071);
a.texImage2D(3553,0,6408,4,4,0,6408,5121,null);this._framebuffer={format:b,texture:d,copied:!1}};k.prototype._initializeIeTextureFix=function(){if(6408===this._framebuffer.format){for(var a=this._gl,b=new Uint8Array(64),d=0;64>d;d++)b[d]=255;this._ieFixTexture=a.createTexture();a.bindTexture(3553,this._ieFixTexture);a.texParameteri(3553,10241,9728);a.texImage2D(3553,0,6408,4,4,0,6408,5121,b);this._ieFixMaterial=new f(this._programRep,this._ieFixTexture,F.createFrom(1,1,1,1),!0,519)}};k.prototype.dispose=
function(){for(var a in this._mat2dataMerged){this._releaseMaterials(a);var b=this._mat2dataMerged[a],d;for(d in b.origin2data)b.origin2data[d].vbo.dispose()}this._mat2dataMerged=null;for(a in this._mat2dataInstanced)for(d in this._releaseMaterials(a),b=this._mat2dataInstanced[a],b.origin2data)b.origin2data[d].vbo.dispose();this._mat2dataInstanced=null;this._quadVBO.dispose();this._ieFixTexture&&(this._gl.deleteTexture(this._ieFixTexture),this._ieFixTexture=null);this._gl.deleteTexture(this._framebuffer.texture);
this._framebuffer.texture=null;this._linearDepthTextureHelper.getEnableState()&&this._linearDepthTextureHelper.disable();this._normalTextureHelper.getEnableState()&&this._normalTextureHelper.disable();this._highlightTextureHelper.getEnableState()&&this._highlightTextureHelper.setEnableState(!1)};k.prototype.setLightingData=function(a){this._lighting.set(a);this._needsRender=!0};k.prototype.getLightingData=function(){return this._lighting.get()};k.prototype.setPixelRatio=function(a){this._pixelRatio=
a;this._needsRender=!0};k.prototype.getPixelRatio=function(){return this._pixelRatio};k.prototype.addExternalRenderer=function(a,b){this._externalRenderers.addRenderer(a,b);return!0};k.prototype.removeExternalRenderer=function(a){this._externalRenderers.removeRenderer(a);return!0};k.prototype.getExternalRenderers=function(){return this._externalRenderers};k.prototype.resetNeedsRender=function(){this._needsRender=!1;this._externalRenderers.resetNeedsRender()};k.prototype.needsRender=function(){return this._needsRender||
this._externalRenderers.needsRender()};k.prototype.getCombinedStats=function(){this._stats.VBOallocatedSize=0;this._stats.VBOoptimalSize=0;this._stats.VBOusedSize=0;for(var a in this._mat2dataInstanced){var b=this._mat2dataInstanced[a],d;for(d in b.origin2data){var c=b.origin2data[d];this._stats.VBOallocatedSize+=c.buffer.getArray().length;this._stats.VBOusedSize+=c.buffer.getSize();this._stats.VBOoptimalSize+=c.optimalCount}}for(a in this._mat2dataMerged)for(d in b=this._mat2dataMerged[a],b.origin2data)c=
b.origin2data[d],this._stats.VBOallocatedSize+=c.buffer.getArray().length,this._stats.VBOusedSize+=c.buffer.getSize(),this._stats.VBOoptimalSize+=c.optimalCount;this._stats.VBOallocatedSize*=0.00390625;this._stats.VBOusedSize*=0.00390625;this._stats.VBOoptimalSize*=0.00390625;return this._stats};k.prototype.setSelectionObject=function(a,b){a?(Array.isArray(a)?this._selectionIndices=this._name2indices(A(a)):this._selectionIndices=this._name2indices(A([a])),this._selectionFaceIndexRange=void 0,null!=
b&&1===b.length&&(this._selectionFaceIndexRange=[[3*b[0][0],3*b[0][1]]])):this._selectionFaceIndexRange=this._selectionIndices=void 0;this._needsRender=!0};k.prototype.renderGeometrySlots=function(a){this._externalRenderers.render(t.INTERNAL_MATERIAL,a);this._externalRenderers.render(t.OPAQUE_TERRAIN,a);this._renderInternalSlot(t.OPAQUE_MATERIAL,a);this._externalRenderers.render(t.OPAQUE_EXTERNAL,a);this._renderInternalSlot(t.TRANSPARENT_MATERIAL,a);this._externalRenderers.render(t.TRANSPARENT_EXTERNAL,
a);this._externalRenderers.render(t.TRANSPARENT_TERRAIN,a)};k.prototype._renderHighlights=function(a,b,d,c){var f=!!c&&c.getEnableState()&&void 0!==this._selectionIndices;this._highlightTextureHelper.setEnableState(f);f&&(this._highlightTextureHelper.setupFBOs(a),this._highlightTextureHelper.prepareHighlightPass(),this.renderGeometryPass(p.MATERIAL_HIGHLIGHT,a,b,this._selectionIndices,this._selectionFaceIndexRange),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._renderInternalSlot(t.OVERLAY,this._renderContext),
this._highlightTextureHelper.finish(d),b=this._highlightTextureHelper.getHighlightFBO(),c.render(a,d,b))};k.prototype._renderUnordered=function(a,b,d,c,f,m,l){var g=this._gl;this._isRendering=!0;this._stats.reset();this._framebuffer.copied=!1;this._updateGlobalUniforms(a.projectionMatrix);this._renderContext.pass=p.MATERIAL;this._renderContext.camera=a;this._renderContext.shadowMap=d;this._renderContext.ssaoHelper=c;this._renderContext.offscreenRenderingHelper=m;this._renderContext.depth=this._linearDepthTextureHelper.getDepthFBO();
this._renderContext.normals=this._normalTextureHelper.getNormalFBO();this._renderContext.highlight=this._highlightTextureHelper.getHighlightFBO();this._renderContext.visibleContent=b;this._renderContext.filterContent=null;this._renderContext.filterFaceRange=null;this.offscreenRenderingEnabled&&m.prepareRenderPass(a);this._externalRenderers.render(t.BACKGROUND,this._renderContext);this.renderGeometrySlots(this._renderContext);this.offscreenRenderingEnabled?(this._renderContext.framebufferTex=m.getColorTexture(),
this._framebuffer.copied=!0):this._copyFramebufferToTexture(a.fullViewport);this._externalRenderers.render(t.POSTPROCESSING_ATMOSPHERE,this._renderContext);this.offscreenRenderingEnabled&&(d=a.viewport,d=H.ortho(d[0],d[2],d[1],d[3],-1,1),m.drawQuad(d));g.clear(g.DEPTH_BUFFER_BIT);this._renderInternalSlot(t.OVERLAY,this._renderContext);this._renderHighlights(a,b,f,l);g.bindBuffer(g.ARRAY_BUFFER,null);r.unuse(g);this._ieFixMaterial&&!f&&(g.blendFuncSeparate(g.ZERO,g.ONE,g.ONE,g.ZERO),this._ieFixMaterial.bind(g,
M),this._ieFixMaterial.bindView(g,M),this._quadVBO.bind(),this._quadVBO.setPointers(this._ieFixMaterial.getProgram()),g.drawArrays(g.TRIANGLE_STRIP,0,this._quadVBO.getNum()),this._ieFixMaterial.release(g),g.blendFunc(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA));this._framesRendered++;this._isRendering=!1};k.prototype._renderOrdered=function(a,b){this._isRendering=!0;this._stats.reset();this._framebuffer.copied=!1;this._updateGlobalUniforms(a.projectionMatrix);this._bindParameters.view=a.viewMatrix;this._bindParameters.proj=
a.projectionMatrix;this._bindParameters.viewInvTransp=a.viewInverseTransposeMatrix;V[0]=a.near;V[1]=a.far;this._bindParameters.nearFar=V;this._bindParameters.lightingData=this._lighting.get();this._bindParameters.viewport=a.fullViewport;this._bindParameters.framebufferTex=this._framebuffer.texture;this._bindParameters.pixelRatio=this._pixelRatio;this._bindParameters.instanceParameters=void 0;this._bindParameters.depthFBO=this._linearDepthTextureHelper.getDepthFBO();this._bindParameters.normalFBO=
this._normalTextureHelper.getNormalFBO();for(var d=!0,c=0;c<this._renderOrder.length;c++){var f=this._renderOrder[c][1];if(f.instanced){var m=f.instanced,l=m[p.MATERIAL];if(l&&(!l.isVisible||l.isVisible()))this._renderInternalInstanced(m,l,this._bindParameters,Infinity,b,null,null,!1),d=!0}if(f.merged&&(m=f.merged,(l=m[p.MATERIAL])&&(!l.isVisible||l.isVisible())))d&&(d=l.getProgram(),d.use(),d.uniformMatrix4fv("model",G),d.hasUniform("modelNormal")&&d.uniformMatrix4fv("modelNormal",G),d=!1),this._renderInternalMerged(m,
l,this._bindParameters,Infinity)}c=this._gl;c.bindBuffer(c.ARRAY_BUFFER,null);r.unuse(c);this._framesRendered++;this._isRendering=!1};k.prototype.render=function(a,b,d,c,f,m,l){this._orderedRendering?this._renderOrdered(a,b):this._renderUnordered(a,b,d,c,f,l,m)};k.prototype.renderAuxiliaryBuffers=function(a,b,d,c,f,m,l){l=this.ssaoEnabled||this._externalRenderers.needsDepthMap();this._linearDepthTextureHelper.setEnableState(l);l&&(this._linearDepthTextureHelper.setupFBOs(a),this._linearDepthTextureHelper.prepareDepthPass(),
this.renderGeometryPass(p.MATERIAL_DEPTH,a,b,void 0,void 0,d,c),this._linearDepthTextureHelper.finish(m));this._normalTextureHelper.setEnableState(this.ssaoEnabled);this.ssaoEnabled&&(this._normalTextureHelper.setupFBOs(a),this._normalTextureHelper.prepareNormalPass(),this.renderGeometryPass(p.MATERIAL_NORMAL,a,b,void 0,void 0,d,c),this._normalTextureHelper.finish(m));this.ssaoEnabled&&c.computeSSAO(a,m,f,this._linearDepthTextureHelper.getDepthFBO(),this._normalTextureHelper.getNormalFBO());c.bindAll(this._programRep)};
k.prototype.renderGeometryPass=function(a,b,d,c,f,m,l){this._isRendering=!0;this._updateGlobalUniforms(b.projectionMatrix);this._renderContext.pass=a;this._renderContext.camera=b;this._renderContext.shadowMap=m;this._renderContext.ssaoHelper=l;this._renderContext.depth=this._linearDepthTextureHelper.getDepthFBO();this._renderContext.normals=this._normalTextureHelper.getNormalFBO();this._renderContext.visibleContent=d;this._renderContext.filterContent=c;this._renderContext.filterFaceRange=f;this.renderGeometrySlots(this._renderContext);
this._isRendering=!1};k.prototype.renderSelection=function(a){this._isRendering=!0;for(var b=0;b<t.MAX_SLOTS;++b)this._renderInternalSlot(b,a);this._isRendering=!1};k.prototype._copyFramebufferToTexture=function(a){var b=this._gl;b.bindTexture(b.TEXTURE_2D,this._framebuffer.texture);b.copyTexImage2D(b.TEXTURE_2D,0,this._framebuffer.format,a[0],a[1],a[2],a[3],0);this._renderContext.framebufferTex=this._framebuffer.texture;this._framebuffer.copied=!0};k.prototype._renderInternalSlot=function(a,b){this._bindParameters.view=
b.camera.viewMatrix;this._bindParameters.proj=b.camera.projectionMatrix;this._bindParameters.viewInvTransp=b.camera.viewInverseTransposeMatrix;V[0]=b.camera.near;V[1]=b.camera.far;this._bindParameters.nearFar=V;this._bindParameters.lightingData=this._lighting.get();this._bindParameters.viewport=b.camera.fullViewport;this._bindParameters.framebufferTex=this.offscreenRenderingEnabled?this._renderContext.offscreenRenderingHelper.getColorTexture():this._framebuffer.texture;this._bindParameters.shadowMap=
b.shadowMap;this._bindParameters.pixelRatio=this._pixelRatio;this._bindParameters.instanceParameters=void 0;this._bindParameters.depthFBO=this._linearDepthTextureHelper.getDepthFBO();for(var d in this._mat2dataInstanced){var c=this._mat2dataInstanced[d],f=c[b.pass];f&&(f.beginSlot(a)&&(!f.isVisible||f.isVisible()))&&this._renderInternalInstanced(c,f,this._bindParameters,a,b.visibleContent,b.filterContent,b.filterFaceRange,!1)}if(b.filterContent)for(d in this._mat2dataMerged)c=this._mat2dataMerged[d],
(f=c[b.pass])&&(f.beginSlot(a)&&(!f.isVisible||f.isVisible()))&&this._renderInternalInstanced(c,f,this._bindParameters,a,null,b.filterContent,b.filterFaceRange,!0);else{for(var c=this._programRep.getProgramsUsingUniform("model"),f=this._programRep.getProgramsUsingUniform("modelNormal"),m=0;m<c.length;m++){var l=c[m];l.use();l.uniformMatrix4fv("model",G);-1<f.indexOf(l)&&l.uniformMatrix4fv("modelNormal",G)}for(d in this._mat2dataMerged)c=this._mat2dataMerged[d],(f=c[b.pass])&&(f.beginSlot(a)&&(!f.isVisible||
f.isVisible()))&&this._renderInternalMerged(c,f,this._bindParameters,a)}};k.prototype._renderInternalInstanced=function(a,b,d,c,f,m,l,g){c=this._gl;var e=!1,p=b.getDrawMode(c),h=this._bindParameters.extensions.angleInstancedArrays,r;for(r in a.origin2data){var k=a.origin2data[r];d.origin=k.origin;var B=!1;if(b.instanced)for(var t in k.perGeometryDataInfo){var u=k.perGeometryDataInfo[t];e||(b.bind(c,d),e=!0);B||(k.vbo.bind(),k.vbo.setPointers(b.getProgram()),b.bindView(c,d),B=!0);u.instanceBuffer.bind();
u.instanceBuffer.setPointers(b.getProgram());var n=u.to-u.from,A=u.refCount;p===c.TRIANGLES&&(this._stats.trianglesRendered+=A*n/3);h.drawArraysInstancedANGLE(p,u.from,n,A);this._stats.drawCallsAngleInstanced++;this._stats.instancesDrawnAngle+=A}else{var u=k.instances,D;for(D in u){var n=u[D],A=n.idx,x=n.displayedIndexRange;l&&(x=l);if(!(x&&0===x.length)&&!(f&&!f.get(A)||m&&!m.get(A)))e||(b.bind(c,d),e=!0),B||(k.vbo.bind(),k.vbo.setPointers(b.getProgram()),b.bindView(c,d),B=!0),g||b.bindInstance(c,
n),this._stats.drawCallsInstanced++,p===c.TRIANGLES&&(this._stats.trianglesRendered+=(n.to-n.from)/3),x?this._drawArraysFaceRange(x,n.from,p):c.drawArrays(p,n.from,n.to-n.from)}}}e&&b.release(c,d)};k.prototype._drawArraysFaceRange=function(a,b,d){for(var c=this._gl,f=0;f<a.length;f++){var m=a[f];c.drawArrays(d,m[0]+b,m[1]-m[0]+1)}this._stats.drawCallsFragmented+=a.length-1};k.prototype._renderInternalMerged=function(a,b,d,c){c=this._gl;var f=!1,m;for(m in a.origin2data){var l=a.origin2data[m];d.origin=
l.origin;if(!(l.displayedIndexRange&&0===l.displayedIndexRange.length)){f||(b.bind(c,d),f=!0);l.vbo.bind();l.vbo.setPointers(b.getProgram());b.bindView(c,d);this._stats.drawCallsMerged++;var g=b.getDrawMode(c);g===c.TRIANGLES&&(this._stats.trianglesRendered+=l.vbo.getNum()/3);l.displayedIndexRange?this._drawArraysFaceRange(l.displayedIndexRange,0,g):c.drawArrays(g,0,l.vbo.getNum())}}f&&b.release(c,d)};k.prototype._updateGlobalUniforms=function(a){for(var b=this._programRep.getProgramsUsingUniform("proj"),
d=0;d<b.length;d++)b[d].uniformMatrix4fv("proj",a);if(this._lighting){b=this._programRep.getProgramsUsingUniform("lightDirection");for(d=0;d<b.length;d++)this._lighting.setUniforms(b[d])}};k.prototype.print=function(){var a=Object.keys(this._mat2dataMerged).length,b=Object.keys(this._mat2dataInstanced).length;console.log("number of materials (merged/instanced): "+a+"/"+b);var a=0,d;for(d in this._mat2dataMerged){var b=this._mat2dataMerged[d],c;for(c in b.origin2data)a+=Object.keys(b.origin2data[c].instances).length}var f=
0;for(d in this._mat2dataInstanced)for(c in b=this._mat2dataInstanced[d],b.origin2data)f+=Object.keys(b.origin2data[c].instances).length;console.log("number of instances (merged/instanced): "+a+"/"+f)};k.prototype.isEmpty=function(){for(var a in this._mat2dataInstanced){var b=this._mat2dataInstanced[a],d;for(d in b.origin2data)if(!y(b.origin2data[d].instances))return!1}for(a in this._mat2dataMerged)for(d in b=this._mat2dataMerged[a],b.origin2data)if(!y(b.origin2data[d].instances))return!1;return!0};
k.prototype.modify=function(a,b,d,c){this._isRendering&&console.warn("Renderer.modify called while rendering");var f=[],m=[];this._mergedOrInstanced(a,f,m);a=[];var l=[];this._mergedOrInstanced(b,a,l);b={};d&&this._performUpdates(d,b);d=[];this._modifyMerged(f,a,d,b);this._modifyInstanced(m,l,d);this._updateMergedFaceranges(b);this._releaseMaterials(d);this._modifyMaterials(c);this._needsRender=!0};k.prototype._isInstanced=function(a){var b=!1,d=B(a.data.faces.indices).length,b=(b=(b=b||!1===a.material.canBeMerged)||
a.material.instanced)||a.material.isBackdrop;return a.singleUse?b:b=b||d>this._threshold};k.prototype._mergedOrInstanced=function(a,b,d){for(var c=0;c<a.length;++c)1>B(a[c].data.faces.indices).length||(this._isInstanced(a[c])?d.push(a[c]):b.push(a[c]))};k.prototype._performUpdates=function(a,b){for(var d=0;d<a.length;d++){var c=a[d],f=c.renderGeometry,m=this._isInstanced(f),c=c.updateType;c&2&&this._updateFaceranges(f,m,b);c&4||!m&&c&16?this._updateVertexAttributes(f,m):m&&c&16?this._updateInstanceTransformation(f,
m):c&8&&this._updateColorAttributes(f)}};k.prototype._updateFaceranges=function(a,b,d){var c=a.material.getId(),f=a.origin.id,m=(b?this._mat2dataInstanced:this._mat2dataMerged)[c].origin2data[f],l=m.instances[a.uniqueName];l&&(l.displayedIndexRange=a.displayedIndexRange,b||(d[this._modifiedMergedFacerangesKey(c,f)]=m))};k.prototype._updateMergedFaceranges=function(a){for(var b in a){var d=a[b];d.displayedIndexRange=[];var c=d.instances,f=!0,m;for(m in c){var l=c[m];l.displayedIndexRange?(d.displayedIndexRange.push.apply(d.displayedIndexRange,
n.offsetIntervals(l.displayedIndexRange,l.from)),f=!1):d.displayedIndexRange.push([l.from,l.to-1])}d.displayedIndexRange=f?null:n.mergeIntervals(d.displayedIndexRange)}};k.prototype._updateVertexAttributes=function(a,b){var d=a.material,c=d.getId(),c=(b?this._mat2dataInstanced:this._mat2dataMerged)[c].origin2data[a.origin.id],f=c.instances[a.uniqueName],m,l;b||(m=a.origin.vec3,D(L,-m[0],-m[1],-m[2]),H.multiply(L,a.transformation,Y),H.inverse(Y,E),H.transpose(E),m=Y,l=E);var g=d.getVertexBufferLayout().getStride();
C(f.from+d.getOutputAmount(B(a.data.faces.indices).length)/g===f.to,"material VBO layout has changed");d.fillInterleaved(a.data,m,l,a.instanceParameters,c.buffer.getArray(),f.from*g);c.vbo.updateSubData(c.buffer.getArray(),f.from*g,f.to*g)};k.prototype._updateInstanceTransformation=function(a,b){var d=a.origin.vec3,c=(b?this._mat2dataInstanced:this._mat2dataMerged)[a.material.getId()].origin2data[a.origin.id],f=c.instances[a.uniqueName];D(L,-d[0],-d[1],-d[2]);H.multiply(L,a.transformation,f.transformation);
H.inverse(f.transformation,f.transformationNormal);H.transpose(f.transformationNormal,f.transformationNormal);d=c.perGeometryDataInfo[a.data.id];if(c=d.instanceBufferData){var m=c.getSlot(a.idx);c.fill(m,0,f.transformation);c.fill(m,16,f.transformationNormal);f=c.getOffset(m);d.instanceBuffer.updateSubData(c.getArray(),f,f+32)}};k.prototype._updateColorAttributes=function(a){var b=a.material,d=b.getId(),c=a.origin.id,d=(this._isInstanced(a)?this._mat2dataInstanced:this._mat2dataMerged)[d].origin2data[c],
c=d.instances[a.uniqueName],f={};f[N.COLOR]=!0;var m=b.getVertexBufferLayout().getStride();C(c.from+b.getOutputAmount(B(a.data.faces.indices).length)/m===c.to,"material VBO layout has changed");b.fillInterleaved(a.data,void 0,void 0,a.instanceParameters,d.buffer.getArray(),c.from*m,f);d.vbo.updateSubData(d.buffer.getArray(),c.from*m,c.to*m)};k.prototype._modifyMerged=function(b,d,c,f){b=this._compMat2delta(b,d,!1);for(var m in b){d=b[m];for(var l in d){var g=d[l],e=g.optimalCount,r=g.material,k=r.getVertexBufferLayout(),
t=k.getStride(),u=this._mat2dataMerged[m];if(null==u){C(0<e);var n=r.getRenderPriority(),u={origin2data:{}};u[p.MATERIAL]=this._materialRep.aquire(r);u[p.MATERIAL_DEPTH_SHADOWMAP]=this._materialRep.aquireDepthShadowMap(r);u[p.MATERIAL_NORMAL]=this._materialRep.aquireNormal(r);u[p.MATERIAL_DEPTH]=this._materialRep.aquireDepth(r);u[p.MATERIAL_HIGHLIGHT]=this._materialRep.aquireHighlight(r);this._mat2dataMerged[m]=u;this._orderedRendering&&this._insertIntoRenderOrder(u,n,"merged")}n=u.origin2data[l];
null==n&&(C(0<e),n={instances:{},vbo:new a(void 0,k,this._gl),buffer:new h(e),optimalCount:0,origin:g.origin},u.origin2data[l]=n);if(0<e){var k=n.buffer.getSize(),A=n.buffer.getArray(),u=e<g.sparseCount/2,x=n.buffer.resize(u?e:g.sparseCount),F=g.toRemove;if(u||x){for(var k=0,y=n.buffer.getArray(),u=0,w=F.length;u<w;++u)x=n.instances[F[u].uniqueName],n.optimalCount-=(x.to-x.from)*t,delete n.instances[F[u].uniqueName];var u={},z;for(z in n.instances)x=n.instances[z],C(null==u[x.from]),u[x.from]=x;for(var v in u){var x=
u[v],w=x.from*t,G=x.to*t;y.set(A.subarray(w,G),k);x.from=k/t;k+=G-w;x.to=k/t}C(k===n.optimalCount)}else{u=0;for(x=F.length;u<x;++u)A=F[u].uniqueName,C(void 0!==n.instances[A]),w=n.instances[A].from*t,G=n.instances[A].to*t,n.buffer.erase(w,G),delete n.instances[A],n.optimalCount-=G-w}D(L,-g.origin[0],-g.origin[1],-g.origin[2]);g=g.toAdd;F=!1;u=0;for(A=g.length;u<A;++u)w=g[u],G=w.data,H.multiply(L,w.transformation,Y),H.inverse(Y,E),H.transpose(E),x=k,r.fillInterleaved(G,Y,E,w.instanceParameters,n.buffer.getArray(),
k),G=r.getOutputAmount(B(G.faces.indices).length),y=x+G,C(null==n.instances[w.uniqueName]),x=new Z(w.name,x/t,y/t,w.displayedIndexRange,void 0,void 0,w.idx),w.displayedIndexRange&&(F=!0),n.instances[w.uniqueName]=x,n.optimalCount+=G,k+=G;C(n.optimalCount===e);n.vbo.setData(n.buffer.getArray(),n.buffer.getSize());if(F||n.displayedIndexRange)f[this._modifiedMergedFacerangesKey(m,l)]=n}else C(0===e),n.vbo.dispose(),delete u.origin2data[l],0===Object.keys(u.origin2data).length&&(c.push(m),delete this._mat2dataMerged[m],
this._orderedRendering&&this._removeFromRenderOrder(u,"merged"))}}};k.prototype._modifyInstanced=function(b,d,c){b=this._compMat2delta(b,d,!0);for(var f in b){d=b[f];for(var m in d){var l=d[m];if(0===l.optimalCount)l=this._mat2dataInstanced[f],l.origin2data[m].vbo.dispose(),delete l.origin2data[m],0===Object.keys(l.origin2data).length&&(c.push(f),delete this._mat2dataInstanced[f],this._orderedRendering&&this._removeFromRenderOrder(l,"instanced"));else{var g=l.material,r=this._mat2dataInstanced[f];
if(null==r){var k=g.getRenderPriority(),r={origin2data:{}};r[p.MATERIAL]=this._materialRep.aquire(g);r[p.MATERIAL_DEPTH_SHADOWMAP]=this._materialRep.aquireDepthShadowMap(g);r[p.MATERIAL_NORMAL]=this._materialRep.aquireNormal(g);r[p.MATERIAL_DEPTH]=this._materialRep.aquireDepth(g);r[p.MATERIAL_HIGHLIGHT]=this._materialRep.aquireHighlight(g);this._mat2dataInstanced[f]=r;this._orderedRendering&&this._insertIntoRenderOrder(r,k,"instanced")}var t=g.getVertexBufferLayout(),u=r[p.MATERIAL].instanced?g.getInstanceBufferLayout():
null,n=u&&u.hasAttribute("instanceColor"),A=t.getStride(),k=r.origin2data[m];null==k&&(k={instances:{},vbo:new a(void 0,t,this._gl),buffer:new h(l.optimalCount),optimalCount:0,perGeometryDataInfo:{},origin:l.origin},r.origin2data[m]=k);var r=k.buffer.getSize(),x=k.buffer.getArray(),F=l.optimalCount<l.sparseCount/2,y=k.buffer.resize(F?l.optimalCount:l.sparseCount),w;for(w in l.perGeometryDelta)if((t=k.perGeometryDataInfo[w])&&t.instanceBufferData){var z=l.perGeometryDelta[w].removeCount;0<z&&t.instanceBufferData.prepareFree(z)}var v=
l.toRemove;if(F||y){F=0;for(r=v.length;F<r;++F){y=v[F];delete k.instances[y.uniqueName];w=y.data.id;var G=t=k.perGeometryDataInfo[w];0===--G.refCount&&null==l.dataId2refCount[w]?(k.optimalCount-=(G.to-G.from)*A,delete k.perGeometryDataInfo[w]):t.instanceBufferData&&t.instanceBufferData.free(y.idx)}var r=0,F=k.buffer.getArray(),y={},q;for(q in k.perGeometryDataInfo)G=k.perGeometryDataInfo[q],C(null==y[G.from]),y[G.from]=G;for(name in y)G=y[name],z=G.from*A,t=G.to*A,F.set(x.subarray(z,t),r),G.from=
r/A,r+=t-z,G.to=r/A;for(name in k.instances)z=k.instances[name],z.from=k.perGeometryDataInfo[z.dataId].from,z.to=k.perGeometryDataInfo[z.dataId].to}else{F=0;for(x=v.length;F<x;++F)y=v[F],delete k.instances[y.uniqueName],w=y.data.id,t=k.perGeometryDataInfo[w],0===--t.refCount&&null==l.dataId2refCount[w]?(z=t.from*A,t=t.to*A,k.buffer.erase(z,t),k.optimalCount-=t-z,delete k.perGeometryDataInfo[w]):t.instanceBufferData&&t.instanceBufferData.free(y.idx)}D(L,-l.origin[0],-l.origin[1],-l.origin[2]);for(w in l.perGeometryDelta)if((t=
k.perGeometryDataInfo[w])&&t.instanceBufferData)F=l.perGeometryDelta[w].addCount,0<F&&t.instanceBufferData.prepareAllocate(F);x=l.toAdd;F=0;for(v=x.length;F<v;++F){y=x[F];z=y.data;w=z.id;t=k.perGeometryDataInfo[w];null==t?(g.fillInterleaved(z,void 0,void 0,void 0,k.buffer.getArray(),r),G=g.getOutputAmount(B(z.faces.indices).length),z=r/A,r+=G,t=r/A,k.optimalCount+=G,t={refCount:1,from:z,to:t,instanceBuffer:null,instanceBufferData:null},u&&(t.instanceBuffer=new a(void 0,u,this._gl),t.instanceBufferData=
new e(u.getStride(),l.perGeometryDelta[w].addCount)),k.perGeometryDataInfo[w]=t):++t.refCount;C(t.from*A<=k.buffer.getSize()&&t.to*A<=k.buffer.getSize());z=H.create();H.multiply(L,y.transformation,z);z=new Z(y.name,t.from,t.to,y.displayedIndexRange,z,y.instanceParameters,y.idx,w);if(t=t.instanceBufferData)G=t.allocate(y.idx),t.fill(G,0,z.transformation),t.fill(G,16,z.transformationNormal),n&&t.fill(G,32,y.instanceParameters.color);k.instances[y.uniqueName]=z}C(k.optimalCount===l.optimalCount);k.vbo.setData(k.buffer.getArray(),
k.buffer.getSize());for(w in k.perGeometryDataInfo)g=k.perGeometryDataInfo[w],g.instanceBuffer&&(u=l.perGeometryDelta[w],0<u.addCount+u.removeCount&&(u=g.instanceBufferData.compact(),g.instanceBuffer.setData(u,u.length)))}}}};k.prototype._compMat2delta=function(a,b,d){var c={};this._updateMat2delta(a,!0,d,c);this._updateMat2delta(b,!1,d,c);return c};k.prototype._updateMat2delta=function(a,b,d,c){for(var f=0,m=a.length;f<m;++f){var l=a[f],g=l.origin,e=l.material,p=e.getId(),h=d?this._mat2dataInstanced[p]:
this._mat2dataMerged[p],h=h&&h.origin2data[g.id],r=c[p];null==r&&(r={},c[p]=r);p=r[g.id];if(null==p){p={optimalCount:null==h?0:h.optimalCount,sparseCount:null==h?0:h.buffer.getSize(),material:e,toAdd:[],toRemove:[],perGeometryDelta:null,origin:g.vec3};if(d){var k={};if(void 0!==h)for(var t in h.perGeometryDataInfo)k[t]=h.perGeometryDataInfo[t].refCount;p.dataId2refCount=k;p.perGeometryDelta={}}r[g.id]=p}g=e.getOutputAmount(B(l.data.faces.indices).length);d?(e=l.data.id,h=p.perGeometryDelta[e],h||
(h={addCount:0,removeCount:0},p.perGeometryDelta[e]=h),b?(h.addCount++,null==p.dataId2refCount[e]&&(p.dataId2refCount[e]=0),1===++p.dataId2refCount[e]&&(p.optimalCount+=g,p.sparseCount+=g),p.toAdd.push(l)):(h.removeCount++,0===--p.dataId2refCount[e]&&(delete p.dataId2refCount[e],p.optimalCount-=g),p.toRemove.push(l))):b?(p.optimalCount+=g,p.sparseCount+=g,p.toAdd.push(l)):(p.optimalCount-=g,p.toRemove.push(l))}};k.prototype._modifiedMergedFacerangesKey=function(a,b){return a+"_"+b};k.prototype._insertIntoRenderOrder=
function(a,b,d){for(var c=a[p.MATERIAL].getMaterialId(),f=this._renderOrder.length,m=0;m<f&&this._renderOrder[m][0]>=b;){var l=this._renderOrder[m][1];if(l.id===c){C(!l[d],"matData for type already exists");l[d]=a;return}m++}c={id:c,instanced:null,merged:null};c[d]=a;this._renderOrder.splice(m,0,[b,c])};k.prototype._removeFromRenderOrder=function(a,b){for(var d=a[p.MATERIAL].getMaterialId(),c=0;this._renderOrder[c][1].id!==d;)c++;d=this._renderOrder[c][1];d[b]=null;!d.instanced&&!d.merged&&this._renderOrder.splice(c,
1)};k.prototype._updateRenderOrder=function(a,b){for(var d=b.length,c=0;c<d&&b[c][1].id!==a;)c++;if(c<d){var f=b[c][1],f=(f.merged||f.instanced)[p.MATERIAL].getRenderPriority(),m=b[c][0];if(f!==b[c][0]){b[c][0]=f;m=f>m?-1:1;for(c+=m;-1<c&&c<d&&m*b[c][0]>m*f;){var l=b[c];b[c]=b[c-m];b[c-m]=l;c+=m}}}};k.prototype._modifyMaterials=function(a){for(var b in a)this._materialRep.updateMaterialParameters(b)};k.prototype.modifyRenderOrder=function(a){if(this._orderedRendering){for(var b in a)this._updateRenderOrder(b,
this._renderOrder);this._needsRender=!0}};k.prototype._releaseMaterials=function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._materialRep.release(a[b]),this._materialRep.releaseDepthShadowMap(a[b]),this._materialRep.releaseNormal(a[b]),this._materialRep.releaseDepth(a[b]),this._materialRep.releaseHighlight(a[b]);else this._materialRep.release(a),this._materialRep.releaseDepthShadowMap(a),this._materialRep.releaseNormal(a),this._materialRep.releaseDepth(a),this._materialRep.releaseHighlight(a)};
k.prototype._name2indices=function(a){for(var b=new u,d=0;2>d;++d){var c=0===d?this._mat2dataMerged:this._mat2dataInstanced,f;for(f in c){var m=c[f].origin2data,l;for(l in m){var g=m[l].instances,e;for(e in g){var p=g[e];void 0!==a[p.name]&&b.set(p.idx)}}}}return b};return k}();var I=function(){function a(){this.reset()}a.prototype.reset=function(){this.VBOusedSize=this.VBOoptimalSize=this.VBOallocatedSize=this.instancesDrawnAngle=this.drawCallsFragmented=this.drawCallsMerged=this.drawCallsAngleInstanced=
this.drawCallsInstanced=this.trianglesRendered=0};return a}(),Z=function(){return function(a,b,d,c,f,m,l,g){this.name=a;this.from=b;this.to=d;this.displayedIndexRange=c;this.transformation=f;this.instanceParameters=m;this.idx=l;this.dataId=g;null!=f&&(this.transformationNormal=H.create(),H.set(f,this.transformationNormal),H.inverse(this.transformationNormal,this.transformationNormal),H.transpose(this.transformationNormal,this.transformationNormal))}}(),V=s.create(),L=H.identity(),Y=H.create(),E=H.create();
return z})},"esri/views/3d/webgl-engine/lib/IntervalUtilities":function(){define(["require","exports"],function(s,q){return function(){function n(){}n.copyIntervals=function(k){for(var h=[],e=0;e<k.length;e++){var c=k[e];h.push([c[0],c[1]])}return h};n.convertFaceToIndexRange=function(k,h){for(var e=0;e<k.length;e++){var c=k[e];c[0]*=h;c[1]=c[1]*h+(h-1)}};n.sortIntervals=function(k){return k.sort(function(h,e){return h[0]===e[0]?h[1]>e[1]?1:h[1]<e[1]?-1:0:h[0]>e[0]?1:h[0]<e[0]?-1:0})};n.intersectIntervals=
function(k,h){if(0>=k.length)return[];for(var e=[],c=0;c<k.length;c++){var b=k[c];b[1]<h[0]||b[0]>h[1]||(b=[b[0],b[1]],b[0]<h[0]&&(b[0]=h[0]),b[1]>h[1]&&(b[1]=h[1]),e.push(b))}return e};n.mergeIntervals=function(k){if(0>=k.length)return[];var h=[];k=this.sortIntervals(k);h.push(k[0]);for(var e=1;e<k.length;e++){var c=h[h.length-1];c[1]+1<k[e][0]?h.push(k[e]):c[1]<k[e][1]&&(c[1]=k[e][1],h.pop(),h.push(c))}return h};n.invertIntervals=function(k,h){for(var e=[],c=0,b=0;b<k.length;b++){var g=k[b];g[0]>
c&&e.push([c,g[0]-1]);c=g[1]+1}c<=h&&e.push([c,h]);return e};n.offsetIntervals=function(k,h){for(var e=[],c=0;c<k.length;c++){var b=k[c];e.push([b[0]+h,b[1]+h])}return e};return n}()})},"esri/views/3d/webgl-engine/lib/Float32ArrayList":function(){define(["require","exports","./Util"],function(s,q,n){return function(){function k(h){null==h?h=16:65536>h&&(h=n.nextHighestPowerOfTwo(h));this.array=new Float32Array(h);this.size=0}k.prototype.resize=function(h,e){void 0===e&&(e=!1);this.size=h;var c,b;
if(this.size>this.array.length){for(c=this.array.length||1;c<this.size;)c*=2;b=new Float32Array(c);e&&b.set(this.array);this.array=b;return!0}if(this.size<=this.array.length/2){c=this.array.length;for(b=2*this.size;c>=b;)c/=2;b=new Float32Array(c);e&&b.set(this.array.subarray(0,c));this.array=b;return!0}return!1};k.prototype.append=function(h){var e=this.size;this.resize(this.size+h.length,!0);this.array.set(h,e)};k.prototype.erase=function(h,e){for(var c=h;c<e;++c)this.array[c]=0};k.prototype.getArray=
function(){return this.array};k.prototype.getSize=function(){return this.size};return k}()})},"esri/views/3d/webgl-engine/lib/InstanceBufferData":function(){define(["require","exports","./Util"],function(s,q,n){return function(){function k(h,e){e=null==e?4*h:n.nextHighestPowerOfTwo(e*h);this.array=new Float32Array(e);this.zeroItem=new Float32Array(h);this.endSlot=0;this.instanceDataSize=h;this.emptySlots=[];this.emptySlotsIdx=0;this.id2slot={};this.slot2id=Array(e)}k.prototype.prepareFree=function(h){this.emptySlots.length+=
h};k.prototype.free=function(h){h=this.id2slot[h];null!=h&&(this.emptySlots[this.emptySlotsIdx++]=h,this.slot2id[h]=void 0)};k.prototype.prepareAllocate=function(h){h-=this.emptySlotsIdx;0<h&&this._resizeArray((this.endSlot+h)*this.instanceDataSize)};k.prototype.allocate=function(h){var e;e=0<this.emptySlotsIdx?this.emptySlots[--this.emptySlotsIdx]:this.endSlot++;this.id2slot[h]=e;this.slot2id[e]=h;return e};k.prototype.getSlot=function(h){return this.id2slot[h]};k.prototype.getOffset=function(h){return h*
this.instanceDataSize};k.prototype.getArray=function(){return this.array};k.prototype.fill=function(h,e,c){this.array.set(c,h*this.instanceDataSize+e)};k.prototype.compact=function(){if(0<this.emptySlotsIdx){this.emptySlots.length=this.emptySlotsIdx;for(this.emptySlots.sort(function(b,c){return b-c});0<this.emptySlotsIdx&&this.emptySlots[this.emptySlotsIdx-1]===this.endSlot;)this.emptySlotsIdx--,this.endSlot--;for(;0<this.emptySlotsIdx;){this.emptySlotsIdx--;var h=this.endSlot-1,e=this.emptySlots[this.emptySlotsIdx],
c=h*this.instanceDataSize,b=e*this.instanceDataSize;this.array.set(this.array.subarray(c,c+this.instanceDataSize),b);this.array.set(this.zeroItem,c);c=this.slot2id[h];this.slot2id[h]=void 0;this.slot2id[e]=c;this.id2slot[c]=e;this.endSlot--}}this._resizeArray(this.endSlot*this.instanceDataSize);this.emptySlots.length=0;return this.array};k.prototype._resizeArray=function(h){var e;if(h>this.array.length){for(e=this.array.length||1;e<h;)e*=2;h=new Float32Array(e);h.set(this.array);this.array=h}else if(h<=
this.array.length/2){e=this.array.length;for(h*=2;e>=h;)e/=2;h=new Float32Array(e);h.set(this.array.subarray(0,e));this.array=h}};return k}()})},"esri/views/3d/webgl-engine/lib/Lighting":function(){define(["require","exports","./gl-matrix"],function(s,q,n){var k=n.vec3d,h=n.vec4d;return function(){function e(c,b,g,f){this.ambient=h.create(c);this.diffuse=h.create(b);this.specular=h.create(g);this.direction=k.create(f)}e.prototype.setUniforms=function(c){c.uniform4fv("lightAmbient",this.ambient);c.uniform4fv("lightDiffuse",
this.diffuse);c.uniform4fv("lightSpecular",this.specular);c.uniform3fv("lightDirection",this.direction)};e.prototype.set=function(c){c.ambient&&h.set(c.ambient,this.ambient);c.diffuse&&h.set(c.diffuse,this.diffuse);c.specular&&h.set(c.specular,this.specular);c.direction&&k.set(c.direction,this.direction)};e.prototype.get=function(){return{ambient:this.ambient,diffuse:this.diffuse,specular:this.specular,direction:this.direction}};return e}()})},"esri/views/3d/webgl-engine/materials/internal/SimpleGLMaterial":function(){define("require exports dojo/text!./SimpleGLMaterial.xml ./MaterialUtil ../../lib/GLSLProgram ../../lib/GLSLShader ../../lib/RenderSlot".split(" "),
function(s,q,n,k,h,e,c){var b=k.Layouts.Pos;return function(){function g(b,a,c,l){void 0===l&&(l=4);this.id=k.__GLMaterial_id++;this.program=b.get("simple");this.color=a;this.depthFunc=c;this.drawMode=l}g.prototype.getId=function(){return this.id};g.prototype.beginSlot=function(b){return b===c.INTERNAL_MATERIAL};g.prototype.getProgram=function(){return this.program};g.prototype.bind=function(c,a){this.program.use();this.program.uniformMatrix4fv("model",k.IDENTITY);this.program.uniformMatrix4fv("proj",
a.proj);this.program.uniform4fv("color",this.color);b.enableVertexAttribArrays(c,this.program,void 0);c.enable(c.BLEND);void 0!==this.depthFunc&&c.depthFunc(this.depthFunc)};g.prototype.release=function(c){void 0!==this.depthFunc&&c.depthFunc(c.LESS);c.disable(c.BLEND);b.disableVertexAttribArrays(c,this.program,void 0)};g.prototype.bindView=function(b,a){k.bindView(a.origin,a.view,this.program)};g.prototype.bindInstance=function(b,a){this.program.uniformMatrix4fv("model",a.transformation)};g.prototype.getDrawMode=
function(b){return this.drawMode};g.loadShaders=function(b,a,c,l){b._parse(n);a=new e(l.VERTEX_SHADER,b.vertexShaderSimple,l,void 0);b=new e(l.FRAGMENT_SHADER,b.fragmentShaderSimple,l,void 0);l=new h([a,b],l);c.add("simple",l)};return g}()})},"esri/views/3d/webgl-engine/materials/internal/TexOnlyGLMaterial":function(){define("require exports dojo/text!./TexOnlyGLMaterial.xml ./MaterialUtil ../../lib/GLSLProgram ../../lib/GLSLShader ../../lib/RenderSlot ../../lib/gl-matrix".split(" "),function(s,q,
n,k,h,e,c,b){var g=k.Layouts.PosTex,f=b.vec4d.createFrom(1,1,1,1);return function(){function a(a,b,d,c,f){this.id=k.__GLMaterial_id++;this.program=a.get("texOnly");this.color=d;this.depthFunc=f;this.blend=c;this.texGLName=b}a.prototype.getId=function(){return this.id};a.prototype.beginSlot=function(a){return a===c.INTERNAL_MATERIAL};a.prototype.getProgram=function(){return this.program};a.prototype.setColor=function(a){this.color=a};a.prototype.bind=function(a,b){this.program.use();this.program.uniformMatrix4fv("model",
k.IDENTITY);this.program.uniformMatrix4fv("proj",b.proj);this.program.uniform4fv("color",void 0!==this.color?this.color:f);this.program.uniform1i("tex",0);a.bindTexture(a.TEXTURE_2D,this.texGLName);g.enableVertexAttribArrays(a,this.program,void 0);this.blend&&a.enable(a.BLEND);void 0!==this.depthFunc&&a.depthFunc(this.depthFunc)};a.prototype.release=function(a){void 0!==this.depthFunc&&a.depthFunc(a.LESS);this.blend&&a.disable(a.BLEND);g.disableVertexAttribArrays(a,this.program,void 0)};a.prototype.bindView=
function(a,b){k.bindView(b.origin,b.view,this.program)};a.prototype.bindInstance=function(a,b){this.program.uniformMatrix4fv("model",b.transformation)};a.prototype.getDrawMode=function(a){return a.TRIANGLES};a.loadShaders=function(a,b,d,c){a._parse(n);var f=new e(c.VERTEX_SHADER,a.vertexShaderTexOnly,c,void 0);a=new e(c.FRAGMENT_SHADER,a.fragmentShaderTexOnly,c,void 0);c=new h([f,a],c);d.add("texOnly",c);b.add("vertexShaderTexOnly",f);b.add("fragmentShaderTexOnly",a)};return a}()})},"esri/views/3d/webgl-engine/lib/LinearDepthTextureHelper":function(){define(["require",
"exports","./GLFBO","./Util"],function(s,q,n,k){return function(){function h(e){this.gl=e;this.depthFBO=void 0;this.height=this.width=this.viewportToRestore=null}h.prototype.setEnableState=function(e){e!==this.getEnableState()&&(e?this.enable():this.disable())};h.prototype.getEnableState=function(){return void 0!==this.depthFBO};h.prototype.getDepthFBO=function(){return this.depthFBO};h.prototype.enable=function(){k.assert(!this.getEnableState());var e=this.gl;this.depthFBO=new n(e.RGBA,e.UNSIGNED_BYTE,
!0,e.NEAREST,e,void 0)};h.prototype.disable=function(){k.assert(this.getEnableState());this.depthFBO.dispose();this.depthFBO=void 0};h.prototype.setupFBOs=function(e){k.assert(this.getEnableState());this.viewportToRestore=e=e.fullViewport;this.width=e[2];this.height=e[3];this.gl.viewport(0,0,this.width,this.height)};h.prototype.prepareDepthPass=function(){k.assert(this.getEnableState());var e=this.gl;this.depthFBO.setSize(this.width,this.height);this.depthFBO.bind();e.clearColor(0,0,0,0);e.clear(e.COLOR_BUFFER_BIT|
e.DEPTH_BUFFER_BIT)};h.prototype.finish=function(e){var c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,e);c.viewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])};return h}()})},"esri/views/3d/webgl-engine/lib/GLFBO":function(){define(["require","exports","./GLUtil"],function(s,q,n){return function(){function k(h,e,c,b,g,f,a){this.frameBuffer=g.createFramebuffer();this.texture=f||g.createTexture();this.renderBuffer=c?g.createRenderbuffer():void 0;
this.depthTexture=a?g.createTexture():void 0;this.dimJ=this.dimI=0;this.gl=g;this.format=h;this.type=e;this.texFilter=b;this._initTexture(this.texture);a&&this._initTexture(this.depthTexture)}k.prototype._initTexture=function(h){var e=this.gl;e.bindTexture(e.TEXTURE_2D,h);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this.texFilter);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this.texFilter);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,
e.CLAMP_TO_EDGE);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,4,4,0,e.RGBA,e.UNSIGNED_BYTE,null)};k.prototype.dispose=function(){var h=this.gl;h.deleteFramebuffer(this.frameBuffer);h.deleteTexture(this.texture);void 0!==this.renderBuffer&&h.deleteRenderbuffer(this.renderBuffer)};k.prototype.setSize=function(h,e){if(!(h===this.dimI&&e===this.dimJ)){this.dimI=h;this.dimJ=e;var c=this.gl;c.bindTexture(c.TEXTURE_2D,this.texture);c.texImage2D(c.TEXTURE_2D,0,this.format,this.dimI,this.dimJ,0,this.format,this.type,
null);void 0!==this.renderBuffer?(c.bindRenderbuffer(c.RENDERBUFFER,this.renderBuffer),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,this.dimI,this.dimJ)):void 0!==this.depthTexture&&(c.bindTexture(c.TEXTURE_2D,this.depthTexture),c.texImage2D(c.TEXTURE_2D,0,c.DEPTH_STENCIL,this.dimI,this.dimJ,0,c.DEPTH_STENCIL,34042,null));c.bindFramebuffer(c.FRAMEBUFFER,this.frameBuffer);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,this.texture,0);void 0!==this.renderBuffer?c.framebufferRenderbuffer(c.FRAMEBUFFER,
c.DEPTH_ATTACHMENT,c.RENDERBUFFER,this.renderBuffer):void 0!==this.depthTexture&&c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,this.depthTexture,0);n.checkFramebufferStatus(c.FRAMEBUFFER,c);void 0!==this.renderBuffer&&c.bindRenderbuffer(c.RENDERBUFFER,null);c.bindFramebuffer(c.FRAMEBUFFER,null)}};k.prototype.getWidth=function(){return this.dimI};k.prototype.getHeight=function(){return this.dimJ};k.prototype.bind=function(){var h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,
this.frameBuffer)};k.prototype.getVirtualDepthFBO=function(){var h=this.depthTexture,e=this.dimI,c=this.dimJ;return{getWidth:function(){return e},getHeight:function(){return c},getTexture:function(){return h}}};k.prototype.getTexture=function(){return this.texture};k.prototype.getGLName=function(){return this.frameBuffer};return k}()})},"esri/views/3d/webgl-engine/lib/NormalTextureHelper":function(){define(["require","exports","./GLFBO","./Util"],function(s,q,n,k){return function(){function h(e){this.gl=
e;this.normalFBO=void 0;this.height=this.width=this.viewportToRestore=null}h.prototype.setEnableState=function(e){e!==this.getEnableState()&&(e?this.enable():this.disable())};h.prototype.getEnableState=function(){return void 0!==this.normalFBO};h.prototype.getNormalFBO=function(){return this.normalFBO};h.prototype.enable=function(){k.assert(!this.getEnableState());var e=this.gl;this.normalFBO=new n(e.RGBA,e.UNSIGNED_BYTE,!0,this.gl.NEAREST,e,void 0)};h.prototype.disable=function(){k.assert(this.getEnableState());
this.normalFBO.dispose();this.normalFBO=void 0};h.prototype.setupFBOs=function(e){k.assert(this.getEnableState());this.viewportToRestore=e=e.viewport;this.width=e[2];this.height=e[3];this.gl.viewport(0,0,this.width,this.height)};h.prototype.prepareNormalPass=function(){k.assert(this.getEnableState());var e=this.gl;this.normalFBO.setSize(this.width,this.height);this.normalFBO.bind();e.clearColor(0,0,0,0);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)};h.prototype.finish=function(e){var c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,
e);c.viewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])};return h}()})},"esri/views/3d/webgl-engine/lib/HighlightTextureHelper":function(){define(["require","exports","./GLFBO","./Util"],function(s,q,n,k){return function(){function h(e){this.gl=e;this.height=this.width=this.viewportToRestore=this.fbo2=this.fbo=null}h.prototype.setEnableState=function(e){e!==this.getEnableState()&&(e?this.enable():this.disable())};h.prototype.getEnableState=
function(){return null!==this.fbo};h.prototype.getHighlightFBO=function(){return this.fbo};h.prototype.getBlurFBO=function(){return this.fbo2};h.prototype.enable=function(){k.assert(!this.getEnableState());this.fbo=new n(this.gl.RGBA,this.gl.UNSIGNED_BYTE,!0,this.gl.NEAREST,this.gl,null)};h.prototype.disable=function(){k.assert(this.getEnableState());this.fbo.dispose();this.fbo=null};h.prototype.setupFBOs=function(e){k.assert(this.getEnableState());this.viewportToRestore=e=e.fullViewport;this.width=
e[2];this.height=e[3];this.gl.viewport(0,0,this.width,this.height)};h.prototype.prepareHighlightPass=function(){k.assert(this.getEnableState());this.fbo.setSize(this.width,this.height);this.fbo.bind();this.gl.clearColor(0,0,0,0);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)};h.prototype.finish=function(e){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e);this.gl.viewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3])};return h}()})},
"esri/views/3d/webgl-engine/lib/RenderContext":function(){define(["require","exports","./RenderSlot","./RenderPass"],function(s,q,n,k){return function(){return function(){this.normals=this.lightingData=this.highlight=this.filterFaceRange=this.filterContent=this.depth=this.camera=null;this.pass=k.MATERIAL;this.shadowMap=null;this.slot=n.BACKGROUND;this.framebufferTex=this.visibleContent=this.offscreenRenderingHelper=this.ssaoHelper=null}}()})},"esri/views/3d/webgl-engine/lib/ExternalRendererContainer":function(){define(["require",
"exports","./RenderSlot"],function(s,q,n){return function(){function k(){this.renderersChanged=!1;this.renderers=[];this.slots=[];for(var h=0;h<n.MAX_SLOTS;++h)this.slots[h]=[]}k.prototype.addRenderer=function(h,e){this.renderers.push(e);for(var c=0;c<h.length;++c)this.slots[h[c]].push(e);this.renderersChanged=!0};k.prototype.removeRenderer=function(h){this.renderers=this.renderers.filter(function(c){return c!==h});for(var e=0;e<this.slots.length;++e)this.slots[e]=this.slots[e].filter(function(c){return c!==
h});this.renderersChanged=!0};k.prototype.render=function(h,e){e.slot=h;for(var c=this.slots[h],b=0;b<c.length;++b){var g=c[b];g.render(e)&&(g.didRender=!0)}};k.prototype.needsRender=function(){if(this.renderersChanged)return!0;for(var h=0;h<this.renderers.length;++h)if(this.renderers[h].needsRender)return!0;return!1};k.prototype.needsDepthMap=function(){for(var h=0;h<this.renderers.length;++h)if(this.renderers[h].needsDepthMap)return!0;return!1};k.prototype.resetNeedsRender=function(){this.renderersChanged=
!1;for(var h=0;h<this.renderers.length;++h){var e=this.renderers[h];e.resetNeedsRender?e.resetNeedsRender():e.didRender&&(e.needsRender=!1,e.didRender=!1)}};return k}()})},"esri/views/3d/webgl-engine/lib/BitSet":function(){define(["require","exports"],function(s,q){return function(){function n(){this.bitsPerWord=32;this.addressBitsPerWord=5;this._store=[]}n.prototype.clone=function(){var k=new n;k._store=this._store.slice();return k};n.prototype.wordIndex=function(k){return k>>this.addressBitsPerWord};
n.prototype.set=function(k){return this._store[this.wordIndex(k-1)]|=1<<k-1};n.prototype.clear=function(k){return this._store[this.wordIndex(k-1)]&=255^1<<k-1};n.prototype.clearAll=function(){for(var k=0;k<this._store.length;++k)this._store[k]=0};n.prototype.get=function(k){return 0!==(this._store[this.wordIndex(k-1)]&1<<k-1)};n.prototype.length=function(){return 0===this.wordLength()?0:this.bitsPerWord*(this.wordLength()-1)+(this._store[this.wordLength()-1].toString(2).length+1)};n.prototype.wordLength=
function(){for(var k,h=this._store.length,e=k=this._store.length-1;(0>=k?0>=e:0<=e)&&0===this._store[e];0>=k?e++:e--)h--;return h};n.prototype.store=function(){return this._store};n.prototype.cardinality=function(){for(var k=0,h=0,e=this.length();0<=e?h<=e:h>=e;0<=e?h++:h--)this.get(h)&&k++;return k};n.prototype.toString=function(){for(var k=[],h=0,e=this.length();0<=e?h<=e:h>=e;0<=e?h++:h--)this.get(h)&&k.push(""+h);return"{"+k.join(",")+"}"};n.prototype.toBinaryString=function(){var k=this,h=function(e,
c,b){for(;e.length<b;)e=c+e;return e};return 0<this.wordLength()?this._store.map(function(e){return h(e.toString(2),"0",k.bitsPerWord)}).join(""):h("","0",this.bitsPerWord)};n.prototype.or=function(k){if(this!==k){for(var h=Math.min(this.wordLength(),k.wordLength()),e=0,c=h-1;0<=c?e<=c:e>=c;0<=c?e++:e--)this._store[e]|=k.store[e];h<k.wordLength()&&(this._store=this._store.concat(k._store.slice(h,k.wordLength())));return null}};n.prototype.and=function(k){var h;if(this!==k){for(var e=h=this.wordLength(),
c=k.wordLength();h<=c?e<=c:e>=c;h<=c?e++:e--)this._store[e]=0;e=0;for(h=this.wordLength();0<=h?e<=h:e>=h;0<=h?e++:e--)this._store[e]&=k.store[e];return null}};n.prototype.andNot=function(k){for(var h=0,e=Math.min(this.wordLength(),k.wordLength())-1;0<=e?h<=e:h>=e;0<=e?h++:h--)this._store[h]&=~k.store[h];return null};n.prototype.xor=function(k){if(this!==k){for(var h=0,e=this.wordLength();0<=e?h<=e:h>=e;0<=e?h++:h--)this._store[h]^=k.store[h];return null}};return n}()})},"esri/views/3d/webgl-engine/lib/Camera":function(){define(["require",
"exports","./Util","./gl-matrix"],function(s,q,n,k){function h(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}function e(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]}var c=k.vec3d,b=k.vec4d,g=k.mat4d;s=function(){function d(a,d,f){this._viewport=b.create();this._padding=b.create();this._fov=55/180*Math.PI;this._near=0;this._far=1E3;this._viewDirty=!0;this._viewMatrix=g.create();this._projectionDirty=!0;this._projectionMatrix=g.create();this._viewInverseTransposeMatrixDirty=!0;
this._viewInverseTransposeMatrix=null;this._frustumPlanesDirty=!0;this._frustumPlanes=[b.create(),b.create(),b.create(),b.create(),b.create(),b.create()];this._fullViewport=null;this._eye=c.create(a);this._center=c.create(d);this._up=void 0!==f?c.create(f):c.create([0,0,1]);this._padding=b.create()}Object.defineProperty(d.prototype,"eye",{get:function(){return this._eye},set:function(a){this._compareAndSetView(a,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"center",
{get:function(){return this._center},set:function(a){this._compareAndSetView(a,this._center)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"up",{get:function(){return this._up},set:function(a){this._compareAndSetView(a,this._up)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewMatrix",{get:function(){this._viewDirty&&(g.lookAt(this._eye,this._center,this._up,this._viewMatrix),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0);return this._viewMatrix},
set:function(a){g.set(a,this._viewMatrix);this._viewDirty=!1;this._frustumPlanesDirty=this._viewInverseTransposeMatrixDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"near",{get:function(){return this._near},set:function(a){this._near!==a&&(this._near=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"far",{get:function(){return this._far},set:function(a){this._far!==a&&(this._far=a,this._frustumPlanesDirty=
this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewport",{get:function(){return this._viewport},set:function(a){this.x=a[0];this.y=a[1];this.width=a[2];this.height=a[3]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"x",{get:function(){return this._viewport[0]},set:function(a){a+=this._padding[3];this._viewport[0]!==a&&(this._viewport[0]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"y",{get:function(){return this._viewport[1]},set:function(a){a+=this._padding[2];this._viewport[1]!==a&&(this._viewport[1]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"width",{get:function(){return this._viewport[2]},set:function(a){a-=this._padding[1]+this._padding[3];this._viewport[2]!==a&&(this._viewport[2]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"height",{get:function(){return this._viewport[3]},set:function(a){a-=this._padding[0]+this._padding[2];this._viewport[3]!==a&&(this._viewport[3]=a,this._frustumPlanesDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fullWidth",{get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fullHeight",{get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fullViewport",{get:function(){this._fullViewport||(this._fullViewport=b.create());this._fullViewport[0]=this._viewport[0]-this._padding[3];this._fullViewport[1]=this._viewport[1]-this._padding[2];this._fullViewport[2]=this.fullWidth;this._fullViewport[3]=this.fullHeight;return this._fullViewport},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"aspect",{get:function(){return this.width/this.height},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"padding",{get:function(){return this._padding},set:function(a){this._padding[0]===a[0]&&this._padding[1]===a[1]&&this._padding[2]===a[2]&&this._padding[3]===a[3]||(this._viewport[0]+=a[3]-this._padding[3],this._viewport[1]+=a[2]-this._padding[2],this._viewport[2]-=a[1]+a[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=a[0]+a[2]-(this._padding[0]+this._padding[2]),b.set(a,this._padding),this._frustumPlanesDirty=this._projectionDirty=!0)},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"projectionMatrix",{get:function(){if(this._projectionDirty){var a=this.width,b=this.height,d=this.near*Math.tan(this.fovY/2),c=d*this.aspect;g.frustum(-c*(1+2*this._padding[3]/a),c*(1+2*this._padding[1]/a),-d*(1+2*this._padding[2]/b),d*(1+2*this._padding[0]/b),this.near,this.far,this._projectionMatrix);this._projectionDirty=!1}return this._projectionMatrix},set:function(a){g.set(a,this._projectionMatrix);this._projectionDirty=!1;this._frustumPlanesDirty=
!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fov",{get:function(){return this._fov},set:function(a){this._fov=a;this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fovX",{get:function(){return n.fovd2fovx(this._fov,this.width,this.height)},set:function(a){this._fov=n.fovx2fovd(a,this.width,this.height);this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"fovY",{get:function(){return n.fovd2fovy(this._fov,this.width,this.height)},set:function(a){this._fov=n.fovy2fovd(a,this.width,this.height);this._frustumPlanesDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"distance",{get:function(){return c.dist(this._center,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"angleOfElevation",{get:function(){c.subtract(this._center,this._eye,f);c.normalize(f);var a=c.dot(this._center,
f)/c.length(this._center);return Math.acos(n.clamp(a,-1,1))-0.5*Math.PI},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"frustumPoints",{get:function(){return this.computeFrustumPoints()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"frustumPlanes",{get:function(){this._frustumPlanesDirty&&(this._frustumPlanes=this._computeFrustumPlanes(this._frustumPlanes),this._frustumPlanesDirty=!1);return this._frustumPlanes},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"viewInverseTransposeMatrix",{get:function(){if(this._viewInverseTransposeMatrixDirty||this._viewDirty)this._viewInverseTransposeMatrix||(this._viewInverseTransposeMatrix=g.create()),g.inverse(this.viewMatrix,this._viewInverseTransposeMatrix),g.transpose(this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1;return this._viewInverseTransposeMatrix},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"perPixelRatio",{get:function(){return Math.tan(this.fovX/2)/this.width},
enumerable:!0,configurable:!0});d.prototype.copyFrom=function(a){c.set(a._eye,this._eye);c.set(a._center,this._center);c.set(a._up,this._up);b.set(a._viewport,this._viewport);b.set(a._padding,this._padding);this._near=a._near;this._far=a._far;this._fov=a._fov;a._viewDirty?this._frustumPlanesDirty=this._viewDirty=!0:(g.set(a._viewMatrix,this._viewMatrix),this._viewDirty=!1);a._projectionDirty?this._frustumPlanesDirty=this._projectionDirty=!0:(g.set(a._projectionMatrix,this._projectionMatrix),this._projectionDirty=
!1);return this};d.prototype.copy=function(){var a=new d;a.copyFrom(this);return a};d.prototype.equals=function(a){return h(this._eye,a._eye)&&h(this._center,a._center)&&h(this._up,a._up)&&e(this._viewport,a._viewport)&&e(this._padding,a._padding)&&this._near===a._near&&this._far===a._far&&this._fov===a._fov};d.prototype.almostEquals=function(a,b){var d=c.dist(this.eye,this.center)*(b||5E-4),d=d*d,f;if(f=c.dist2(a.eye,this.eye)<d){if(d=c.dist2(a.center,this.center)<d)if(d=0.0010>Math.abs(a.fov-this.fov)){var l=
a.padding,g=this.padding,d=g[0]-l[0];f=g[1]-l[1];var e=g[2]-l[2],l=g[3]-l[3],d=0.5>d*d+f*f+e*e+l*l}f=d}return f};d.prototype.markViewDirty=function(){this._frustumPlanesDirty=this._viewDirty=!0};d.prototype.computeDirection=function(a){a||(a=c.create());return c.normalize(c.subtract(this._center,this._eye,a))};d.prototype.computePixelSizeAt=function(a){return 2*c.dist(a,this._eye)*Math.tan(this.fovX/2)/this.width};d.prototype.computePixelSizeAtDist=function(a){return 2*a*Math.tan(this.fovX/2)/this.width};
d.prototype.computeDistanceFromRadius=function(a,b){return a/Math.tan(Math.min(this.fovX,this.fovY)/(2*(b||1)))};d.prototype.copyFrustumPlanes=function(a){if(!a){a=Array(6);for(var d=0;6>d;++d)a[d]=b.create()}for(var c=this.frustumPlanes,d=0;6>d;d++)b.set(c[d],a[d]);return a};d.prototype.computeFrustumPoints=function(a){if(!a){a=Array(8);for(var b=0;8>b;++b)a[b]=c.create()}n.matrix2frustum(this.viewMatrix,this.projectionMatrix,a);return a};d.prototype.setGLViewport=function(a){var b=this.viewport,
d=this.padding;a.viewport(b[0]-d[3],b[1]-d[2],b[2]+d[1]+d[3],b[3]+d[0]+d[2])};d.prototype.projectPoint=function(d,f,l){void 0===l&&(l=!1);b.set4(d[0],d[1],d[2],1,a);g.multiplyVec4(this.viewMatrix,a);l&&(f[2]=-a[2]);g.multiplyVec4(this.projectionMatrix,a);c.scale(a,1/Math.abs(a[3]));d=this.fullViewport;f[0]=n.lerp(0,d[0]+d[2],0.5+0.5*a[0]);f[1]=n.lerp(0,d[1]+d[3],0.5+0.5*a[1]);l||(f[2]=0.5*(a[2]+1));return f};d.prototype.unprojectPoint=function(b,d,c){void 0===c&&(c=!1);if(c)return console.error("Camera.unprojectPoint() not yet implemented for linear Z"),
null;g.multiply(this.projectionMatrix,this.viewMatrix,r);if(!g.inverse(r))return null;c=this.fullViewport;a[0]=2*(b[0]-c[0])/c[2]-1;a[1]=2*(b[1]-c[1])/c[3]-1;a[2]=2*b[2]-1;a[3]=1;g.multiplyVec4(r,a);if(0===a[3])return null;d[0]=a[0]/a[3];d[1]=a[1]/a[3];d[2]=a[2]/a[3];return d};d.prototype.computeUpOnSphere=function(){c.subtract(this.center,this.eye,l);var a=c.length(this.center);1>a?c.set3(0,0,1,this.up):Math.abs(c.dot(l,this.center))>0.9999*c.length(l)*a||(c.cross(l,this.center,this.up),c.cross(this.up,
l,this.up),c.normalize(this.up))};d.prototype._compareAndSetView=function(a,b){h(a,b)||(c.set(a,b),this._frustumPlanesDirty=this._viewDirty=!0)};d.prototype._computeFrustumPlanes=function(a){if(!a){a=Array(6);for(var d=0;6>d;++d)a[d]=b.create()}n.matrix2frustumPlanes(this.viewMatrix,this.projectionMatrix,a);return a};return d}();var f=c.create(),a=b.create(),r=g.create(),l=c.create();return s})},"esri/views/3d/webgl-engine/lib/webgl-utils":function(){define([],function(){var s=function(k,h){for(var e=
["webgl","experimental-webgl","webkit-3d","moz-webgl"],c=null,b=0;b<e.length;++b){try{c=k.getContext(e[b],h)}catch(g){}if(c)break}return c},q=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(k,h){return window.setTimeout(k,1E3/60)}).bind(window),n=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||
window.clearTimeout).bind(window);return{create3DContext:s,setupWebGL:function(k,h){function e(b){var c=k.parentNode;c&&(c.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+b+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}if(!window.WebGLRenderingContext)return e('This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),
[null,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'];var c=s(k,h);return!c?(e('It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),[null,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e']):
[c]},detectWebGL:function(){var k;try{k=window.WebGLRenderingContext}catch(h){k=[!1,0]}var e;try{e=s(document.createElement("canvas"))}catch(c){e=[!1,1]}return!k?[!1,0]:!e?[!1,1]:[!0,{VERSION:e.getParameter(e.VERSION),SHADING_LANGUAGE_VERSION:e.getParameter(e.SHADING_LANGUAGE_VERSION),VENDOR:e.getParameter(e.VENDOR),RENDERER:e.getParameter(e.RENDERER),EXTENSIONS:e.getSupportedExtensions(),MAX_TEXTURE_SIZE:e.getParameter(e.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:e.getParameter(e.MAX_RENDERBUFFER_SIZE),
MAX_VERTEX_TEXTURE_IMAGE_UNITS:e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]},requestAnimFrame:q,cancelAnimFrame:n}})},"esri/views/3d/webgl-engine/lib/GLDefaultState":function(){define(["require","exports"],function(s,q){return function(){function n(k){this.cullEnabled=!1;this.blendFuncSrc=770;this.blendFuncDst=771;this.depthFunc=513;this._gl=k}n.prototype.apply=function(){this.cullEnabled?this._gl.enable(2884):this._gl.disable(2884);this._gl.blendFunc(this.blendFuncSrc,this.blendFuncDst);this._gl.depthFunc(this.depthFunc)};
return n}()})},"esri/views/3d/webgl-engine/parts/Viewport":function(){define("require exports dojo/has ../lib/PerformanceTimer ../lib/Camera ../lib/Util ../lib/BitSet ../lib/gl-matrix ./Visualizer".split(" "),function(s,q,n,k,h,e,c,b,g){var f=b.vec3;s=b.vec4d;var a=b.mat4d,r=2E4,l=[0,0],d=a.create(),m=[s.create(),s.create(),s.create(),s.create(),s.create(),s.create()],p={get:function(a){return!0}},t=0;return function(){function b(a,d,m,l,e){this._content={};this._visibleContent=new c;this._frustumCullingEnabled=
!0;this._maxFarNearRatio=r;this._stats={renderGeometriesTotal:0,renderGeometriesVisible:0,visualizerRenderTimer:null,viewportRenderTimer:null};this._needsRender=!0;this._gl=e;this._visualizer=new g(a,d,m,l,e);this._camera=new h(f.createFrom(0,100,-100),f.createFrom(0,0,0));t&&(this._stats.visualizerRenderTimer=new k(10),this._stats.viewportRenderTimer=new k(10))}b.prototype.getCombinedStats=function(){var a={},b=this._visualizer.getCombinedStats(),d;for(d in b)a[d]=b[d];a.renderGeometriesTotal=this._stats.renderGeometriesTotal;
a.renderGeometriesVisible=this._stats.renderGeometriesVisible;t&&(a.visualizerTotalRenderTime=this._stats.visualizerRenderTimer.getTotal(),a.visualizerCurrentRenderTime=this._stats.visualizerRenderTimer.getLastFiltered(),a.viewportTotalRenderTime=this._stats.viewportRenderTimer.getTotal(),a.viewportCurrentRenderTime=this._stats.viewportRenderTimer.getLastFiltered(),a.totalNumFramesRendered=this._stats.viewportRenderTimer.getNumMeasurements());void 0!==this._gl.getUsedTextureMemory&&(a.textureMemory=
this._gl.getUsedTextureMemory());void 0!==this._gl.getUsedRenderbufferMemory&&(a.renderbufferMemory=this._gl.getUsedRenderbufferMemory());void 0!==this._gl.getUsedVBOMemory&&(a.VBOMemory=this._gl.getUsedVBOMemory());if(void 0!==this._gl.getUsedTextureMemoryStats){var b=this._gl.getUsedTextureMemoryStats(),c;for(c in b)a["texMem type: "+c]=b[c]}return a};b.prototype.dispose=function(){this._visualizer.dispose();this._visualizer=null};b.prototype.setLightingData=function(a){this._visualizer.setLightingData(a)};
b.prototype.getLightingData=function(){return this._visualizer.getLightingData()};b.prototype.getViewParams=function(a){var b=this._visualizer.getViewParams(a);if(!a||a.frustumCullingEnabled)b.frustumCullingEnabled=this._frustumCullingEnabled;if(!a||a.maxFarNearRatio)b.maxFarNearRatio=this._maxFarNearRatio;return b};b.prototype.setViewParams=function(a){void 0!==a.frustumCullingEnabled&&(this._frustumCullingEnabled=a.frustumCullingEnabled);void 0!==a.maxFarNearRatio&&(this._maxFarNearRatio=-1===a.maxFarNearRatio?
r:a.maxFarNearRatio);this._visualizer.setViewParams(a);this._needsRender=!0};b.prototype.setRenderParams=function(a){this._visualizer.setRenderParams(a)};b.prototype.getRenderParams=function(){return this._visualizer.getRenderParams()};b.prototype.getFrustumObjects=function(){var a={},b;for(b in this._content)this._visibleContent.get(this._content[b].idx)&&(a[this._content[b].name]=1);return a};b.prototype.modify=function(a,b,d,c){this._visualizer.modify(a,b,d,c);this._content=this._visualizer.getContent()};
b.prototype.getContent=function(){return this._content};b.prototype.setSelectionObject=function(a,b){this._visualizer.setSelectionObject(a,b)};b.prototype.setCamera=function(a){this._camera.copyFrom(a);this._computeVisibleContentAndUpdateNearFar();this._needsRender=!0};b.prototype.getCamera=function(){return this._camera};b.prototype.getPickRay=function(a,b,d){return this.pickRayWithBeginPoint(a,void 0,this._camera.viewMatrix,b,d)};b.prototype.pickRayWithBeginPoint=function(a,b,d,c,f){return this._visualizer.getPickRay(a,
b,this._camera,d,c,f)};b.prototype.addExternalRenderer=function(a,b){return this._visualizer.addExternalRenderer(a,b)};b.prototype.removeExternalRenderer=function(a){return this._visualizer.removeExternalRenderer(a)};b.prototype.getExternalRenderers=function(){return this._visualizer.getExternalRenderers()};b.prototype.render=function(a,b){t&&this._stats.viewportRenderTimer.start();var d=this._computeVisibleContentAndUpdateNearFar();t&&this._stats.visualizerRenderTimer.start();this._visualizer.render(this._camera,
a,d,b);t&&(this._stats.visualizerRenderTimer.stop(),this._stats.viewportRenderTimer.stop())};b.prototype.resetNeedsRender=function(){this._needsRender=!1;this._visualizer.resetNeedsRender()};b.prototype.needsRender=function(){return this._needsRender||this._visualizer.needsRender()};b.prototype._computeVisibleContentAndUpdateNearFar=function(){return this._frustumCullingEnabled||0<this._maxFarNearRatio?(l[1]=0,this._computeFrustumCullingAndNearFar(this._camera.eye,this._visibleContent,l),0<this._maxFarNearRatio&&
0<l[1]&&(this._camera.far=l[1],this._camera.near=Math.max(l[0],this._camera.far/this._maxFarNearRatio)),this._visibleContent):p};b.prototype._computeFrustumCullingAndNearFar=function(b,c,f){a.perspective(this._camera.fovY,this._camera.aspect,1,10,d);e.matrix2frustumPlanes(this._camera.viewMatrix,d,m);c.clearAll();this._stats.renderGeometriesTotal=0;this._stats.renderGeometriesVisible=0;b=-Number.MAX_VALUE;var l=-Number.MAX_VALUE,g=m[0][0],p=m[0][1],h=m[0][2],r=m[0][3],k=m[1][0],t=m[1][1],n=m[1][2],
x=m[1][3],G=m[2][0],q=m[2][1],s=m[2][2],I=m[2][3],Z=m[3][0],V=m[3][1],L=m[3][2],Y=m[3][3],E=m[4][0],ba=m[4][1],W=m[4][2],R=m[4][3],T=m[5][3],J;for(J in this._content){var S=this._content[J];this._stats.renderGeometriesTotal++;if(!S.material.isBackdrop){var K=S.center,Q=K[0],U=K[1],X=K[2],K=S.bsRadius;if(g*Q+p*U+h*X+r>K)continue;if(k*Q+t*U+n*X+x>K)continue;if(G*Q+q*U+s*X+I>K)continue;if(Z*Q+V*U+L*X+Y>K)continue;U=E*Q+ba*U+W*X;Q=U+K;K=-U+K;Q>b&&(b=Q);K>l&&(l=K)}c.set(S.idx);this._stats.renderGeometriesVisible++}c=
b!==-Number.MAX_VALUE;l+=T;0<this._stats.renderGeometriesVisible&&c&&(f[0]=0.99*Math.max(1-(b+R),2),f[1]=1.01*Math.max(10+l,f[0]+1))};return b}()})},"esri/views/3d/webgl-engine/lib/PerformanceTimer":function(){define(["require","exports","./Util"],function(s,q,n){return function(){function k(h){this._filterSampleIndex=0;this._lastTime=NaN;this._numMeasurements=this._totalTime=0;this._filterSamples=Array(h);this.reset()}k.prototype.reset=function(){for(var h=this._filterSampleIndex=0;h<this._filterSize;h++)this._filterSamples[h]=
NaN};k.prototype.start=function(){this._tsStart=n.performance.now()};k.prototype.stop=function(){this._lastTime=n.performance.now()-this._tsStart;this._totalTime+=this._lastTime;this._numMeasurements++;this._filterSize&&(this._filterSamples[this._filterSampleIndex]=this._lastTime,this._filterSampleIndex=(this._filterSampleIndex+1)%this._filterSize);return this._lastTime};k.prototype.getLast=function(){return this._lastTime};k.prototype.getLastFiltered=function(){for(var h=0,e=0;e<this._filterSamples.length;e++)h+=
this._filterSamples[e];return h/this._filterSamples.length};k.prototype.getAverage=function(){return this._totalTime/this._numMeasurements};k.prototype.getTotal=function(){return this._totalTime};k.prototype.getNumMeasurements=function(){return this._numMeasurements};return k}()})},"esri/views/3d/webgl-engine/parts/Visualizer":function(){define("require exports ../lib/Renderer ../lib/SSAOHelperObscurance ../lib/ShadowMap ../lib/NearFarCalc ../lib/Util ../lib/gl-matrix ../lib/RenderPass ../lib/HighlightHelper ../lib/OffscreenRenderingHelper".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a){var r=b.vec3d,l=b.mat4d,d=c.assert;return function(){function b(d,c,l,m,g){this._drawSSAOMapDebugQuad=this._drawShadowMapDebugQuad=!1;this._needsRender=!0;this._content={};this._gl=g;this._renderer=new n(d,c,l,m,g,!1);this._programRep=d;this._shadowMap=new h(d,g);this._ssaoHelper=new k(d,m,g);this._nearFarCalc=new e;this._highlightHelper=new f(d,m,g);this._offscreenRenderingHelper=new a(d,g)}b.prototype.getCombinedStats=function(){return this._renderer.getCombinedStats()};
b.prototype.dispose=function(){this._renderer.dispose();this._shadowMap.getEnableState()&&this._shadowMap.setEnableState(!1);this._ssaoHelper.getEnableState()&&this._ssaoHelper.setEnableState(!1);this._highlightHelper.getEnableState()&&this._highlightHelper.setEnableState(!1);this._offscreenRenderingHelper.getEnableState()&&this._offscreenRenderingHelper.setEnableState(!1)};b.prototype.setLightingData=function(a){this._renderer.setLightingData(a)};b.prototype.getLightingData=function(){return this._renderer.getLightingData()};
b.prototype.getViewParams=function(a){var b=a||{};if(!a||a.pixelRatio)b.pixelRatio=this._renderer.getPixelRatio();return b};b.prototype.setViewParams=function(a){null!=a.pixelRatio&&this._renderer.setPixelRatio(a.pixelRatio)};b.prototype.setRenderParams=function(a){void 0!==a.shadowMapResolution&&!1===this._shadowMap.getEnableState()&&this._shadowMap.setTextureResolution(a.shadowMapResolution);void 0!==a.shadowMap&&a.shadowMap!==this._shadowMap.getEnableState()&&this._shadowMap.setEnableState(a.shadowMap);
void 0!==a.shadowMapMaxCascades&&this._shadowMap.setMaxNumCascades(a.shadowMapMaxCascades);!0!==this._highlightHelper.getEnableState()&&this._highlightHelper.setEnableState(!0);void 0!==a.ssao&&a.ssao!==this._ssaoHelper.getEnableState()&&this._ssaoHelper.setEnableState(a.ssao);void 0!==a.ssaoAttenuation&&this._ssaoHelper.setAttenuation(a.ssaoAttenuation);void 0!==a.ssaoRadius&&this._ssaoHelper.setRadius(a.ssaoRadius);void 0!==a.ssaoFilterRadius&&this._ssaoHelper.setFilterRadius(a.ssaoFilterRadius);
void 0!==a.ssaoSamples&&this._ssaoHelper.setSamples(a.ssaoSamples);void 0!==a.drawShadowMapDebugQuad&&(this._drawShadowMapDebugQuad=a.drawShadowMapDebugQuad);void 0!==a.drawSSAODebugQuad&&(this._drawSSAOMapDebugQuad=a.drawSSAODebugQuad);this._ssaoHelper.getEnableState()?this._renderer.ssaoEnabled=!0:this._renderer.ssaoEnabled=!1;void 0!==a.offscreenRendering&&a.offscreenRendering!==this._offscreenRenderingHelper.getEnableState()&&(this._offscreenRenderingHelper.setEnableState(a.offscreenRendering),
this._renderer.offscreenRenderingEnabled=a.offscreenRendering);this._needsRender=!0};b.prototype.getRenderParams=function(){var a={};this._shadowMap.getIsSupported()&&(a.shadowMap=this._shadowMap.getEnableState(),a.shadowMapResolution=this._shadowMap.getTextureResolution(),a.shadowMapMaxCascades=this._shadowMap.getMaxNumCascades());this._ssaoHelper.getIsSupported()&&(a.ssao=this._ssaoHelper.getEnableState(),a.ssaoAttenuation=this._ssaoHelper.getAttenuation(),a.ssaoRadius=this._ssaoHelper.getRadius(),
a.ssaoFilterRadius=this._ssaoHelper.getFilterRadius(),a.ssaoSamples=this._ssaoHelper.getSamples());return a};b.prototype.modify=function(a,b,c,f){this._renderer.modify(a,b,c,f);f=0;for(var l=b.length;f<l;++f)delete this._content[b[f].uniqueName];f=0;for(b=a.length;f<b;++f)this._content[a[f].uniqueName]=a[f];f=0;for(a=c.length;f<a;++f)d(this._content[c[f].renderGeometry.uniqueName]===c[f].renderGeometry)};b.prototype.getContent=function(){return this._content};b.prototype.getPickRay=function(a,b,d,
c,f,l){r.unproject(r.createFrom(a[0],a[1],0),c,d.projectionMatrix,d.fullViewport,f);r.unproject(r.createFrom(a[0],a[1],1),c,d.projectionMatrix,d.fullViewport,l)};b.prototype.getProjectionMatrix=function(a,b,d,f,m){b=c.fovx2fovy(b,a[2],a[3]);l.perspective(180*b/Math.PI,a[2]/a[3],d,f,m)};b.prototype.setSelectionObject=function(a,b){this._renderer.setSelectionObject(a,b)};b.prototype.addExternalRenderer=function(a,b){return this._renderer.addExternalRenderer(a,b)};b.prototype.removeExternalRenderer=
function(a){return this._renderer.removeExternalRenderer(a)};b.prototype.getExternalRenderers=function(){return this._renderer.getExternalRenderers()};b.prototype.resetNeedsRender=function(){this._needsRender=!1;this._renderer.resetNeedsRender()};b.prototype.needsRender=function(){return this._needsRender||this._renderer.needsRender()};b.prototype.render=function(a,b,d,c){var f=a.viewport,m;if(this._shadowMap.getEnableState()||this._ssaoHelper.getEnableState())m=this._nearFarCalc.calculateSceneNearFar(a,
this._content,d);if(this._shadowMap.getEnableState()){this._shadowMap.prepare(a,b,this._content,d,m);b=this._shadowMap.getCascades();for(var e=0;e<b.length;++e){var h=b[e];h.camera.setGLViewport(this._gl);this._renderer.renderGeometryPass(g.MATERIAL_DEPTH_SHADOWMAP,h.camera,d)}this._shadowMap.finish(c);a.setGLViewport(this._gl)}this._shadowMap.bindAll(this._programRep);this._renderer.renderAuxiliaryBuffers(a,d,this._shadowMap,this._ssaoHelper,m,c,this._offscreenRenderingHelper);this._renderer.render(a,
d,this._shadowMap,this._ssaoHelper,c,this._highlightHelper,this._offscreenRenderingHelper);this._drawShadowMapDebugQuad&&this._shadowMap.getEnableState()&&(a=l.ortho(f[0],f[2],f[1],f[3],-1,1),this._shadowMap.drawDebugQuad(a));this._drawSSAOMapDebugQuad&&this._ssaoHelper.getEnableState()&&(a=l.ortho(f[0],f[2],f[1],f[3],-1,1),this._ssaoHelper.drawQuad(a))};return b}()})},"esri/views/3d/webgl-engine/lib/SSAOHelperObscurance":function(){define("require exports ./GLFBO ./GLUtil ./GLVBO ./GLSLShader ./GLSLProgram ./VertexBufferLayout ./Util ./gl-matrix dojo/text!../materials/internal/ssao.xml".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a){var r=f.vec3d,l=f.vec4d;s=function(){function f(a,b,d){this._enabled=!1;this._BLUR_F=2;this._attenuation=0.5;this._radius=3;this._filterRadius=4;this._samples=16;this._viewportToRestore=l.create();this._gl=d;this._programRep=a;this._textureRep=b;this._emptyTexture=k.createEmptyTexture(d)}f.prototype.getIsSupported=function(){var a=this._gl,b=-1!==a.getParameter(a.VERSION).indexOf("WebGL 0.93"),d=-1!==a.getParameter(a.VERSION).indexOf("WebGL 0.94");return a.getExtension("OES_standard_derivatives")&&
!(b||d)};f.prototype.setEnableState=function(a){a?this.enable():this.disable()};f.prototype.getEnableState=function(){return this._enabled};f.prototype.enable=function(){var a=this;g.assert(!this.getEnableState());g.assert(this.getIsSupported());var d=this._gl;this._enabled=!0;this._ssaoFBO=new n(6408,5121,!1,9729,d);this._blur0FBO=new n(6408,5121,!1,9729,d);this._blur1FBO=new n(6408,5121,!1,9729,d);this._noiseTexture=d.createTexture();d.bindTexture(3553,this._noiseTexture);d.texImage2D(3553,0,6408,
8,8,0,6408,5121,null);d.generateMipmap(3553);var c=new Image;c.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAqf0lEQVR42gTBB5ydB2EY8G/v8b7v7Xnv9mmcdFp3WpasZUuWFzZgDJgkhgwoSdM2JbTNjzZA06ZNgaRJWtKSEgjDGNuA8UYeWpZkbZ10uj3efu977317j/7/4De/8ef9vCow2VUGGHzRhuQ+t08GvhZb+jy85wOu/68JzwtQSCZedpsvC8SL6NJNNwZoHMaZiMoCrjrPATpGJFxvRCYMKqTCBsyVw8h5B6ROArU3+8HOGLe3Ay+UABow3D4wEcfOakDbjh2h594mikMNcI62ISNzIius0bfeN+QHrv+L7M53FHq1XC29breFgmCjwPHQ/fo88OIg9kvDdQPhB93G8yk6DtRYFT64fR/jQn0NIcIgYHylyFjVHPBboCB7HQ5sXuoZqQCHqKUjtvKNpvxkivqlZe514DOA/Keethib6OkOw204MMTjY3HX8VIGFeITgBEApGRFY3hyKyPeRWK/NNa2huJeLKzBJAimiY7ZQbAh0HwPEP9jxHhs6he37z8+KWqdeD7TCttNwgHftJpfzCq/iOJbKrxap2Ymet8zwVEoNReE7T4aI6t2mBuO4Meyh3vHAeK2+KvLzWHEgSCJpgR5EvP7QPFLyeDWWrqc1iVz6LwPI7GEpOEExCwzVZwtKtDGyzRW5tGyz5WA7HLtfrOIHp9T9kXQB1z7E10eYMytTs5QOuci8E+YIk9W/roj5nxvjVVLaM+30x/09CPGIdQlfsOe/WqxoS9Sf5bVv+drIqyP6uNrQMxFGDPSt1PurVE/UcuV9ci35bmCPTiIjsuZZjZCePj01iMbKBYa7UyVIDI+MDMSAV7sw6CSjKEG0IqwXhEkVtFwFJQ9D3q9q2RE8xEzuxvCN0Bq0pAFH7IMZEW3/zQU6rQ8Dw1bqPE2XCxtht8B/Hsg/yzu3CUcGdb6PW6QCVRs7bYKDwDQfYefmmJO2O/d4LyOzns2kA3kt7Bxrn1ZZ4hlYFs+uYpAnNDyDI36VE+6wLadkEwTwQIdYovCIM8SEVS24D+ktuqjWIT4yWFEN/zEfsqIWkFfKQsW8DNVyLEDKWwZ6ew8x5ojpAmh7DbTuiCGFcW/DXl5hO7Y/BztDCbwqtMaxcanBq59oBYuVIAM2o2twXHduUpDjChd7xinXHoB5OKsvd/jlrN+SnHoir0dn1hWWSbrDzj0Nd6x3PUb1LYyVIpv9AHW9sPW+aEhU8peULyaAG12TddDnq0zVg5S+vfnVLQBwjt3PcU9k0feDfAkCjohqkfBRgeVfcx1xYcTzRYoNbVPbCQ/mmC66x3pMpN7IPDeT7a2+TYYDYj41QNoEoGVQhPLlIPb8k2yMZlM2gNIiEu4nfIZFKeDW08qY9ds2wLoLWIt2yJuYrXnWhNbytRVs1sHIw6qhoE/sYJsJArzFLNdUzxalSOyF3oIBU2ttqZFumoEj6XoZVOHKWSJDoGe+WGZmObQuA4f+uap/u15hOEW1LveusgkSWNvivQRRg7bAQWcd+wUcmN/DTkr6XeHmX/pVnYkebSt/RBNP8PhsXnqFhfUu/ozIH++g98KYa+EnqoRZtFucB/WVPy5MoJEyH+RgSeFoTuDS3Rjpi7Iog/+N2aD7N9oJkprVsWpNOqZ5JsMfDKSID//tUCyQrANUm4Q/czDP1mKVTo2lrM6uuJh9RV3pMc1ylB/5zpYs3EWgR87+hDYZY06VIzFYd+HxTY9FyARG0RytMQAJujsU3Pz/qPlwVVI99+KBosYv4qQOzQP4WWCfPVd5eSjvPMmAkY0LFL9lX5vMfDKgtMADu3pCrNLctVht8XYBr6KRvBkWte8jafxscvmLE7tITB4IxDf4GJ/7YdtklZdgOO6z62Bj4ADitP0UfcQAiwSnoEgw44j+mCCpjb7zL2IcBSOYLS5ArdRgU/EJrsgnLhuAgv6ylO+fTYJZMPiFVUt4bafDNpq8gW2/+Wc1LSVejMjel0a5Yg2kUT1DzSmbB3aGVsieORVfXAq7vYkeQUZKUHxZlufMOFKsneeaJYoxjH4j6q2BObSoPx+o2RkzKti/lyb2uC7h60bB4z9maJ4tnFpvw/fQ8zfJ3IAAiSE6G2X40l/PFI+xGgcAjM+/31BL8p1KGRn8kFaztzEFxsAfOxjR910VTxaqsh6/z5RGNebzyWtoossscYHUPKL91d9BhtQTclREMGf6PoMnmDJ6orHxKl7RZO9DwAIBqRCqlbTHs8hf0fa/1ZcPuxk/I42xYnbafCqgGGatSnGPUaE/1azHhdzw/rok76dX+vslH00lkxaRKfW/wwn3mJTQOH5bu/vzgMJNnTuAvJMFL3p9f90ttxSrfnxNusCI0spKhX0O7XBAHcouivCT56YhuFE+A4vrQr7VfSfeXbsbpt4rbhpwuNPNBagcd8A6DO4PgSzeDQ6lGlIevQ2yGyG3fn49mPgnTNJZqVuLwC8E3FFyBozgL47rtOWlrXOd1s/dRPjgYmLAzl2dWFOGk+bW+PStap2Xm/ERvzJdDYd4fd16N3x3ooL/FzJ8PEPT4H4WRk5ygiRK97yrjHU5p/69gdFfUdLiDlYG0NeFYyjRmZNdLM6mDPgwceejmpR8ek2Pm02WQ3ZqW5nCDTpL9931LtJdladOI0oZjCwoGICD1xZV4cYZxIgzhjekCf9wh4+jDU5IjvsdEm/12T6e0aJ5YqnS7ROWkWBX3FAnboqd7c6kAcAxZwBS3bSAZcH0F6pV/7AkfvSEzW3fzrp1VvQjkL3wetuK7N/CV692ve/zNVq5KYktPLl/CMDhNzFjT6ZOIK3RgxqBaLxgL8Aoc+F8MeP7gFuRpXbCDtlAbL10NvMh/tsocPBVQx9SFIIiN0CNzcipYWwz5GmjGWiarABr7U30U+uUNtF9/saPWDaKnox3JOtzsKvq1INHtwgug+a9C8U+XIiPGGIWaCNg7RE1WFxot+t3g22M6JFGzGOpSzmpS+ODP4Q6RwuwVKDW0f8olQHYv4Iwf51NAr0mmJoXL1TpxX/Jwq9m3b+wiCKtLfiNrWV4I/5xBkDPvnpZ+Q8EN/Czdf1bA+T5A6JpRxP74kwUm8y12j7Jd+fsDMtag5nJvLUigJjbnooZikOBpxD6T+Nk7Ln0kFZlhujYcHz/L1UK05AHRt+gErP4E4f5gKsX+O8TCsbUG1hHj2+vX3Ng7bL0R3a5KytLaPmeay0xND+gBfUj9Phq/2xfYKS87H3ta1Qso4H9Ca6X0hoMdy/IXM7QuhIVg9ZbI2oBRhk6xpX8qoHNrL9POGnrNERY9igV1x61qKLAvFcGoiRcch1N+k7LK/5D0D3eIobCG4s2iADwB67+vJqtk0Tc1TMkgQLKKRG4Bl48I3u2FQq/lO3XbK9g21Br2Wrcyobb2DqyLVhQbWbiwX3JdQGgLjIbjStUiveYGF6IpjdMZj6eyO1pSwXCSByV38TzEY2/VEpeAXdtABk0qq9aZB+cGf+ukGgq26f4iAJfso+9b38L3dfnIImHIwH4TRyf4e78yxS+Uxq6TugN4xw5XDxOoluqXYDJhgyxre24BJr10njnXjpWcTtWbdv4aXNbXQq03s36vFSR1oz9oxk321YuwoQdbNCsfy3tHAmMcnpdcCnnvFu3ffTYs/Ph90bPfqToDdPLPaNcCKivoo0Rwkqbsk1bPVbJpYxGIKUfXH4pK6H8fghaPY13icA4JO+NLuCpoYlHDM9EB75+kNH/n6o9zE+TRnBkkL8xiqWY+Q9ZzaAg4+fLzZjhNfw3w/gUQRFiPz+fPeS0b8aFIJGPC+rr24QY6gIO9YVpEO6A2aaeyYdXRMVVLdKluURo78cBmBt9EtRzeNaKwWKt2E84X3D5pkIp/iAp5BlCgOpbCJAGniU3QBwNA46JmID4zirCmjDcPth6PehZa+zDdAvOqltgXj53q4T5ealBjQn4yoLHxl7ENmhUxeNvsVRYwtikoW6UeUxgr9EMFvwiR9UeuVRYKur4GLqMtLds4H9c7GxNSJGLKubjwZ8TGOXLmgCr4e5uEw7XWCj+lNk1wMUOZOC/mXXfhLtvOu24Kyd7Rq3dEnkuAFo8DA4pyLpJ0zioo44oRxXdESQO1rq81ulq3WDJXbt3ADVNIjWg2a/R+JYnI2PeepVLB6LPzi5eMUa2/jvGWrYA0pIsd2Ax6mPHbLgJuQbN3uQNGGu19WDg/3b6lAnBRn9N3KlQsrLj5LkBOCnwk7P3pLX1ljdnh8cnPPerTvbJmSkWHISCPCTNYii/Dg4JrjaCNS+3DAPRwm9DyJkalkLQz4YsGNLFveiCyw6cE4MzvjUgRAl0jAQclYHdAaYaFVABepI4sP/oeepxPi9oGlSi3tpWIX0FzAOuE71y02MAmdQrbkGPmClGtJGKw+fOHi4cTrPd5qF/4KGkWmwqPqRP9fyB03ZL2FMBtc/W3/43eT17zGJUY+tBegRFjLJktlYf8TKpkmzJai8GvczudWw+UeEPcTZGuLLoFGDpv5YDH7ZFo4P1jmZ3TCjEotNcBqm155Pjm3NzFEKWKF7KcVY72eG4IF507vbNnbj9CwxsimhPW5KBT/cwpfvy/YzvJdcA+6n/B0d85Em9Jpj0SJ6LewBcL7Fw//+NzPSGw1uSqy9jfTmcJuyMzyA57DcJ7BZOkbPIcUXsDPjoMXY/keYYLd0Rax9ZOgJqJzTsb8onXqy1r3kKf8mbdIKVceTSXiiGi4/HR7Pt5tt27+BzW2VM1tj6lqIToB4087XR9bgOfSFKyGf5eeM2J0YhpmrH9/Uu2+28qDSL1av08BUz/i2dTounIci36M4SXJfQvpHifh6TOnD1lTMejVlfZUXf66md5FwdmEaOG1150HxOMK+gQNbgOZs0N1/lb7CJLdA8ILbK7RYCYPhDrXAb+xLMG4f8mFkDpBeyS5+tXLxfxPxJxjk++79i5TfpbnAivqN+HcMfaKsuVEQwkWRTQ6/a5BboYuIP2CsCo3BHucNjYkXfHt7YLxqKU/w4c/bdMrAM0RpawTOtWVdL3+l+Mr9a6KGHjzCdL+Pcs82YJuhXDZ2rh2NZcStekK3eqM4bjnwp/7yMa1OFl1OV3t6QPCo35w0tr2V7Copy7J1Es2x8Vv/HFIPufBxivtOv7nfIH2UelqlYzTdYMRhlOaizWtwONQqix3wIN5egwKRjEqW/h7rM7j0/YG2BRMfQkYeQJUQeo9nCmVps09F9focPDhOOXQUQMjU5dVeslBdgwfdev4kpssy+ovCLglTwJ6SUOXLRMTn3S0pz10x5bTC15u11cl30Nk9Jrzr0xP8nKHV48h0J54cVJqaeI9qlm1gjOB1k0QhXwFP2ObcgC+t0r1ti6P/KzA/SXo/IN0SMFjq9ZuIrLr9A1akw429QOUM5B5UEmUvRmTAe60bM1yWrYMPpCFXI/q4RWB0CWq9rGRvUP6uaKQ/IG34bkpJkt3ViM6N0IEnJx4orp2D+v9I4duJatlZ7BHsJdqYiWJ5E3tNwoeEVCoY2xmtrCoYT1IXAPjUwBP+UKQvs1zFNa06XEMiWsMnUtTlALgZWDlM1hWo28GbMfiUPvgdt/o7pfRflcM/cqANpekRiR1c1GDZum7sabObAKJGAiHtLqegHQC9DUL/UQuHsMQHtHGasfv6lruN/s+g4LNBZ8IJFEA+CQPYmvAjW3wuu8Em2BOLwXwZlFGfMPA9gYvg7ivh8mmQV+jMZCwMKS/nJW8SwW8HazdipRdLct7AJkj40MeOWg3QPwIrXSSc0ovjYScZv/py9VCo137HQyowz7J1BdefseFZXLWQTNmHRNUYHKOArrc1Ld3Tuhw9+iusRlGgUILvkENzEP00tfai71AkRVocwA0+urjxvsVO2au4HpYHBLzTXC5UGH9S7qA+0j8DO6I9fVCSn0La27FII/Qbem53DIga6BQMqMD2zzG2vQobkLxi4skm+av45lv9+w+7UIYVvifAu/74qdQWePGbEC300M0D1rtJrtekESHiIQhLqFk1c20F3oyQ/1MLh3NF2TCvWlpMoB11+RF/m885P9EFQfa2INC4bf0oSDykNB1c7ThJKog6qH/NiRykcxtxc2BiNWPBGQs03Gqy95X23pK3XS3Id6JoO1j/fb+rDEHXOWYCdF5p3D/MD/9Mrf9+0tmM5+43b29zk5/TG88Wc7/BuItg64CzAGDFRsPDYMwC4GPHTsRewpMoEvw7U5wNabW1NhdM5YstTBJvmeCl7EufAXYGheRUrgK3lAcnaBjUtvX7A1YCYrVzG4BI+Fs3u211IAOjITr3qxz1iQhYAzxcC97nqQcC/gNJ/ksGu21JMSvl4BgZhY+tDS2kbAZC/0+j2RmMSIBqxviUr8mBMw5m0irMJ0A6wqp4q7OS54rtv3SYfwE31V4hYBefEWo9yP7E3S6Ry/zAdvd68APdrcHzIBj1kQVNtfTmSN4Y1lvHcX/BxRMGVgizNziT1a+NL4f1ZGrBBLkAbTppStCqqHPLZhyPiDx3SKmtw205TO2WxMEQqkULr7vCn91BzmndvbHWFAu8GiSrgAZyZNMScbS5iAArlhrh5G4HedwL/wH2E6v+bbD1O455A4uBvlNoAUNKwqPsjk9+loTuhkiXwuigelze5UHCb/AJNKw2cc+G4CfE/Z0ZwVsDXSAOfr9R/gpL/ghGMJOL8BA2mOuKNInxFF6AW/7uErMW8sNkEBOBtXXXEbm30CCTJbxe6EOIbec+RTjqvdUflOP7AfgnkC8nhSIm3neEOmts61kCO/o2RP02eqWjJjzYn3A/WgFSoyAwj64gKr0H3nFCK7pZt2FDmwwcSqB3YBMgY3HXWDAoBqr9PHSGIeh/l/QZXZpL2wpO7AylAwZ87Pce3z6xUVvn4SNt0I8zpte4alIJpNWn8cjfSE4UKTvooupk8qPXRvFrmj6smvX17qSIX9baO7HYIjg6IqOvJIEg3tVQ9qyR25F2fx7JpzrMHwCdjgkYRexElPxR1RDICwMQssAVuoCZADE5CJ9ZJS8LV/rUdEFDlFhrI1yQ+/EEZmII9DDLO54bQvrj5cmbQPfa7cH/UOQXdKzucZ2IOklamgTnaRQuwQ/+x1PS39leFqUqIMbQ9x6YH8xs9TiGTviU6lvwehYNuM1i85I+gNg8DiEuTIIk2iOce93t0LQ0udyF6JpSw2dw9G1nJVmKfxT36xJryH6PzgQR9qRD1Mm5e37Mygzm/LbTyeGse9tUbxKBlqB2FtLmQgRT0XuwlEeSNxcWvzw98AE28vXwWr2FlIrAWsXu9Qf2Q3c/wgIo6RZJ5GQlejmceYZfebOaO8nDj/iTnf8s2C9IEEsxD0K57+JXP2Utf9NInQAnGuzKs458w4LXRbgQ9GaWxz4G11+LwAVYeMNM7iHu6gv4qVhtn2OYKeKRJRdJHF61unu1ms8j/2aR7OYTz6aWX1mXRDFnB7aepsLG4BHvkkwVYqa/DYsRNiB3CDPZ2q5Kr5L8oC6j5ULS3/jzu6tf88tQ1tTXmBhfdwgUwXDbbt33gD8woaq7sVQiLnSMXLTtZzY89fkny98x1N8pSu8ETpNAIhg/T8GIQvlae9NA9hx0Nc/krzNurU+PlTodk7+HO9MBugPzcYk8hFtQfN/X7klPxXMLqKf25wcIYKZhb/Htf+L1Uc18kw5jZOGML5c98ZDc5yHfzmVjvWqAh2URb7rTpwH7Z5Z+n7SJeCIdOVzgdwzy80P8Hd9okBHiZ/rd9S+Vrvw4zFlirKiTK6TcVpw1zP5HqVhBXt6RhPfu3IsNMMHfNPSZVSonE3UuRpsMiGM3OJSv93QnDntYsYtdGVuljAmJA47Bndeazv44WQHWORbVjGCIspejDdhnQEoI5OYlcXg5yt52/BHhWJF2Rgxn5H7RStg/JEAf9XnV5j1UAfm2Iy+qgJmEmxTPRFm9jxx0wK5FwlHNEHBPdTZ53Mfs/p00dG2Ren4MbqsBCHPX40CcaD98IfZyAX/LGkYN+CRygtyrER/0WGlb84sVrjlknK7HuCRx0us3BOkONLiBYUCABPNb+cChaP1nBEzlW6DhhQp4wS7EaP8jKzkYuZbKviVem6ZHQsCk7QpfziL22v/or/9J1/1wUns39AYhbg+CwWbwRuSzsQTe07J0eMfvMWHVtaiDsBwCaUJapcqMVu/+bgG9YOOvJ0rvKPZQBrhYhc4Z5hMKxupj1xvFyWmg1W5N56lDJHzoDx/cuAshRzC4RgMiLb4Q2pN8r9bnJc+XUvwe3YZ5fcMVHyusfcuXdpv27i51WA0lbuZsfK3s5de9lWW9zXCCmTWIWhI18QtJZ9RNj1RbAC/ACLbCUo/Cit3JZCjjtKR+f5zdBJtOH2uWGr47tDtauNpKbom3Vu6n4oxtJhFDmzaT2pc62ZPu0gKZ4cnId/Bp195CRRtJRKMX3+4KNbD9NDEARUw+Dj82NV0k8VggVL8EZM8rwKmwWWb4ZiA9mmtNR/6rbulcqybAyYcAajMrvmsCHZJlu0CItUtWhsU38uDA04ET8wqzujLFgSgRRzt+kXEaAKwDm59pL/0Y4byu6kKl7cTK+UR9vb7pvG1tF02qxaRg1uiHnx+g7wOFJdw86CMbIvQEdeeHfeLxFBSPJn5VXZvyXLVsJVZjFpf/G5N9TGEn4xIAIx1aZlnqNx48+fxpszhYt1rUyHKHyqS/reuRCO8KEKE/+p90d4cP7dOZGBZrAe4Q2Cr6VoWFGp7KU8jzB6QbTf++mX28Qt7b0RpHxG638hMdZDlOSXXCsLeIhHkEgDBnDc48xzage9HPIxbGocP0yslbVL0Ed92bnx3d/O9vKImgbfPx20LzQCP7f6r+b/H2tmDTlvc+6g0PHKeaeAe5lUU2I63NVlYI5Hba+5RBXfNRT+s/tQ4/PTEt6013TMhfYY1q4O1CPEUaPZSt/QOqj9rMG3KYH1yhRG/UXcb6yZcW8U+k+wPZPCgBlgpNu8Kf+VLERKyNT9vbszywFAMfMpx9lkOsgwtg4j67egVCDgb+ZEV+Y3qxbUuniUxWX3sxPzIPegZS/ka7kue5Y0IwTZu5WqyB9RSCfE3Uwk57704/vV7o8av3lyOVAoQ+jppahwoMNvpxOGpVqrkEMMvAXy4/1nLZ7CXbF+Kq4DobenxfVH8/pClZz8kcJjJSt/V/IWS/l38JjraIQDwVzDZtH9eDrv81QfiKDZ1jLt12E1ftzmRWhx30rpGsWMCynxugBxI8c3BRcxANJ0r34OFhMkV49Gt40u53T1vkZujkMataE3APzs1g0F8IXsmQDntQsdKFNf6iGH8VLQGmiW3JPBuidQduZTq7OqgW5JykjNnmiYjhbLj8+P7cqCWZYZRrkQTaRDf45QL5RUW9XKQDYn5MF6gY8ryV/nXW3qQrGXcQEKwbvgo4z6HJe/l20BOgwI4GgQJQVMNVFiLM3ZsX3olzj1B2we3+Guo/EO8csQZWY33MdXWPW08uYR5nM+10sH+4/+NzncE/GNbn6voapCiKV4hwCWxfwQ78q7g/B6aP81fbEJ+wCzml/1fZcKYdX5lgUa+LB/huzhEU6bsC/HuPnLhb8Wg6ni/HtV9Ygzwe4IyOGaVdivTDbEOW8wcpQLHx/7eC3Zi8sy8oXu5DhE+kw1u06LV7AqFiBTzxumkfMOCJAaDW1i2H8GXwYpRK1uBaofc2xGWoiG1SfQOZZd0xdeJz8d58GK/YijySB0J9Q+cPTWd/fav6mWhmSO8Q1NbxYhNAcb578XuSsC1uvGTGXkoqnwE2LrPE4WXsNmR+dr37NhPqTXwkhI99/qiruLWDhPRfke3BzfdO0Ym4QFzArH8aMPeu75kh1CseVwnsv8eZgrp91VD2VNU2J07EI+ZuhsZro1D0FpfMsrN9T7l9p9GKTy9r7nBy5t7G3PJk57ic3KRV0fbnLkfXYjF0cMEtFJzX6tUctEsk76FuiYm6EKzekXpHANhG2gts8KgF2qDT9Ady9p3FJLXcvD25D//CQrhEA4ctzFtu/O1u7KgeZ1Lgehq0AnjThaOUIIg7oyTm6DQFQGxYkfvTSD5z57MAe02y8MhnHbc3kWCVWgQS5KFidDa1hijkDgK9HylNiIkH7XUrO8mGx+CxPLJ6RBdr/s20MPBsaIkt9iU5tym3LEP0dJx732kMJwDPoVwVGRLds0r/XgQ5tHsywG8kAgXM0DB7PeFzbWyWa93IoiNSjCBLB+zoOu2+108JuNch6SnYLid74PzEj7llBoIHpx7hDqyxHrF/GasXOcNsJUiWOCPPptVgZcrbrM+/gYSTsRQGWXfwbi+2QpryYDX91ZRFe+c74jbKkPWQeYJdeasX+669/9kssmTPRZwQeXKLpE1E+wMyRDnkcUh+wZGLtPCR7U1wokVAtb7GMvgxlM9qyhlaafSIiZSV2vD+PkAeQIjhlvNRwBAevJgfJOo8qbpPQ2lV3ymUV1TQolwR8JBjKHETgw/91SRAJYKWvUwY46fq3dmcPUTKvlFYHq4cWmVrkV/zqAmy8WLPDahcp4/cpPwdQXMEimgoAXgeHsB/4wcD4WgpYL2kvse//ZIdm06Q86YrrHN/K2SfRJ33m8q3c8ZOC98HW3tg6JanGyYpF7dQgLGiKVfQ9BSfnsWrmyqiJkSrmImzcgVGKVKYrTVWN7tf6d09g6JtyFuSLqhgFsKE9Fy0wFs608u58BMfHhXUar/Ce5muvzisF6JoXe2fcbJTln4mpowiRCwa1bKE6YQTUT9l2z2PjQjcg7OFOC2z8RtLwKey7nwpOL7UIOmIcqMA0iv93CeLhhdhHK4m+WVcKc6sqRqPbXLI16EKsbTpOrc4BMRmvPYq2zwSQVf6zmEllfa8DyVodxwKuwDoOxBniJSY0GaSTDsOqaQq/TpWPIHx64a5xoLT7VUtdG8H8OA3t0HiED0CijKwqttKb740UfZbUfUqGDsNpefiSl7rr/f83Q50h3RzmP+FgiNLqYstIw1HsxCxO+NEcqIwD1RLyafv9PRS1ILpg6J3x9QLGncu4++SB34Fv9pKDJ2lVkflsOoIdszZhLGgK6yT3sT6qIAYAGSBuEik+gu6XOLEgRo4G9MPE8n3jPXHO7aczYZ1+58G+f9MLf5MHd1ldxDeLWLZJoN9pgofnfxs6YhJmWY95DHASjIJ7z4lgpx/SPVFkL0J+49CDoRHdmCHKHKzSLUtPev6OAMuUMQEEHouvSjVNk/k3u7co8aJ+6ADVeEupccQgcHC7UHvmhdNBOLdkMUixyPyK5y5ExMa1LU8oJ3sOnIx+RekN9rAOLaHYPY+Mg+Y7XM8dkgU5p0NAOF36Npi5F2nrS0C9fUadVLAZStsYtK4z94LmF/r8P5vHAT/Fou9Tm8cbjNGvPSpfGe9jhgGmhEpo965JlCczvY8rexaSSe7OVjwZnN2Ob0XkI0+vIwpbCs8lTFWA3WPBZ+j2YdrQXUIbCB4f3E+ES1oGFtWgKXRWKbVP8KnH6tCcoS3ie6H7TTq8e/HEl2l9buU/IptFZByo+5URfMLrQ3UGn29p2sMOyh5u9PYYuA+tOC9Dtsn0O61GrW8Vd1aH6ESfgC5Jg/P8EeGoNSrO1RuOKZ6QOKuKyDdGpj3XS1dR40xjXig7TSGmF9BUEK49IG27ZCocDx5yYHgIKBh8yjbftWO9QPkIibON4Mkgr6TQvea8SNccZVMwuqhXXh1GcPOknL/us4J3nxgC/7gSJD6ZPnuEYD5h5xabgNFEADolRV4z8cp5UeJB0vLK0bCTjKuGoBUQPwToZ9JDn5+w5NxIp4QtgLQBtgfDq1Oc+biHviY+Jm56YXtd9rtk2tlOP76Fb93EUwCcuET2W7HdYPAfxuz11rhA9bgJiSxErg86pGuTrrkL8nelqi1o1VcikcTFPFpXBsQkF9hrfTG5MedxuuME2ltj2r/X8zXK+ZOiW1l5EdKm0wYA6zzCzH/b+cGOyASKNKByGzhU+dk/DSiX2v6GbD0sUznKsJdgSIpDB5vsOUmpSXMKxhQJdBh2zQB9Uga2d7mF1i5Z8Pb/mg0GVkuNZFeFdf6/sQsRJ50cShX0xvFi14EdTAyK5xklct0uG9dU9Ly1BB7e4OdFA2kzjJ4+m4cGSTZsV7nWyCf6oBZWxqinVt+YsTvf6sQA1rUNjuKCtq0KP8EGoOrnXterJwiZH5WDOMJ9wiaTF4E1V6uuU/1KwyzJ+H1nMWLaG9MzrZDB0QJOUnUSxKEth9LU1tb7gYILPvJutypcbbUg/cb8KOPnEjRaCOkwJVQYECuiICK6u6V6FnMA4Qdf4LKiO9CPrEHjf0QCB60rN/YDmrSfSJweSDouFYaper4DVl9KMj8Qq4nhIkrzSCV1VtB8Pv6oXTxphryWz16RTVKqPbbKq9zbQasDtcKWRE9WvP3FNcsICp2kRWQCpSzS+z4+Er1rJgNglbTAWRqrATd8ElRNLkfMfFJWHPwNMPW7vUSOpc9im7UGfizlYOdvT787XWsxMF36s1xPyQov0uMDNuh7HVeyHWziyzKJnJFH1zyJG7twS5yiydQvr+9XtYK/mjNWUEdhgM3TJsWQEK3aaE+HqwUhLE1b65h42a1E3HMqoXuC4BzlnNuEIgryVdgYucd4NsTHd+tf+jBWV+6h6kT2CgOBmdI7gEfBrIYkOCO9tZGY+K770tcEjoG+l/rLT2tDByN06xhRUokM4Ltw8U/fNh/ydTjO4JddSFJ0n6Z9SMiz3lreKURYDM2Z+Szp9+zXvKr6SE29NRrJAGbmRjkSxi3sOErHFrB10tJ2uuT+/tem+j2qexl1P1B2DlgxMa8kS4WHKFWv0vqTQxY7YqnQN8jE+lmv3woeUknMmJciOh8HaLQ2A4uHN+oXYqBkyrckpNz2iLo5vZD/nuEEs/JWzZsCcp2U8YtsPcGQNdIOqvcZRD40+RjBs4WmDr7pU77XhyaIrC93dqsR+qa8BHQOWj4Bu7/Ha59bpCbhRoXY5nTHcgXGvNW2VGXpouirMtJDL3cggbY4AV6rYdtSbnCb2FR0Z3oEVYPa38SZH/o+79XTKl48AVc9BeBWAJbggJXJboVa3PUkSLquk/t1LtVD19MizUfx5LVJ+bJeSq5krVfq1glKB5TIifOV/Do4YI96WDkPPZoWbriIDEdfqy828yhXsnn3/Q6xwJvxVRu4ckHYGnN8zaBRAdlIQwaphWujvdJ4yQCnsPlge7wXDKQuPB5N5wTIyBk/4aw/x/R8SmxQAIM6p4hOxgaYEqGMRpnHcImrDOAMzoXe5VuTKeSPwTmd9FAoKsDOcbGwJsRslfufhCPDSOeWxn4MGty5kg1UIKiP9KtE0xsFPeMLKY0a93YsRVF6su0Tt99uEIYYhogYODAIeFhKqEoyScLyLpjtsnsKTisrwea2HklEPbCjoHgxYi/aPGvA4ZvW8U1dmnMPBgKzwPWT0KUDrRhLPZrT5vB4pMbfon/pNjubIqSAql2YwbQQ66PYVPKvacgMpbKeSS7HSboMBqsLqOFLRlY6bT9QfjaHB7bGfcHQrij1HeGzjphnmbYO359jhvWcLnotM4nsaKU84N3l6nyqRVAQ2K1lrzE659W4Y8ff/hhirkxkgauyvgHNf5Azu8xxk+geLrsjEjx7wK9Z5DodQgqFhp5dO0L4xmvV4M0Y0SFL0OEAVJhhZCKKOnUEM+8TXV/ijaeWGRfwFcNXeQQ4Y7jPytH+ZKzujr6KtApadQaVPlBtAUtg9thT+0kGoo/CvMwOHLTWLuQAvZKzCXc2eFg388gR0yblNUY5JXJ0oFq8N6Et7LKFG367qbWxTUnt3vgemDfAeCT3iMX9+ixihTYoJQGQduFd2K61cIwIDy42PwyyfBAlB69X7pGJWNsTubeIzIBLt1b4a6OQB8ptWFIGIquvVlHu0wqhWx6QJPCQW+8z2h0mDaBT+D9Wddq+oAV60yhIgprTSh7klj8n15U6kkIEZluuJjvLpLZU1QoduLnoIodg37XTJlN/Y0gfKIMzYFZ03d5Wt7iluXVifzY6pDCEoLJ9wOz5Hy6CR/+zuPZFZd4t60NpSxXp6rd3nWq2NfD+YRwSdCNRPK6Lu8LkjZpvlgn+wl0xjLLDD1ixtN0kEMsMAhr8NFsCh6wXAOvrUOc0oEDDrlq9fZH0o8qXnYcv+cXGJweDpW6T2+Lt5q9nFKfv5/JnuxsfcdFm4RMa+wwv/5WLaaPCuv93AxVUQE4R4hKhMQ0H+TkXrcoWciBXUUSWJatVI4SzzvRkzb5PRI+wBz2lOju72rUh1j7mdyWptDkPB/q48dgfBzSCRDyLK/iwy+4+Ndx/I5XmXXV5dlkcnObFaHFJvI5aKgJzGYQ6qpcZ4zooB37BkE9QnAQ5rfxPDVE0hJ2oN6rBryoUXU3OiuuHV/IygkyxwkqeK+YUcsBo5CdWKXw1IC1oZd3U4uKEx93sE1J80d0cKwYmHeqt4jBHVC3p84ObsRrrlbAlJtJcKYXRdj/HwATFUYLcKM1oAAAAABJRU5ErkJggg\x3d\x3d";
c.onload=function(){a._noiseTexture&&k.texImage2D(c,a._noiseTexture,d,a._programRep,d.getParameter(2978),!0,!1,!1)};this._quadVBO=new h(new Float32Array([-1,-1,1,-1,-1,1,1,1]),b.Defaults.Pos2,d)};f.prototype.disable=function(){g.assert(this.getEnableState());this._enabled=!1;this._quadVBO.dispose();this._gl.deleteTexture(this._noiseTexture);this._blur1FBO.dispose();this._blur0FBO.dispose();this._ssaoFBO.dispose();this._ssaoFBO=this._blur0FBO=this._blur1FBO=this._noiseTexture=this._quadVBO=null};f.prototype.setAttenuation=
function(a){this._attenuation=a};f.prototype.getAttenuation=function(){return this._attenuation};f.prototype.setRadius=function(a){this._radius=a};f.prototype.getRadius=function(){return this._radius};f.prototype.setFilterRadius=function(a){this._filterRadius=Math.max(Math.round(a),1)};f.prototype.getFilterRadius=function(){return this._filterRadius};f.prototype.setSamples=function(a){this._samples=a};f.prototype.getSamples=function(){return this._samples};f.prototype.computeSSAO=function(a,b,c,f,
e){g.assert(this.getEnableState());var h=f.getWidth(),k=f.getHeight();c=h/this._BLUR_F;var n=k/this._BLUR_F;this._ssaoFBO.setSize(h,k);this._blur0FBO.setSize(c,n);this._blur1FBO.setSize(c,n);c=1*h;n=1*k;this._ssaoFBO.bind();l.set(a.fullViewport,this._viewportToRestore);var z=this._gl;z.viewport(0,0,h,k);var w=this._programRep.get(8>=this._samples?"ssao8":16>=this._samples?"ssao16":32>=this._samples?"ssao32":"ssao64"),q=this._programRep.get("blur");w.use();var I=a.projectionMatrix;d[0]=-2/(c*I[0]);
d[1]=-2/(n*I[5]);d[2]=(1-I[2])/I[0];d[3]=(1+I[6])/I[5];I=0===I[11];w.uniform2f("rnmScale",h/v,k/v);w.uniform3fv("pSphere",8>=this._samples?m:16>=this._samples?p:32>=this._samples?t:x);w.uniform1f("numSpiralTurns",this._samples<u.length?u[this._samples]:5779);w.uniform4fv("projInfo",d);h=1/a.computePixelSizeAtDist(1);w.uniform1f("projScale",1*h);w.uniform2f("screenDimensions",c,n);I?(w.uniform2f("nearFar",a.near,a.far),w.uniform2f("zScale",0,-1)):(w.uniform2f("nearFar",a.near,a.far),w.uniform2f("zScale",
1,0));var s=2*this._radius,k=r.dist(a.eye,a.center),s=20*a.computePixelSizeAtDist(k),s=Math.max(0.1,s);w.uniform1f("radius",s);w.uniform1f("intensity",4*this._attenuation/Math.pow(s,6));w.uniform1i("rnm",0);w.uniform1i("normalMap",1);w.uniform1i("depthMap",2);z.activeTexture(z.TEXTURE0);z.bindTexture(z.TEXTURE_2D,this._noiseTexture);z.activeTexture(z.TEXTURE1);z.bindTexture(z.TEXTURE_2D,e.getTexture());z.activeTexture(z.TEXTURE2);z.bindTexture(z.TEXTURE_2D,f.getTexture());this._quadVBO.bind();this._quadVBO.setPointers(w);
this._quadVBO.getLayout().enableVertexAttribArrays(z,w);z.drawArrays(z.TRIANGLE_STRIP,0,this._quadVBO.getNum());q.changeShaderDefines(1,["RADIUS "+this._filterRadius]);f=(this._filterRadius+1)/2;f=1/(2*f*f);z.activeTexture(z.TEXTURE0);z.bindTexture(z.TEXTURE_2D,this._ssaoFBO.getTexture());z.viewport(0,0,c/this._BLUR_F,n/this._BLUR_F);this._blur0FBO.bind();q.use();q.uniform2f("screenDimensions",c,n);q.uniform1i("tex",0);q.uniform1i("normalMap",1);q.uniform1i("depthMap",2);q.uniform2f("blurSize",0,
1*this._BLUR_F/n);q.uniform1i("radius",this._filterRadius);q.uniform1f("g_BlurFalloff",f);q.uniform2f("nearFar",a.near,a.far);5E4<k&&(h=Math.max(0,h-(k-5E4)));q.uniform1f("projScale",h);I?q.uniform2f("zScale",0,-1):q.uniform2f("zScale",1,0);z.drawArrays(z.TRIANGLE_STRIP,0,this._quadVBO.getNum());q.uniform2f("blurSize",1*this._BLUR_F/c,0);this._blur1FBO.bind();z.bindTexture(z.TEXTURE_2D,this._blur0FBO.getTexture());z.drawArrays(z.TRIANGLE_STRIP,0,this._quadVBO.getNum());this._quadVBO.getLayout().disableVertexAttribArrays(z,
w);z.bindFramebuffer(z.FRAMEBUFFER,b);z.viewport(this._viewportToRestore[0],this._viewportToRestore[1],this._viewportToRestore[2],this._viewportToRestore[3])};f.prototype.setUniforms=function(a){var b=this.getEnableState();a.use();var d=this._gl;d.activeTexture(d.TEXTURE6);d.bindTexture(d.TEXTURE_2D,b?this._blur1FBO.getTexture():this._emptyTexture);d.activeTexture(d.TEXTURE0);a.uniform1i("ssaoTex",6);b?a.uniform4f("viewportPixelSz",this._viewportToRestore[0],this._viewportToRestore[1],1/this._ssaoFBO.getWidth(),
1/this._ssaoFBO.getHeight()):a.uniform4f("viewportPixelSz",-1,-1,-1,-1)};f.prototype.bindAll=function(a){a=a.getProgramsUsingUniform("viewportPixelSz");for(var b=0;b<a.length;b++)this.setUniforms(a[b])};f.prototype.drawQuad=function(a){g.assert(this.getEnableState());this._debugQuadVBO||(this._debugQuadVBO=new h(z,b.Defaults.Pos2Tex,this._gl));var d=this._gl,c=this._programRep.get("showDepth");d.disable(d.DEPTH_TEST);c.use();c.uniformMatrix4fv("proj",a);c.uniform1i("depthTex",0);d.bindTexture(d.TEXTURE_2D,
this._ssaoFBO.getTexture());this._debugQuadVBO.getLayout().enableVertexAttribArrays(d,c);this._debugQuadVBO.bind();this._debugQuadVBO.setPointers(c);d.drawArrays(d.TRIANGLE_STRIP,0,this._debugQuadVBO.getNum());d.bindBuffer(d.ARRAY_BUFFER,null);this._debugQuadVBO.getLayout().disableVertexAttribArrays(d,c);d.useProgram(null);d.enable(d.DEPTH_TEST)};f.loadShaders=function(b,d,f,l){g.assert(null==b.samples);b.samples="samplesUNDEF";b._parse(a);d=new e(l.VERTEX_SHADER,b.vertexShaderShowDepth,l);var m=
new e(l.FRAGMENT_SHADER,b.fragmentShaderShowDepth,l);d=new c([d,m],l);var p=b.createFsSSAOSrcObscurance,m=new e(l.VERTEX_SHADER,b.vsUVQuad,l),h=new e(l.FRAGMENT_SHADER,p.replace("samplesUNDEF","8"),l),r=new e(l.FRAGMENT_SHADER,p.replace("samplesUNDEF","16"),l),k=new e(l.FRAGMENT_SHADER,p.replace("samplesUNDEF","32"),l),t=new e(l.FRAGMENT_SHADER,p.replace("samplesUNDEF","64"),l),p=new e(l.FRAGMENT_SHADER,b.fsBlurEdgeAware,l),h=new c([m,h],l),r=new c([m,r],l),k=new c([m,k],l),t=new c([m,t],l);l=new c([m,
p],l);f.add("showDepth",d);f.add("ssao8",h);f.add("ssao16",r);f.add("ssao32",k);f.add("ssao64",t);f.add("blur",l);delete b.samples};return f}();var d=l.create(),m=[0.186937,0,0,0.677503,0,0,-0.782832,0.128424,0.557187,0.248064,0.460317,-0.659755,0.062892,0.918659,0.312829,-0.241031,-0.814826,0.224206,-0.642866,0.132138,-0.45016,0.145727,-0.590568,-0.626141,0.005017,-0.002234,0.012668],p=[0.186937,0,0,0.700542,0,0,-0.864858,-0.481795,-0.111713,-0.624773,0.102853,-0.730153,-0.387172,0.260319,0.007229,
-0.222367,-0.642631,-0.707697,-0.01336,-0.014956,0.169662,0.122575,0.1544,-0.456944,-0.177141,0.85997,-0.42346,-0.131631,0.814545,0.524355,-0.779469,0.007991,0.624833,0.308092,0.209288,0.35969,0.359331,-0.184533,-0.377458,0.192633,-0.482999,-0.065284,0.233538,0.293706,-0.055139,0.417709,-0.386701,0.442449,-0.301656,-0.836426,0.408344],t=[0.837372,0,0,0.723531,-0.467287,0.034157,0.169582,-0.31169,-0.881801,0.696236,0.455215,-0.204568,-0.304514,0.528086,0.626381,-0.053116,0.222507,0.037523,0.199755,
0.311291,0.916799,-0.681552,-0.516264,0.501792,-0.37127,0.021088,0.737477,-0.029503,0.209188,-0.95298,-0.573731,0.009962,-0.154202,-0.257345,-0.905958,0.282747,0.370779,0.527867,-0.669424,-0.601758,-0.191278,-0.708243,0.271796,0.782684,0.535565,-0.006867,-0.015312,-0.017276,0.419958,0.265628,0.233036,-0.543898,0.554747,-0.174055,-0.079242,0.053475,-0.099539,0.372042,-0.339267,-0.357362,0.015781,-0.011352,0.042707,-0.340564,-0.272507,-0.067725,0.799249,-0.127948,0.586808,0.450015,0.01965,-0.416454,
-0.506524,0.323229,0.206546,-0.087316,-0.311097,0.466049,0.146374,-0.34528,-0.045904,-0.152614,-0.926686,-0.287529,-0.665726,-0.032904,0.246643,0.248703,0.637193,-0.062541,-0.073706,0.495925,-0.315143,0.05946,-0.116042,0.075586],x=[0.186937,0,0,0.605726,-0.313457,-0.097616,0.003541,0.781245,0.283011,-0.225029,-0.373279,0.274442,-0.047511,0.04992,-0.226365,0.627629,-0.623617,-0.463628,0.133094,-0.318299,0.528128,0.262035,0.100234,-0.09012,0.178335,-0.426972,-0.666048,-0.27306,-0.207352,0.05514,-0.613649,
-0.063395,0.060608,-0.283391,-0.41382,-0.087565,0.136768,0.506126,0.484137,-0.593808,-0.344603,0.453164,0.675326,0.124799,-0.697865,-0.33502,0.411337,-0.09337,-0.15271,0.002908,-0.063582,0.366733,-0.699739,0.401148,-0.519536,-0.585625,-0.508413,0.106482,-0.428709,-0.260221,0.012847,-0.118806,0.016962,-0.188182,0.49945,0.452364,0.586617,0.722539,-0.23302,0.111295,0.202827,0.066695,-0.036503,0.315842,0.896467,-0.039109,-0.270116,-0.080062,0.613435,0.508787,0.538656,-0.352275,0.566869,-0.666275,0.887876,
-0.138341,-0.434135,-0.444711,0.269156,0.119506,-0.029457,-0.077316,0.754474,0.274125,-0.13876,-0.37082,-0.73268,0.332723,0.568545,-0.203992,0.878922,-0.430778,0.541154,-0.546752,0.11786,-3.93E-4,-0.083318,0.059333,-0.341406,-0.117017,-0.318568,-0.262425,-0.457913,0.848753,0.89229,-0.30157,0.322416,0.742328,0.032262,0.643827,0.048091,-0.078044,-0.49908,0.064858,0.549944,-0.796252,-0.230688,0.88978,-0.010153,0.397241,-0.27645,0.405666,-0.46593,0.131187,-0.600166,0.333834,-0.078219,0.73837,-0.870169,
-0.411658,-0.222175,-0.492421,0.741454,0.293757,-0.591244,0.389112,-0.388324,0.792346,0.578552,0.088459,-0.121858,-0.437241,-0.472535,-0.374835,0.302427,0.721264,0.057485,0.204085,-0.126575,0.510325,0.481492,-0.579888,-0.29411,-0.82136,0.156404,-0.819717,-0.042466,0.456573,0.079884,0.07019,0.179002,0.220279,0.970222,-0.088025,-0.299911,-0.234627,-0.820794,0.912112,0.243306,0.317869,0.241336,0.161841,-0.721568,0.301135,-0.635993,-0.0939,-0.514731,-0.089673,0.850964,-0.905087,0.314604,-0.098397],v=
64,u=[1,1,1,2,3,2,5,2,3,2,3,3,5,5,3,4,7,5,5,7,9,8,5,5,7,7,7,8,5,8,11,12,7,10,13,8,11,8,7,14,11,11,13,12,13,19,17,13,11,18,19,11,11,14,17,21,15,16,17,18,13,17,11,17,19,18,25,18,19,19,29,21,19,27,31,29,21,18,17,29,31,31,23,18,25,26,25,23,19,34,19,27,21,25,39,29,17,21,27,29],z=new Float32Array([0,0,0,0,512,0,1,0,0,512,0,1,512,512,1,1]);return s})},"esri/views/3d/webgl-engine/lib/ShadowMap":function(){define("./GLVBO ./GLSLProgram ./VertexBufferLayout ./GLUtil ./Camera ./Util ./gl-matrix".split(" "),
function(s,q,n,k,h,e,c){var b=c.vec2d,g=c.vec3d,f=c.vec4d,a=c.mat3d,r=c.mat4d,l=c.mat4;return function(d,c){function p(a,b){g.set3(a[b],a[b+3],a[b+6],ka);return ka}var t,x=4096,v,u,z=k.createEmptyTexture(c),w=1,C=2,A=[0,0,0,0,0],y=function(){this.camera=new h;this.lightMat=r.create()},B=[],D,F,H;for(D=0;4>D;++D)B[D]=new y;this.getIsSupported=function(){return c.getExtension("OES_standard_derivatives")};this.setTextureResolution=function(a){x=a};this.getTextureResolution=function(){return x};this.setMaxNumCascades=
function(a){C=e.clamp(Math.floor(a),1,4)};this.getMaxNumCascades=function(){return C};this.setEnableState=function(a){e.assert(a!==this.getEnableState());a?this.enable():this.disable()};this.getEnableState=function(){return void 0!==t};this.enable=function(){e.assert(!this.getEnableState());e.assert(this.getIsSupported(),"Shadow maps not supported");t=c.createTexture();c.bindTexture(c.TEXTURE_2D,t);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,
c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,x,x,0,c.RGBA,c.UNSIGNED_BYTE,null);v=c.createRenderbuffer();c.bindRenderbuffer(c.RENDERBUFFER,v);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,x,x);u=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,u);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,t,0);c.framebufferRenderbuffer(c.FRAMEBUFFER,
c.DEPTH_ATTACHMENT,c.RENDERBUFFER,v);k.checkFramebufferStatus(c.FRAMEBUFFER,c);c.bindTexture(c.TEXTURE_2D,null);c.bindRenderbuffer(c.RENDERBUFFER,null);c.bindFramebuffer(c.FRAMEBUFFER,null)};this.disable=function(){e.assert(this.getEnableState());c.deleteFramebuffer(u);c.deleteRenderbuffer(v);c.deleteTexture(t);t=v=u=void 0};var N=r.create(),G=r.create(),O=f.create(),M=Array(8);for(D=0;8>D;++D)M[D]=f.create();var I=g.create(),Z=g.create(),V=b.create(),L=b.create(),Y=b.create(),E=b.create(),ba=b.create(),
W=r.create(),R=g.create();this.prepare=function(a,d,l,h,k){e.assert(this.getEnableState());r.multiply(a.projectionMatrix,a.viewMatrix,N);var t=k[0],n=k[1];2>t&&(t=2);2>n&&(n=2);t>=n&&(t=2,n=4);w=Math.min(1+Math.floor(e.logWithBase(n/t,4)),C);l=Math.pow(n/t,1/w);for(k=0;k<w+1;++k)A[k]=t*Math.pow(l,k);r.inverse(N,G);r.lookAt([0,0,0],[-d[0],-d[1],-d[2]],[0,1,0],W);l=a.viewMatrix;a=a.projectionMatrix;for(k=0;k<w;++k){h=B[k];t=-A[k];n=-A[k+1];t=(a[10]*t+a[14])/Math.abs(a[11]*t+a[15]);n=(a[10]*n+a[14])/
Math.abs(a[11]*n+a[15]);e.assert(t<n);for(F=0;8>F;++F){f.set4(0===F%4||3==F%4?-1:1,0===F%4||1==F%4?-1:1,4>F?t:n,1,O);r.multiplyVec4(G,O,M[F]);for(H=0;3>H;++H)M[F][H]/=M[F][3]}g.negate(M[0],R);r.translate(W,R,h.camera.viewMatrix);for(F=0;8>F;++F)r.multiplyVec3(h.camera.viewMatrix,M[F]);g.set(M[0],I);g.set(M[0],Z);for(F=1;8>F;++F)for(H=0;3>H;++H)I[H]=Math.min(I[H],M[F][H]),Z[H]=Math.max(Z[H],M[F][H]);I[2]-=200;Z[2]+=200;h.camera.near=-Z[2];h.camera.far=-I[2];t=1/M[0][3];n=1/M[4][3];e.assert(t<n);var D=
t+Math.sqrt(t*n),y=Math.sin(Math.acos(l[2]*d[0]+l[6]*d[1]+l[10]*d[2])),D=D/y,t=M,z=D,Q=y,y=V,q=L,v=Y,K=E,D=ba;b.set2(0,0,U);for(var s=void 0,s=0;4>s;++s)b.add(U,t[s],U);b.scale(U,0.25);b.set2(0,0,X);for(s=4;8>s;++s)b.add(X,t[s],X);b.scale(X,0.25);b.lerp(t[4],t[5],0.5,P[0]);b.lerp(t[5],t[6],0.5,P[1]);b.lerp(t[6],t[7],0.5,P[2]);b.lerp(t[7],t[4],0.5,P[3]);for(var S=0,J=b.dist2(P[0],U),s=1;4>s;++s){var ka=b.dist2(P[s],U);ka<J&&(J=ka,S=s)}b.subtract(P[S],t[S+4],$);s=$[0];$[0]=-$[1];$[1]=s;b.subtract(X,
U,ea);b.lerp($,ea,Q);b.normalize($);S=Q=void 0;Q=S=b.dot(b.subtract(t[0],U,ca),$);for(s=1;8>s;++s)J=b.dot(b.subtract(t[s],U,ca),$),J<Q?Q=J:J>S&&(S=J);b.set(U,y);b.scale($,Q-z,ca);b.add(y,ca,y);for(var ka=-1,T=1,s=z=J=0;8>s;++s){b.subtract(t[s],y,ha);b.normalize(ha);var ma=$[0]*ha[1]-$[1]*ha[0];0<ma?ma>ka&&(ka=ma,J=s):ma<T&&(T=ma,z=s)}e.verify(0<ka,"leftArea");e.verify(0>T,"rightArea");b.scale($,Q,fa);b.add(fa,U,fa);b.scale($,S,da);b.add(da,U,da);ga[0]=-$[1];ga[1]=$[0];q=e.rayRay2D(y,t[z],da,b.add(da,
ga,ca),1,q);v=e.rayRay2D(y,t[J],da,ca,1,v);K=e.rayRay2D(y,t[J],fa,b.add(fa,ga,ca),1,K);t=e.rayRay2D(y,t[z],fa,ca,1,D);e.verify(q,"rayRay");e.verify(v,"rayRay");e.verify(K,"rayRay");e.verify(t,"rayRay");v=V;t=L;y=E;K=ba;D=h.camera.projectionMatrix;b.scale(b.subtract(y,K,ja),0.5);aa[0]=ja[0];aa[1]=ja[1];aa[2]=0;aa[3]=ja[1];aa[4]=-ja[0];aa[5]=0;aa[6]=ja[0]*ja[0]+ja[1]*ja[1];aa[7]=ja[0]*ja[1]-ja[1]*ja[0];aa[8]=1;aa[6]=-b.dot(p(aa,0),v);aa[7]=-b.dot(p(aa,1),v);v=b.dot(p(aa,0),y)+aa[6];q=b.dot(p(aa,1),
y)+aa[7];s=b.dot(p(aa,0),K)+aa[6];K=b.dot(p(aa,1),K)+aa[7];v=-(v+s)/(q+K);aa[0]+=aa[1]*v;aa[3]+=aa[4]*v;aa[6]+=aa[7]*v;v=1/(b.dot(p(aa,0),y)+aa[6]);q=1/(b.dot(p(aa,1),y)+aa[7]);aa[0]*=v;aa[3]*=v;aa[6]*=v;aa[1]*=q;aa[4]*=q;aa[7]*=q;aa[2]=aa[1];aa[5]=aa[4];aa[8]=aa[7];aa[7]+=1;v=b.dot(p(aa,1),t)+aa[7];q=b.dot(p(aa,2),t)+aa[8];s=b.dot(p(aa,1),y)+aa[7];K=b.dot(p(aa,2),y)+aa[8];v=-0.5*(v/q+s/K);aa[1]+=aa[2]*v;aa[4]+=aa[5]*v;aa[7]+=aa[8]*v;v=b.dot(p(aa,1),t)+aa[7];q=b.dot(p(aa,2),t)+aa[8];s=-q/v;aa[1]*=
s;aa[4]*=s;aa[7]*=s;D[0]=aa[0];D[1]=aa[1];D[2]=0;D[3]=aa[2];D[4]=aa[3];D[5]=aa[4];D[6]=0;D[7]=aa[5];D[8]=0;D[9]=0;D[10]=1;D[11]=0;D[12]=aa[6];D[13]=aa[7];D[14]=0;D[15]=aa[8];h.camera.projectionMatrix[10]=2/(I[2]-Z[2]);h.camera.projectionMatrix[14]=-(I[2]+Z[2])/(I[2]-Z[2]);r.multiply(h.camera.projectionMatrix,h.camera.viewMatrix,h.lightMat);t=x/2;h.camera.viewport[0]=0===k%2?0:t;h.camera.viewport[1]=0===Math.floor(k/2)?0:t;h.camera.viewport[2]=t;h.camera.viewport[3]=t}A[w]=100*n;c.bindFramebuffer(c.FRAMEBUFFER,
u);c.activeTexture(c.TEXTURE7);c.bindTexture(c.TEXTURE_2D,null);c.activeTexture(c.TEXTURE0);c.clearColor(1,1,1,1);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT)};var T=[];this.getCascades=function(){for(var a=0;a<w;++a)T[a]=B[a];T.length=w;return T};this.finish=function(a){e.assert(this.getEnableState());q.unuse(c);c.bindFramebuffer(c.FRAMEBUFFER,a)};this.bind=function(a){var b=this.getEnableState();c.activeTexture(c.TEXTURE7);c.bindTexture(c.TEXTURE_2D,b?t:z);c.activeTexture(c.TEXTURE0);a.use();
a.uniform1i("depthTex",7);a.uniform1f("depthHalfPixelSz",b?0.5/x:-1);a.uniform1i("shadowMapNum",w);a.uniform4f("shadowMapDistance",A[0],A[1],A[2],A[3])};this.bindAll=function(a){a=a.getProgramsUsingUniform("shadowMapDistance");for(var b=0;b<a.length;b++)this.bind(a[b])};var J=l.create(),S=new Float32Array(64);this.bindView=function(a,b){if(this.getEnableState()){var d;l.translate(B[0].lightMat,b,J);for(d=0;16>d;++d)S[d]=J[d];l.translate(B[1].lightMat,b,J);for(d=0;16>d;++d)S[16+d]=J[d];l.translate(B[2].lightMat,
b,J);for(d=0;16>d;++d)S[32+d]=J[d];l.translate(B[3].lightMat,b,J);for(d=0;16>d;++d)S[48+d]=J[d];a.uniformMatrix4fv("shadowMapMatrix",S)}};y=new Float32Array(16);y[0]=0;y[1]=0;y[2]=0;y[3]=0;y[4]=256;y[5]=0;y[6]=1;y[7]=0;y[8]=0;y[9]=256;y[10]=0;y[11]=1;y[12]=256;y[13]=256;y[14]=1;y[15]=1;var K=n.Defaults.Pos2Tex,Q=new s(y,K,c);this.drawDebugQuad=function(a){e.assert(this.getEnableState());var b=d.get("showDepth");c.disable(c.DEPTH_TEST);b.use();b.uniformMatrix4fv("proj",a);b.uniform1i("depthTex",0);
c.bindTexture(c.TEXTURE_2D,t);K.enableVertexAttribArrays(c,b);Q.bind();Q.setPointers(b);c.drawArrays(c.TRIANGLE_STRIP,0,Q.getNum());c.bindBuffer(c.ARRAY_BUFFER,null);K.disableVertexAttribArrays(c,b);c.bindTexture(c.TEXTURE_2D,null);q.unuse(c);c.enable(c.DEPTH_TEST)};var U=b.create(),X=b.create(),P=[b.create(),b.create(),b.create(),b.create()],$=b.create(),ea=b.create(),ca=b.create(),ha=b.create(),fa=b.create(),da=b.create(),ga=b.create(),ka=g.create(),ja=b.create(),aa=a.create()}})},"esri/views/3d/webgl-engine/lib/NearFarCalc":function(){define(["require",
"exports","./Util","./gl-matrix"],function(s,q,n,k){s=k.vec3d;var h=k.vec4d,e=k.mat4d;k=function(){function a(){this._context={content:[],near:[],far:[],nearSpecial:[],farSpecial:[],bestNear:0,bestFar:0,bestNear2:0,bestFar2:0};this._boundingInfoHelper=new c}a.prototype._resetContext=function(){var a=this._context;a.content.length=0;a.near.length=0;a.far.length=0;a.nearSpecial.length=0;a.farSpecial.length=0;a.bestNear=Number.MAX_VALUE;a.bestFar=-Number.MAX_VALUE;return this._context};a.prototype.calculateSceneNearFar=
function(a,b,c){var f=this._resetContext(),g=a.viewMatrix,e=g[2],h=g[6],r=g[10],k=g[14],n=0,C;for(C in b)if(g=b[C],!(null!=g.displayedIndexRange&&0===g.displayedIndexRange.length)&&g.castShadow&&c.get(g.idx)){var A=g.bsRadius,y=g.center,B=e*y[0]+h*y[1]+r*y[2]+k,y=B-A,A=B+A;f.content[n]=g;f.near[n]=-A;f.far[n]=-y;++n}if(0===n)return[f.bestNear,f.bestFar];for(b=0;b<n;++b)f.near[b]>f.bestFar&&(f.bestFar=f.near[b]),2<f.near[b]&&f.far[b]<f.bestNear&&(f.bestNear=f.far[b]);f.bestNear2=Math.max(0.5*f.bestNear,
2);f.bestFar2=2*f.bestFar;for(b=e=c=0;b<n;++b)f.near[b]<f.bestNear&&(f.near[b]>=f.bestNear2?f.bestNear=f.near[b]:f.nearSpecial[c++]=b),f.far[b]>f.bestFar&&(f.far[b]<=f.bestFar2?f.bestFar=f.far[b]:f.farSpecial[e++]=b);if(0===c&&0===e)return[f.bestNear,f.bestFar];f.nearSpecial.length=c;f.farSpecial.length=e;f.nearSpecial.sort(function(a,b){return f.near[a]<f.near[b]?-1:f.near[a]>f.near[b]?1:0});f.farSpecial.sort(function(a,b){return f.far[a]<f.far[b]?1:f.far[a]>f.far[b]?-1:0});this._boundingInfoHelper.init(a,
f);for(b=0;b<c;++b)f.near[f.nearSpecial[b]]<f.bestNear&&(g=f.content[f.nearSpecial[b]],a=g.boundingInfo,this._boundingInfoHelper.includeNearBoundingInfoRec(a,g.transformation));for(b=0;b<e;++b)f.far[f.farSpecial[b]]>f.bestFar&&(g=f.content[f.farSpecial[b]],a=g.boundingInfo,this._boundingInfoHelper.includeFarBoundingInfoRec(a,g.transformation));return[f.bestNear,f.bestFar]};return a}();var c=function(){function a(){this._clippingHelper=new b;this._planes=[h.create(),h.create(),h.create(),h.create(),
h.create(),h.create()];this._viewProj=e.create();this._view=e.create()}a.prototype.init=function(a,b){this._context=b;e.set(a.viewMatrix,this._view);e.multiply(a.projectionMatrix,this._view,this._viewProj);a.copyFrustumPlanes(this._planes);this._clippingHelper.init(b)};a.prototype.includeNearBoundingInfoRec=function(a,b){var c=a.getBSRadius(),g=a.getCenter();e.multiplyVec3(b,g,f);var g=b[2]*b[2]+b[6]*b[6]+b[10]*b[10],g=Math.sqrt(Math.max(Math.max(b[0]*b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+
b[9]*b[9]),g)),h=f[0],r=f[1],k=f[2],c=c*g;if(!(this._planes[0][0]*h+this._planes[0][1]*r+this._planes[0][2]*k+this._planes[0][3]>c)&&(!(this._planes[1][0]*h+this._planes[1][1]*r+this._planes[1][2]*k+this._planes[1][3]>c)&&!(this._planes[2][0]*h+this._planes[2][1]*r+this._planes[2][2]*k+this._planes[2][3]>c)&&!(this._planes[3][0]*h+this._planes[3][1]*r+this._planes[3][2]*k+this._planes[3][3]>c))&&(g=this._view[2]*h+this._view[6]*r+this._view[10]*k+this._view[14],h=g+c,!(2>-(g-c))&&!(-h>=this._context.bestNear)))if(-h>
this._context.bestNear2)this._context.bestNear=-h;else{if(100<c&&(c=a.getChildren(),void 0!==c)){for(g=0;8>g;++g)void 0!==c[g]&&this.includeNearBoundingInfoRec(c[g],b);return}this._clippingHelper.intersectFrustumAABB(this._viewProj,b,a.getBBMin(),a.getBBMax())}};a.prototype.includeFarBoundingInfoRec=function(a,b){var c=a.getBSRadius(),g=a.getCenter();e.multiplyVec3(b,g,f);var g=b[2]*b[2]+b[6]*b[6]+b[10]*b[10],g=Math.sqrt(Math.max(Math.max(b[0]*b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+b[9]*b[9]),
g)),h=f[0],r=f[1],k=f[2],c=c*g;if(!(this._planes[0][0]*h+this._planes[0][1]*r+this._planes[0][2]*k+this._planes[0][3]>c)&&(!(this._planes[1][0]*h+this._planes[1][1]*r+this._planes[1][2]*k+this._planes[1][3]>c)&&!(this._planes[2][0]*h+this._planes[2][1]*r+this._planes[2][2]*k+this._planes[2][3]>c)&&!(this._planes[3][0]*h+this._planes[3][1]*r+this._planes[3][2]*k+this._planes[3][3]>c))&&(g=this._view[2]*h+this._view[6]*r+this._view[10]*k+this._view[14]-c,!(-g<=this._context.bestFar)))if(-g<this._context.bestFar2)this._context.bestFar=
-g;else{if(100<c&&(c=a.getChildren(),void 0!==c)){for(g=0;8>g;++g)void 0!==c[g]&&this.includeFarBoundingInfoRec(c[g],b);return}this._clippingHelper.intersectFrustumAABB(this._viewProj,b,a.getBBMin(),a.getBBMax())}};return a}(),b=function(){function b(){this._clipP=Array(8);for(var a=0;8>a;++a)this._clipP[a]=h.create()}b.prototype.init=function(a){this._context=a};b.prototype.intersectFrustumAABB=function(b,d,c,f){e.multiply(b,d,a);for(b=0;8>b;++b){d=this._clipP[b];var h=0===b||3===b||4===b||7===b?
c[0]:f[0],r=0===b||1===b||4===b||5===b?c[1]:f[1],k=4>b?c[2]:f[2];d[0]=a[0]*h+a[4]*r+a[8]*k+a[12];d[1]=a[1]*h+a[5]*r+a[9]*k+a[13];d[2]=a[2]*h+a[6]*r+a[10]*k+a[14];d[3]=a[3]*h+a[7]*r+a[11]*k+a[15]}for(b=0;12>b;++b){c=this._clipTriangle(this._clipP[g[b][0]],this._clipP[g[b][1]],this._clipP[g[b][2]]);f=!0;for(d=0;d<c.length;++d)if(h=c[d][3],2<=h){f=!1;break}if(!f)for(d=0;d<c.length;++d)h=c[d][3],h<this._context.bestNear&&(this._context.bestNear=h),h>this._context.bestFar&&(this._context.bestFar=h)}};
b.prototype._inside=function(a,b){if(0===b)return a[0]>=-a[3];if(1===b)return a[1]>=-a[3];if(2===b)return a[0]<=a[3];if(3===b)return a[1]<=a[3];n.assert(!1)};b.prototype._intersect=function(a,b,c){var f=0;0===c?f=(-a[3]-a[0])/(b[0]-a[0]+b[3]-a[3]):1===c?f=(-a[3]-a[1])/(b[1]-a[1]+b[3]-a[3]):2===c?f=(a[3]-a[0])/(b[0]-a[0]-b[3]+a[3]):3===c&&(f=(a[3]-a[1])/(b[1]-a[1]-b[3]+a[3]));return h.lerp(a,b,f,h.create())};b.prototype._clipTriangle=function(a,b,c){a=[a,b,c];for(b=0;4>b;++b){c=a;a=[];for(var f=0;f<
c.length;++f){var g=c[f],e=c[(f+1)%c.length];this._inside(e,b)?(this._inside(g,b)||a.push(this._intersect(g,e,b)),a.push(e)):this._inside(g,b)&&a.push(this._intersect(g,e,b))}}return a};return b}(),g=[[0,1,3],[2,3,1],[1,5,2],[6,2,5],[5,4,6],[7,6,4],[4,0,7],[3,7,0],[3,2,7],[6,7,2],[4,5,0],[1,0,5]],f=s.create(),a=e.create();return k})},"esri/views/3d/webgl-engine/lib/HighlightHelper":function(){define("require exports ./GLFBO ./GLVBO ./GLSLShader ./GLSLProgram ./VertexBufferLayout ./Util ./gl-matrix dojo/text!../materials/internal/highlight.xml".split(" "),
function(s,q,n,k,h,e,c,b,g,f){var a=g.vec4d;return function(){function g(b,d,c){this.blur1Fbo=this.blur0Fbo=this.quadVBO=null;this.gl=c;this.viewportToRestore=a.create();this.programRep=b;this.color=a.create();this.exponent=0.3;this.fill=0.1;a.set4(1,0,0.5,1,this.color)}g.prototype.createQuadVBO=function(a){var b=new Float32Array(8);b[0]=-1;b[1]=-1;b[2]=1;b[3]=-1;b[4]=-1;b[5]=1;b[6]=1;b[7]=1;return new k(b,c.Defaults.Pos2,a)};g.prototype.getIsSupported=function(){return!0};g.prototype.setEnableState=
function(a){b.assert(a!==this.getEnableState());a?this.enable():this.disable()};g.prototype.getEnableState=function(){return null!==this.blur0Fbo};g.prototype.enable=function(){var a=this.gl;this.quadVBO=this.createQuadVBO(this.gl);this.blur0Fbo=new n(a.RGBA,a.UNSIGNED_BYTE,!1,a.LINEAR,a,null);this.blur1Fbo=new n(a.RGBA,a.UNSIGNED_BYTE,!1,a.LINEAR,a,null)};g.prototype.disable=function(){b.assert(this.getEnableState());this.quadVBO.dispose();this.blur1Fbo.dispose();this.blur0Fbo.dispose();this.blur1Fbo=
this.blur0Fbo=this.quadVBO=null};g.prototype.getHighlightFBO=function(){return this.blur0Fbo};g.prototype.render=function(c,d,f){this.updateDebugData();var g=this.gl;b.assert(this.getEnableState());a.set(c.fullViewport,this.viewportToRestore);c=f.getWidth();var e=f.getHeight();c=Math.ceil(c/2);e=Math.ceil(e/2);this.blur0Fbo.setSize(c,e);this.blur1Fbo.setSize(c,e);var h=this.programRep.get("highlight-blur"),r=this.programRep.get("highlight-apply");this.quadVBO.bind();this.quadVBO.setPointers(h,!1);
this.quadVBO.getLayout().enableVertexAttribArrays(g,h,void 0);g.depthMask(!1);g.disable(g.DEPTH_TEST);g.disable(g.BLEND);this.blur0Fbo.bind();g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,f.getTexture());h.use();h.uniform1i("tex",0);h.uniform2f("blurSize",1/c,0);g.viewport(0,0,c,e);g.drawArrays(g.TRIANGLE_STRIP,0,this.quadVBO.getNum());this.blur1Fbo.bind();h.uniform1i("tex",0);h.uniform2f("blurSize",0,1/e);g.bindTexture(g.TEXTURE_2D,this.blur0Fbo.getTexture());g.drawArrays(g.TRIANGLE_STRIP,
0,this.quadVBO.getNum());g.bindFramebuffer(g.FRAMEBUFFER,d);g.enable(g.BLEND);g.blendFunc(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA);g.viewport(this.viewportToRestore[0],this.viewportToRestore[1],this.viewportToRestore[2],this.viewportToRestore[3]);r.use();r.uniform1i("tex",0);g.bindTexture(g.TEXTURE_2D,this.blur1Fbo.getTexture());r.uniform1i("origin",1);r.uniform4fv("color",this.color);r.uniform1f("exponent",this.exponent);r.uniform1f("fill",this.fill);g.activeTexture(g.TEXTURE1);g.bindTexture(g.TEXTURE_2D,
f.getTexture());g.drawArrays(g.TRIANGLE_STRIP,0,this.quadVBO.getNum());g.activeTexture(g.TEXTURE0);this.quadVBO.getLayout().disableVertexAttribArrays(g,h,void 0);g.depthMask(!0);g.enable(g.DEPTH_TEST);g.disable(g.BLEND)};g.prototype.updateDebugData=function(){window.webglEngineHighlightColor?a.set(window.webglEngineHighlightColor,this.color):window.webglEngineHighlightColor=[this.color[0],this.color[1],this.color[2],this.color[3]];void 0!==window.webglEngineHighlightExponent?this.exponent=window.webglEngineHighlightExponent:
window.webglEngineHighlightExponent=this.exponent;void 0!==window.webglEngineHighlightFill?this.fill=window.webglEngineHighlightFill:window.webglEngineHighlightFill=this.fill};g.loadShaders=function(a,b,c,g){a._parse(f);var r=new h(g.VERTEX_SHADER,a.vsHighlightBlurG9,g,void 0),k=new h(g.FRAGMENT_SHADER,a.fsHighlightBlurG9,g,void 0);b=new h(g.VERTEX_SHADER,a.vsHighlightApply,g,void 0);a=new h(g.FRAGMENT_SHADER,a.fsHighlightApply,g,void 0);r=new e([r,k],g);g=new e([b,a],g);c.add("highlight-blur",r);
c.add("highlight-apply",g)};return g}()})},"esri/views/3d/webgl-engine/lib/OffscreenRenderingHelper":function(){define("require exports ./GLFBO ./GLVBO ./GLSLShader ./GLSLProgram ./VertexBufferLayout ./Util dojo/text!../materials/internal/offscreen.xml".split(" "),function(s,q,n,k,h,e,c,b,g){return function(){function f(a,b){this._enabled=!1;this.height=this.width=0;this._programRep=a;this._gl=b;this.height=this.width=this._extension=null}f.prototype.enable=function(){b.assert(!this.getEnableState());
b.assert(this.getIsSupported());var a=this._gl;this._enabled=!0;this.osFBO=new n(a.RGBA,a.UNSIGNED_BYTE,!1,a.NEAREST,a,void 0,!0);this.quadVBO=this.createQuadVBO(a)};f.prototype.disable=function(){b.assert(this.getEnableState());this._enabled=!1;this.osFBO.dispose();this.quadVBO.dispose();this.quadVBO=this.osFBO=null};f.prototype.createQuadVBO=function(a){var b=new Float32Array(16);b[0]=-1;b[1]=-1;b[2]=-1;b[3]=-1;b[4]=1;b[5]=-1;b[6]=1;b[7]=-1;b[8]=-1;b[9]=1;b[10]=-1;b[11]=1;b[12]=1;b[13]=1;b[14]=
1;b[15]=1;return new k(b,c.Defaults.Pos2Tex,a)};f.prototype.getIsSupported=function(){var a=this._gl;this._extension||(this._extension=a.getExtension("WEBGL_depth_texture"));return!!this._extension};f.prototype.setEnableState=function(a){a?this.enable():this.disable()};f.prototype.getEnableState=function(){return this._enabled};f.prototype.getColorTexture=function(){return this.osFBO.getTexture()};f.prototype.getDepthFBO=function(){return this.osFBO.getVirtualDepthFBO()};f.prototype.prepareRenderPass=
function(a){b.assert(this.getEnableState());var c=this._gl;a=a.fullViewport;this.width=a[2];this.height=a[3];this.osFBO.setSize(this.width,this.height);this.osFBO.bind();c.clearColor(0,0,0,1);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT)};f.prototype.drawQuad=function(a){b.assert(this.getEnableState());a=this._gl;var c=this._programRep.get("offscreenProgram");a.bindFramebuffer(a.FRAMEBUFFER,null);a.disable(a.DEPTH_TEST);a.clear(a.COLOR_BUFFER_BIT);c.use();a.bindTexture(a.TEXTURE_2D,this.osFBO.getTexture());
this.quadVBO.getLayout().enableVertexAttribArrays(a,c);this.quadVBO.bind();this.quadVBO.setPointers(c);a.drawArrays(a.TRIANGLE_STRIP,0,this.quadVBO.getNum());a.bindBuffer(a.ARRAY_BUFFER,null);this.quadVBO.getLayout().disableVertexAttribArrays(a,c);a.useProgram(null);a.enable(a.DEPTH_TEST)};f.loadShaders=function(a,b,c,d){a._parse(g);b=new h(d.VERTEX_SHADER,a.vsOffscreenRenderer,d);a=new h(d.FRAGMENT_SHADER,a.fsOffscreenRenderer,d);d=new e([b,a],d);c.add("offscreenProgram",d)};return f}()})},"esri/views/3d/webgl-engine/materials/repository":function(){define("dojo/text!./internal/util.xml ./BillboardMaterial ./ColorMaterial ./HUDMaterial ./LeafCardMaterial ./Material ./RibbonLineMaterial ./WaterMaterial ./internal/SimpleGLMaterial ./internal/TexOnlyGLMaterial ./internal/BlendLayers".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a){return{initializeShaders:function(r,l,d,m){r._parse(s);g.loadShaders(r,l,d,m);f.loadShaders(r,l,d,m);e.loadShaders(r,l,d,m);q.loadShaders(r,l,d,m);k.loadShaders(r,l,d,m);h.loadShaders(r,l,d,m);c.loadShaders(r,l,d,m);b.loadShaders(r,l,d,m);a.loadShaders(r,l,d,m);n.loadShaders(r,l,d,m)}}})},"esri/views/3d/webgl-engine/materials/BillboardMaterial":function(){define(["dojo/text!./BillboardMaterial.xml","./internal/MaterialUtil","../lib/GLSLProgram","../lib/GLSLShader",
"../lib/RenderSlot"],function(s,q,n,k,h){var e=function(f,a){q.basicMaterialConstructor(this,a);var e=q.Layouts.PosNormTex;this.getSize=function(){return 1.05};this.dispose=function(){};this.getTextureId=function(){return f};this.getOutputAmount=function(a){return 6*a*e.getStride()};this.getVertexBufferLayout=function(){return e};this.fillInterleaved=function(a,b,c,f,g,e){f=q.fill;var h=a.faces.indices.va,r=a.vertexAttr.va.data,k=a.vertexAttr.tc4.data,n=a.vertexAttr.n0.data,C=a.vertexAttr.n1.data,
A=a.vertexAttr.n2.data;a=a.vertexAttr.n3.data;for(var y=0;y<h.length;++y){var B=4*h[y],D=3*h[y];e+=f(r,B,g,e,b,3);e+=f(n,D,g,e,c,3);g[e++]=k[B];g[e++]=k[B+1];e+=f(r,B,g,e,b,3);e+=f(C,D,g,e,c,3);g[e++]=k[B+2]+1;g[e++]=k[B+1];e+=f(r,B,g,e,b,3);e+=f(A,D,g,e,c,3);g[e++]=k[B+2]+1;g[e++]=k[B+3]+1;e+=f(r,B,g,e,b,3);e+=f(A,D,g,e,c,3);g[e++]=k[B+2]+1;g[e++]=k[B+3]+1;e+=f(r,B,g,e,b,3);e+=f(a,D,g,e,c,3);g[e++]=k[B];g[e++]=k[B+3]+1;e+=f(r,B,g,e,b,3);e+=f(n,D,g,e,c,3);g[e++]=k[B];g[e++]=k[B+1]}};this.intersect=
function(){};this.getGLMaterials=function(){return{color:c,depthShadowMap:g,normal:void 0,depth:b,highlight:void 0}};this.getAllTextureIds=function(){return[f]}},c=function(b,a,c){q.basicGLMaterialConstructor(this,b);var g=h.TRANSPARENT_MATERIAL,d=a.get("billboard");q.singleTextureGLMaterialConstructor(this,c,{textureId:b.getTextureId()});this.beginSlot=function(a){return g===a};this.getProgram=function(){return d};this.bind=function(a,c){d.use();this.bindTexture(a,d);b.getVertexBufferLayout().enableVertexAttribArrays(a,
d)};this.release=function(a){b.getVertexBufferLayout().disableVertexAttribArrays(a,d)};this.bindView=function(a,b){q.bindView(b.origin,b.view,d)};this.bindInstance=function(a,b){d.uniformMatrix4fv("model",b.transformation);d.uniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.TRIANGLES}},b=function(b,a,c,g){q.basicGLMaterialConstructor(this,b);var d=h.TRANSPARENT_MATERIAL,m=null==g?a.get("billboardDepth"):a.get("billboardDepthShadowMap");q.singleTextureGLMaterialConstructor(this,
c,{textureId:b.getTextureId()});this.beginSlot=function(a){return d===a};this.getProgram=function(){return m};this.bind=function(a,d){m.use();this.bindTexture(a,m);m.uniform2fv("nearFar",d.nearFar);b.getVertexBufferLayout().enableVertexAttribArrays(a,m)};this.release=function(a){b.getVertexBufferLayout().disableVertexAttribArrays(a,m)};this.bindView=function(a,b){q.bindView(b.origin,b.view,m)};this.bindInstance=function(a,b){m.uniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.TRIANGLES}},
g=function(c,a,g){b.call(this,c,a,g,!0)};e.loadShaders=function(b,a,c,g){b._parse(s);var d=new k(g.VERTEX_SHADER,b.vertexShaderBillboard,g),m=new k(g.FRAGMENT_SHADER,b.fragmentShaderBillboard,g),d=new n([d,m],g);b=new k(g.VERTEX_SHADER,b.vertexShaderBillboardDepth,g);m=a.get("fsDepthTextured");a=a.get("fsDepthTexturedShadowMap");m=new n([b,m],g);g=new n([b,a],g);c.add("billboard",d);c.add("billboardDepth",m);c.add("billboardDepthShadowMap",g)};return e})},"esri/views/3d/webgl-engine/materials/ColorMaterial":function(){define("dojo/_base/lang dojo/text!./ColorMaterial.xml ./internal/MaterialUtil ../lib/GLSLProgram ../lib/GLSLShader ../lib/RenderSlot ../lib/Util".split(" "),
function(s,q,n,k,h,e,c){c=function(c,a){n.basicMaterialConstructor(this,a);c=c||{};c.color=c.color||[1,1,1,1];c.polygonOffset=c.polygonOffset||!1;c.vertexColors=c.vertexColors||!1;var e=n.Layouts.PosColor;this.getParams=function(){return c};this.setColor=function(a){c.color=a;this.notifyDirty("matChanged")};this.getColor=function(){return c.color};this.setTransparent=function(a){c.transparent=a;this.notifyDirty("matChanged")};this.getTransparent=function(a){return c.transparent};this.dispose=function(){};
this.getOutputAmount=function(a){return a*e.getStride()};this.getVertexBufferLayout=function(){return e};this.fillInterleaved=function(a,b,c,f,g,h,k){n.fillInterleaved(a,b,c,f,e,g,h,k)};this.intersect=n.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:b,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:g}};this.getAllTextureIds=function(){return[]}};var b=function(b,a,c){n.basicGLMaterialConstructor(this,b);var g=s.clone(b.getParams()),d=a.get("colorMaterial"),m=b.getColor();
this.beginSlot=function(a){return a===(1>m[3]?e.TRANSPARENT_MATERIAL:e.OPAQUE_MATERIAL)};this.getProgram=function(){return d};this.updateParameters=function(){g.color=b.getColor();g.transparent=b.getTransparent()};this.bind=function(a,c){d.use();d.uniform4fv("eColor",g.color);b.getVertexBufferLayout().enableVertexAttribArrays(a,d);g.polygonOffset&&(a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(1,1));g.transparent&&a.enable(a.BLEND);a.web3DDefaultState.cullEnabled&&a.disable(a.CULL_FACE)};this.release=
function(a){b.getVertexBufferLayout().disableVertexAttribArrays(a,d);g.transparent&&a.disable(a.BLEND);a.web3DDefaultState.cullEnabled&&a.enable(a.CULL_FACE)};this.bindView=function(a,b){n.bindView(b.origin,b.view,d)};this.bindInstance=function(a,b){d.uniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.TRIANGLES}},g=function(b,a,c){n.basicGLMaterialConstructor(this,b);var g=s.clone(b.getParams()),d=a.get("colorMaterial"),m=[1,1,1,1];this.beginSlot=function(a){return a===
(1>m[3]?e.TRANSPARENT_MATERIAL:e.OPAQUE_MATERIAL)};this.getProgram=function(){return d};this.updateParameters=function(){g.color=b.getColor();g.transparent=b.getTransparent()};this.bind=function(a,c){d.use();d.uniform4fv("eColor",g.color);b.getVertexBufferLayout().enableVertexAttribArrays(a,d);g.polygonOffset&&(a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(1,1));a.web3DDefaultState.cullEnabled&&a.disable(a.CULL_FACE)};this.release=function(a){b.getVertexBufferLayout().disableVertexAttribArrays(a,
d);a.web3DDefaultState.cullEnabled&&a.enable(a.CULL_FACE)};this.bindView=function(a,b){n.bindView(b.origin,b.view,d)};this.bindInstance=function(a,b){d.uniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.TRIANGLES}};c.programs=null;c.loadShaders=function(b,a,c,g){b._parse(q);a=new h(g.VERTEX_SHADER,b.vertexShaderColorMaterial,g);b=new h(g.FRAGMENT_SHADER,b.fragmentShaderColorMaterial,g);g=new k([a,b],g);c.add("colorMaterial",g)};return c})},"esri/views/3d/webgl-engine/materials/HUDMaterial":function(){define("dojo/_base/lang dojo/text!./HUDMaterial.xml ./internal/MaterialUtil ../lib/GLSLProgram ../lib/GLSLShader ../lib/ShaderVariations ../lib/VertexBufferLayout ../lib/Util ../lib/gl-matrix ../lib/webglConstants ../lib/RenderSlot".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a){var r=g.vec2d,l=g.vec3d,d=g.mat4d,m=b.assert,p=b.VertexAttrConstants,t={"bottom-left":[0,0],bottom:[0.5,0],"bottom-right":[1,0],left:[0,0.5],center:[0.5,0.5],right:[1,0.5],"top-left":[0,1],top:[0.5,1],"top-right":[1,1]};b=function(a,b){n.basicMaterialConstructor(this,b);a=a||null;a.texCoordScale=a.texCoordScale||[1,1];a.occlusionTest=void 0!==a.occlusionTest?a.occlusionTest:!0;a.color=a.color||[1,1,1,1];a.screenMinMaxSize=a.screenMinMaxSize||[0,1E5];a.outlineColor=
a.outlineColor||[1,1,1,1];a.outlineSize=a.outlineSize||0;a.textureIsSignedDistanceField=a.textureIsSignedDistanceField?1:0;a.distanceFieldBoundingBox=a.distanceFieldBoundingBox||[0.25,0.25,0.75,0.75];a.screenOffset?a.screenOffset.forEach(function(b,d){a.screenOffset[d]=2*b}):a.screenOffset=[0,0];"string"===typeof a.anchorPos?(m(t[a.anchorPos],"HUDMaterial: invalid anchorPos specified"),a.anchorPos=t[a.anchorPos]):a.anchorPos||(a.anchorPos=t.center);null==a.shaderPolygonOffset&&(a.shaderPolygonOffset=
1E-5);var g=new c([p.POSITION,p.NORMAL,p.UV0,p.COLOR,p.SIZE,p.AUXPOS1],[3,3,2,4,2,4],[f.FLOAT,f.FLOAT,f.FLOAT,f.UNSIGNED_BYTE,f.FLOAT,f.FLOAT]),e=g.getStride(),h=4*e;this.dispose=function(){};this.getParameterValues=function(){var b={color:a.color,texCoordScale:a.texCoordScale,polygonOffset:a.polygonOffset,anchorPos:a.anchorPos,screenOffset:a.screenOffset,screenMinMaxSize:a.screenMinMaxSize,shaderPolygonOffset:a.shaderPolygonOffset,textureIsSignedDistanceField:a.textureIsSignedDistanceField,outlineColor:a.outlineColor,
outlineSize:a.outlineSize,distanceFieldBoundingBox:a.distanceFieldBoundingBox};a.textureId&&(b.textureId=a.textureId);a.direction&&(b.direction=a.direction);return b};this.setParameterValues=function(b){for(var d in b)"textureId"===d&&m(a.textureId,"Can only change texture of material that already has a texture"),"direction"===d&&m(a.direction,"Can only change direction of HUDMaterial which was initialized with a direction"),a[d]=b[d];this.notifyDirty("matChanged")};this.getParams=function(){return a};
this.getOutputAmount=function(a){return 6*a*e};this.getVertexBufferLayout=function(){return g};this.fillInterleaved=function(b,d,c,f,l,m){f=n.fill;for(var r=g.getAttributes(),k=b.faces.indices[p.POSITION],B=b.vertexAttr[p.POSITION].data,t=m+r[p.POSITION].offset,D=0;D<k.length;++D){var y=3*k[D];f(B,y,l,t,d,3);t+=e;f(B,y,l,t,d,3);t+=e;f(B,y,l,t,d,3);t+=e;f(B,y,l,t,d,3);t+=e;f(B,y,l,t,d,3);t+=e;f(B,y,l,t,d,3);t+=e}d=b.faces.indices[p.NORMAL];B=b.vertexAttr[p.NORMAL].data;t=m+r[p.NORMAL].offset;for(D=
0;D<d.length;++D)y=3*d[D],f(B,y,l,t,c,3),t+=e,f(B,y,l,t,c,3),t+=e,f(B,y,l,t,c,3),t+=e,f(B,y,l,t,c,3),t+=e,f(B,y,l,t,c,3),t+=e,f(B,y,l,t,c,3),t+=e;t=m+r[p.UV0].offset;D=b.vertexAttr[p.UV0].data;null==D||3>=D.length?(c=y=0,d=a.texCoordScale[0],B=a.texCoordScale[1]):(y=b.vertexAttr[p.UV0].data[0],c=b.vertexAttr[p.UV0].data[1],d=b.vertexAttr[p.UV0].data[2],B=b.vertexAttr[p.UV0].data[3]);d=Math.min(1.99999,d+1);B=Math.min(1.99999,B+1);for(D=0;D<k.length;++D)l[t]=y,l[t+1]=c,t+=e,l[t]=d,l[t+1]=c,t+=e,l[t]=
d,l[t+1]=B,t+=e,l[t]=d,l[t+1]=B,t+=e,l[t]=y,l[t+1]=B,t+=e,l[t]=y,l[t+1]=c,t+=e;k=b.faces.indices[p.COLOR];c=b.vertexAttr[p.COLOR].data;t=4*(m+r[p.COLOR].offset);d=new Uint8Array(l.buffer);for(D=0;D<k.length;++D)y=4*k[D],f(c,y,d,t,null,4),t+=h,f(c,y,d,t,null,4),t+=h,f(c,y,d,t,null,4),t+=h,f(c,y,d,t,null,4),t+=h,f(c,y,d,t,null,4),t+=h,f(c,y,d,t,null,4),t+=h;k=b.faces.indices[p.SIZE];y=b.vertexAttr[p.SIZE].data;t=m+r[p.SIZE].offset;for(D=0;D<k.length;++D)c=y[2*k[D]],d=y[2*k[D]+1],l[t]=c,l[t+1]=d,t+=
e,l[t]=c,l[t+1]=d,t+=e,l[t]=c,l[t+1]=d,t+=e,l[t]=c,l[t+1]=d,t+=e,l[t]=c,l[t+1]=d,t+=e,l[t]=c,l[t+1]=d,t+=e;if(null!=b.faces.indices[p.AUXPOS1]&&null!=b.vertexAttr[p.AUXPOS1]){k=b.faces.indices[p.AUXPOS1];b=b.vertexAttr[p.AUXPOS1].data;t=m+r.auxpos1.offset;for(D=0;D<k.length;++D)y=4*k[D],f(b,y,l,t,null,4),t+=e,f(b,y,l,t,null,4),t+=e,f(b,y,l,t,null,4),t+=e,f(b,y,l,t,null,4),t+=e,f(b,y,l,t,null,4),t+=e,f(b,y,l,t,null,4),t+=e}};var r=l.create(),k=l.create(),D=[0,0];this.intersect=function(b,c,f,g,e,h,
t,n,A,z,w,x){if(x){c=b.getData().getVertexAttr()[p.POSITION];b=b.getData().getVertexAttr()[p.SIZE];m(3<=c.size);for(t=0;t<c.data.length/c.size;t++)if(n=t*c.size,l.set3(c.data[n],c.data[n+1],c.data[n+2],r),d.multiplyVec3(f,r,r),n=t*b.size,D[0]=b.data[n],D[1]=b.data[n+1],A.projectPoint(r,k),-1<k[0]){x=a.anchorPos;n=k[0]-1-(0<x[0]?D[0]*x[0]:0);z=n+D[0];x=k[1]-1-(0<x[1]?D[1]*x[1]:0);var C=x+D[1];if(a.textureIsSignedDistanceField){var q=a.distanceFieldBoundingBox,v=a.outlineSize/2;n+=D[0]*q[0]-v;z-=D[0]*
(1-q[2])-v;x+=D[1]*q[1]-v;C-=D[1]*(1-q[3])-v}g[0]>n&&(g[0]<z&&g[1]>x&&g[1]<C)&&(n=l.subtract(e,r,l.create()),z=l.length(n),l.scale(n,1/z),z=0.98*z/l.dist(e,h),w(z,n,-1,1,!0))}}};this.getGLMaterials=function(){return{color:x,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:v}};this.getAllTextureIds=function(){return[a.textureId]};this._textureDirty=!1;this.setTextureDirty=function(){this._textureDirty=!0}};var x=function(b,d,c){function f(){return d.shaderVariators.HUDMaterial.getProgram([!!m.direction,
!!m.worldScale,m.occlusionTest,m.textureIsSignedDistanceField])}n.basicGLMaterialConstructor(this,b);var g=a.TRANSPARENT_MATERIAL,l=a.OVERLAY,e=0,m=s.clone(b.getParams()),h=d.get("hudOcclusionTestPixel"),p=f();n.singleTextureGLMaterialConstructor(this,c,m);var k=[254/255,253/255,252/255];this.beginSlot=function(a){e=a;return m.occlusionTest?a===g||a==l:a===g};this.getProgram=function(){return e===g&&m.occlusionTest?h:p};this.getAllPrograms=function(){return[h,p]};this.updateParameters=function(){var a=
b.getParams();m.color=a.color;m.texCoordScale=a.texCoordScale;m.polygonOffset=a.polygonOffset;m.anchorPos=a.anchorPos;m.screenOffset=a.screenOffset;m.screenMinMaxSize=a.screenMinMaxSize;m.direction=a.direction;m.shaderPolygonOffset=a.shaderPolygonOffset;m.textureIsSignedDistanceField=a.textureIsSignedDistanceField;m.outlineColor=a.outlineColor;m.outlineSize=a.outlineSize;this.updateTexture(a.textureId);p=f()};this.bind=function(a,d){b._textureDirty&&(this.renderTexture(a),b._textureDirty=!1);if(e===
g&&m.occlusionTest)h.use(),h.uniform1f("polygonOffset",m.shaderPolygonOffset),h.uniform4fv("viewport",d.viewport),h.uniform4f("color",k[0],k[1],k[2],1),b.getVertexBufferLayout().enableVertexAttribArrays(a,h),a.depthFunc(a.LEQUAL);else{p.use();this.bindTexture(a,p);p.uniform1i("framebufferTex",1);a.activeTexture(a.TEXTURE1);a.bindTexture(a.TEXTURE_2D,d.framebufferTex);a.activeTexture(a.TEXTURE0);p.uniform3fv("markerColor",k);p.uniform4fv("viewport",d.viewport);p.uniform4fv("overrideColor",m.color);
p.uniform1f("pixelRatio",d.pixelRatio);p.uniform1f("polygonOffset",m.shaderPolygonOffset);m.textureIsSignedDistanceField&&(p.uniform4fv("outlineColor",m.outlineColor),p.uniform1f("outlineSize",m.outlineSize));if(m.worldScale){var c=[-1,-1],f=m.screenMinMaxSize,l=d.proj,t=d.viewport[2]/d.pixelRatio;f&&(0!==l[11]?(l=2*Math.atan(1/l[0]),t=2*(Math.tan(l/2)/t),c[0]=f[0]*t,c[1]=f[1]*t):r.scale(f,2/(l[0]*t),c));p.uniform2fv("minMaxWorldSizeFactor",c)}m.direction&&p.uniform3fv("direction",m.direction);p.uniform2fv("texScale",
m.texCoordScale);p.uniform2fv("screenOffset",m.screenOffset);p.uniform2fv("anchorPos",m.anchorPos);b.getVertexBufferLayout().enableVertexAttribArrays(a,p);m.polygonOffset&&(a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(0,-4));a.web3DDefaultState.cullEnabled&&a.disable(a.CULL_FACE);a.enable(a.BLEND)}};this.release=function(a){e===g&&m.occlusionTest?(a.depthFunc(a.LESS),b.getVertexBufferLayout().disableVertexAttribArrays(a,h)):(m.polygonOffset&&a.disable(a.POLYGON_OFFSET_FILL),a.web3DDefaultState.cullEnabled&&
a.enable(a.CULL_FACE),a.disable(a.BLEND),b.getVertexBufferLayout().disableVertexAttribArrays(a,p))};this.bindView=function(a,b){var d=b.origin;e===g&&m.occlusionTest?(n.bindView(d,b.view,h),n.bindCamPos(d,b.viewInvTransp,h)):(n.bindView(d,b.view,p),n.bindCamPos(d,b.viewInvTransp,p))};this.bindInstance=function(a,b){e===g&&m.occlusionTest?(h.uniformMatrix4fv("model",b.transformation),h.uniformMatrix4fv("modelNormal",b.transformationNormal)):p.uniformMatrix4fv("model",b.transformation)};this.getDrawMode=
function(a){return e===g&&m.occlusionTest?a.POINTS:a.TRIANGLES}},v=function(b,d,c){function f(){return d.shaderVariators.HUDMaterialHighlight.getProgram([!!g.direction,!!g.worldScale,g.occlusionTest,g.textureIsSignedDistanceField])}n.basicGLMaterialConstructor(this,b);var g=s.clone(b.getParams()),l=d.get("hudOcclusionTestPixel"),m=f();n.singleTextureGLMaterialConstructor(this,c,g);var e=[254/255,253/255,252/255];this.beginSlot=function(b){return b===a.OVERLAY};this.getProgram=function(){return m};
this.getAllPrograms=function(){return[l,m]};this.updateParameters=function(){var a=b.getParams();g.color=a.color;g.texCoordScale=a.texCoordScale;g.polygonOffset=a.polygonOffset;g.anchorPos=a.anchorPos;g.screenOffset=a.screenOffset;g.screenMinMaxSize=a.screenMinMaxSize;g.direction=a.direction;g.shaderPolygonOffset=a.shaderPolygonOffset;g.textureIsSignedDistanceField=a.textureIsSignedDistanceField;g.outlineColor=a.outlineColor;g.outlineSize=a.outlineSize;this.updateTexture(a.textureId);m=f()};this.bind=
function(a,d){b._textureDirty&&(this.renderTexture(a),b._textureDirty=!1);m.use();this.bindTexture(a,m);m.uniform1i("framebufferTex",1);a.activeTexture(a.TEXTURE1);a.bindTexture(a.TEXTURE_2D,d.framebufferTex);a.activeTexture(a.TEXTURE0);m.uniform3fv("markerColor",e);m.uniform4fv("viewport",d.viewport);m.uniform4fv("overrideColor",g.color);m.uniform1f("pixelRatio",d.pixelRatio);m.uniform1f("polygonOffset",g.shaderPolygonOffset);g.textureIsSignedDistanceField&&(m.uniform4fv("outlineColor",g.outlineColor),
m.uniform1f("outlineSize",g.outlineSize));if(g.worldScale){var c=[-1,-1],f=g.screenMinMaxSize,l=d.proj,h=d.viewport[2]/d.pixelRatio;f&&(0!==l[11]?(l=2*Math.atan(1/l[0]),h=2*(Math.tan(l/2)/h),c[0]=f[0]*h,c[1]=f[1]*h):r.scale(f,2/(l[0]*h),c));m.uniform2fv("minMaxWorldSizeFactor",c)}g.direction&&m.uniform3fv("direction",g.direction);m.uniform2fv("texScale",g.texCoordScale);m.uniform2fv("screenOffset",g.screenOffset);m.uniform2fv("anchorPos",g.anchorPos);b.getVertexBufferLayout().enableVertexAttribArrays(a,
m);g.polygonOffset&&(a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(0,-4));a.web3DDefaultState.cullEnabled&&a.disable(a.CULL_FACE);a.enable(a.BLEND)};this.release=function(a){g.polygonOffset&&a.disable(a.POLYGON_OFFSET_FILL);a.web3DDefaultState.cullEnabled&&a.enable(a.CULL_FACE);a.disable(a.BLEND);b.getVertexBufferLayout().disableVertexAttribArrays(a,m)};this.bindView=function(a,b){var d=b.origin;n.bindView(d,b.view,m);n.bindCamPos(d,b.viewInvTransp,m)};this.bindInstance=function(a,b){m.uniformMatrix4fv("model",
b.transformation)};this.getDrawMode=function(a){return a.TRIANGLES}};b.loadShaders=function(a,b,d,c){a._parse(q);var f=0<c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=new e("hud",["vertexShaderHUD","fragmentShaderHUD"],null,d,b,a,c);g.addBinaryShaderSnippetSuffix("Direction","Direction",[!0,!1]);g.addBinaryShaderSnippetSuffix("WorldScale","WorldScale",[!0,!1]);g.addDefine("OcclTest",f?"OCCL_TEST":"OCCL_PIXELSHADER");g.addDefine("SDF","SIGNED_DISTANCE_FIELD");d.shaderVariators.HUDMaterial=g;b=
new e("hudHighlight",["vertexShaderHUD","fragmentShaderHUDHighlight"],null,d,b,a,c);b.addBinaryShaderSnippetSuffix("Direction","Direction",[!0,!1]);b.addBinaryShaderSnippetSuffix("WorldScale","WorldScale",[!0,!1]);b.addDefine("OcclTest",f?"OCCL_TEST":"OCCL_PIXELSHADER");b.addDefine("SDF","SIGNED_DISTANCE_FIELD");d.shaderVariators.HUDMaterialHighlight=b;f=new h(c.VERTEX_SHADER,a.vertexShaderOcclusionTestPixel,c);a=new h(c.FRAGMENT_SHADER,a.fragmentShaderSimple,c);c=new k([f,a],c);d.add("hudOcclusionTestPixel",
c)};return b})},"esri/views/3d/webgl-engine/lib/ShaderVariations":function(){define(["dojo/_base/lang","./Util","../lib/GLSLProgram","../lib/GLSLShader"],function(s,q,n,k){var h=q.assert,e=function(c,b){return c+b.toString()};return function(c,b,g,f,a,r,l){h(2===b.length,"you must specify shader snippet prefixes for vertex and fragment shaders");!g||0===g.length?g=[[],[]]:Array.isArray(g[0])||(g=[g,g]);var d=[],m=!1,p={},t={};this.addDefine=function(a,b,c,f){h(!m,"you cannot add another variable after the first program has been generated");
h(a,"you must specify a program name suffix");d.push({programNameSuffixes:["",a],shaderNameSuffixes:f||a,defineStr:b,affectsShaderTypes:c||[!0,!0]})};this.addBinaryShaderSnippetSuffix=function(a,b,c){h(!m,"you cannot add another variable after the first program has been generated");h(a,"you must specify a program name suffix");d.push({programNameSuffixes:["",a],shaderSnippetSuffixes:["",b],affectsShaderTypes:c||[!0,!0]})};this.addNaryShaderSnippetSuffix=function(a,b){h(!m,"you cannot add another variable after the first program has been generated");
var c=a.map(function(a){h(null!=a.value,"value must always be specified");return a.value});d.push({values:c,programNameSuffixes:a.map(function(a,b){return null!=a.programNameSuffix?a.programNameSuffix:c[b]}),shaderSnippetSuffixes:a.map(function(a,b){return null!=a.shaderSnippetSuffix?a.shaderSnippetSuffix:c[b]}),affectsShaderTypes:b||[!0,!0]})};this.getShaderVariation=function(a){h(a.length===d.length,"you must specify a value for each variable");for(var f=c,l=s.clone(b),m=s.clone(b),e=s.clone(g),
p=0;p<d.length;p++){var r=d[p],k=a[p],t;r.values?(t=r.values.indexOf(k),h(0<=t,"invalid value "+k+" for variable "+p)):t=k?1:0;f+=r.programNameSuffixes[t];for(k=0;2>k;k++)r.affectsShaderTypes[k]&&(r.shaderSnippetSuffixes&&(l[k]+=r.shaderSnippetSuffixes[t],m[k]+=r.shaderSnippetSuffixes[t]),r.defineStr&&t&&(e[k].push(r.defineStr),m[k]+=r.shaderNameSuffixes))}return{programName:f,shaderSnippetNames:l,shaderNames:m,defines:e}};this.getProgram=function(b,d,c){d=d||r;c=c||l;m=!0;var g=b.reduce(e,"");if(t[g])return t[g];
b=this.getShaderVariation(b);var w=f.get(b.programName);if(w)return w;var C,A,y=b.shaderNames[0],w=p[y]||a&&a.shaders[y];w||(C=b.shaderSnippetNames[0],A=d[C],h(null!=A,"shader snippet '"+C+"' does not exist"),w=new k(c.VERTEX_SHADER,A,c,b.defines[0]),p[y]=w,a&&a.add(y,w));y=b.shaderNames[1];C=p[y]||a&&a.shaders[y];C||(C=b.shaderSnippetNames[1],A=d[C],h(null!=A,"shader snippet '"+C+"' does not exist"),C=new k(c.FRAGMENT_SHADER,A,c,b.defines[1]),p[y]=C,a&&a.add(y,C));w=new n([w,C],c);t[g]=w;f.add(b.programName,
w);return w}}})},"esri/views/3d/webgl-engine/materials/LeafCardMaterial":function(){define("dojo/text!./LeafCardMaterial.xml ./internal/MaterialUtil ../lib/VertexBufferLayout ../lib/GLSLProgram ../lib/GLSLShader ../lib/Util ../lib/gl-matrix ../lib/RenderSlot".split(" "),function(s,q,n,k,h,e,c,b){var g=c.vec3,f=c.mat4,a=c.mat4d,r=e.VertexAttrConstants;c=function(b,c,h,k,u,z){function w(){return 2*Math.random()-1}q.basicMaterialConstructor(this,z);var C=new n([r.POSITION,r.NORMAL,r.UV0],[3,4,4]),A=
C.getStride();this.getAmbient=function(){return c};this.getDiffuse=function(){return h};this.getSpecular=function(){return k};this.getShininess=function(){return u};this.dispose=function(){};this.getTextureId=function(){return b};this.getOutputAmount=function(a){var b=0,d;for(d=0;d<a/6;d++)0===d%1&&(b+=6);a=b;for(d=b=0;d<a/6;d++)0===d%1&&(b+=6);return b*A};this.getVertexBufferLayout=function(){return C};this.reduce=function(a,b){for(var d=a.position,c=a.normal,f=a.uv0,g=[],l=[],m=[],e=0,h=0;h<d.length/
6;h++)if(0===h%b)for(var p=0;6>p;p++)g[e]=d[6*h+p],l[e]=c[6*h+p],m[e]=f[6*h+p],e++;return{position:g,normal:l,uv0:m}};this.fillInterleaved=function(b,d,c,l,m,h){l=q.fill;var p=this.reduce(b.faces.indices,1),p=this.reduce(p,1),r=this.getOutputAmount(b.faces.indices.position.length);e.assert(r===p.position.length*A);var k=p.position,t=p.normal,n=p.uv0,p=b.vertexAttr.position.data,u=b.vertexAttr.normal.data,z=b.vertexAttr.uv0.data,x=g.create();b=k.length/6;for(var r=h,C=g.createFrom(-Number.MAX_VALUE,
-Number.MAX_VALUE,-Number.MAX_VALUE),v=g.createFrom(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s=0;s<b;++s){for(var R=g.create(),T=g.create(),J=[100,100,-100,-100],S=g.create(),K=0;6>K;++K){var Q=6*s+K,U=3*k[Q],X=3*t[Q],Q=2*n[Q];R[0]+=p[U+0];R[1]+=p[U+1];R[2]+=p[U+2];T[0]+=u[X+0];T[1]+=u[X+1];T[2]+=u[X+2];X=z[Q+0];Q=z[Q+1];J[0]=Math.min(J[0],X);J[1]=Math.min(J[1],Q);J[2]=Math.max(J[2],X);J[3]=Math.max(J[3],Q);0===K&&g.set3(p[U+0],p[U+1],p[U+2],S)}R[0]/=6;R[1]/=6;R[2]/=6;T[0]/=6;T[1]/=6;T[2]/=
6;R[0]+=0.1*w();R[1]+=0.1*w();R[2]+=0.1*w();void 0!==d&&(a.multiplyVec3(d,S,S),a.multiplyVec3(d,R,R),a.multiplyVec3(c,T,T));g.add(R,x,x);g.max(C,R,C);g.min(v,R,v);J[0]+=0.01;J[1]+=0.01;J[2]-=0.01;J[3]-=0.01;for(K=0;4>K;K++)J[K]=Math.min(J[K],0.99999);K=2*Math.random()*Math.PI;S=1.41*g.dist(S,R);h+=l(R,0,m,h,void 0,3);h+=l(T,0,m,h,void 0,3);m[h++]=0;m[h++]=J[0];m[h++]=J[1];m[h++]=K;m[h++]=S;h+=l(R,0,m,h,void 0,3);h+=l(T,0,m,h,void 0,3);m[h++]=0;m[h++]=J[2]+1;m[h++]=J[1];m[h++]=K;m[h++]=S;h+=l(R,0,
m,h,void 0,3);h+=l(T,0,m,h,void 0,3);m[h++]=0;m[h++]=J[2]+1;m[h++]=J[3]+1;m[h++]=K;m[h++]=S;h+=l(R,0,m,h,void 0,3);h+=l(T,0,m,h,void 0,3);m[h++]=0;m[h++]=J[2]+1;m[h++]=J[3]+1;m[h++]=K;m[h++]=S;h+=l(R,0,m,h,void 0,3);h+=l(T,0,m,h,void 0,3);m[h++]=0;m[h++]=J[0];m[h++]=J[3]+1;m[h++]=K;m[h++]=S;h+=l(R,0,m,h,void 0,3);h+=l(T,0,m,h,void 0,3);m[h++]=0;m[h++]=J[0];m[h++]=J[1];m[h++]=K;m[h++]=S}x[0]/=b;x[1]/=b;x[2]/=b;d=g.create();g.add(C,v,d);g.scale(d,0.5,d);h=g.create();g.subtract(C,v,h);h[0]=Math.abs(h[0])/
2;h[1]=Math.abs(h[1])/2;h[2]=Math.abs(h[2])/2;k=g.create(x);k[1]-=(C[1]-v[1])/3;C=g.create();v=g.create();p=g.create();t=[g.create(),g.create(),g.create(),g.create()];x=[0,0,0,0];n=f.create();for(s=0;s<b;++s){g.set3(m[r],m[r+1],m[r+2],p);g.subtract(p,k,C);g.normalize(C,C);v=g.subtract(p,d,v);g.normalize(v,v);z=Math.abs(g.dot(v,[1,0,0]));K=Math.abs(g.dot(v,[0,1,0]));u=Math.abs(g.dot(v,[0,0,1]));z=z*Math.abs(d[0]-p[0])/h[0];z+=K*Math.abs(d[1]-p[1])/h[1];z+=u*Math.abs(d[2]-p[2])/h[2];for(K=0;4>K;K++)f.identity(n),
f.rotate(n,0.8*w(),[0,1,0],n),f.rotate(n,0.8*w(),[1,0,0],n),f.multiplyVec3(n,C,t[K]),x[K]=0.5+0.5*z-0.2*w();u=0.8+0.3*w();for(K=0;6>K;++K){var P;switch(K){case 0:P=0;break;case 1:P=1;break;case 2:P=2;break;case 3:P=2;break;case 4:P=3;break;case 5:P=0}r+=3;r+=l(t[P],0,m,r,c,3);m[r++]=x[P];r+=3;m[r++]*=u}}};this.intersect=function(){};this.getGLMaterials=function(){return{color:l,depthShadowMap:m,normal:void 0,depth:d,highlight:void 0}};this.getAllTextureIds=function(){return[b]}};var l=function(a,
d,c){q.basicGLMaterialConstructor(this,a);var f=b.TRANSPARENT_MATERIAL,g=d.get("leafCard");q.singleTextureGLMaterialConstructor(this,c,{textureId:a.getTextureId()});this.beginSlot=function(a){return f===a};this.getProgram=function(){return g};var m=a.getAmbient(),l=a.getDiffuse(),e=a.getSpecular(),h=a.getShininess();this.bind=function(b,d){g.use();this.bindTexture(b,g);g.uniform3fv("ambient",m);g.uniform3fv("diffuse",l);g.uniform3fv("specular",e);g.uniform1f("shininess",h);g.uniform1f("trafoScale",
1);a.getVertexBufferLayout().enableVertexAttribArrays(b,g)};this.release=function(b){a.getVertexBufferLayout().disableVertexAttribArrays(b,g)};this.bindView=function(a,b){q.bindView(b.origin,b.view,g);q.bindCamPos(b.origin,b.viewInvTransp,g)};this.bindInstance=function(a,b){g.uniformMatrix4fv("model",b.transformation);g.uniformMatrix4fv("modelNormal",b.transformationNormal);var d=b.transformation,c=Math.sqrt(d[0]*d[0]+d[4]*d[4]+d[8]*d[8]),f=Math.sqrt(d[1]*d[1]+d[5]*d[5]+d[9]*d[9]),d=Math.sqrt(d[2]*
d[2]+d[6]*d[6]+d[10]*d[10]);g.uniform1f("trafoScale",(c+f+d)/3)};this.getDrawMode=function(a){return a.TRIANGLES}},d=function(a,d,c,f){q.basicGLMaterialConstructor(this,a);var g=b.TRANSPARENT_MATERIAL,m=null==f?d.get("leafCardDepth"):d.get("leafCardDepthShadowMap");q.singleTextureGLMaterialConstructor(this,c,{textureId:a.getTextureId()});this.beginSlot=function(a){return g===a};this.getProgram=function(){return m};this.bind=function(b,d){m.use();this.bindTexture(b,m);m.uniform2fv("nearFar",d.nearFar);
a.getVertexBufferLayout().enableVertexAttribArrays(b,m)};this.release=function(b){a.getVertexBufferLayout().disableVertexAttribArrays(b,m)};this.bindView=function(a,b){q.bindView(b.origin,b.view,m)};this.bindInstance=function(a,b){m.uniformMatrix4fv("model",b.transformation);var d=b.transformation,c=Math.sqrt(d[0]*d[0]+d[4]*d[4]+d[8]*d[8]),f=Math.sqrt(d[1]*d[1]+d[5]*d[5]+d[9]*d[9]),d=Math.sqrt(d[2]*d[2]+d[6]*d[6]+d[10]*d[10]);m.uniform1f("trafoScale",(c+f+d)/3)};this.getDrawMode=function(a){return a.TRIANGLES}},
m=function(a,b,c){d.call(this,a,b,c,!0)};c.loadShaders=function(a,b,d,c){a._parse(s);var f=new h(c.VERTEX_SHADER,a.vertexShaderLeafCard,c),g=new h(c.FRAGMENT_SHADER,a.fragmentShaderLeafCard,c),f=new k([f,g],c);a=new h(c.VERTEX_SHADER,a.vertexShaderLeafCardDepth,c);g=b.get("fsDepthTextured");b=b.get("fsDepthTexturedShadowMap");g=new k([a,g],c);c=new k([a,b],c);d.add("leafCard",f);d.add("leafCardDepth",g);d.add("leafCardDepthShadowMap",c)};return c})},"esri/views/3d/webgl-engine/materials/Material":function(){define("dojo/_base/lang dojo/text!./Material.xml ./internal/MaterialUtil ../lib/GLSLProgram ../lib/GLSLShader ../lib/ShaderVariations ../lib/Util ../lib/gl-matrix ../lib/RenderSlot".split(" "),
function(s,q,n,k,h,e,c,b,g){var f=c.assert,a=b.vec3,r,l=a.create();c=function(a,b){n.basicMaterialConstructor(this,b);a=a||{};a.ambient=a.ambient||[0.2,0.2,0.2];a.diffuse=a.diffuse||[0.8,0.8,0.8];a.specular=a.specular||[0,0,0];a.shininess=a.shininess||10;a.opacity=void 0!==a.opacity?a.opacity:1;a.blendModeOneOne=a.blendModeOneOne||!1;a.inverseWindingOrder=a.inverseWindingOrder||!1;a.vertexColors=a.vertexColors||!1;a.flipV=a.flipV||!1;a.doubleSided=a.doubleSided||!1;a.cullFace=a.cullFace||void 0;a.instanced=
a.instanced||!1;this.instanced=!!a.instanced;a.textureId||(a.reflTextureId=void 0);var d;d=a.textureId?a.atlasRegions?"PosNormTexRegion":"PosNormTex":"PosNorm";a.vertexColors&&(d+="Col");var c=n.Layouts[d],g=a.instanced?n.Layouts.ModelCol:null;a.instanced&&(g=-1<a.instanced.indexOf("color")?n.Layouts.ModelCol:n.Layouts.Model);this.dispose=function(){};this.getParams=function(){return a};this.getParameterValues=function(){var b={ambient:a.ambient,diffuse:a.diffuse,specular:a.specular,shininess:a.shininess,
opacity:a.opacity,transparent:a.transparent,polygonOffset:a.polygonOffset,reflectivity:a.reflectivity,atlasRegions:a.atlasRegions,flipV:a.flipV,doubleSided:a.doubleSided,cullFace:a.cullFace};a.textureId&&(b.textureId=a.textureId,b.initTexture=a.initTexture);return b};this.setParameterValues=function(b){for(var d in b)"textureId"===d&&f(a.textureId,"Can only change texture of material that already has a texture"),a[d]=b[d];this.notifyDirty("matChanged")};this.getOutputAmount=function(a){return a*c.getStride()};
this.getVertexBufferLayout=function(){return c};this.getInstanceBufferLayout=function(){return g};this.fillInterleaved=function(a,b,d,f,g,m,l){n.fillInterleaved(a,b,d,f,c,g,m,l)};this.intersect=n.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:p,depthShadowMap:x,normal:v,depth:t,highlight:u}};this.getAllTextureIds=function(){var b=[];a.textureId&&b.push(a.textureId);a.reflTextureId&&b.push(a.reflTextureId);return b}};c.paramsFromOldConstructor=function(a,b,d,c,f,g,m,l,e,h,p,
r,k){return{textureId:a,transparent:b,ambient:d,diffuse:c,specular:f,shininess:g,opacity:m,polygonOffset:l,initTexture:e,reflTextureId:h,reflectivity:p,flipV:r,doubleSided:k,cullFace:void 0}};var d=function(a,b){var d=b.cullFace?"none"!==b.cullFace:b.transparent?!1:!0;a.web3DDefaultState.cullEnabled!==d&&(d?(a.enable(a.CULL_FACE),"front"===b.cullFace&&a.cullFace(a.FRONT)):a.disable(a.CULL_FACE))},m=function(a,b){var d=b.cullFace?"none"!==b.cullFace:b.transparent?!1:!0;a.web3DDefaultState.cullEnabled!==
d&&(d?(a.disable(a.CULL_FACE),"front"===b.cullFace&&a.cullFace(a.BACK)):a.enable(a.CULL_FACE))},p=function(b,c,e){n.basicGLMaterialConstructor(this,b);var h=s.clone(b.getParams()),p=h.transparent?g.TRANSPARENT_MATERIAL:g.OPAQUE_MATERIAL;n.singleTextureGLMaterialConstructor(this,e,h);var k=n.aquireIfNotUndefined(h.reflTextureId,h.reflInitTexture,e);f(!(h.atlasRegions&&h.reflTextureId),"Atlas texture with reflection is not yet supported");var t=!h.textureId?"none":h.atlasRegions?"AtlasTextured":"Textured";
this.instanced=r&&h.instanced;var u=!!this.instanced&&-1<this.instanced.indexOf("color"),x=c.shaderVariators.Material.getProgram([t,!!h.reflTextureId,h.vertexColors,h.flipV,h.doubleSided,!!this.instanced,u]),q=this.dispose;this.dispose=function(){q();n.releaseIfNotUndefined(h.reflTextureId,e)};this.beginSlot=function(a){return p===a};this.getProgram=function(){return x};this.updateParameters=function(){var a=b.getParams();h.ambient=a.ambient;h.diffuse=a.diffuse;h.specular=a.specular;h.shininess=a.shininess;
h.opacity=a.opacity;h.polygonOffset=a.polygonOffset;h.reflectivity=a.reflectivity;h.flipV=a.flipV;h.doubleSided=a.doubleSided;h.cullFace=a.cullFace;h.transparent!=a.transparent&&(p=a.transparent?g.TRANSPARENT_MATERIAL:g.OPAQUE_MATERIAL,h.transparent=a.transparent);h.initTexture=a.initTexture;this.updateTexture(a.textureId);a.atlasRegions&&(h.atlasRegions=a.atlasRegions);h.blendModeOneOne=a.blendModeOneOne;h.inverseWindingOrder=a.inverseWindingOrder};this.bind=function(a,c){x.use();x.uniform3fv("ambient",
h.ambient);x.uniform3fv("diffuse",h.diffuse);x.uniform3fv("specular",h.specular);x.uniform1f("shininess",h.shininess);x.uniform1f("opacity",h.opacity);c.shadowMap||x.uniform1f("depthHalfPixelSz",-1);this.bindTexture(a,x);void 0!==k&&(x.uniform1i("reflTex",1),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,k),a.activeTexture(a.TEXTURE0),x.uniform1f("reflectivity",h.reflectivity));b.getVertexBufferLayout().enableVertexAttribArrays(a,x,!1);this.instanced&&b.getInstanceBufferLayout().enableVertexAttribArrays(a,
x,c.extensions.angleInstancedArrays);h.inverseWindingOrder&&a.frontFace(a.CW);h.transparent&&(a.enable(a.BLEND),h.blendModeOneOne&&(a.blendFunc(a.ONE,a.ONE),a.depthMask(!1)));h.polygonOffset&&(a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(2,2));d(a,h)};this.release=function(a,d){h.polygonOffset&&a.disable(a.POLYGON_OFFSET_FILL);m(a,h);h.transparent&&(a.disable(a.BLEND),h.blendModeOneOne&&(a.blendFunc(a.web3DDefaultState.blendFuncSrc,a.web3DDefaultState.blendFuncDst),a.depthMask(!0)));h.inverseWindingOrder&&
a.frontFace(a.CCW);b.getVertexBufferLayout().disableVertexAttribArrays(a,x,!1);this.instanced&&b.getInstanceBufferLayout().disableVertexAttribArrays(a,x,d.extensions.angleInstancedArrays)};this.bindView=function(a,b){var d=b.origin;n.bindView(d,b.view,x);n.bindCamPos(d,b.viewInvTransp,x);b.shadowMap&&b.shadowMap.bindView(x,d)};this.bindInstance=function(b,d){x.uniformMatrix4fv("model",d.transformation);x.uniformMatrix4fv("modelNormal",d.transformationNormal);if(u&&d.instanceParameters){var c=d.instanceParameters.color;
c&&(a.multiply(h.ambient,c,l),x.uniform3fv("ambient",l),a.multiply(h.diffuse,c,l),x.uniform3fv("diffuse",l),x.uniform1f("opacity",h.opacity*c[3]))}};this.getDrawMode=function(a){return a.TRIANGLES}},t=function(a,b,c,f){n.basicGLMaterialConstructor(this,a);var l=s.clone(a.getParams()),e=null!=f?b.get(a.getVertexBufferLayout().hasAttribute("uv0")?"depthTexturedShadowMap":"depthShadowMap"):b.get(a.getVertexBufferLayout().hasAttribute("uv0")?"depthTextured":"depth"),h=l.transparent?g.TRANSPARENT_MATERIAL:
g.OPAQUE_MATERIAL;n.singleTextureGLMaterialConstructor(this,c,l);this.beginSlot=function(a){return h===a};this.getProgram=function(){return e};this.updateParameters=function(){var b=a.getParams();l.initTexture=b.initTexture;l.cullFace=b.cullFace;l.inverseWindingOrder=b.inverseWindingOrder;this.updateTexture(b.textureId)};this.bind=function(b,c){e.use();e.uniform2fv("nearFar",c.nearFar);l.inverseWindingOrder&&b.frontFace(b.CW);this.bindTexture(b,e);a.getVertexBufferLayout().enableVertexAttribArrays(b,
e);d(b,l)};this.release=function(b){m(b,l);l.inverseWindingOrder&&b.frontFace(b.CCW);a.getVertexBufferLayout().disableVertexAttribArrays(b,e)};this.bindView=function(a,b){n.bindView(b.origin,b.view,e)};this.bindInstance=function(a,b){e.uniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.TRIANGLES}},x=function(a,b,d){t.call(this,a,b,d,!0)},v=function(a,b,c){n.basicGLMaterialConstructor(this,a);var f=s.clone(a.getParams()),l=b.get(a.getVertexBufferLayout().hasAttribute("uv0")?
"normalTextured":"normal"),e=f.transparent?g.TRANSPARENT_MATERIAL:g.OPAQUE_MATERIAL;n.singleTextureGLMaterialConstructor(this,c,f);this.beginSlot=function(a){return e===a};this.getProgram=function(){return l};this.updateParameters=function(){var b=a.getParams();f.initTexture=b.initTexture;f.cullFace=b.cullFace;f.inverseWindingOrder=b.inverseWindingOrder;this.updateTexture(b.textureId)};this.bind=function(b,c){l.use();this.bindTexture(b,l);l.uniformMatrix4fv("viewNormal",c.viewInvTransp);a.getVertexBufferLayout().enableVertexAttribArrays(b,
l);d(b,f);f.inverseWindingOrder&&b.frontFace(b.CW)};this.release=function(b){m(b,f);f.inverseWindingOrder&&b.frontFace(b.CCW);a.getVertexBufferLayout().disableVertexAttribArrays(b,l)};this.bindView=function(a,b){n.bindView(b.origin,b.view,l)};this.bindInstance=function(a,b){l.uniformMatrix4fv("model",b.transformation);l.uniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.TRIANGLES}},u=function(a,b,c,f){n.basicGLMaterialConstructor(this,a);var l=s.clone(a.getParams()),
e=b.get(a.getVertexBufferLayout().hasAttribute("uv0")?"highlightTextured":"highlight"),h=g.OPAQUE_MATERIAL;n.singleTextureGLMaterialConstructor(this,c,l);this.beginSlot=function(a){return h===a};this.getProgram=function(){return e};this.updateParameters=function(){var b=a.getParams();l.initTexture=b.initTexture;l.cullFace=b.cullFace;l.inverseWindingOrder=b.inverseWindingOrder;this.updateTexture(b.textureId)};this.bind=function(b,c){e.use();this.bindTexture(b,e);a.getVertexBufferLayout().enableVertexAttribArrays(b,
e);d(b,l);l.inverseWindingOrder&&b.frontFace(b.CW)};this.release=function(b){m(b,l);l.inverseWindingOrder&&b.frontFace(b.CCW);a.getVertexBufferLayout().disableVertexAttribArrays(b,e)};this.bindView=function(a,b){n.bindView(b.origin,b.view,e)};this.bindInstance=function(a,b){e.uniformMatrix4fv("model",b.transformation);e.uniformMatrix4fv("modelNormal",b.transformationNormal)};this.getDrawMode=function(a){return a.TRIANGLES}};c.loadShaders=function(a,b,d,c){a._parse(q);c.getExtension("OES_standard_derivatives");
r=c.getExtension("ANGLE_instanced_arrays");var f=new e("phong",["vsPhong","fsPhong"],null,d,b,a,c);f.addNaryShaderSnippetSuffix([{value:"none",programNameSuffix:"",shaderSnippetSuffix:""},{value:"Textured"},{value:"AtlasTextured"}]);f.addBinaryShaderSnippetSuffix("Refl","Refl",[!1,!0]);f.addDefine("Color","VERTEXCOLORS");f.addDefine("FlipV","FLIPV");f.addDefine("DoubleSided","DOUBLESIDED");f.addDefine("Instanced","INSTANCED");f.addDefine("InstColor","INSTANCEDCOLOR");d.shaderVariators.Material=f;
var f=new h(c.VERTEX_SHADER,a.vsDepth,c),g=new h(c.VERTEX_SHADER,a.vsDepthTextured,c),m=new h(c.VERTEX_SHADER,a.vsNormal,c),l=new h(c.VERTEX_SHADER,a.vsNormalTextured,c),p=new h(c.VERTEX_SHADER,a.vsHighlight,c),t=new h(c.VERTEX_SHADER,a.vsHighlightTextured,c),n=new h(c.FRAGMENT_SHADER,a.fsDepth,c,["BIAS_SHADOWMAP 1"]),u=new h(c.FRAGMENT_SHADER,a.fsDepthTextured,c,["BIAS_SHADOWMAP 1"]),x=new h(c.FRAGMENT_SHADER,a.fsDepth,c),v=new h(c.FRAGMENT_SHADER,a.fsDepthTextured,c),s=new h(c.FRAGMENT_SHADER,a.fsNormal,
c),V=new h(c.FRAGMENT_SHADER,a.fsNormalTextured,c),L=new h(c.FRAGMENT_SHADER,a.fsHighlight,c),Y=new h(c.FRAGMENT_SHADER,a.fsHighlightTextured,c);a=new k([f,n],c);var E=new k([g,u],c),ba=new k([f,x],c),g=new k([g,v],c),m=new k([m,s],c),l=new k([l,V],c),p=new k([p,L],c);c=new k([t,Y],c);d.add("depthShadowMap",a);d.add("depthTexturedShadowMap",E);d.add("depth",ba);d.add("depthTextured",g);d.add("normal",m);d.add("normalTextured",l);d.add("highlight",p);d.add("highlightTextured",c);b.add("fsDepth",x);
b.add("fsDepthTextured",v);b.add("fsDepthShadowMap",n);b.add("fsDepthTexturedShadowMap",u);b.add("vsDepth",f);b.add("fsNormal",s)};return c})},"esri/views/3d/webgl-engine/materials/RibbonLineMaterial":function(){define("dojo/_base/lang dojo/text!./RibbonLineMaterial.xml ./internal/MaterialUtil ../lib/VertexBufferLayout ../lib/GLSLProgram ../lib/GLSLShader ../lib/Util ../lib/gl-matrix ../lib/webglConstants ../lib/RenderSlot".split(" "),function(s,q,n,k,h,e,c,b,g,f){var a=[255,255,255,255],r=[0,0,0,
0],l=b.vec3d,d=b.vec2d,m=b.mat4d,p=l.create(),t=l.create(),x=l.create(),v=l.create(),u=d.create(),z=d.create(),w=l.create(),C=l.create();b=function(b,d){n.basicMaterialConstructor(this,d);var f=c.VertexAttrConstants;b=b||{};b.color=b.color||[1,1,1,1];b.width=b.width||0;b.type=b.type||"screen";b.join=b.join||"miter";b.miterLimit="miter"===b.join?b.miterLimit||5:b.miterLimit;var e="wall"===b.type?2:4,h="wall"===b.type?new k([f.POSITION,f.UV0],[3,2]):new k([f.POSITION,f.UV0,f.AUXPOS1,f.AUXPOS2,f.COLOR,
f.SIZE],[3,2,3,3,4,1],[g.FLOAT,g.FLOAT,g.FLOAT,g.FLOAT,g.FLOAT,g.FLOAT]);this.canBeMerged=!1;this.getParams=function(){return b};this.getParameterValues=function(){var a={color:b.color,width:b.width,type:b.type,join:b.join,polygonOffset:b.polygonOffset};"miter"===b.join&&(a.miterLimit=b.miterLimit);return a};this.setParameterValues=function(a){for(var d in a)a.hasOwnProperty(d)&&(c.assert("type"!==d,"RibbonLineMaterial: type cannot be changed after creation"),b[d]=a[d]);this.notifyDirty("matChanged")};
this.dispose=function(){};this.getOutputAmount=function(a){return((a/2+1-2)*e+4)*h.getStride()};this.getVertexBufferLayout=function(){return h};this.fillInterleaved=function(d,c,g,m,l,e){g=d.vertexAttr[f.POSITION].data;m=d.vertexAttr[f.COLOR]?d.vertexAttr[f.COLOR].data:a;var h=d.vertexAttr[f.SIZE]?d.vertexAttr[f.SIZE].data:r;(d=d.faces&&d.faces.indices&&d.faces.indices.position)&&d.length!=2*(g.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");if("wall"===b.type){m=e;h=g.length/
3;e=0;d=g[0];for(var p=g[1],k=g[2],t,n,B,u=0;u<h;u++){var x=3*u;t=d;n=p;B=k;d=g[x];p=g[x+1];k=g[x+2];c&&(d=c[0]*d+c[4]*p+c[8]*k+c[12],p=c[1]*d+c[5]*p+c[9]*k+c[13],k=c[2]*d+c[6]*p+c[10]*k+c[14]);e+=Math.sqrt((d-t)*(d-t)+(p-n)*(p-n)+(k-B)*(k-B));l[m++]=d;l[m++]=p;l[m++]=k;l[m++]=e;l[m++]=-1;l[m++]=d;l[m++]=p;l[m++]=k;l[m++]=e;l[m++]=1}}else{d=g.length/3;p=g[0];k=g[1];t=g[2];n=0;c&&(p=c[0]*p+c[4]*k+c[8]*t+c[12],k=c[1]*p+c[5]*k+c[9]*t+c[13],t=c[2]*p+c[6]*k+c[10]*t+c[14]);B=p;var u=k,x=t,A=g[3],q=g[4],
w=g[5];c&&(A=c[0]*A+c[4]*q+c[8]*w+c[12],q=c[1]*A+c[5]*q+c[9]*w+c[13],w=c[2]*A+c[6]*q+c[10]*w+c[14]);for(var Q=0;Q<d;Q++){var C=3*Q;Q<d-1&&(A=g[C+3],q=g[C+4],w=g[C+5],c&&(A=c[0]*A+c[4]*q+c[8]*w+c[12],q=c[1]*A+c[5]*q+c[9]*w+c[13],w=c[2]*A+c[6]*q+c[10]*w+c[14]));n+=Math.sqrt((B-p)*(B-p)+(u-k)*(u-k)+(x-t)*(x-t));l[e++]=B;l[e++]=u;l[e++]=x;l[e++]=n;l[e++]=0===Q?-1.2:-1;l[e++]=p;l[e++]=k;l[e++]=t;l[e++]=A;l[e++]=q;l[e++]=w;l[e++]=m[0];l[e++]=m[1];l[e++]=m[2];l[e++]=m[3];l[e++]=h[0];l[e++]=B;l[e++]=u;l[e++]=
x;l[e++]=n;l[e++]=0===Q?1.2:1;l[e++]=p;l[e++]=k;l[e++]=t;l[e++]=A;l[e++]=q;l[e++]=w;l[e++]=m[0];l[e++]=m[1];l[e++]=m[2];l[e++]=m[3];l[e++]=h[0];0<Q&&Q<d-1&&(l[e++]=B,l[e++]=u,l[e++]=x,l[e++]=n,l[e++]=-1.2,l[e++]=p,l[e++]=k,l[e++]=t,l[e++]=A,l[e++]=q,l[e++]=w,l[e++]=m[0],l[e++]=m[1],l[e++]=m[2],l[e++]=m[3],l[e++]=h[0],l[e++]=B,l[e++]=u,l[e++]=x,l[e++]=n,l[e++]=1.2,l[e++]=p,l[e++]=k,l[e++]=t,l[e++]=A,l[e++]=q,l[e++]=w,l[e++]=m[0],l[e++]=m[1],l[e++]=m[2],l[e++]=m[3],l[e++]=h[0]);p=B;k=u;t=x;B=A;u=q;
x=w}}};this.intersect=function(a,d,g,e,h,r,k,n,B,A,q,F){if(F){d=a.getData().getVertexAttr(f.position).position.data;a=a.getData().getVertexAttr(f.SIZE).size;a=(a&&a.data[0])+b.width;k=Number.MAX_VALUE;for(n=0;n<d.length-5;n+=3){p[0]=d[n];p[1]=d[n+1];p[2]=d[n+2];m.multiplyVec3(g,p);t[0]=d[n+3];t[1]=d[n+4];t[2]=d[n+5];m.multiplyVec3(g,t);B.projectPoint(p,u);B.projectPoint(t,z);if(0>u[2]&&0<z[2])l.subtract(p,t,x),A=B.frustumPlanes,F=-(l.dot(A[4],p)+A[4][3]),A=F/l.dot(x,A[4]),l.scale(x,A,x),l.add(p,x,
p),B.projectPoint(p,u);else if(0<u[2]&&0>z[2])l.subtract(t,p,x),A=B.frustumPlanes,F=-(l.dot(A[4],t)+A[4][3]),A=F/l.dot(x,A[4]),l.scale(x,A,x),l.add(t,x,t),B.projectPoint(t,z);else if(0>u[2]&&0>z[2])continue;A=c.projectVectorVector2D(u,z,e);A<k&&(k=A,l.set(p,w),l.set(t,C))}k<a/2+4&&(g=c.linelineDistance3D(w,C,h,r),e=Number.MAX_VALUE,g[0]&&(l.subtract(g[2],h,v),e=0.98*l.length(v)/l.dist(h,r)),q(e,v))}};this.getGLMaterials=function(){return{color:A,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};
this.getAllTextureIds=function(){return[]}};var A=function(a,b){n.basicGLMaterialConstructor(this,a);var d=s.clone(a.getParams());d.miterLimit="miter"===d.join?d.miterLimit:0;delete d.join;var c=b.get("ribbonLine_"+d.type);this.updateParameters=function(){var b=a.getParams();d.polygonOffset=b.polygonOffset;d.color=b.color;d.width=b.width;d.miterLimit="miter"===b.join?b.miterLimit:0};this.beginSlot=function(a){return a===f.TRANSPARENT_MATERIAL};this.getProgram=function(){return c};this.bind=function(b,
f){c.use();c.uniform4fv("eColor",d.color);c.uniform1f("miterLimit",d.miterLimit);c.uniform1f("nearPlane",f.nearFar[0]);"screen"===d.type?(c.uniform2fv("screenSize",[f.viewport[2],f.viewport[3]]),c.uniform1f("extLineWidth",d.width*f.pixelRatio)):c.uniform1f("extLineWidth",d.width);a.getVertexBufferLayout().enableVertexAttribArrays(b,c);d.polygonOffset&&(b.enable(b.POLYGON_OFFSET_FILL),b.polygonOffset(0,-4));b.enable(b.BLEND);b.web3DDefaultState.cullEnabled&&b.disable(b.CULL_FACE);1>d.color[3]&&b.depthMask(!1)};
this.release=function(b){a.getVertexBufferLayout().disableVertexAttribArrays(b,c);d.polygonOffset&&b.disable(b.POLYGON_OFFSET_FILL);b.disable(b.BLEND);b.web3DDefaultState.cullEnabled&&b.enable(b.CULL_FACE);b.depthMask(!0)};this.bindView=function(a,b){n.bindView(b.origin,b.view,c)};this.bindInstance=function(a,b){c.uniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.TRIANGLE_STRIP}};b.loadShaders=function(a,b,d,c){a._parse(q);var f=new e(c.VERTEX_SHADER,a.vsRibbonLine,
c,["SCREENSCALE"]),g=new e(c.VERTEX_SHADER,a.vsRibbonLine,c);b=new e(c.VERTEX_SHADER,a.vsRibbonLine,c,["WALL"]);a=new e(c.FRAGMENT_SHADER,a.fsRibbonLine,c);f=new h([f,a],c);g=new h([g,a],c);c=new h([b,a],c);d.add("ribbonLine_screen",f);d.add("ribbonLine_strip",g);d.add("ribbonLine_wall",c)};return b})},"esri/views/3d/webgl-engine/materials/WaterMaterial":function(){define(["dojo/text!./WaterMaterial.xml","./internal/MaterialUtil","../lib/GLSLProgram","../lib/GLSLShader","../lib/RenderSlot"],function(s,
q,n,k,h){var e=function(b,g,f,a,e,l){q.basicMaterialConstructor(this,l);var d=q.Layouts.Pos;this.dispose=function(){};this.getNoiseTextureId=function(){return b};this.getReflTextureId=function(){return g};this.getColor=function(){return f};this.getScale=function(){return a};this.getSpeed=function(){return e};this.getOutputAmount=function(a){return a*d.getStride()};this.getVertexBufferLayout=function(){return d};this.fillInterleaved=function(a,b,c,f,g,l,e){q.fillInterleaved(a,b,c,f,d,g,l,e)};this.intersect=
q.intersectTriangleGeometry;this.getGLMaterials=function(){return{color:c,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};this.getAllTextureIds=function(){return[b,g]}},c=function(b,c,f){q.basicGLMaterialConstructor(this,b);var a=h.TRANSPARENT_MATERIAL,e=c.get("water");c={noiseTextureId:b.getNoiseTextureId(),reflTextureId:b.getReflTextureId()};q.multiTextureGLMaterialConstructor(this,f,c,[["noiseTextureId",void 0,"noiseTex"],["reflTextureId",void 0,"reflTex"]]);var l=b.getColor(),
d=b.getScale(),m=b.getSpeed(),p=Date.now();this.beginSlot=function(b){return a===b};this.getProgram=function(){return e};this.bind=function(a,c){e.use();this.bindTextures(a,e);e.uniform3fv("color",l);e.uniform1f("scale",d);var f=(Date.now()-p)/1E5*m,f=f-Math.floor(f);e.uniform1f("speed",f);c.shadowMap||e.uniform1f("depthHalfPixelSz",-1);b.getVertexBufferLayout().enableVertexAttribArrays(a,e)};this.release=function(a){b.getVertexBufferLayout().disableVertexAttribArrays(a,e)};this.bindView=function(a,
b){var d=b.origin;q.bindView(d,b.view,e);q.bindCamPos(d,b.viewInvTransp,e);b.shadowMap&&b.shadowMap.bindView(e,d)};this.bindInstance=function(a,b){e.uniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(a){return a.TRIANGLES}};e.loadShaders=function(b,c,f,a){b._parse(s);c=new k(a.VERTEX_SHADER,b.vertexShaderWater,a);b=new k(a.FRAGMENT_SHADER,b.fragmentShaderWater,a);a=new n([c,b],a);f.add("water",a)};return e})},"esri/views/3d/webgl-engine/materials/internal/BlendLayers":function(){define(["dojo/text!./BlendLayers.xml",
"../../lib/GLSLProgram","../../lib/GLSLShader"],function(s,q,n){return{loadShaders:function(k,h,e,c){k._parse(s);h=new n(c.VERTEX_SHADER,k.vertexShaderBlendLayers,c);k=new n(c.FRAGMENT_SHADER,k.fragmentShaderBlendLayers,c);c=new q([h,k],c);e.add("blendlayers",c)}}})},"esri/views/3d/webgl-engine/lib/tracer":function(){define(["require","exports","./webgl-debug"],function(s,q,n){var k=null,h=[];q.enabled=!1;q.begin=function(){q.enabled&&(k=[])};q.trace=function(e){q.enabled&&null!=k&&k.push(e)};q.end=
function(){if(q.enabled){var e=k;k=null;e&&(h.forEach(function(c){return c(e)}),h.length=0);return e}};q.instrumentContext=function(e){return!q.enabled?e:n.makeDebugContext(e,void 0,function(c,b){q.enabled&&k&&k.push("gl."+c+"("+n.glFunctionArgsToString(c,b)+")")})};q.request=function(e){h.push(e)}})},"esri/views/3d/webgl-engine/lib/Selector":function(){define(["require","exports","dojo/has","./PerformanceTimer","./gl-matrix"],function(s,q,n,k,h){var e=h.vec3d,c=h.mat4d,b=c.create(),g=e.create(),
f=e.create(),a=0;s=function(){function l(b,f,g,l,h,n,u){void 0===u&&(u=!1);this.dir=e.create();this.normalDir=null;this.minResult=new r;this.maxResult=new r;this.invertedM=c.create();this.mode="intersect";this.performanceInfo={queryDuration:0,numObjectsTested:0};this.intersectObject=this.intersectObject.bind(this);a&&(this.timer=new k(1));this.init(b,f,g,l,h,n,u)}l.prototype.init=function(b,c,f,g,l,h,r){c&&f&&e.subtract(f,c,this.dir);this.minResult.init(c,f);this.maxResult.init(c,f);this.numObjectsTested=
0;this.point=g;this.camera=l;this.isSelection=r;this.layers=b;this.p0=c;this.p1=f;this.hudResults=[];null==h&&(h=1E-5);this.tolerance=h;if(this.layers){a&&this.timer.start();for(b=0;b<this.layers.length;++b)if(c=this.layers[b],f=c.getSpatialQueryAccelerator?c.getSpatialQueryAccelerator():void 0)f.forEachAlongRay(this.p0,this.dir,this.intersectObject);else{c=c.getObjects();f=0;for(g=c.length;f<g;++f)this.intersectObject(c[f])}a&&(this.timer.stop(),this.performanceInfo.queryDuration=this.timer.getLast(),
this.performanceInfo.numObjectsTested=this.numObjectsTested)}};l.prototype.getDirection=function(){this.normalDir||(this.normalDir=e.create(),e.normalize(this.dir,this.normalDir));return this.normalDir};l.prototype.intersectObject=function(a){var l=this;this.numObjectsTested++;for(var e=a.getId(),h=a.getGeometryRecords(),k=a.getObjectTransformation(),n,u=0;u<h.length;u++){var q=h[u].geometry,w=h[u].materials;n=q.getId();c.set(k,b);c.multiply(b,h[u].transformation);c.inverse(b,this.invertedM);c.multiplyVec3(this.invertedM,
this.p0,g);c.multiplyVec3(this.invertedM,this.p1,f);for(var C=0,A=q.numGroups;C<A;++C)w[C].intersect(q,C,b,this.point,this.p0,this.p1,g,f,this.camera,this.tolerance,function(b,c,f,g,h){if(0<=b)if(h)h=new r,h.set(a,e,b,c,g,a.getCenter(),n,f),l.hudResults.push(h);else{if(null==l.minResult.priority||g>=l.minResult.priority)(null==l.minResult.dist||b<l.minResult.dist)&&l.minResult.set(a,e,b,c,g,null,n,f);if(null==l.maxResult.priority||g>=l.maxResult.priority)(null==l.maxResult.dist||b>l.maxResult.dist)&&
l.maxResult.set(a,e,b,c,g,null,n,f)}},this.isSelection)}};l.prototype.getMinResult=function(){return this.minResult};l.prototype.getMaxResult=function(){return this.maxResult};l.prototype.getHudResults=function(){return this.hudResults};l.DEFAULT_TOLERANCE=1E-5;l.Result=typeof r;return l}();var r=function(){function a(b,c){this.normal=e.create();this.init(b,c)}a.prototype.getIntersectionPoint=function(a){if(null==this.dist)return!1;e.lerp(this.p0,this.p1,this.dist,a);return!0};a.prototype.set=function(a,
b,c,f,g,l,h,r){this.dist=c;e.set(f,this.normal);this.object=a;this.name=b;this.priority=g;this.center=l;this.geometryId=h;this.triangleNr=r};a.prototype.setIntersector=function(a){this.intersector=a};a.prototype.init=function(a,b){this.priority=this.name=this.object=this.dist=void 0;this.triangleNr=this.geometryId=this.center=null;this.intersector="stage";this.p0=a;this.p1=b};return a}();return s})},"esri/views/3d/support/RenderCoordsHelper":function(){define(["./earthUtils","./projectionUtils","../lib/glMatrix",
"../webgl-engine/lib/BufferVectorMath","../../../geometry/support/scaleUtils"],function(s,q,n,k,h){var e=n.vec3,c=k.Vec3Compact,b=s.earthRadius,g=[0,0,1];s=function(b){this.spatialReference=b};s.prototype.toRenderCoords=function(b,a,c){return"esri.geometry.Point"===b.declaredClass?q.pointToVector(b,a,this.spatialReference):q.vectorToVector(b,a,c,this.spatialReference)};s.prototype.fromRenderCoords=function(b,a,c){return"esri.geometry.Point"===a.declaredClass||"esri.SpatialReference"===a.declaredClass?
q.vectorToPoint(b,this.spatialReference,a,c):q.vectorToVector(b,this.spatialReference,a,c)};n=function(b){this.spatialReference=b=b||q.SphericalRenderSpatialReference;this.unitInMeters=1};n.prototype=new s;n.prototype.getAltitude=function(f,a){return c.length(f,a||0)-b};n.prototype.setAltitude=function(f,a,g){g=g||0;f=(f+b)/c.length(a,g);c.scale(a,g,f)};n.prototype.setAltitudeOfTransformation=function(b,a){this.setAltitude(b,a,12)};n.prototype.worldUpAtPosition=function(b,a){e.normalize(b,a)};k=function(b){this.spatialReference=
b;this.unitInMeters=h.getUnitValueForSR(b);this.worldUp=g};k.prototype=new s;k.prototype.getAltitude=function(b,a){return a?b[a+2]:b[2]};k.prototype.setAltitude=function(b,a,c){c?a[c+2]=b:a[2]=b};k.prototype.setAltitudeOfTransformation=function(b,a){this.setAltitude(b,a,12)};k.prototype.worldUpAtPosition=function(b,a){e.set(g,a)};k.worldUp=g;s.Spherical=n;s.Planar=k;return s})},"esri/views/3d/support/MapCoordsHelper":function(){define("dojo/Evented dojo/Deferred ../../../core/declare ../../../portal/support/geometryServiceUtils ../../../tasks/support/ProjectParameters ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/support/scaleUtils".split(" "),
function(s,q,n,k,h,e,c,b){return n(s,{unitInMeters:1,spatialReference:null,constructor:function(c,f,a){this.spatialReference=f;this.unitInMeters=b.getUnitValueForSR(this.spatialReference);(this.geometryService=a)||k.create(c&&c.portalItem).then(function(a){this.geometryService=a}.bind(this)).otherwise(function(){})},toGeographic:function(b){var f=new q,a=!0,r=this.spatialReference;if(!this.geometryService)return f.reject("Must specify geometryService in esri/config"),f;if(!Array.isArray(b[0])||"number"===
typeof b[0])b=[b],a=!1;b.forEach(function(a,f){a instanceof c||(b[f]=new c(a,r))});var l=new h({geometries:b,outSR:e.WGS84});this.geometryService.project(l).then(function(b){try{b=b.map(function(a){return[a.x,a.y]}),f.resolve(a?b:b[0])}catch(c){f.reject(c)}},function(a){f.reject(a)});return f.promise},canProject:function(){return!!this.geometryService}})})},"esri/portal/support/geometryServiceUtils":function(){define("require exports ../Portal ../PortalItem ../../config ../../tasks/GeometryService ../../core/promiseUtils ../../core/Error".split(" "),
function(s,q,n,k,h,e,c,b){q.create=function(g){void 0===g&&(g=null);if(h.geometryServiceUrl)return c.resolve(new e({url:h.geometryServiceUrl}));if(!g)return c.reject(new b("internal:geometry-service-url-not-configured"));var f;g.isInstanceOf(k)?f=g.portal||n.getDefault():g.isInstanceOf(n)&&(f=g);return f.load().then(function(a){if(a.helperServices&&a.helperServices.geometry&&a.helperServices.geometry.url)return c.resolve(new e({url:a.helperServices.geometry.url}));throw new b("internal:geometry-service-url-not-configured");
})}})},"esri/tasks/GeometryService":function(){define("../core/declare ../core/jsonDictionary ../geometry/Extent ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon ../geometry/support/jsonUtils ../request ./Task dojo/_base/array dojo/_base/lang".split(" "),function(s,q,n,k,h,e,c,b,g,f,a){var r=q({MGRS:"mgrs",USNG:"usng",UTM:"utm",GeoRef:"geo-ref",GARS:"gars",DMS:"dms",DDM:"ddm",DD:"dd"});s=s(g,{declaredClass:"esri.tasks.GeometryService",_encodeGeometries:function(a){var b=[],f,g=a.length;
for(f=0;f<g;f++)b.push(a[f].toJSON());return{geometryType:c.getJsonType(a[0]),geometries:b}},_decodeGeometries:function(b,d,g){var e=c.getGeometryType(d);b=b.geometries;var h=[],r={spatialReference:g.toJSON()},k=a.mixin;f.forEach(b,function(a,b){h[b]=new e(k(a,r))});return h},_toProjectGeometry:function(a){var b=a.spatialReference.toJSON();return a instanceof n?new e({rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]],spatialReference:b}):new h({paths:[[].concat(a.points)],
spatialReference:b})},_fromProjectedGeometry:function(a,b,c){return"extent"===b?(a=a.rings[0],new n(a[0][0],a[0][1],a[2][0],a[2][1],c)):new k({points:a.paths[0],spatialReference:c.toJSON()})},project:function(f,d){var g=a.mixin({},this.parsedUrl.query,{f:"json"}),e;f.geometries?(d=f.outSR,e=f.geometries[0],g=a.mixin(g,f.toJSON())):(e=f[0],g=a.mixin(g,{outSR:d.wkid||JSON.stringify(d.toJSON()),inSR:e.spatialReference.wkid||JSON.stringify(e.spatialReference.toJSON()),geometries:JSON.stringify(this._encodeGeometries(f))}));
var h=c.getJsonType(e),r=this._decodeGeometries;return b(this.parsedUrl.path+"/project",{query:g,callbackParamName:"callback"}).then(function(a){return r(a.data,h,d)})},simplify:function(f){var d=f[0].spatialReference,g=a.mixin({},this.parsedUrl.query,{f:"json",sr:d.wkid?d.wkid:JSON.stringify(d.toJSON()),geometries:JSON.stringify(this._encodeGeometries(f))}),e=c.getJsonType(f[0]),h=this._decodeGeometries;return b(this.parsedUrl.path+"/simplify",{query:g,callbackParamName:"callback"}).then(function(a){return h(a.data,
e,d)})},convexHull:function(f){var d=f[0].spatialReference;f=a.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(d.toJSON()),geometries:JSON.stringify(this._encodeGeometries(f))});return b(this.parsedUrl.path+"/convexHull",{query:f,callbackParamName:"callback"}).then(function(a){return c.fromJSON(a.data.geometry).set("spatialReference",d)})},union:function(f){var d=f[0].spatialReference;f=a.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(d.toJSON()),geometries:JSON.stringify(this._encodeGeometries(f))});
return b(this.parsedUrl.path+"/union",{query:f,callbackParamName:"callback"}).then(function(a){return c.fromJSON(a.data.geometry).set("spatialReference",d)})},autoComplete:function(c,d){var f=c[0].spatialReference,g=a.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(f.toJSON()),polygons:JSON.stringify(this._encodeGeometries(c).geometries),polylines:JSON.stringify(this._encodeGeometries(d).geometries)});return b(this.parsedUrl.path+"/autoComplete",{query:g,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||
[]).map(function(a){return new e({spatialReference:f,rings:a.rings})})})},reshape:function(f,d){var g=f.spatialReference,e=a.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(g.toJSON()),target:JSON.stringify({geometryType:c.getJsonType(f),geometry:f.toJSON()}),reshaper:JSON.stringify(d.toJSON())});return b(this.parsedUrl.path+"/reshape",{query:e,callbackParamName:"callback"}).then(function(a){return c.fromJSON(a.data.geometry).set("spatialReference",g)})},cut:function(g,d){var e=g[0].spatialReference,
h=f.map(g,function(a){return a.toJSON()}),h=a.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(e.toJSON()),target:JSON.stringify({geometryType:c.getJsonType(g[0]),geometries:h}),cutter:JSON.stringify(d.toJSON())});return b(this.parsedUrl.path+"/cut",{query:h,callbackParamName:"callback"}).then(function(a){a=a.data;return{cutIndexes:a.cutIndexes,geometries:(a.geometries||[]).map(function(a){return c.fromJSON(a).set("spatialReference",e)})}})},intersect:function(f,d){var g=f[0].spatialReference,
e=a.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(g.toJSON()),geometries:JSON.stringify(this._encodeGeometries(f)),geometry:JSON.stringify({geometryType:c.getJsonType(d),geometry:d.toJSON()})});return b(this.parsedUrl.path+"/intersect",{query:e,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return c.fromJSON(a).set("spatialReference",g)})})},difference:function(f,d){var g=f[0].spatialReference,e=a.mixin({},this.parsedUrl.query,{f:"json",sr:JSON.stringify(g.toJSON()),
geometries:JSON.stringify(this._encodeGeometries(f)),geometry:JSON.stringify({geometryType:c.getJsonType(d),geometry:d.toJSON()})});return b(this.parsedUrl.path+"/difference",{query:e,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return c.fromJSON(a).set("spatialReference",g)})})},buffer:function(c){var d=a.mixin({},this.parsedUrl.query,{f:"json"},c.toJSON()),f=c.outSpatialReference||c.geometries[0].spatialReference;return b(this.parsedUrl.path+"/buffer",
{query:d,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return new e({spatialReference:f,rings:a.rings})})})},areasAndLengths:function(c){c=a.mixin({},this.parsedUrl.query,{f:"json"},c.toJSON());return b(this.parsedUrl.path+"/areasAndLengths",{query:c,callbackParamName:"callback"}).then(function(a){return a.data})},lengths:function(c){c=a.mixin({},this.parsedUrl.query,{f:"json"},c.toJSON());return b(this.parsedUrl.path+"/lengths",{query:c,callbackParamName:"callback"}).then(function(a){return a.data})},
labelPoints:function(g){var d=f.map(g,function(a){return a.toJSON()}),e=g[0].spatialReference;g=a.mixin({},this.parsedUrl.query,{f:"json",sr:e.wkid?e.wkid:JSON.stringify(e.toJSON()),polygons:JSON.stringify(d)});return b(this.parsedUrl.path+"/labelPoints",{query:g,callbackParamName:"callback"}).then(function(a){return(a.data.labelPoints||[]).map(function(a){return c.fromJSON(a).set("spatialReference",e)})})},relation:function(c){c=a.mixin({},this.parsedUrl.query,{f:"json"},c.toJSON());return b(this.parsedUrl.path+
"/relation",{query:c,callbackParamName:"callback"}).then(this._handleRelationResponse)},trimExtend:function(c){var d=a.mixin({},this.parsedUrl.query,{f:"json"},c.toJSON()),f=c.sr;return b(this.parsedUrl.path+"/trimExtend",{query:d,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return new h({spatialReference:f,paths:a.paths})})})},densify:function(f){var d=a.mixin({},this.parsedUrl.query,{f:"json"},f.toJSON()),g=f.geometries[0].spatialReference;return b(this.parsedUrl.path+
"/densify",{query:d,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return c.fromJSON(a).set("spatialReference",g)})})},generalize:function(f){var d=a.mixin({},this.parsedUrl.query,{f:"json"},f.toJSON()),g=f.geometries[0].spatialReference;return b(this.parsedUrl.path+"/generalize",{query:d,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return c.fromJSON(a).set("spatialReference",g)})})},offset:function(f){var d=
a.mixin({},this.parsedUrl.query,{f:"json"},f.toJSON()),g=f.geometries[0].spatialReference;return b(this.parsedUrl.path+"/offset",{query:d,callbackParamName:"callback"}).then(function(a){return(a.data.geometries||[]).map(function(a){return c.fromJSON(a).set("spatialReference",g)})})},distance:function(c){c=a.mixin({},this.parsedUrl.query,{f:"json"},c.toJSON());return b(this.parsedUrl.path+"/distance",{query:c,callbackParamName:"callback"}).then(this._handleDistanceResponse)},toGeoCoordinateString:function(c){var d=
{};a.isObject(c.sr)?d.sr=c.sr.wkid||JSON.stringify(c.sr.toJSON()):d.sr=c.sr;d.coordinates=JSON.stringify(c.coordinates);d.conversionType=r.toJSON(c.conversionType||"mgrs");d.conversionMode=c.conversionMode;d.numOfDigits=c.numOfDigits;d.rounding=c.rounding;d.addSpaces=c.addSpaces;c=a.mixin({},this.parsedUrl.query,{f:"json"},d);return b(this.parsedUrl.path+"/toGeoCoordinateString",{query:c,callbackParamName:"callback"}).then(this._handleToGeoCoordinateResponse)},fromGeoCoordinateString:function(c){var d=
{};a.isObject(c.sr)?d.sr=c.sr.wkid||JSON.stringify(c.sr.toJSON()):d.sr=c.sr;d.strings=JSON.stringify(c.strings);d.conversionType=r.toJSON(c.conversionType||"mgrs");d.conversionMode=c.conversionMode;c=a.mixin({},this.parsedUrl.query,{f:"json"},d);return b(this.parsedUrl.path+"/fromGeoCoordinateString",{query:c,callbackParamName:"callback"}).then(this._handleFromGeoCoordinateResponse)},_handleRelationResponse:function(a){return a.data.relations},_handleDistanceResponse:function(a){return(a=a.data)&&
a.distance},_handleToGeoCoordinateResponse:function(a){return a.data.strings},_handleFromGeoCoordinateResponse:function(a){return a.data.coordinates}});a.mixin(s,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,
UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,
UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,
UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",
UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});return s})},"esri/tasks/support/ProjectParameters":function(){define(["../../core/declare","dojo/_base/array","../../core/Accessoire","../../core/lang","../../geometry/support/jsonUtils"],function(s,q,n,k,h){return s(n,{declaredClass:"esri.tasks.support.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJSON:function(){var e=q.map(this.geometries,function(b){return b.toJSON()}),c={};
c.outSR=this.outSR.wkid||JSON.stringify(this.outSR.toJSON());c.inSR=this.geometries[0].spatialReference.wkid||JSON.stringify(this.geometries[0].spatialReference.toJSON());c.geometries=JSON.stringify({geometryType:h.getJsonType(this.geometries[0]),geometries:e});this.transformation&&(c.transformation=this.transformation.wkid||JSON.stringify(this.transformation));k.isDefined(this.transformForward)&&(c.transformForward=this.transformForward);return c}})})},"esri/views/3d/support/ResourceController":function(){define("../../../core/declare ../../../core/Scheduler ../support/eventUtils ./StreamDataManager ./PreallocArray ../webgl-engine/lib/Util".split(" "),
function(s,q,n,k,h,e){function c(a){this.budget=this.begin=0;this.performance=e.performance;this.enabled=!0;void 0!==a&&this.reset(a)}var b=e.assert,g={TERRAIN:"terrain",SCENE:"scene",SYMBOLOGY:"symbols"},f=new h(20);c.prototype.now=function(){return this.performance.now()};c.prototype.reset=function(a){this.begin=this.now();this.budget=this.enabled?a:Number.MAX_VALUE};c.prototype.done=function(){return this.enabled&&this.elapsed()>=this.budget};c.prototype.remaining=function(){return Math.max(this.budget-
this.elapsed(),0)};c.prototype.elapsed=function(){return this.now()-this.begin};s=s(null,{constructor:function(b,f){this._clients=[];this._frameWorker=null;this._budget=new c;this._idleFrameWorkers=[];this._idleFrameWorkerRobin=0;this._idleUpdatesStartFired=!1;this._lastTargetChangeTime=e.performance.now();this.navigationTimeout=300;this.animatingFrameTimeBudget=10;this.idleFrameWorkerBudget=30;this.idleFrameTimeBudget=50;var d={},m;for(m in g)d[g[m]]=0;d[g.TERRAIN]=15;d[g.SCENE]=20;d[g.SYMBOLOGY]=
5;this._maxGpuMemory=1500;this.streamDataManager=new k(d);this._cameraListeners=n.on(b,{navigation:{currentViewReachedTarget:this._targetReached,targetViewChanged:this._targetChanged}},this);f||(f=q);this._frameTask=f.addFrameTask({update:this._frameUpdate.bind(this)});this._view=b;this.stats={frameUpdateTime:new a,idleUpdateTime:new a};this.frameUpdateNavigation=null},destroy:function(){this._frameTask.remove();this._frameTask=null;this._cameraListeners.remove();this.streamDataManager.destroy();
this.streamDataManager=null},setEnableBudget:function(a){this._budget.enabled=!!a},registerClient:function(a,b,d){this._clients.push({client:a,type:b});"function"===typeof a.setMaxGpuMemory&&a.setMaxGpuMemory(this._maxGpuMemory);return this.streamDataManager.makeSupplier(b,d)},deregisterClient:function(a){for(var b=0;b<this._clients.length;b++)if(this._clients[b].client===a){this._clients[b]=this._clients[this._clients.length-1];this._clients.pop();return}console.warn("deregistering an unregistered client.")},
setMaxGpuMemory:function(a){this._maxGpuMemory=a;for(var b=0;b<this._clients.length;b++){var d=this._clients[b].client;"function"===typeof d.setMaxGpuMemory&&d.setMaxGpuMemory(a)}},registerIdleFrameWorker:function(a,c){var d=this._idleFrameWorkers.some(function(b){return b.client===a});b(!d,"Can only register idle frame workers once per client/layer");b(!c.idleFrame||c.needsUpdate,"needsUpdate has to be specified if idleFrame is specified");this._idleFrameWorkers.push({client:a,callbacks:c});this._isIdle()&&
(this._idleUpdatesStartFired&&c.idleBegin)&&c.idleBegin.call(a)},deregisterIdleFrameWorker:function(a){for(var b=this._idleFrameWorkers,d=0;d<b.length;d++){var c=b[d];if(c.client===a){this._idleUpdatesStartFired&&c.callbacks.idleEnd&&c.callbacks.idleEnd.call(a);b[d]=b[b.length-1];b.pop();break}}},registerFrameWorker:function(a){b(!this._frameWorker,"Only one (non-idle) per-frame worker supported at the moment");this._frameWorker=a},deregisterFrameWorker:function(){this._frameWorker=null},_targetChanged:function(a){this._lastTargetChangeTime=
e.performance.now();this._targetReached=!1;this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._callWorkersNoScheduling("idleEnd"))},_targetReached:function(a){this._targetReached=!0},_frameUpdate:function(a){var b=this._isIdle();this._budget.reset((b?this.idleFrameWorkerBudget:this.animatingFrameTimeBudget)-a.spendInFrame);this._view.navigation&&this._view.navigation.step(a.deltaTime);this._frameWorker&&(this._frameWorker(this._budget),this.stats.frameUpdateTime.addSample(this._budget.elapsed()));
b&&(this._idleUpdatesStartFired||(this._callWorkersNoScheduling("idleBegin"),this._idleUpdatesStartFired=!0),this._budget.reset(this.idleFrameTimeBudget-this._budget.elapsed()),3<this._budget.remaining()&&(this._callWorkersStrictScheduling("idleFrame",this._budget),this.stats.idleUpdateTime.addSample(this._budget.elapsed())))},_isIdle:function(){return this._budget.now()-this._lastTargetChangeTime>this.navigationTimeout&&this._targetReached},_callWorkersNoScheduling:function(a){for(var b=this._idleFrameWorkers,
d=0;d<b.length;d++){var c=b[d];c.callbacks[a]&&c.callbacks[a].call(c.client)}},_callWorkersStrictScheduling:function(a,b){var d=this._idleFrameWorkers,c=d.length,g,e,h;f.clear();e=0;for(h=this._idleFrameWorkerRobin;e<c;e++)g=d[h++%c],g.callbacks.needsUpdate&&g.callbacks.needsUpdate.call(g.client)&&(0===f.length&&(this._idleFrameWorkerRobin=h),f.push(g));g=b.now();for(d=g+b.remaining();0<f.length&&g<d;)b.reset((d-g)/f.length),g=f.pop(),g.callbacks[a].call(g.client,b),g=b.now()}});s.ClientType=g;var a=
function(){this.addSample=function(a){this.min=Math.min(this.min,a);this.max=Math.max(this.max,a);this.total+=a;this.numSamples++};this.getAverage=function(){return this.total/this.numSamples};this.reset=function(){this.numSamples=this.total=0;this.min=Number.MAX_VALUE;this.max=-Number.MAX_VALUE};this.reset()};return s})},"esri/views/3d/support/StreamDataManager":function(){define(["../../../core/declare","./StreamDataLoader"],function(s,q){var n=s(null,{_clientType:void 0,_loader:void 0,constructor:function(k,
h,e){this._clientType=k;this._loader=h;this._addUrlTokenFunction=e},request:function(k,h,e){return this._loader.request(k,h,this._clientType,e,this._addUrlTokenFunction)},isRequested:function(k){return this._loader.isRequested(k)},cancelRequest:function(k){this._loader.cancel(k)},getRequestedURLs:function(){return this._loader.getRequestedURLs(this._clientType)},cancelRequestsBulk:function(k){this._loader.cancelBulk(k,this._clientType)}});return s(null,{constructor:function(k){this._loader=new q(k)},
destroy:function(){this._loader.destroy();this._loader=null},hasPendingDownloads:function(){return this._loader.hasPendingDownloads()},makeSupplier:function(k,h){return new n(k,this._loader,h)}})})},"esri/views/3d/support/StreamDataLoader":function(){define("../../../core/declare ../../../request ../../../config ../../../core/urlUtils ./PromiseLightweight ./AsyncQuotaRoundRobinQueue ../webgl-engine/lib/Util".split(" "),function(s,q,n,k,h,e,c){var b=c.assert,g={QUEUED:1,DOWNLOADING:2,CANCELLED:4};
s=s(null,{constructor:function(a){this.alreadyLoading={};this.loadQueue=new e(f,this._doneLoadingCallback,this,a)},destroy:function(){for(var a in this.alreadyLoading){for(var b=this.alreadyLoading[a],c=0;c<b.clientPromises.length;c++){var d=b.clientPromises[c];d.isRejected()||d.reject(b.url,null,b.docType,b.clientMetadata[c])}this._cancelTask(b)}this.loadQueue.clear();this.alreadyLoading=this.loadQueue=null},request:function(a,b,c,d,e){d=d||{};var p=new h.Promise;p.requestURL=a;var k=this.alreadyLoading[a];
k?(k.clientPromises.push(p),k.clientMetadata.push(d.metadata)):(k={url:a,docType:b,clientType:c,status:g.QUEUED,clientMetadata:[d.metadata],clientPromises:[p],downloadObj:null,_cancelledInQueue:!1},e&&(k.urlWithToken=e(a)),this.alreadyLoading[a]=k,d.notQueueable?f(k,this._doneLoadingCallback.bind(this)):this.loadQueue.push(k));return p},isRequested:function(a){return void 0!==this.alreadyLoading[a]},cancel:function(a){var b=this.alreadyLoading[a.requestURL];b&&this._removeRequestPromiseFromTask(b,
a)},getRequestedURLs:function(a){var b={},c;for(c in this.alreadyLoading)this.alreadyLoading[c].clientType===a&&(b[c]=!0);return b},cancelBulk:function(a,b){var f;if(c.getFirstObjectValue(a)instanceof h.Promise)for(f in a)this.cancel(a[f]);else{var d=[];for(f in a){var g=this.alreadyLoading[f];g&&(this._cancelTask(g),d.push(g))}0<d.length&&this.loadQueue.removeTasks(d,b)}},hasPendingDownloads:function(){return!c.objectEmpty(this.alreadyLoading)},_removeRequestPromiseFromTask:function(a,c){var f=a.clientPromises.length;
if(1<f){var d=a.clientPromises.indexOf(c);b(-1<d,"request to be cancelled is already cancelled or invalid");a.clientPromises[d]=a.clientPromises[f-1];a.clientPromises.pop();a.clientMetadata[d]=a.clientMetadata[f-1];a.clientMetadata.pop()}else b(a.clientPromises[0]===c,"request to be cancelled is already cancelled or invalid"),this._cancelTask(a)},_cancelTask:function(a){if(a.status===g.DOWNLOADING){this.loadQueue.workerCancelled(a);if("image"===a.docType){var b=a.downloadObj;b.removeAttribute("onload");
b.removeAttribute("onerror");b.removeAttribute("src")}else a.status=g.CANCELLED,a.downloadObj.cancel();a.downloadObj=null}a.status=g.CANCELLED;a.clientPromise=void 0;a.metadata=void 0;delete this.alreadyLoading[a.url]},_doneLoadingCallback:function(a,c){var f;b(a.status===g.DOWNLOADING);delete this.alreadyLoading[a.url];if(c)for(f=0;f<a.clientPromises.length;f++)a.clientPromises[f].isRejected()||a.clientPromises[f].reject(a.url,c,a.docType,a.clientMetadata[f]);else for(f=0;f<a.clientPromises.length;f++)a.clientPromises[f].done(a.url,
a.result,a.docType,a.clientMetadata[f])}});var f=function(a,b){if(a.status===g.CANCELLED)return!1;var f=a.urlWithToken||a.url;0===f.indexOf("//")&&(f=window.location.protocol+f);if("image"===a.docType){var d=new Image;d.onload=function(){a.status!==g.CANCELLED&&(a.result=d,d.removeAttribute("onload"),d.removeAttribute("onerror"),b(a))};d.onerror=function(){a.status!==g.CANCELLED&&(d.removeAttribute("onload"),d.removeAttribute("onerror"),b(a,{status:404}))};var e=k.hasSameOrigin(f,window.location.href);
"data:"===f.substring(0,5)?d.src=f:e||k.canUseXhr(f)?(e||(d.crossOrigin="anonymous"),d.src=f):d.src=(a.urlWithToken||!n.request.proxyUrl?"":n.request.proxyUrl+"?")+f;a.downloadObj=d}else f=q(f,{responseType:"binary"===a.docType?"array-buffer":"json",failOk:!0}),f.then(function(d){a.duration=c.performance.now()-a.startTime;a.size=0;a.result=d.data;b(a)},function(d){a.status!==g.CANCELLED&&b(a,d)}),a.downloadObj=f;a.status=g.DOWNLOADING;return!0};s.TaskStatus=g;return s})},"esri/views/3d/support/PromiseLightweight":function(){(function(s){function q(h){this._callbacks=
[];this._errbacks=[];this._cancelCallback=h;this._iserr=this._isdone=this._iscancelled=!1}function n(h,e){var c=new q;0===h.length?c.done.apply(c,e):h[0].apply(null,e).then(function(){h.splice(0,1);n(h,arguments).then(function(){c.done.apply(c,arguments)})});return c}q.prototype.cancel=function(h){this._callbacks=[];this._errbacks=[];this._iscancelled=!0;this._cancelCallback&&this._cancelCallback(h)};q.prototype.then=function(h,e,c){var b;if(!this._iscancelled)return this._isdone?b=h.apply(c,this.result):
this._iserr&&e?b=e.apply(c,this.result):(this._callbacks.push(function(){return h.apply(c,arguments)}),e&&this._errbacks.push(function(){return e.apply(c,arguments)})),b};q.prototype.done=function(){this.result=arguments;this._isdone=!0;for(var h=0;h<this._callbacks.length;h++)this._callbacks[h].apply(null,arguments);this._callbacks=[];this._errbacks=[]};q.prototype.resolve=q.prototype.done;q.prototype.reject=function(){if(!this._iscancelled){this.result=arguments;this._iserr=!0;for(var h=0;h<this._errbacks.length;h++)this._errbacks[h].apply(null,
arguments);this._callbacks=[];this._errbacks=[]}};q.prototype.isRejected=function(){return this._iserr};q.prototype.isFulfilled=function(){return this._isdone||this._iserr};q.prototype.isCancelled=function(){return this._iscancelled};var k={Promise:q,join:function(h){function e(e,d){return function(){d&&(a=!0);g+=1;f[e]=Array.prototype.slice.call(arguments);g===b&&(a?c.reject():c.done(f))}}for(var c=new q,b=h.length,g=0,f=[],a=!1,k=0;k<b;k++)h[k].then(e(k,!1),e(k,!0));0===h.length&&c.done();return c},
chain:n};"function"===typeof define&&define.amd?define(function(){return k}):s.promise=k})(this)},"esri/views/3d/support/AsyncQuotaRoundRobinQueue":function(){define(["../../../core/arrayUtils","../webgl-engine/lib/Util"],function(s,q){return function(n,k,h,e,c){function b(){return"workers: "+r+", queues: "+a.map(function(a){return a.length})}var g=0,f={},a=[],r=[],l=[],d=[],m=0,p=0,t;for(t in e)a[g]=[],r[g]=0,d[g]={requests:0,size:0,duration:0,speed:0},l[g]=e[t],f[t]=g++,p+=e[t];var x=a.length,g=
0;this.setWorkerQuota=function(a){q.assert(s.equals(Object.keys(this.typeWorkerAllication),Object.keys(a)));this.typeWorkerAllication=a;p=0;for(var b in a)l[f[b]]=a[b],p+=a[b]};this.setWorkerFunc=function(a){n=a};this.push=function(d){var g=f[d.clientType];m<p?(r[g]++,m++,c&&console.log("queue start type "+g+", "+b()),n(d,z)):(a[g].push(d),c&&console.log("queue push type "+g+", "+b()))};this._getStatsForType=function(b){b=f[b];return{quota:l[b],workers:r[b],queueSize:a[b].length,requestStats:d[b]}};
this.removeTasks=function(b,d){for(var c=[],g=a[f[d]],e=0;e<g.length;e++){var m=g[e];-1<b.indexOf(m)||c.push(m)}a[f[d]]=c};this.workerCancelled=function(a){v(a);a._cancelledInQueue=!0};this.clear=function(){for(var b=0;b<a.length;b++)a[b]=[]};var v=function(a){var e=f[a.clientType];r[e]--;m--;d[e].requests++;d[e].size+=a.size||0;d[e].duration+=a.duration||0;d[e].speed=0<d[e].duration?d[e].size/d[e].duration:0;q.assert(0<=r[e]);a=g;e=!1;do r[a]<l[a]&&u(a)&&(e=!0),a=(a+1)%x;while(!e&&a!=g);if(!e){do u(a)&&
(e=!0),a=(a+1)%x;while(!e&&a!=g)}!e&&c&&console.log("queue sink, "+b());g=a},u=function(d){for(;0<a[d].length;){if(n(a[d].shift(),z))return c&&console.log("queue startqueued clientType "+d+", "+b()),r[d]++,m++,!0;c&&console.log("queue task cancelled, "+b())}return!1},z=function(a){a._cancelledInQueue||(k.apply(h,arguments),v(a))}}})},"esri/core/arrayUtils":function(){define([],function(){function s(n,k){return-1===n.indexOf(k)}function q(n,k,h){return!n.some(k.bind(null,h))}return{findIndex:function(n,
k,h){for(var e=n.length,c,b=0;b<e;b++)if(c=n[b],k.call(h,c,b,n))return b;return-1},equals:function(n,k){if(!n&&!k)return!0;if(!n||!k||n.length!=k.length)return!1;for(var h=0;h<n.length;h++)if(n[h]!==k[h])return!1;return!0},difference:function(n,k,h){var e;h?(e=k.filter(q.bind(null,n,h)),n=n.filter(q.bind(null,k,h))):(e=k.filter(s.bind(null,n)),n=n.filter(s.bind(null,k)));return{added:e,removed:n}}}})},"esri/views/3d/support/PreallocArray":function(){define(["../../../core/declare","./HeapSort"],function(s,
q){return s([],{constructor:function(n,k){this.data=Array(n);this.length=0;if(k){for(var h=0;h<n;h++)this.data[h]=k(h);this._allocator=k;this._hasAllocator=!0}else this._allocator=this._nullAllocator,this._hasAllocator=!1},_nullAllocator:function(){return null},grow:function(n){for(;this.data.length<n;)this.data.push(this._allocator(this.data.length))},next:function(){if(!this._hasAllocator)return null;this.data.length===this.length&&this.grow(2*this.length);return this.data[this.length++]},swap:function(n,
k){var h=this.data[n];this.data[n]=this.data[k];this.data[k]=h},push:function(n){this.data.length===this.length&&this.grow(2*this.length);this.data[this.length++]=n},pushArray:function(n){var k=this.length+n.length;k>=this.data.length&&this.grow(Math.max(2*this.length,k));for(k=0;k<n.length;k++)this.data[this.length++]=n[k]},pushEither:function(n){Array.isArray(n)?this.pushArray(n):this.push(n)},pop:function(){if(0===this.length)return null;var n=this.data[--this.length];this._hasAllocator||(this.data[this.length]=
null);return n},slice:function(n,k){void 0===k&&(k=this.length);return this.data.slice(n,k)},clear:function(){if(!this._hasAllocator)for(var n=0;n<this.length;n++)this.data[n]=null;this.length=0},peek:function(){return 0===this.length?null:this.data[this.length-1]},sort:function(n){q.sort(this.data,0,this.length,n);return this}})})},"esri/views/3d/support/HeapSort":function(){define([],function(){function s(n,k,h,e){for(var c=k,b=h>>>1,g=n[c-1];k<=b;){k=c<<1;k<h&&0>e(n[k-1],n[k])&&++k;var f=n[k-1];
if(0>=e(f,g))break;n[c-1]=f;c=k}n[c-1]=g}function q(n,k){return n<k?-1:n>k?1:0}return{sort:function(n,k,h,e){void 0===k&&(k=0);void 0===h&&(h=n.length);void 0===e&&(e=q);for(var c=h>>>1;c>k;c--)s(n,c,h,e);for(var b=k+1,c=h-1;c>k;c--)h=n[k],n[k]=n[c],n[c]=h,s(n,b,c,e);return n}}})},"esri/views/3d/support/DisplayQualityProfile":function(){define(["require","exports","../../../core/sniff"],function(s,q,n){var k={low:{sceneLayer:{lodFactor:0.2},tiledSurface:{lodBias:-1},antialiasingEnabled:!1},high:{sceneLayer:{lodFactor:1},
tiledSurface:{lodBias:0},antialiasingEnabled:!0}};return function(){function h(){}h.isValidProfile=function(e){return e in k};h.getDefaultProfile=function(){return n("trident")||n("safari")?"low":"high"};h.apply=function(e,c){var b=k[e];c.qualitySettings.sceneLayer.lodFactor=b.sceneLayer.lodFactor;c.qualitySettings.tiledSurface.lodBias=b.tiledSurface.lodBias;c.qualitySettings.antialiasingEnabled=b.antialiasingEnabled};return h}()})},"esri/views/3d/support/QualitySettings":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/typescript ../../../core/Accessor".split(" "),
function(s,q,n,k,h,e){var c=function(b){function c(){b.apply(this,arguments)}n(c,b);k([h.property({value:1})],c.prototype,"lodFactor",void 0);return c=k([h.subclass()],c)}(e),b=function(b){function c(){b.apply(this,arguments)}n(c,b);k([h.property({value:0})],c.prototype,"lodBias",void 0);return c=k([h.subclass()],c)}(e);return function(g){function f(){g.apply(this,arguments)}n(f,g);f.prototype.getDefaults=function(){return{sceneLayer:new c,tiledSurface:new b,antialiasingEnabled:!0}};k([h.property()],
f.prototype,"sceneLayer",void 0);k([h.property()],f.prototype,"tiledSurface",void 0);k([h.property()],f.prototype,"antialiasingEnabled",void 0);return f=k([h.subclass()],f)}(e)})},"esri/views/3d/terrain/TerrainSurface":function(){define("../../../core/declare ../../../core/Accessoire ../../../core/arrayUtils dojo/Evented dojo/on ../lib/glMatrix ../support/eventUtils ../support/projectionUtils ../support/ResourceController ../support/PromiseLightweight ../../../geometry/support/webMercatorUtils ./TerrainRenderer ./OverlayManager ./SurfaceExtentHelper ./SurfaceTilingSchemeLogic ./TilingScheme ./terrainUtils ./TileUtils ./TerrainConst ./TileGeometryFactory ./SphericalTile ./PlanarTile ./TilemapOnlyTile ./MapTileAgent ./ElevationTileAgent ../support/PreallocArray ../support/ObjectPool ../support/aaBoundingRect ../support/mathUtils".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u,z,w,C,A,y,B,D,F,H){function N(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}var G=e.vec3d,O=e.vec4d,M=e.mat4d,I=t.weakAssert,Z=80/180*Math.PI,V=v.TileUpdateTypes,L=O.create(),Y=[0,0,0],E=Array(10),ba={spatialReference:null,tile:null},W={spatialReference:null,extent:null},R={spatialReference:null,extent:null,scale:0},T=[-Infinity,-Infinity,Infinity,Infinity],J=function(a){a.remove()},S=s([q,k],{classMetadata:{properties:{ready:{readOnly:!0,getter:function(){return!!this._rootTiles}},
manifold:{readOnly:!0,getter:function(){return this._manifold}},tilingScheme:{readOnly:!0,getter:function(){return this._tilingScheme}},tilingSchemeLocked:{readOnly:!0,getter:function(){return this.tilingSchemeLogic.tilingSchemeLocked}},spatialReference:{readOnly:!0,dependsOn:["tilingScheme"],getter:function(){return this._tilingScheme?this._tilingScheme.spatialReference:null}},overlayManager:{value:null},wireframe:{value:!1},opacity:{value:1},cullBackFaces:{value:!1},renderOrder:{value:1},skirts:{value:!0},
frontMostTransparent:{value:!1},tileBackground:{value:"data:image/png;base64,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"},
extent:{}}},defaultTileBackground:"data:image/png;base64,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",
constructor:function(){this._rootTiles=null;this._iteratorPool=new D(2,x.IteratorPreorder);this._postorderIterator=new x.IteratorPostorder;this._topLevelTilemapOnlyTiles=Array(v.TILEMAP_SIZE_EXP+1);for(a=0;a<this._topLevelTilemapOnlyTiles.length;a++)this._topLevelTilemapOnlyTiles[a]=new C([a-v.TILEMAP_SIZE_EXP,0,0]);this._dataExtent=this._clippingExtent=this._tilingScheme=null;this._rootExtent=[0,0,0,0];this.notifyChange("extent");this._elevationBounds=[0,0];this.loaded=!1;this._frameUpdateLowerPrio=
new B(500);this.maxTextureScale=1.2;this._stage=this._view._stage;this._updateNextFrame=this._lvPendingUpdates=this._pendingUpdates=this.suspended=this.visible=!1;this._curOverlayOpacity=1;this._curEyePos=G.create();this._curSplitLimits=[0,0,0,0,0];this._curFrustumPlanes=Array(6);this._viewProjectionMatrix=M.identity();for(var a=0;6>a;++a)this._curFrustumPlanes[a]=O.create();this.tilemapStats={tilemapRequestsSent:0,tilemapRequestsPending:0,tilemapRequestErrors:0,fullTilemaps:0,emptyTilemaps:0,tilesRequested:0,
tileRequestsSent:0,tileRequestErrors:0,tilesNotPresent:0};this._layerViews=[[],[]];this._layerIndexByLayerViewId=[{},{}];this._basemapLayerViewHandles={};this._groupLayerViewHandles={};this._layerViewChangesHandle=null;this.hideSkirtsDistanceFromExtentMargin=1.2;this.hideSkirtsMinimumCameraTilt=Z},normalizeCtorArgs:function(a,b){this._view=a;this._manifold=b;this.TileClass="planar"===b?w:z;return{}},initialize:function(){this._renderer=new r(this.manifold);this._renderer.loaded=this._setLoaded.bind(this);
this._renderer.updateTileBackground(this.tileBackground);this._renderer.install(this._view._stage);this.overlayManager=new l(this,this._view);this.extentHelper=new ("spherical"===this.manifold?d.SurfaceExtentHelperGlobal:d.SurfaceExtentHelperLocal)({layers:this._view.map.allLayers,layerViews:this._view.allLayerViews,spatialReference:this._view.spatialReference});this.tilingSchemeLogic=new m({layers:this._view.map.allLayers,extentHelper:this.extentHelper,manifold:this.manifold,viewSpatialReference:this._view.spatialReference});
this.tilingSchemeLogic.changeCallback=this._updateTilingSchemeAndExtent.bind(this);this._updateTilingSchemeAndExtent();this._streamDataSupplier=this._view.resourceController.registerClient(this,g.ClientType.TERRAIN);this._idleWorkers={needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate};this._view.resourceController.registerFrameWorker(this._frameUpdate.bind(this));this._view.resourceController.registerIdleFrameWorker(this,this._idleWorkers);this._viewChangeListenerHandles=[];this._viewChangeUpdate=
this._viewChangeUpdate.bind(this);this._viewChangeListenerHandles.push(this._view.on("resize",this._viewChangeUpdate));this._viewChangeListenerHandles.push(c.on(this._view,"navigation.currentViewChanged",this._viewChangeUpdate));this._viewChangeListenerHandles.push(this._view.watch("qualitySettings.tiledSurface.lodBias",this._viewChangeUpdate));this._layerViewChangesHandle=this._view.allLayerViews.on("change",this._handleLayerViewChanges.bind(this));this._handleLayerViewChanges({added:this._view.allLayerViews.toArray(),
removed:[],moved:[]});this._clippingChangedHandle=this._view.watch("clippingArea",this._clippingChanged.bind(this));this._updateClippingExtent()},destroy:function(){this._removeAllTiles();this.tilingSchemeLogic.destroy();this.tilingSchemeLogic=null;this.extentHelper.destroy();this.extentHelper=null;for(var a in this._basemapLayerViewHandles)this._unregisterTiledLayerView(a);this._view.resourceController.deregisterFrameWorker(this);this._view.resourceController.deregisterIdleFrameWorker(this);this._view.resourceController.deregisterClient(this);
this._viewChangeListenerHandles.forEach(J);for(var b in this._groupLayerViewHandles)this._groupLayerViewHandles[b].forEach(J);this._layerViewChangesHandle.remove();this._clippingChangedHandle.remove();this.overlayManager&&(this.overlayManager.destroy(),this.overlayManager=null);this._renderer.uninstall(this._stage);this._streamDataSupplier=this._stage=this._view=this._renderer=null},setVisibility:function(a){a!==this.visible&&(this.visible=a,this._renderer.setVisibility(a),this.setUpdatesDisabled(!a),
a&&this._viewChangeUpdate())},isVisible:function(){return this.visible&&this.ready},setUpdatesDisabled:function(a){(this.suspended=a)||this._viewChangeUpdate()},getElevation:function(a){return!this.ready||0===this._rootTiles[0].layerInfo[v.LayerClass.ELEVATION].length?null:Array.isArray(a)?this._getElevation(a):!b.pointToVector(a,L,this.tilingScheme.spatialReference)?(console.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null):this._getElevation(L)},
_getElevation:function(a){var b=v.LayerClass.ELEVATION,d=this._rootTiles[0].layerInfo[b].length,c;E.length<d&&(E.length=d);for(var f=0;f<this._rootTiles.length;f++){var g=this._rootTiles[f];if(x.isPosWithinTile(g,a))for(;g;){var e=g.layerInfo[b];for(c=0;c<d;c++)e[c].data&&(E[c]=e[c].data.samplerData);if(!g.children[0])break;c=0;a[0]>g.children[0].extent[2]&&(c+=1);a[1]<g.children[0].extent[1]&&(c+=2);g=g.children[c]}}a=u.elevationSampler(a[0],a[1],E);for(c=0;c<d;c++)E[c]=void 0;return a},getElevationBounds:function(){return this._elevationBounds},
getScale:function(a){if(this.tilingScheme){if(!b.pointToVector(a,L,this.spatialReference))return console.error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null;if(this._rootTiles)for(var d=0;d<this._rootTiles.length;d++)if(a=this._rootTiles[d],x.isPosWithinTile(a,L)){for(;a.children[0];)d=0,L[0]>a.children[0].extent[2]&&(d+=1),L[1]<a.children[0].extent[1]&&(d+=2),a=a.children[d];return this._getLodBiasCorrectedScale(a.lij[0])}}return 1E100},queryVisibleScaleRange:function(a,
b,d,c){b=b?this._tilingScheme.levelAtScale(b):0;d=d?this._tilingScheme.levelAtScale(d):Infinity;var f=this._getLodBias();this._renderer.queryVisibleLevelRange(a,b+f,d+f,c)},_setLoaded:function(){this.loaded||(this.loaded=!0,this.emit("load"))},_updateTilingSchemeAndExtent:function(){var a=this.tilingSchemeLogic.extent,b=this.tilingSchemeLogic.tilingScheme,d=!1;a&&!F.equals(a,this._dataExtent)&&(d=!0,this._dataExtent?F.set(this._dataExtent,a):this._dataExtent=F.create(a));b!=this._tilingScheme&&(I(b,
"tiling scheme cannot be reset to undefined"),d=!0,this._tilingScheme&&this._removeAllTiles(),this._tilingScheme=b,this.notifyChange("tilingScheme"),this._updateClippingExtent(),b&&(this._updateTiledLayers(),this._renderer.setTileSize(b.pixelSize[0]),this.overlayManager.setSpatialReference(b.spatialReference,"spherical"===this.manifold)));this.tilingSchemeLocked!==this.tilingSchemeLogic.tilingSchemeLocked&&this.notifyChange("tilingSchemeLocked");d&&this._updateRootTiles()},_acquireTile:function(a,
b,d,c){var f=this.TileClass.Pool.acquire();Y[0]=a;Y[1]=b;Y[2]=d;f.init(Y,c,this,this._tilingScheme);return f},_releaseTile:function(a){a.dispose();a.parent=null;a.parentSurface=null;this.TileClass.Pool.release(a)},_updateRootTiles:function(){var a=this._clippingExtent||this._dataExtent,b=this._tilingScheme;if(a&&b){var d=b.rootTilesInExtent(a,L,Infinity);if(this._rootTiles){if(64<d.length){console.warn("Could not extend surface to encompass all layers because it would have resulted in too many root tiles.");
return}var a=this._rootTiles.map(function(a){return a.lij}),c=n.difference(a,d,N);if(0<c.removed.length||0<c.added.length){var f=this._rootTiles.filter(function(a){return-1<n.findIndex(c.removed,N.bind(null,a.lij))?(this._purgeChildTiles(a),this._purgeTile(a),!1):!0}.bind(this));c.added.forEach(function(a){a=this._acquireTile(0,a[1],a[2],null);f.push(a);this._loadTile(a)}.bind(this));this._rootTiles=f;this._renderer.setRootTiles(this._rootTiles)}}else 64<d.length&&(console.warn("Maximum number of root tiles exceeded, only a part of the map will be visible."),
d=b.rootTilesInExtent(a,L,64)),this._rootTiles=d.map(function(a){a=this._acquireTile(0,a[1],a[2],null);this._loadTile(a);return a}.bind(this)),this._renderer.setRootTiles(this._rootTiles);n.equals(L,this._rootExtent)||(this._rootExtent=O.create(L),this._hasFixedExtent()||this.notifyChange("extent"));this.setVisibility(!0);this._viewChangeUpdate();this.notifyChange("ready")}},_viewChangeUpdate:function(){this._stage&&(!this.suspended&&this._tilingScheme&&this.visible)&&(this._updateViewDependentParameters(),
this._updateOverlayOpacity(this._curEyePos),this._updateTiles(this._rootTiles),this.overlayManager&&this.overlayManager.setOverlayDirty())},_updateTiles:function(a){var b=this._iteratorPool.acquire();b.reset(a);a=this._curSplitLimits;for(var d=this._curFrustumPlanes,c=this._curEyePos,f=Infinity,g=-Infinity;!b.done;){var e=b.next();e.updateClippingStatus(this._clippingExtent);var m=!0;if(e.updateVisibility(d,c)){e.updateScreenDepth(this._viewProjectionMatrix);e.renderData&&(f=Math.min(e.elevationBounds[0],
f),g=Math.max(e.elevationBounds[1],g));var l=e.shouldSplit(a,c);l===V.SPLIT?(e.pendingUpdates&=~V.MERGE,e.renderData?(m=!1,e.pendingUpdates|=V.SPLIT,b.skip()):m=!1):(e.pendingUpdates&=~V.SPLIT,l===V.VSPLITMERGE&&e.updateAgents(v.LayerClass.ELEVATION),b.skip())}else b.skip();if(m&&!e.renderData){e.pendingUpdates|=V.MERGE;e.pendingUpdates&=~V.SPLIT;m=this._iteratorPool.acquire();for(m.reset(e);!m.done;)l=m.next(),l.updateVisibility(d,c),l.visible&&l.updateScreenDepth(this._viewProjectionMatrix);this._iteratorPool.release(m)}0!==
e.pendingUpdates&&(this._pendingUpdates=!0)}this._iteratorPool.release(b);isFinite(f)&&isFinite(g)&&(this._elevationBounds[0]=f,this._elevationBounds[1]=g)},_viewParamSelector:{projectionMatrix:!0,fovX:!0,viewport:!0},_updateViewDependentParameters:function(){var a=this._view.navigation.currentCamera,b=Math.tan(0.5*a.fovX),d=Math.tan(0.5*a.fovY),c=this.tilingScheme.pixelSize,f=Math.pow(2,-this._getLodBias());this._curSplitLimits[0]=b;this._curSplitLimits[1]=c[0]/a.width*this.maxTextureScale*f;this._curSplitLimits[2]=
d;this._curSplitLimits[3]=c[1]/a.height*this.maxTextureScale*f;this._curSplitLimits[4]=this.tilingScheme.getMaxLod();a.copyFrustumPlanes(this._curFrustumPlanes);M.multiply(a.projectionMatrix,a.viewMatrix,this._viewProjectionMatrix);G.set(a.eye,this._curEyePos);t.autoUpdateSkirtsVisibility(this,this._curEyePos)},_setLayerViewsUpdating:function(){for(var a=0;a<v.LayerClass.LAYER_CLASS_COUNT;a++)for(var b=this._layerViews[a],d=0;d<b.length;d++){var c=b[d];c.suspended||(c.updating=this._pendingUpdates,
c.updatingPercentage=this._pendingUpdates?100:0)}},_frameUpdateTraversal:function(a){if(!this.suspended){this._frameUpdateLowerPrio.clear();var b=this._renderer.numTileTexturesComposited,d=this._iteratorPool.acquire();d.reset(this._rootTiles);for(var c=!1,f=!1;!d.done&&(1<a.remaining()||!c)&&12>this._renderer.numTileTexturesComposited-b;){var g=d.next();g.pendingUpdates&V.MERGE?(this._mergeTile(g),g.pendingUpdates&=~V.MERGE,c=!0,d.skip()):g.pendingUpdates&V.SPLIT?(this._splitTile(g),g.pendingUpdates&=
~V.SPLIT,c=!0,d.skip()):0<g.pendingUpdates&&this._frameUpdateLowerPrio.push(g);0!==g.pendingUpdates&&(f=!0)}this._pendingUpdates=f||!d.done;this._iteratorPool.release(d);return c}},_updateTileGeometry:function(a){this._renderer._updateTileGeometry(a);ba.spatialReference=this.spatialReference;ba.tile=a;h.emit(this,"elevation-change-tile",ba)},_updateTileTexture:function(a){this._renderer.updateTileTexture(a)},_frameUpdate:function(a){if(this._rootTiles){for(var b=this._frameUpdateTraversal(a);(1<a.remaining()||
!b)&&0<this._frameUpdateLowerPrio.length;){var d=this._frameUpdateLowerPrio.pop();d.pendingUpdates&V.DECODE_LERC?(this._decodeLERC(d),d.pendingUpdates&=~V.DECODE_LERC,b=!0):d.pendingUpdates&V.UPDATE_GEOMETRY?(this._renderer.updateTileGeometryNeedsUpdate(d),this._updateTileGeometry(d),b=!0,d.pendingUpdates&=~V.UPDATE_GEOMETRY):d.pendingUpdates&V.UPDATE_TEXTURE&&(this._updateTileTexture(d),d.pendingUpdates&=~V.UPDATE_TEXTURE,b=!0);0!==d.pendingUpdates&&(this._pendingUpdates=!0)}0<this._frameUpdateLowerPrio.length&&
(this._pendingUpdates=!0);this._streamDataSupplier._loader.hasPendingDownloads()&&(this._pendingUpdates=!0);if(this._pendingUpdates!==this._lvPendingUpdates&&(this._pendingUpdates||20===++this._updateNextFrame))this._setLayerViewsUpdating(),this._lvPendingUpdates=this._pendingUpdates,this._updateNextFrame=0}},_needsIdleUpdate:function(){return this.isVisible()&&this.overlayManager&&this.overlayManager.overlaysNeedUpdate()},_idleUpdate:function(a){this.overlayManager.updateOverlay();this._updateOverlayOpacity(this._curEyePos)},
_updateClippingExtent:function(){if(!this.spatialReference)return!1;var a=[],d=null;b.extentToBoundingRect(this._view.clippingArea,a,this.spatialReference)&&(d=a);if(n.equals(d,this._clippingExtent))return!1;this._clippingExtent=d;this.notifyChange("extent");return!0},_clippingChanged:function(){this._updateClippingExtent()&&this._updateRootTiles()},_getLodBias:function(){return Math.round(this._view.qualitySettings.tiledSurface.lodBias)},_getLodBiasCorrectedScale:function(a){var b=this.tilingScheme.levels;
a=H.clamp(a-this._getLodBias(),0,b.length-1);return b[a].scale},_cancelTilemapRequests:function(a){for(var b=0;b<v.LayerClass.LAYER_CLASS_COUNT;b++){var d=a.layerInfo[b];if(d)for(var c=0;c<d.length;c++){var f=d[c];f.tilemapRequest&&(f.tilemapRequest.cancel(),f.tilemapRequest=null)}}},_removeAllTiles:function(){this._rootTiles&&(this._rootTiles.forEach(function(a){this._purgeChildTiles(a);this._purgeTile(a)}.bind(this)),this._rootTiles=null,this.notifyChange("ready"));for(var a=0;a<this._topLevelTilemapOnlyTiles.length;a++)this._cancelTilemapRequests(this._topLevelTilemapOnlyTiles[a]);
this.setVisibility(!1)},_purgeChildTiles:function(a){var b=this._postorderIterator;for(b.reset(a);!b.done;){for(var d=b.next(),c=0;4>c;c++)d.children[c]=null;d!==a&&this._purgeTile(d)}},_purgeTile:function(a){a.unload(this._renderer);this._cancelTilemapRequests(a);a.parent=null;this._renderer.releaseTileTextures(a);this._releaseTile(a)},_splitTile:function(a){var b=a.lij[0]+1,d=2*a.lij[1],c=2*a.lij[2];a.children[0]=this._createTile(b,d,c,a);a.children[1]=this._createTile(b,d,c+1,a);a.children[2]=
this._createTile(b,d+1,c,a);a.children[3]=this._createTile(b,d+1,c+1,a);a.unload(this._renderer);R.spatialReference=this.spatialReference;R.extent=a.extent;R.scale=this._getLodBiasCorrectedScale(b);h.emit(this,"scale-change",R)},_createTile:function(a,b,d,c){I(c,"_createTile sanity check");a=this._acquireTile(a,b,d,c);a.updateClippingStatus(this._clippingExtent);a.updateVisibility(this._curFrustumPlanes,this._curEyePos);a.visible&&(a.updateScreenDepth(this._viewProjectionMatrix),a.shouldSplit(this._curSplitLimits,
this._curEyePos)===V.SPLIT&&(a.pendingUpdates|=V.SPLIT,this._pendingUpdates=!0));this._loadTile(a);return a},_mergeTile:function(a){I(!a.renderData,"_mergeTile sanity check");this._loadTile(a);this._purgeChildTiles(a);R.spatialReference=this.spatialReference;R.extent=a.extent;R.scale=this._getLodBiasCorrectedScale(a.lij[0]);h.emit(this,"scale-change",R)},_loadTile:function(a){a.load(this._renderer);this.overlayManager&&this.overlayManager.hasOverlays()&&this.overlayManager.setOverlayParamsOfTile(a,
a.renderData,this._curOverlayOpacity)},_decodeLERC:function(a){var b=v.LayerClass.ELEVATION,d=a.layerInfo[b];if(d)for(var c=0;c<d.length;c++){var f=d[c];f.pendingUpdates&=~V.DECODE_LERC;if(f.rawData){var g=a.createElevationDataFromLERC(f.rawData);f.rawData=null;if(g){f.data=g;var f=[g.bounds[0],g.bounds[1],a.lij[0]],e=this._iteratorPool.acquire();for(e.reset(a);!e.done;)e.next().setLayerElevationBounds(c,f);this._iteratorPool.release(e);a.dataArrived(c,b,g);this._updateTiles(a);W.spatialReference=
this.spatialReference;W.extent=a.extent;h.emit(this,"elevation-change",W)}}}},_handleLayerViewChanges:function(a){var b=!1;a.added.forEach(function(a){var d=a.layer;t.isTiledLayerView(a)?(this._registerTiledLayer(d,a),d.get("loaded")&&(b=!0)):a.supportsDraping&&this.overlayManager&&this.overlayManager.registerLayerView(a)}.bind(this));a.removed.forEach(function(a){t.isTiledLayerView(a)?(b=!0,this._unregisterTiledLayerView(a.id)):a.supportsDraping&&this.overlayManager&&this.overlayManager.unregisterLayerView(a)}.bind(this));
(b=b||0<a.moved.filter(t.isTiledLayerView).length)&&this._updateTiledLayers()},_registerTiledLayer:function(a,b){var d=[];d.push(b.watch("suspended",function(){this._updateTiledLayers()}.bind(this)));d.push(b.layer.watch("opacity",this._updateTileTextures.bind(this)));this._basemapLayerViewHandles[b.id]=d},_unregisterTiledLayerView:function(a){var b=this._basemapLayerViewHandles[a];if(b){for(var d=0;d<b.length;d++)b[d].remove();delete this._basemapLayerViewHandles[a]}},_updateTiledLayers:function(){if(this._tilingScheme){var a=
this._view.allLayerViews,b=[[],[]],d=v.LayerClass,c=null,f=F.create(F.NEGATIVE_INFINITY),g=function(a){var g=a.layer;if(g&&a&&!a.suspended&&t.isTiledLayerView(a)){var e=g.fullExtent;if(e)if(this._tilingScheme.compatibleWith(g.tileInfo))if(F.expand(f,e),t.isElevationLayerView(a))b[d.ELEVATION].push(a);else{if(Infinity!==a.maxDataLevel&&(null===c||a.maxDataLevel>c))c=a.maxDataLevel;b[d.MAP].push(a)}else console.warn("Terrain: tiling scheme of layer "+g.id+" is incompatible with other tiled layers, will not be drawn");
else console.warn("Terrain: Map or elevation layer does not have fullExtent: "+g.id)}}.bind(this);a.forEach(g,this);for(var e=0;e<d.LAYER_CLASS_COUNT;e++){a=this._layerViews[e];g=b[e];g.reverse();var m=a.length!==g.length,l=g.length,p=Array(l),k=Array(a.length);this._layerIndexByLayerViewId[e]={};for(var r=0;r<l;r++){this._layerIndexByLayerViewId[e][g[r].id]=r;var n=a.indexOf(g[r]);p[r]=n;r!==n&&(m=!0);-1<n&&(k[n]=r)}if(m){this._layerViews[e]=g;this._topLevelTilemapOnlyTiles.forEach(function(a){a.modifyLayers(k,
p,e)});if(this._rootTiles){a=this._postorderIterator;for(a.reset(this._rootTiles);!a.done;)a.next().modifyLayers(k,p,e);for(a.reset(this._rootTiles);!a.done;)g=a.next(),g.restartAgents(e),e===d.ELEVATION&&g.updateElevationBounds();this._updateTiles(this._rootTiles)}e===d.ELEVATION&&this.tilingScheme&&(W.spatialReference=this.tilingScheme.spatialReference,W.extent=T,h.emit(this,"elevation-change",W))}}this.tilingScheme.levels.length-1<c&&(this.tilingScheme.ensureMaxLod(c),this._viewChangeUpdate())}},
_getLayerExtentUnion:function(b){var d=this._view.allLayerViews,c=F.create(F.NEGATIVE_INFINITY);d.forEach(function(d){var f=d.layer;(d=d.fullExtentInViewSpatialReference||f.fullExtent)&&!d.spatialReference.equals(b)&&(d=a.canProject(d.spatialReference,b)?a.project(d,b):null);d&&F.expand(c,d)});return F.allFinite(c)?c:null},layerViewByIndex:function(a,b){return this._layerViews[b][a]},agentTypeByLayerIndex:function(a,b){return b===v.LayerClass.ELEVATION?y:A},numLayers:function(a){return this._layerViews[a].length},
numTotalLayers:function(){return this._layerViews.reduce(function(a,b){return b.length+a},0)},_updateTileTextures:function(){var a=this._iteratorPool.acquire();for(a.reset(this._rootTiles);!a.done;)a.next().updateTexture();this._iteratorPool.release(a)},requestTileData:function(a,b,d){this.tilemapStats.tilesRequested++;var c=this.layerViewByIndex(b,d);if(c.layer.tileMap){var g=this.getTilemapTile(a),e=g.layerInfo[d][b];if(e.tilemapData){if(!g.tileDataAvailable(a,b,d))return this.tilemapStats.tilesNotPresent++,
this._dispatchDataEvent(a,"dataMissing",d,c,{notInTilemap:!0}),b=new f.Promise,b.reject(),b}else{var m=new f.Promise;m.actualTileRequestPromise=null;e.tilemapRequest||(e.tilemapRequest=this.requestTilemapData(g,b,d,c));e.tilemapRequest.then(function(){e.tilemapRequest=null;if(!m.isCancelled()){var b=this._layerIndexByLayerViewId[d][c.id];null!=b&&(g.tileDataAvailable(a,b,d)?(m.actualTileRequestPromise=this._requestTileData(a,b,d,c),m.actualTileRequestPromise.then(function(){m.resolve()})):(this.tilemapStats.tilesNotPresent++,
this._dispatchDataEvent(a,"dataMissing",d,c,{notInTilemap:!0}),m.reject()))}}.bind(this));return m}}return this._requestTileData(a,b,d,c)},_requestTileData:function(a,b,d,c){this.tilemapStats.tileRequestsSent++;b=c.getTileUrl(a.lij[0],a.lij[1],a.lij[2]);var f=this;d===v.LayerClass.ELEVATION?(b=this._streamDataSupplier.request(b,"binary"),b.then(function(b,g){var e=f._layerIndexByLayerViewId[d][c.id];null!=e?(e=a.layerInfo[d][e],g.url=b,e.rawData=g,a.pendingUpdates|=V.DECODE_LERC,e.pendingUpdates|=
V.DECODE_LERC,f._pendingUpdates=!0):console.warn("TerrainSurface: received data from unknown layer %d %s",d,a.lij.toString())},function(b){f.tilemapStats.tileRequestErrors++;f._dispatchDataEvent(a,"dataMissing",d,c,b)})):(b=this._streamDataSupplier.request(b,"image"),b.then(function(b,g){f._dispatchDataEvent(a,"dataArrived",d,c,g)},function(b){f.tilemapStats.tileRequestErrors++;f._dispatchDataEvent(a,"dataMissing",d,c,b)}));return b},requestTilemapData:function(a,b,d,c){var g,e=new f.Promise(function(){g.cancel()}),
m=a.lij[0]+v.TILEMAP_SIZE_EXP,l=a.lij[1]<<v.TILEMAP_SIZE_EXP,h=a.lij[2]<<v.TILEMAP_SIZE_EXP;this.tilemapStats.tilemapRequestsSent++;this.tilemapStats.tilemapRequestsPending++;var p=this,k=1<<Math.min(v.TILEMAP_SIZE_EXP,m);g=c.layer.tileMap.getTileMap(m,l,h,k,k);g.then(function(f){p.tilemapStats.tilemapRequestsPending--;var g=f.location;!0!==f.valid||!g||g.top!==l||g.left!==h||g.width!==k||g.height!==k?(console.warn("Unexpected tilemap response for %s/%d/%d/%d/%d/%d",c.id,m,l,h,k,k),p.tilemapStats.tilemapRequestErrors++):
(b=this._layerIndexByLayerViewId[d][c.id],null!=b&&(a.layerInfo[d][b].tilemapData=f));e.resolve()}.bind(this),function(){p.tilemapStats.tilemapRequestErrors++;e.resolve()});return e},getTilemapTile:function(a){var b=a.lij[0];return b>v.TILEMAP_SIZE_EXP?x.getTileNLevelsUp(a,v.TILEMAP_SIZE_EXP):this._topLevelTilemapOnlyTiles[b]},_dispatchDataEvent:function(a,b,d,c,f){c=this._layerIndexByLayerViewId[d][c.id];if(null!=c)a[b](c,d,f);else console.warn("TerrainSurface: received data from unknown layer")},
cancelRequest:function(a){var b=a.actualTileRequestPromise;void 0!==b?(null!==b&&this._streamDataSupplier.cancelRequest(b),a.cancel()):this._streamDataSupplier.cancelRequest(a)},_updateTileOverlayParams:function(){if(this._rootTiles){var a=this._iteratorPool.acquire();for(a.reset(this._rootTiles);!a.done;){var b=a.next();b.renderData&&this.overlayManager&&this.overlayManager.setOverlayParamsOfTile(b,b.renderData,this._curOverlayOpacity)}this._iteratorPool.release(a);this._renderer.setNeedsRender()}},
_updateOverlayOpacity:function(a){if(this.overlayManager&&(a=this.overlayManager.updateOpacity(a),!isNaN(a))){if(a!==this._curOverlayOpacity&&this._rootTiles){var b=this._iteratorPool.acquire();for(b.reset(this._rootTiles);!b.done;){var d=b.next();d.renderData&&d.renderData.overlayTexId&&(d.renderData.overlayOpacity=a)}this._iteratorPool.release(b)}this._curOverlayOpacity=a;this._renderer.setNeedsRender()}},getStats:function(){var a=0,b=0,d=0,c=this._iteratorPool.acquire();for(c.reset(this._rootTiles);!c.done;){var f=
c.next();a++;f.renderData&&(b++,f.visible&&d++)}this._iteratorPool.release(c);return{numNodes:a,numLeaves:b,numVisible:d}},getTile:function(a){var b=a.split("/").map(JSON.parse);if(0===b[0])return this._rootTiles.forEach(function(a){if(a.lij[1]===b[1]&&a.lij[2]===b[2])return a}),null;var d=b[1]>>b[0],c=b[2]>>b[0],f;this._rootTiles.some(function(a){return a.lij[1]===d&&a.lij[2]===c?(f=a,!0):!1});if(f){for(var g=1<<b[0]-1;f.lij[0]<b[0];){var e=b[1]&g?2:0;0<(b[2]&g)&&e++;if(!f.children[e])return console.log("Tile "+
a+" doesn't exist, smallest ancestor is "+x.tile2str(f)),null;f=f.children[e];g>>=1}I(f.lij[0]===b[0]&&f.lij[1]===b[1]&&f.lij[2]===b[2],"not the right tile?");return f}return null},setBorders:function(a){this._renderer.setBorders(a)},setDisableRendering:function(a){this._renderer.setDisableRendering(a)},_extentGetter:function(){return this._clippingExtent||this._rootExtent},_hasFixedExtent:function(){return!!this._clippingExtent},_wireframeSetter:function(a){this._renderer.setWireframe(a);return a},
_opacitySetter:function(a){this._renderer.setOpacity(a);return a},_skirtsSetter:function(a){this._renderer.setDrawSkirts(!!a);return a},_cullBackFacesSetter:function(a){this._renderer.setCullBackFaces(a);return a},_renderOrderSetter:function(a){this._renderer.setRenderOrder(a);return a},_frontMostTransparentSetter:function(a){this._renderer.setFrontMostTransparent(!!a);return a},_tileBackgroundSetter:function(a){a!==this.tileBackground&&this._renderer.updateTileBackground(a);return a}});S.checkUnsupported=
function(a,b){var d=p.checkUnsupported(a);return d?d:b?S._checkNumRootTiles(a,b):null};S._checkNumRootTiles=function(a,b){var d=a.lods,c=d[0].resolution*Math.pow(2,d[0].level),f=[c*a.rows,c*a.cols],g=[a.origin.x,a.origin.y];b=[b.xmin,b.ymin,b.xmax,b.ymax];p.computeRowColExtent(b,f,g,L);return 64<(L[2]-L[0])*(L[3]-L[1])?(d=d[0].scale*Math.pow(2,d[0].level),c=Math.max((b[3]-b[1])/a.rows,(b[2]-b[0])/a.cols)*d/c,f=Math.floor(Math.log(c)/Math.log(10)),c=Math.ceil(c/Math.pow(10,f))*Math.pow(10,f),c=Error("Scale of level 0 of the tiling scheme (1:"+
Math.floor(d).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+c.toLocaleString()+"."),c.name="terrainsurface:num-root-tiles",c):null};S.MAX_ROOT_TILES=64;return S})},"esri/views/3d/terrain/TerrainRenderer":function(){define("dojo/Deferred dojo/when ./TileUtils ./TerrainConst ./TileGeometryFactory ../support/PreallocArray ../support/ObjectPool ../webgl-engine/lib/GLVBO ../webgl-engine/lib/GLIBO ../webgl-engine/lib/ShaderVariations dojo/text!./TerrainMaterial.xml ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/lib/GLSLProgram ../webgl-engine/lib/Util ../webgl-engine/lib/GLUtil ../lib/glMatrix ../webgl-engine/lib/RenderPass ../webgl-engine/lib/RenderSlot ../webgl-engine/lib/tracer".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v){var u=d.assert,z=p.vec2d,w=p.vec3d,C=p.vec4d,A=p.mat4d.identity(),y=[2,2],B=x.OPAQUE_TERRAIN,D=x.TRANSPARENT_TERRAIN,F=[0,0],H=w.create(),N,G=r.Layouts.PosTex,O=z.create(),M=function(){this.overlayTexOffset=z.create();this.texOffset=z.create();this.geometryInfo={geometry:null,numSurfaceIndices:0,numSkirtIndices:0,numWithoutSkirtIndices:0,numVertsPerRow:0};this.init()};M.prototype.init=function(){this.geometryInfo.geometry=null;this.geometryInfo.numSurfaceIndices=
0;this.geometryInfo.numSkirtIndices=0;this.geometryInfo.numWithoutSkirtIndices=0;this.geometryInfo.numVertsPerRow=0;this.textureReference=this.texture=this.ibo=this.vbo=this.geometryState=null;z.set2(0,0,this.texOffset);this.texScale=1;this.overlayTexId=null;this.overlayTexScale=[1,1];this.overlayOpacity=1;this.localOrigin=null};M.prototype.updateGeometryState=function(a){return this.geometryState=a.geometryState(this.geometryState)};p=function(p,x){function V(a,b){var d=a.screenDepth,c=b.screenDepth;
return d<c?-aa:d>c?aa:0}function L(a,b){return 0===a.tiles.length?-aa:0===b.tiles.length?aa:V(a.tiles.data[0],b.tiles.data[0])}function Y(a,b){void 0===b&&(b=da.subdivisionReduceLevels);return 0===b?a:0>b?Math.floor((a-1)*(1<<-b))+1:Math.floor((a-1)/(1<<b))+1}x=x||256;var E,ba,W=!1,R=null,T=null,J=null,S={},K=new c(100,M),Q=new e(10,function(){return{root:null,tiles:new e(300)}}),U=new n.IteratorPreorder,X,P,$,ea,ca=!0,ha=1,fa=!0,da={mode:"none",width:1.5,falloff:1.5,wireOpacity:1,surfaceOpacity:0,
color:[1,1,1,0],subdivision:"geometry",subdivisionReduceLevels:0},ga=!1,ka=!1,ja=!1,aa=1,ia=!0,pa=null,na=null,oa=null,qa=null,ra=null,za=null;this.updateTileBackground=function(a){ra&&ra.reject();za=a;var b=new s;ra=b;if(a){var d=new Image;d.src=a instanceof Image?a.src:a;d.onload=function(){b.isFulfilled()||b.resolve(d)}}else b.resolve(null);this.renderTileBackground();return b.promise};var ua=0,sa=0,wa=0,xa=0;this.numTileTexturesComposited=0;this.castShadows=!1;this.loaded=function(){};var Aa=
!1;this.needsRender=!0;this.didRender=!1;var la=new e(10),ta=0,va=new e(30),Ba=new c(10,function(){this.extent=C.create();this.maxLevel=this.minLevel=0;this.callback=null});this.renderTileBackground=function(){if(E&&ra)return ra.then(function(a){oa=this._buildTexture();a&&m.texImage2D(a,oa,E,null,null,!1,!1,!1);R&&n.traverseTilesPreorder(R,function(a){this.updateTileTexture(a)}.bind(this))}.bind(this))};this.initializeRenderContext=function(d){E=d.gl;P=E.getExtension("EXT_texture_filter_anisotropic")||
E.getExtension("MOZ_EXT_texture_filter_anisotropic")||E.getExtension("WEBKIT_EXT_texture_filter_anisotropic");u(!N||N===P.TEXTURE_MAX_ANISOTROPY_EXT,"contexts have different definitions afExt.TEXTURE_MAX_ANISOTROPY_EXT");null!=P&&(N=P.TEXTURE_MAX_ANISOTROPY_EXT,$=E.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT),ea=Math.min(8,$));var c=E.getExtension("OES_element_index_uint");h.setSupportsUintIndices(!!c);q(this.renderTileBackground(),function(){this.needsRender=W=!0}.bind(this));c=new Float32Array(20);
c[0]=-1;c[1]=-1;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=-1;c[7]=0;c[8]=1;c[9]=0;c[10]=-1;c[11]=1;c[12]=0;c[13]=0;c[14]=1;c[15]=1;c[16]=1;c[17]=0;c[18]=1;c[19]=1;na=new b(c,G,E);pa=E.createFramebuffer();ba=d.textureRep;var c=d.shaderSnippets,g=d.shaderRep;d=d.programRep;c.vsTerrain||c._parse(a);E.getExtension("OES_standard_derivatives");var e=new f("terrain",["vsTerrain","fsTerrain"],null,d,g,c,E);e.addDefine("Spherical","SPHERICAL");e.addDefine("Overlay","OVERLAY");e.addDefine("Atmosphere","ATMOSPHERE");
e.addDefine("Wireframe","WIREFRAME");e.addDefine("TileBorders","TILE_BORDERS");e.addBinaryShaderSnippetSuffix("Wireframe","Wireframe",[!1,!0]);g=new f("terrainNormal",["vsTerrainNormal","fsNormal"],null,d,g,c,E);g.addDefine("Spherical","SPHERICAL");g.addDefine("AlphaZero","ALPHA_ZERO");J={depth:d.get("depth"),depthShadowMap:d.get("depthShadowMap"),depthOnly:l.fromSnippets("vsTerrainDepthOnly","fsTerrainDepthOnly",c,E),blendLayers:l.fromSnippets("vertexShaderBlendLayers","fragmentShaderBlendLayers",
c,E)};T={color:e,normal:g};this._updatePrograms();qa=m.createEmptyTexture(E)};this._updatePrograms=function(){var a="spherical"===p,b="shader"===da.mode;J.color=T.color.getProgram([a,!0,a,b,ga,b||ga]);J.normal=T.normal.getProgram([a,!0])};this.install=function(a){a.addExternalRenderer([B,D],this)};this.uninstall=function(a){a.removeExternalRenderer(this)};this.setRootTiles=function(a){R=a};this.setTileSize=function(a){x=a};this.loadTile=function(a){u(null===a.renderData);a.renderData=K.acquire();
a.renderData.init();var b=this.getLocalOriginOfTile(a),d=a.createGeometry(a.renderData.updateGeometryState(a),b,"debug"===da.mode,a.renderData.geometryInfo);a.renderData.localOrigin=b;this._setTileGeometry(a,d);this.updateTileTexture(a);this.needsRender=!0};this.queryVisibleLevelRange=function(a,b,d,c){var f=Ba.acquire();C.set(a,f.extent);f.minLevel=b?b:-Number.MAX_VALUE;f.maxLevel=null!=d?d:Number.MAX_VALUE;f.callback=c;va.push(f);this.needsRender=!0};this._buildTexture=function(a){var b=E.createTexture();
E.bindTexture(E.TEXTURE_2D,b);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR);ea&&E.texParameterf(E.TEXTURE_2D,N,ea);if(a)try{E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,a)}catch(d){E.texImage2D(E.TEXTURE_2D,0,E.RGBA,x,x,0,E.RGBA,E.UNSIGNED_BYTE,null),console.warn("TerrainRenderer: failed to execute 'texImage2D', cross-origin image may not be loaded.")}else E.texImage2D(E.TEXTURE_2D,
0,E.RGBA,x,x,0,E.RGBA,E.UNSIGNED_BYTE,null);E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR_MIPMAP_LINEAR);E.generateMipmap(E.TEXTURE_2D);return b};this._composeTexture=function(a,b,d){E.activeTexture(E.TEXTURE0);E.bindTexture(E.TEXTURE_2D,a);J.blendLayers.uniform1f("scale",b);J.blendLayers.uniform2fv("offset",d);E.drawArrays(E.TRIANGLE_STRIP,0,na.getNum())};this._composeMapLayers=function(a,b,d,c,f){var g=k.LayerClass.MAP;a.renderData.texture||(a.renderData.texture=this._buildTexture());
E.bindFramebuffer(E.FRAMEBUFFER,pa);E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_2D,a.renderData.texture,0);E.viewport(0,0,x,x);E.clearColor(0,0,0,0);E.clear(E.COLOR_BUFFER_BIT);E.enable(E.BLEND);E.blendFuncSeparate(E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ONE);J.blendLayers.use();J.blendLayers.uniform1i("tex",0);G.enableVertexAttribArrays(E,J.blendLayers,!1);na.bind();na.setPointers(J.blendLayers);for(var e=0;e<=d;e++){var m=b[e],l=null,h,p;m.data?(l=m,h=F,
p=1):m.upsampleFromTile&&(m=m.upsampleFromTile,l=m.tile.layerInfo[g][e],h=m.offset,p=m.scale);l&&(l.data instanceof Image&&(l.data=this._buildTexture(l.data)),J.blendLayers.uniform1f("opacity",f[e]),this._composeTexture(l.data,p,h))}c&&this._composeTexture(oa,1,F);E.bindTexture(E.TEXTURE_2D,a.renderData.texture);E.generateMipmap(E.TEXTURE_2D);G.disableVertexAttribArrays(E,J.blendLayers,!1);E.bindFramebuffer(E.FRAMEBUFFER,null);a=E.web3DDefaultState;E.blendFunc(a.blendFuncSrc,a.blendFuncDst);E.disable(E.BLEND);
this.numTileTexturesComposited++};var Ca=Array(20);this.updateTileTexture=function(a){for(var b=a.layerInfo[k.LayerClass.MAP],d=0;d<b.length;d++)b[d].pendingUpdates&=~k.TileUpdateTypes.UPDATE_TEXTURE;if(a.renderData){var c,f=k.LayerClass.MAP,d=a.renderData,g,e=0;for(g=0;g<b.length;g++){c=b[g];var m=a.parentSurface.layerViewByIndex(g,f),l=m.layer.get("opacity");Ca[g]=l;if(c.data||c.upsampleFromTile)if(e++,!m.isTransparent()&&1<=l)break}c=!1;g===b.length&&(c=!0,g--);0===e?(d.textureReference=oa,z.set2(0,
0,d.texOffset),d.texScale=1):1===e&&!c?(c=b[g],c.data?(b=c,z.set2(0,0,d.texOffset),d.texScale=1):(a=c.upsampleFromTile,b=a.tile.layerInfo[f][g],z.set(a.offset,d.texOffset),d.texScale=a.scale),b&&(b.data instanceof Image&&(b.data=this._buildTexture(b.data)),d.textureReference=b.data)):(this._composeMapLayers(a,b,g,c,Ca),d.textureReference=null,z.set2(0,0,d.texOffset),d.texScale=1);this.needsRender=!0}};this.releaseTileTexture=function(a){E.deleteTexture(a)};this.releaseTileTextures=function(a){a=a.layerInfo[k.LayerClass.MAP];
for(var b=0;b<a.length;b++){var d=a[b];d&&d.data instanceof window.WebGLTexture&&E.deleteTexture(d.data)}};this.updateTileGeometryNeedsUpdate=function(a){return a.renderData.updateGeometryState(a).needsUpdate};this._updateTileGeometry=function(a){for(var b=a.renderData.geometryState,d=a.layerInfo[k.LayerClass.ELEVATION],c=0;c<d.length;c++)d[c].pendingUpdates&=~k.TileUpdateTypes.UPDATE_GEOMETRY;return b.needsUpdate?(a.renderData.vbo&&this._releaseTileGeometry(a),b=a.createGeometry(b,a.renderData.localOrigin,
"debug"===da.mode,a.renderData.geometryInfo),this._setTileGeometry(a,b),!0):!1};this.updateTileGeometry=function(a){a.renderData.updateGeometryState(a);return this._updateTileGeometry(a)};this.unloadTile=function(a){this._releaseTileGeometry(a);a.renderData.texture&&E.deleteTexture(a.renderData.texture);K.release(a.renderData);a.renderData=null};this.getLocalOriginOfTile=function(a){if(10<=a.lij[0]){for(;7<a.lij[0];)a=a.parent;return a.centerAtSeaLevel}if("spherical"===p)return H;for(;a.parent;)a=
a.parent;return a.centerAtSeaLevel};this.setVisibility=function(a){ca=a;this.needsRender=!0};this.getStats=function(){return{numTilesRendered:sa,numTilesCulled:wa,numTrianglesRendered:ua,numOriginsRendered:xa}};this.setMaxAnisotropy=function(a){P&&(a=d.clamp(a,1,$),a!==ea&&(ea=a,R&&n.traverseTilesPreorder(R,function(a){a.renderData&&a.renderData.texture&&(E.bindTexture(E.TEXTURE_2D,a.renderData.texture),E.texParameterf(E.TEXTURE_2D,P.TEXTURE_MAX_ANISOTROPY_EXT,ea))})));this.needsRender=!0};this.getMaxAnisotropy=
function(){return ea};this.setDisableRendering=function(a){ka=!!a;this.needsRender=!0};this.getOpacity=function(){return ha};this.getWireframeEnabled=function(){return"shader"===da.mode};this.setWireframe=function(a){if(!a||!0===a)a={mode:a?"shader":"none"};if(void 0!==a.mode&&da.mode!==a.mode){var b="debug"===da.mode,d="debug"===a.mode;da.mode=a.mode;this._updatePrograms();b!==d&&R&&n.traverseTilesPreorder(R,function(a){if(a.renderData){a.renderData.vbo&&this._releaseTileGeometry(a);var b=a.createGeometry(a.renderData.updateGeometryState(a),
a.renderData.localOrigin,d,a.renderData.geometryInfo);this._setTileGeometry(a,b)}}.bind(this));this.needsRender=!0}for(var c in a)da.hasOwnProperty(c)&&(da[c]=a[c]),this.needsRender=!0};this.setOpacity=function(a){ha=a;this.needsRender=!0};this.setDrawSkirts=function(a){fa=a;this.needsRender=!0};this.setCullBackFaces=function(a){ja=a;this.needsRender=!0};this.setRenderOrder=function(a){aa=a;this.needsRender=!0};this.setBorders=function(a){ga!==a&&(ga=a,"none"===da.mode&&(da.transitionTime=0),this._updatePrograms(),
this.needsRender=!0)};this.setFrontMostTransparent=function(a){ia!==a&&(ia=a,this.needsRender=!0)};this.setNeedsRender=function(){this.needsRender=!0;this.didRender=!1};this.resetNeedsRender=function(){this.didRender&&(this.needsRender=0!==va.length,this.didRender=!1)};var ya=w.create();this.isTransparent=function(){return 1>ha||"shader"===da.mode&&(1>da.wireOpacity||1>da.surfaceOpacity)||!za};this.render=function(a){if(W&&!ka&&ca&&R){var b=this.isTransparent();if(a.slot===(b?D:B)){v.trace("# BEGIN RENDER TERRAIN");
Q.clear();X=null;this._renderCollectOrigins();if(0!==aa){for(var d=0;d<Q.length;d++)this._sortFrontToBack(Q.data[d].tiles,V);this._sortFrontToBack(Q,L)}var c,f=!1,g=!1;c=a.pass;var e=a.camera;if(c===t.MATERIAL){if((g=b)&&ia)f=J.depthOnly,f.use(),G.enableVertexAttribArrays(E,f,!1),E.colorMask(!1,!1,!1,!1),this._renderTilesDepthOnly(e,E,f),E.colorMask(!0,!0,!0,!0),E.depthFunc(E.EQUAL),E.depthMask(!1);c=J.color;f=!0;c.use();c.uniform1f("opacity",ha);g&&E.enable(E.BLEND);!E.web3DDefaultState.cullEnabled&&
ja?E.enable(E.CULL_FACE):E.web3DDefaultState.cullEnabled&&!ja&&E.disable(E.CULL_FACE);if("shader"===da.mode||ga)c.uniform1f("wireframe.width",da.width),c.uniform1f("wireframe.falloff",Math.min(da.width,da.falloff)),c.uniform1f("wireframe.wireOpacity",da.wireOpacity*ha),c.uniform1f("wireframe.surfaceOpacity",da.surfaceOpacity*ha),c.uniform4fv("wireframe.color",da.color),c.uniform1f("wireframe.near",e.near),c.uniform1f("wireframe.far",e.far),"geometry"!==da.subdivision&&"constant"!==da.subdivision&&
c.uniform1f("wireframe.subdivision",Y(da.subdivision))}else if(c===t.MATERIAL_DEPTH_SHADOWMAP&&this.castShadows||c===t.MATERIAL_DEPTH)c=c===t.MATERIAL_DEPTH_SHADOWMAP?J.depthShadowMap:J.depth,c.use(),c.uniformMatrix4fv("model",A),O[0]=e.near,O[1]=e.far,c.uniform2fv("nearFar",O);else if(c===t.MATERIAL_NORMAL)c=J.normal,c.use();else return;a.shadowMap&&a.shadowMap.bind(c);a.ssaoHelper&&a.ssaoHelper.setUniforms(c);G.enableVertexAttribArrays(E,c,!1);f&&(c.uniform1i("tex",4),c.uniform1i("overlayTex",5));
c.uniformMatrix4fv("viewNormal",e.viewInverseTransposeMatrix);c.uniformMatrix4fv("proj",e.projectionMatrix);c.uniform3fv("lightDirection",a.lightingData.direction);e=e.viewMatrix;w.set3(e[12],e[13],e[14],ya);w.normalize(ya);c.uniform3fv("viewDirection",ya);for(xa=ua=wa=sa=0;la.length<la.data.length&&0<va.length;)d=va.pop(),la.push(d);ta=la.length;for(d=0;d<Q.length;d++){var m=Q.data[d];c.uniform3fv("origin",m.origin);r.bindView(m.origin,e,c);a.shadowMap&&a.shadowMap.bindView(c,m.origin);xa++;this._renderTiles(m.tiles,
c,f)}G.disableVertexAttribArrays(E,c,!1);E.activeTexture(E.TEXTURE0);E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,null);g&&E.disable(E.BLEND);b&&ia&&(E.depthFunc(E.LESS),E.depthMask(!0));!E.web3DDefaultState.cullEnabled&&ja?E.disable(E.CULL_FACE):E.web3DDefaultState.cullEnabled&&!ja&&E.enable(E.CULL_FACE);for(a=0;a<la.length;a++)b=la.data[a],Ba.release(b),b.callback(a>=ta),b.callback=null;la.clear();0<sa&&!Aa&&(Aa=!0,this.loaded&&this.loaded());v.trace("# END RENDER TERRAIN");return!0}}};this._renderCollectOrigins=
function(){for(var a=0;a<R.length;a++){var b=R[a],d=Q.next();d.root=b;d.origin="spherical"===p?H:b.centerAtSeaLevel;d.tiles.clear();this._renderCollectOriginsForRoot(d)}};this._renderCollectOriginsForRoot=function(a){for(U.reset(a.root);!U.done;){var b=U.next(),d=b.renderData;if(d&&!b.visible)wa++,U.skip();else{var c=Q.peek();if(7===b.lij[0]){if(c===a||0!==c.tiles.length)c=Q.next(),c.tiles.clear();c.root=b;c.origin=b.centerAtSeaLevel}if(d){d=b.lij[0];10<=d?Q.peek().tiles.push(b):a.tiles.push(b);if(null===
X||X.lij[0]<d)X=b;U.skip()}}}};this._sortFrontToBack=function(a,b){a.sort(b)};this._renderTilesDepthOnly=function(a,b,d){var c=a.viewMatrix;d.uniformMatrix4fv("proj",a.projectionMatrix);for(a=0;a<Q.length;a++){var f=Q.data[a];d.uniform3fv("origin",f.origin);r.bindView(f.origin,c,d);for(var g=0;g<f.tiles.length;g++){var e=f.tiles.data[g].renderData;e.vbo.bind();e.vbo.setPointers(d);var m=e.ibo;m.bind();var l=m.getNum();fa||(l=e.geometryInfo.numWithoutSkirtIndices);b.drawElements(b.TRIANGLES,l,m.getType(),
0)}}};this._renderTiles=function(a,b,d){if(0!==a.length){var c=E.TRIANGLES;"debug"===da.mode&&(c=E.LINES);var f="geometry"===da.subdivision,g="constant"===da.subdivision,e=X,m;e?(m=e.lij[0],e=Y(e.renderData.geometryInfo.numVertsPerRow)):e=m=16;for(var l=0;l<a.length;l++){var h=a.data[l],p=h.renderData;v.trace("# RENDER TILE "+h.lij[0]+"/"+h.lij[1]+"/"+h.lij[2]+", screenDepth:"+h.screenDepth);p.vbo.bind();p.vbo.setPointers(b);var k=p.ibo;k.bind();if(d){b.uniform2fv("texOffset",p.texOffset);b.uniform1f("texScale",
p.texScale);E.activeTexture(E.TEXTURE0+4);E.bindTexture(E.TEXTURE_2D,p.textureReference||p.texture);if(p.overlayTexId){var r=b,t=p,n=t.overlayTexId,B=S[n];B||(B=ba.aquire(n),u(B),S[n]=B);r.uniform2fv("overlayTexOffset",t.overlayTexOffset);r.uniform2fv("overlayTexScale",t.overlayTexScale);r.uniform1f("overlayOpacity",t.overlayOpacity);E.activeTexture(E.TEXTURE0+4+1);E.bindTexture(E.TEXTURE_2D,B)}else b.uniform2fv("overlayTexOffset",y),r=qa,E.activeTexture(E.TEXTURE0+4+1),E.bindTexture(E.TEXTURE_2D,
r);if(("shader"===da.mode||ga)&&(f||g))f?b.uniform1f("wireframe.subdivision",Y(p.geometryInfo.numVertsPerRow)):(r=Y(e,h.lij[0]-m),b.uniform1f("wireframe.subdivision",r))}r=k.getNum();fa||(r=p.geometryInfo.numWithoutSkirtIndices);E.drawElements(c,r,k.getType(),0);h.renderOrder=sa;sa++;ua+=r/3;p=h.extent;h=h.lij[0];for(k=0;k<ta;)r=la.data[k],t=r.extent,h>=r.minLevel&&h<=r.maxLevel&&t[0]<=p[2]&&t[2]>=p[0]&&t[1]<=p[3]&&t[3]>=p[1]?(la.swap(k,ta-1),ta--):k++}}};var Ea=w.create(),ma=w.create(),Da=w.create();
this.intersect=function(a,b,d,c){if(R&&!("select"===a.mode&&this.isTransparent())){w.subtract(d,b,Ea);var f=a.getMinResult(),g=a.getMaxResult();for(U.reset(R);!U.done;){var e=U.next();if(null!==e.renderData&&e.visible){var m=e.renderData.geometryInfo.geometry,l=e.renderData.localOrigin;w.subtract(b,l,ma);w.subtract(d,l,Da);r.intersectTriangleGeometry(m,0,void 0,c,b,d,ma,Da,void 0,a.tolerance,function(a,b){if(0<=a){var d;if(void 0===f.dist||a<f.dist)d=n.lij2str(e.lij[0],e.lij[1],e.lij[2]),f.set(void 0,
d,a,b,void 0),f.setIntersector("terrain");if(void 0===g.dist||a>g.dist)d=n.lij2str(e.lij[0],e.lij[1],e.lij[2]),g.set(void 0,d,a,b,void 0),g.setIntersector("terrain")}})}}}};this._setTileGeometry=function(a,d){var c=a.renderData,f=d.geometry.getData(),e=f.getVertexAttr().terrain.data;c.vbo=new b(e,G,E);f=f.getFaces()[0].indices.terrain;c.ibo=new g(f,E);c.geometryInfo.geometry&&h.releaseGeometry(c.geometryInfo.geometry);c.geometryInfo=d;this.needsRender=!0};this._releaseTileGeometry=function(a){a=a.renderData;
a.vbo.dispose();a.ibo.dispose();a.vbo=null;a.ibo=null;a.geometryInfo.geometry&&h.releaseGeometry(a.geometryInfo.geometry);a.geometryInfo.geometry=null;this.needsRender=!0}};p.TileRenderData=M;return p})},"esri/views/3d/terrain/TileUtils":function(){define(["./UpsampleInfo","../support/PreallocArray"],function(s,q){function n(c){this.q=new q(c||100);this._last=null;this.done=!0}function k(c){this.q=new q(c||100);this.done=!0}var h=12756274*Math.PI;n.prototype.reset=function(c){this.q.clear();c&&this.q.pushEither(c);
this._last=null;this.done=0===this.q.length};n.prototype.skip=function(){this._last=null;0===this.q.length&&(this.done=!0)};n.prototype.next=function(){if(this.done)return null;if(null!==this._last){var c=this._last.children;if(c[0])for(var b=4;0<=b;b--){var g=c[b];g&&this.q.push(g)}this._last=null}this._last=this.q.pop();0===this.q.length&&!this._last.children[0]&&(this.done=!0);return this._last};k.prototype.reset=function(c){this.q.clear();this.q.pushEither(c);for(c=0;c<this.q.length;)for(var b=
this.q.data[c++],g=0;4>g;g++){var f=b.children[g];f&&this.q.push(f)}this.done=0===this.q.length};k.prototype.next=function(){var c=this.q.pop();this.done=0===this.q.length;return c};var e={li2lat:function(c,b){return 2*Math.atan(Math.exp(-Math.PI+2*Math.PI*b/(1<<c)))-0.5*Math.PI},lj2lon:function(c,b){return-Math.PI+2*Math.PI*b/(1<<c)},lij2webMerc:function(c,b,g){return[-0.5*h+h*g/(1<<c),-0.5*h+h*b/(1<<c)]},lij2str:function(c,b,g){return c+"/"+b+"/"+g},tile2str:function(c){return c.lij[0]+"/"+c.lij[1]+
"/"+c.lij[2]},latLon2WebMercator:function(c,b,g){1.570796<c?c=1.570796:-1.570796>c&&(c=-1.570796);g[0]=6378137*b;g[1]=3189068.5*Math.log((1+Math.sin(c))/(1-Math.sin(c)))},traverseTilesPreorder:function(c,b,g,f){if(Array.isArray(c))for(var a=0;a<c.length;a++)e._traverseTilesPreorder(c[a],b,g,f);else e._traverseTilesPreorder(c,b,g,f)},_traverseTilesPreorder:function(c,b,g,f){f=b.call(g,c,f);for(var a=0;4>a;a++){var h=c.children[a];h&&e.traverseTilesPreorder(h,b,g,f)}},traverseTilesPostorder:function(c,
b,g){if(Array.isArray(c))for(var f=0;f<c.length;f++)e._traverseTilesPostorder(c[f],b,g);else e._traverseTilesPostorder(c,b,g)},_traverseTilesPostorder:function(c,b,g){for(var f=0;4>f;f++){var a=c.children[f];a&&e.traverseTilesPostorder(a,b,g)}b.call(g,c)},IteratorPreorder:n,IteratorPostorder:k,fallsWithinLayer:function(c,b,g){var f=b.layer;if(!b.hasGlobalExtent){b=f.fullExtent;var a=c.extent;if(g){if(a[0]<b.xmin||a[1]<b.ymin||a[2]>b.xmax||a[3]>b.ymax)return!1}else if(b.xmin>a[2]||b.ymin>a[3]||b.xmax<
a[0]||b.ymax<a[1])return!1}c=c.parentSurface.tilingScheme.levels[c.lij[0]].scale;return 0<f.minScale&&c>1.00000001*f.minScale?!1:c>=0.99999999*f.maxScale},isPosWithinTile:function(c,b){var g=c.extent;return b[0]>=g[0]&&b[1]>=g[1]&&b[0]<=g[2]&&b[1]<=g[3]},getTileNLevelsUp:function(c,b){for(;0<b;)c=c.parent,b--;return c},nextTileInAncestry:function(c,b){var g=c.lij[0]-b.lij[0]-1,f=c.lij[2]>>g,a=0;c.lij[1]>>g&1&&(a+=2);f&1&&(a+=1);return b.children[a]},computeUpsampleInfoForAncestor:function(c,b){for(var g=
1,f=0,a=0;c!==b;)if(g*=0.5,f*=0.5,a*=0.5,c.lij[2]&1&&(f+=0.5),0===(c.lij[1]&1)&&(a+=0.5),c=c.parent,null==c)throw Error("tile was not a descendant of ancestorTile");var e=s.Pool.acquire();e.init(b,f,a,g);return e}};return e})},"esri/views/3d/terrain/UpsampleInfo":function(){define(["../support/ObjectPool","../lib/glMatrix"],function(s,q){function n(h,e,c,b){this.offset=k.create();this.scale=0;this.tile=null;void 0!==h&&this.init(h,e,c,b)}var k=q.vec2d;n.prototype.init=function(h,e,c,b){this.tile=
h;this.offset[0]=e;this.offset[1]=c;this.scale=b};n.Pool=new s(400,n);return n})},"esri/views/3d/support/ObjectPool":function(){define(["../../../core/declare","./PreallocArray"],function(s,q){var n=s([],{constructor:function(k,h){this.freelist=new q(k);this.cls=h;this.initialSize=k},_allocate:function(){return new this.cls},acquire:function(){if(0===this.freelist.length)for(var k=Math.max(1,this.initialSize/2),h=0;h<k;h++)this.freelist.push(new this.cls);return this.freelist.pop()},release:function(k){this.freelist.push(k)}});
n.on=function(k,h){k._pool=null;Object.defineProperty(k,"Pool",{get:function(){this._pool||(this._pool=new n(h,k));return this._pool}})};return n})},"esri/views/3d/terrain/TerrainConst":function(){define(["./TilingScheme","../support/aaBoundingRect"],function(s,q){var n={LayerClass:{MAP:0,ELEVATION:1,LAYER_CLASS_COUNT:2},TileUpdateTypes:{NONE:0,SPLIT:1,VSPLITMERGE:2,MERGE:4,DECODE_LERC:8,UPDATE_GEOMETRY:16,UPDATE_TEXTURE:32},TILE_LOADING_DEBUGLOG:!1,MAX_TILE_TESSELATION:512,ELEVATION_NODATA_VALUE:3.40282347E38/
10,ELEVATION_DESIRED_RESOLUTION_LEVEL:4,TILEMAP_SIZE_EXP:5,Spherical:{ELEVATION_STARTS_AT_LEVEL:8},Planar:{ELEVATION_STARTS_AT_LEVEL:0}};n.TILEMAP_SIZE=1<<n.TILEMAP_SIZE_EXP;n.WEBMERCATOR_WORLD_EXTENT=q.create([0,0,0,0]);s.WebMercatorAuxiliarySphere.getExtent(0,0,0,n.WEBMERCATOR_WORLD_EXTENT);n.GEOGRAPHIC_WORLD_EXTENT=q.create([-180,-90,180,90]);return n})},"esri/views/3d/terrain/TilingScheme":function(){define(["../../../geometry/SpatialReference","../../../geometry/support/scaleUtils","../support/projectionUtils",
"../support/mathUtils"],function(s,q,n,k){function h(b,a){var c=Error(a);c.name=b;return c}var e=n.webMercator.x2lon,c=n.webMercator.y2lat,b=[0,0,0,0],g=function(b){var a=g._checkUnsupported(b);if(a)throw a;this.spatialReference=b.spatialReference;this._isWebMercator=this.spatialReference.isWebMercator;this._isWGS84=this.spatialReference.isWGS84;this.origin=[b.origin.x,b.origin.y];this.pixelSize=[b.cols,b.rows];var c=b.lods.reduce(function(a,b,d){b.level<a.min&&(a.min=b.level,a.minIndex=d);a.max=
Math.max(a.max,b.level);return a},{min:Infinity,minIndex:0,max:-Infinity}),e=b.lods[c.minIndex],d=Math.pow(2,e.level),a=e.resolution*d,e=e.scale*d;this.levels=Array(c.max+1);for(c=0;c<this.levels.length;c++)this.levels[c]={resolution:a,scale:e,tileSize:[a*b.cols,a*b.rows]},a/=2,e/=2};g.prototype={getExtent:function(b,a,g,l,d){l=l||Array(4);var m=this.levels[b];b=m.tileSize[0];m=m.tileSize[1];l[0]=this.origin[0]+g*b;l[2]=l[0]+b;l[3]=this.origin[1]-a*m;l[1]=l[3]-m;d&&(this._isWebMercator?(d[0]=e(l[0]),
d[1]=c(l[1]),d[2]=e(l[2]),d[3]=c(l[3])):this._isWGS84&&(d[0]=k.deg2rad(l[0]),d[1]=k.deg2rad(l[1]),d[2]=k.deg2rad(l[2]),d[3]=k.deg2rad(l[3])))},ensureMaxLod:function(b){for(;this.levels.length<=b;){var a=this.levels[this.levels.length-1],c=a.resolution/2;this.levels.push({resolution:c,scale:a.scale/2,tileSize:[c*this.pixelSize[0],c*this.pixelSize[1]]})}},capMaxLod:function(b){this.levels.length>b+1&&(this.levels.length=b+1)},getMaxLod:function(){return this.levels.length-1},scaleAtLevel:function(b){return this.levels[0].scale/
Math.pow(2,b)},levelAtScale:function(b){var a=this.levels[0].scale;return b>=a?0:Math.log(a/b)*Math.LOG2E},compatibleWith:function(b){if(!(b instanceof g)){if(g._checkUnsupported(b))return!1;b=new g(b)}if(!b.spatialReference.equals(this.spatialReference)||b.pixelSize[0]!==this.pixelSize[0]||b.pixelSize[1]!==this.pixelSize[1])return!1;var a=Math.min(this.levels.length,b.levels.length)-1,c=this.levels[a].resolution,e=k.floatEqualAbsolute,d=0.5*c;if(!e(b.origin[0],this.origin[0],d)||!e(b.origin[1],this.origin[1],
d))return!1;var d=Math.max(this.pixelSize[0],this.pixelSize[1]),m=Math.pow(2,a);return e(c,b.levels[a].resolution,12*(0.5*c/m/d))},rootTilesInExtent:function(c,a,e){var l=this.levels[0].tileSize;g.computeRowColExtent(c,l,this.origin,b);c=b[1];var d=b[3],m=b[0],h=b[2],k=h-m,n=d-c;k*n>e&&(e=Math.floor(Math.sqrt(e)),n>e&&(c=c+Math.floor(0.5*n)-Math.floor(0.5*e),d=c+e),k>e&&(m=m+Math.floor(0.5*k)-Math.floor(0.5*e),h=m+e));e=Array((h-m)*(d-c));k=0;for(n=c;n<d;n++)for(var q=m;q<h;q++)e[k++]=[0,n,q];a&&
(a[0]=this.origin[0]+m*l[0],a[1]=this.origin[1]-d*l[1],a[2]=this.origin[0]+h*l[0],a[3]=this.origin[1]-c*l[1]);return e}};g.computeRowColExtent=function(b,a,c,g){var d=0.0010*(b[2]-b[0]+(b[3]-b[1]));g[0]=Math.floor((b[0]+d-c[0])/a[0]);g[2]=Math.ceil((b[2]-d-c[0])/a[0]);g[1]=Math.floor((c[1]-b[3]+d)/a[1]);g[3]=Math.ceil((c[1]-b[1]-d)/a[1])};g.isPowerOfTwo=function(b){b=b.lods;var a=b[0].resolution*Math.pow(2,b[0].level);return!b.some(function(b){return!k.floatEqualRelative(b.resolution,a/Math.pow(2,
b.level))})};g.hasGapInLevels=function(b){b=b.lods.map(function(a){return a.level});b.sort(function(a,b){return a-b});for(var a=1;a<b.length;a++)if(b[a]!==b[0]+a)return!0;return!1};g.tileSizeSupported=function(b){var a=b.rows;return a===b.cols&&0===(a&a-1)&&128<=a&&512>=a};g._checkUnsupported=function(b){return!b?h("tilingscheme:tile-info-missing","Tiling scheme must have tiling information"):1>b.lods.length?h("tilingscheme:generic","Tiling scheme must have at least one level"):!g.isPowerOfTwo(b)?
h("tilingscheme:power-of-two","Tiling scheme must be power of two"):null};g.checkUnsupported=function(b){var a=g._checkUnsupported(b);return a?a:g.hasGapInLevels(b)?h("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):!g.tileSizeSupported(b)?h("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):null};g.fromExtent=function(b,a){var c=b[2]-b[0],e=b[3]-b[1],d=q.getUnitValueForSR(a),m=1.2*Math.max(c,e),c=new g({rows:256,cols:256,
origin:{x:b[0]-0.5*(m-c),y:b[3]+0.5*(m-e)},lods:[{level:0,resolution:m/256,scale:1/(0.0254*(256/96)/(m*d))}],spatialReference:a});c.ensureMaxLod(20);return c};g.WebMercatorAuxiliarySphereTileInfo={rows:256,cols:256,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:s.WebMercator,lods:[{level:0,resolution:156543.03392800014,scale:5.91657527591555E8}]};g.WebMercatorAuxiliarySphere=new g(g.WebMercatorAuxiliarySphereTileInfo);g.WebMercatorAuxiliarySphere.ensureMaxLod(19);g.makeWGS84WithTileSize=
function(b){var a=256/b;b=new g({rows:b,cols:b,origin:{x:-180,y:90},spatialReference:s.WGS84,lods:[{level:0,resolution:0.703125*a,scale:2.95497598570834E8*a}]});b.ensureMaxLod(16);return b};return g})},"esri/views/3d/terrain/TileGeometryFactory":function(){define("../webgl-engine/lib/Geometry ../webgl-engine/lib/GeometryData ../lib/glMatrix ../support/earthUtils ../support/mathUtils ./TerrainConst".split(" "),function(s,q,n,k,h,e){function c(a,b,d,c,f){a<c[0]&&(c[0]=a);a>f[0]&&(f[0]=a);b<c[1]&&(c[1]=
b);b>f[1]&&(f[1]=b);d<c[2]&&(c[2]=d);d>f[2]&&(f[2]=d)}function b(a,b,d){for(var c=0;c<d.length;c++){var f=d[c];if(f){var g=f.safeWidth,m=f.width,l=f.pixelData,p=h.clamp(f.dy*(f.y1-b),0,g),f=h.clamp(f.dx*(a-f.x0),0,g),g=Math.floor(p),k=Math.floor(f),r=g*m+k,n=r+m,t=l[r],m=l[n],r=l[r+1],l=l[n+1];if(t+m+r+l<0.5*e.ELEVATION_NODATA_VALUE)return p-=g,f-=k,a=t+(r-t)*f,a+(m+(l-m)*f-a)*p}}return null}function g(a){l||a*a+4*(a-1)>w&&(a=1<<Math.floor(h.log2(0.5*(-4+Math.sqrt(16+4*(4+w))))));return a}var f=k.earthRadius,
a=n.vec3d,r=h.lerp,l=!1,d=function(){var b=a.create(),d=a.create(),c=a.create(),f,g,e;this.init=function(m,l){g=m;e=l;a.subtract(c,d,b);f=0.5*a.length(b);a.lerp(d,c,0.5,b)};this.getCenter=function(){return b};this.getBSRadius=function(){return f};this.getBBMin=function(){return d};this.getBBMax=function(){return c};this.getPosition=function(){return g};this.getIndices=function(){return e};this.getPrimitiveIndices=function(){};this.getChildren=function(){}},m=function(a,b,d,c){a*=f;for(var g=0;g<=
b;g++)d[5*c]=0,d[5*c+1]=0,d[5*c+2]=a,c++},p=new function(){var a=Array(50),b=0,c={};this.get=function(g){var e=c[g];e||(e={ptr:0,data:Array(50)},c[g]=e);0<e.ptr?(f.vertexArrayHits++,g=e.data[--e.ptr],e.data[e.ptr]=null):(f.vertexArrayMisses++,g=new Float32Array(g));if(0<b)return f.geometryHits++,e=a[--b],a[b]=null,e.getData().getVertexAttr().terrain.data=g,e;f.geometryMisses++;e={};e.terrain={size:5,data:g};g=new d;return new s(new q([{type:"triangle",indices:{terrain:null},positionKey:"terrain"}],
e),"tile",[g])};this.put=function(d){var f=d.getData(),g=f.getVertexAttr(),e=g.terrain.data,m=c[e.length];50>m.ptr&&(m.data[m.ptr++]=e);g.terrain.data=null;f.getFaces()[0].indices.terrain=null;50>b&&(a[b++]=d)};var f={geometryHits:0,geometryMisses:0,vertexArrayHits:0,vertexArrayMisses:0};this.stats=f;this._pools={geometry:a,vertexArray:c}},t=[],x=Array(e.MAX_TILE_TESSELATION+1),v=Array(e.MAX_TILE_TESSELATION+1),u=Array(e.MAX_TILE_TESSELATION+1),z=Array(e.MAX_TILE_TESSELATION+1),w=65536,C={values:null,
numSurfaceIndices:0,numSkirtIndices:0},A=function(a,b,d){d||(a.values=b.values);a.numSurfaceIndices=b.numSurfaceIndices;a.numSkirtIndices=b.numSkirtIndices;return a},y=function(a,b,d,c,f){var g;g=C;var e=d&2,m=b+(c?1024:0)+(e?2048:0),h=t[m];g||(g={});if(h)A(g,h);else{var h=b-1,p=b-1,k=b*b,r=2*h+2*p,n=6*h*p,u=6*r,x=6*(2*h+p-1);c&&(n*=2,u*=2,x*=2);for(var r=l&&k+r>w?new Uint32Array(n+u):new Uint16Array(n+u),q=0,y=0,v=n,z,s,K,Q,U=0,X=0;X<=p;X++){e&&(U=0===X?x:X===p?-x:0);for(var v=v+U,P=0;P<=h;P++)Q=
s=-1,0===X&&(s=k+P,P!==h&&(Q=q+1)),P===h&&(s=k+h+X,X<p&&(Q=q+h+1)),X===p&&(s=k+h+p+(h-P),0<P&&(Q=q-1)),0===P&&0<X&&(s=k+2*h+p+(p-X),Q=q-(h+1)),-1<s&&(K=0===P&&1===X?k:s+1,-1<Q&&(z=q,c?(r[v+0]=z,r[v+1]=s,r[v+2]=s,r[v+3]=K,r[v+4]=K,r[v+5]=z,r[v+6]=K,r[v+7]=Q,r[v+8]=Q,r[v+9]=z,r[v+10]=z,r[v+11]=K,v+=12):(r[v+0]=z,r[v+1]=s,r[v+2]=K,r[v+3]=K,r[v+4]=Q,r[v+5]=z,v+=6))),++q,P<h&&X<p&&(z=X*(h+1)+P,s=z+1,K=s+(h+1),Q=K-1,c?(r[y+0]=z,r[y+1]=s,r[y+2]=s,r[y+3]=K,r[y+4]=K,r[y+5]=z,r[y+6]=K,r[y+7]=Q,r[y+8]=Q,r[y+
9]=z,r[y+10]=z,r[y+11]=K,y+=12):(r[y+0]=z,r[y+1]=s,r[y+2]=K,r[y+3]=K,r[y+4]=Q,r[y+5]=z,y+=6));v-=U}g.values=r;g.numSurfaceIndices=n;g.numSkirtIndices=u;t[m]=A({},g)}e=a.getData();m=e.getVertexAttr();e.getFaces()[0].indices.terrain=g.values;a.getBoundingInfo(0).init(m.terrain,g.values);f||(f={});f.geometry=a;f.numWithoutSkirtIndices=g.numSurfaceIndices+(d?6*(b-1)*(c?2:1):0);f.numVertsPerRow=b;return A(f,g,!0)};return{createPlanarGlobeTile:function(d,f,e,m,l,h,k){var r=f[0],n=f[1],t=f[2]-r;f=f[3]-n;
var u=0.1*t;d=g(d);var x=d-1,q=d-1,A=d*d,C=p.get(5*(A+(2*x+2*q))),w=C.getData().getVertexAttr().terrain.data,v,z,s=0;v=C.getBoundingInfo(0);var S=v.getBBMin(),K=v.getBBMax();a.set3(1E7,1E7,1E7,S);a.set3(-1E7,-1E7,-1E7,K);for(z=0;z<=q;z++){var Q=z/q,U=n+Q*f;h&&(U<h[1]?(U=h[1],Q=(U-n)/f):U>h[3]&&(U=h[3],Q=(U-n)/f));for(v=0;v<=x;v++){var X=v/x,P=r+X*t;h&&(P<h[0]?(P=h[0],X=(P-r)/t):P>h[2]&&(P=h[2],X=(P-r)/t));var $=e?b(P,U,e)||0:0,P=P-m[0],ea=U-m[1],$=$-m[2];c(P,ea,$,S,K);w[5*s]=P;w[5*s+1]=ea;w[5*s+2]=
$;w[5*s+3]=X;w[5*s+4]=Q;var ca=-1;0===z&&(ca=A+v);v===x&&(ca=A+x+z);z===q&&(ca=A+x+q+(x-v));0===v&&0<z&&(ca=A+2*x+q+(q-z));-1<ca&&(w[5*ca]=P,w[5*ca+1]=ea,w[5*ca+2]=$-u,w[5*ca+3]=X,w[5*ca+4]=Q,c(P,ea-u,$,S,K));++s}}return y(C,d,0,l,k)},createSphericalGlobeTile:function(d,e,l,h,k,n,t,q,A){var C=l[0],w=l[1],s=l[2],Y=l[3],E=Math.max(0.9,1-0.5*(s-C));d=g(d);l=d-1;var ba=d-1,W=d*d,R=p.get(5*(W+(2*l+2*ba))),T=R.getData().getVertexAttr().terrain.data,J=e[2]-e[0],S=e[3]-e[1],K=s-C,s=n[0],Q=n[1];n=n[2];var U=
R.getBoundingInfo(0),X=U.getBBMin(),U=U.getBBMax();a.set3(1E7,1E7,1E7,X);a.set3(-1E7,-1E7,-1E7,U);var P;for(P=0;P<=l;P++){var $=P/l,ea=C+$*K;x[P]=Math.sin(ea);v[P]=Math.cos(ea);u[P]=$;z[P]=e[0]+$*J}for(C=J=0;C<=ba;C++){K=C/ba;P=r(w,Y,K);var ea=Math.cos(P),ca=Math.sin(P),ha;h?(ha=f/2*Math.log((1+ca)/(1-ca)),K=(ha-e[1])/S):ha=180*P/Math.PI;for(P=0;P<=l;P++){var $=u[P],fa=x[P],da=v[P],ga=f;k&&(ga+=b(z[P],ha,k)||0);var da=da*ea*ga,fa=fa*ea*ga,ga=ca*ga,ka=da-s,ja=fa-Q,aa=ga-n;c(ka,ja,aa,X,U);var ia=5*
J;T[ia+0]=ka;T[ia+1]=ja;T[ia+2]=aa;T[ia+3]=$;T[ia+4]=K;ia=-1;0===C&&(ia=W+P);P===l&&(ia=W+l+C);C===ba&&(ia=W+l+ba+(l-P));0===P&&0<C&&(ia=W+2*l+ba+(ba-C));-1<ia&&(da=da*E-s,fa=fa*E-Q,ga=ga*E-n,c(da,fa,ga,X,U),ia*=5,T[ia+0]=da,T[ia+1]=fa,T[ia+2]=ga,T[ia+3]=$,T[ia+4]=K);++J}}h&&(e=!!(t&2),t&1&&m(-1,l,T,W),e&&m(1,l,T,W+l+ba));return y(R,d,h?t:0,q,A)},releaseGeometry:p.put,elevationSampler:b,_geometryObjectPool:p,supportedNumVertsPerRow:g,setSupportsUintIndices:function(a){l=a}}})},"esri/views/3d/webgl-engine/lib/Geometry":function(){define(["require",
"exports","./IdGen","./Util","./BoundingInfo"],function(s,q,n,k,h){return function(){function e(c,b,g){this.singleUse=!1;this.originalColors=null;this.id=e.__idGen.gen(b);this.data=c;this.boundingInfos=g||[];k.assert(1<=c.faces.length)}e.prototype.getId=function(){return this.id};e.prototype.getData=function(){return this.data};Object.defineProperty(e.prototype,"numGroups",{get:function(){return this.data.faces.length},enumerable:!0,configurable:!0});e.prototype.getNumGroups=function(){return this.numGroups};
e.prototype.calculateBoundingInfo=function(c,b){var g=this.data.faces[c],f="triangle"===g.type?3:1,a=g.indices[g.positionKey];if(0===a.length)for(var a=new Uint32Array(f),e=0;e<f;++e)a[e]=e;e=a.length;k.assert(0===e%f);for(var l=e/f,d=new Uint32Array(l),e=0;e<l;++e)d[e]=e;return new h(d,f,a,this.data.vertexAttributes[g.positionKey],b)};e.prototype.getBoundingInfo=function(c){var b=this.boundingInfos[c];null==b&&(b=this.calculateBoundingInfo(c),this.boundingInfos[c]=b);return b};e.prototype.invalidateBoundingInfo=
function(){this.boundingInfos=[]};e.__idGen=new n;return e}()})},"esri/views/3d/webgl-engine/lib/BoundingInfo":function(){define(["require","exports","./Util","./gl-matrix"],function(s,q,n,k){var h=k.vec3d;return function(){function e(c,b,g,f,a){n.assert(1<=c.length);n.assert(0===g.length%b);n.assert(g.length>=c.length*b);n.assert(3===f.size||4===f.size);this.primitiveIndices=c;this.indices=g;this.position=f;this._numIndexPerPrimitive=b;this._faceRange=a;var e=f.data;f=f.size;var l=0,d=c.length;null!=
a&&(l=a[0],d=a[1]+1);var m=f*g[b*c[l]];this.bbMin=h.createFrom(e[m],e[m+1],e[m+2]);this.bbMax=h.create(this.bbMin);for(a=l;a<d;++a)for(var p=b*c[a],k=0;k<b;++k)for(var m=f*g[p+k],x=0;3>x;++x){var q=e[m+x];q<this.bbMin[x]?this.bbMin[x]=q:q>this.bbMax[x]&&(this.bbMax[x]=q)}this.center=h.create();h.lerp(this.bbMin,this.bbMax,0.5,this.center);this.bsRadius=0;for(a=l;a<d;++a){p=b*c[a];for(k=0;k<b;++k)m=f*g[p+k],l=e[m]-this.center[0],x=e[m+1]-this.center[1],m=e[m+2]-this.center[2],m=l*l+x*x+m*m,m>this.bsRadius&&
(this.bsRadius=m)}this.bsRadius=Math.sqrt(this.bsRadius)}e.prototype.getCenter=function(){return this.center};e.prototype.getBSRadius=function(){return this.bsRadius};e.prototype.getBBMin=function(){return this.bbMin};e.prototype.getBBMax=function(){return this.bbMax};e.prototype.getPrimitiveIndices=function(){return this.primitiveIndices};e.prototype.getIndices=function(){return this.indices};e.prototype.getPosition=function(){return this.position};e.prototype.getChildren=function(){if(this.children)return this.children;
if(1<h.dist2(this.bbMin,this.bbMax)){for(var c=h.lerp(this.bbMin,this.bbMax,0.5,h.create()),b=this.primitiveIndices.length,g=new Uint8Array(b),f=Array(8),a=0;8>a;++a)f[a]=0;for(var k=this.position.size,a=0;a<b;++a){for(var l=0,d=this._numIndexPerPrimitive*this.primitiveIndices[a],m=this.position.data,p=k*this.indices[d],n=m[p],q=m[p+1],v=m[p+2],u=1;u<this._numIndexPerPrimitive;++u){var p=k*this.indices[d+u],z=m[p],w=m[p+1],p=m[p+2];z<n&&(n=z);w<q&&(q=w);p<v&&(v=p)}n<c[0]&&(l|=1);q<c[1]&&(l|=2);v<
c[2]&&(l|=4);g[a]=l;++f[l]}for(a=l=0;8>a;++a)0<f[a]&&++l;if(2>l)return;c=Array(8);for(a=0;8>a;++a)c[a]=0<f[a]?new Uint32Array(f[a]):void 0;for(a=0;8>a;++a)f[a]=0;for(a=0;a<b;++a)l=g[a],c[l][f[l]++]=this.primitiveIndices[a];this.children=Array(8);for(a=0;8>a;++a)void 0!==c[a]&&(this.children[a]=new e(c[a],this._numIndexPerPrimitive,this.indices,this.position))}return this.children};return e}()})},"esri/views/3d/webgl-engine/lib/GLIBO":function(){define(["require","exports","./Util"],function(s,q,n){return function(){function k(h,
e){this.num=0;this.glName=e.createBuffer();this.gl=e;void 0!==h&&this.setData(h);this.id=k._id++}k.prototype.setData=function(h){var e=this.gl;h instanceof Uint16Array?this.type=e.UNSIGNED_SHORT:h instanceof Uint32Array?this.type=e.UNSIGNED_INT:n.assert(!1,"only unsigned short or int arrays are supported for indices");e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.glName);e.bufferData(e.ELEMENT_ARRAY_BUFFER,h,e.STATIC_DRAW);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);this.num=h.length};k.prototype.bind=function(){var h=
this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.glName)};k.prototype.getNum=function(){return this.num};k.prototype.getId=function(){return this.id};k.prototype.getType=function(){return this.type};k.prototype.dispose=function(){this.gl.deleteBuffer(this.glName)};k._id=0;return k}()})},"esri/views/3d/terrain/OverlayManager":function(){define("../../../core/declare dojo/on ../support/mathUtils ../support/earthUtils ../support/projectionUtils ../support/aaBoundingRect ../lib/glMatrix ../webgl-engine/Stage ../webgl-engine/lib/Texture ../webgl-engine/lib/Util".split(" "),
function(s,q,n,k,h,e,c,b,g,f){var a=c.vec2d,r=c.vec3d,l=c.vec4d,d=f.assert,m={width:0,height:0,pixelRatio:0,views:null},p=[{viewport:l.create(),extent:l.create()}],t=[p[0],{viewport:l.create(),extent:l.create()}],x=l.create(),v=r.create(),u=[l.create(),l.create()];return s(null,{constructor:function(a,b){this._view=b;this._stage=b._stage;this._renderSR=this._overlaySR=null;this._overlaySREqualsRenderSR=!0;this.terrainSurface=a;this._renderer=this._stage.getTextureGraphicsRenderer();this._connectedLayers=
{};this._overlays=void 0;this._scale=0;this._dirty=!1},destroy:function(){for(var a in this._connectedLayers)this.unregisterLayerView(this._connectedLayers[a]);this._disposeOverlays()},hasOverlays:function(){return!!this._overlays},setSpatialReference:function(a,b){(this._overlaySR=a)?(this._renderSR=this._view.renderSpatialReference,this._overlaySREqualsRenderSR=this._overlaySR.equals(this._renderSR),this._longitudeCyclical=(this._isSpherical=b)?a.isWebMercator?new n.Cyclical(-2.0037508342788905E7,
2.0037508342788905E7):new n.Cyclical(-180,180):null):(this._disposeOverlays(),this._longitudeCyclical=null)},registerLayerView:function(a){var b=a.layer.uid;d(!this._connectedLayers[b],"layer already connected");var c=q(a,"draped-data-change",function(){this.setOverlayDirty()}.bind(this));this._connectedLayers[b]={eventHandles:[c],layerView:a};if(a.setDrapingExtent&&this._overlays)for(b=0;b<this._overlays.length;b++)a.setDrapingExtent(b,this._overlays[b].extent,this._overlaySR,2048);this.setOverlayDirty()},
unregisterLayerView:function(a){for(var b in this._connectedLayers){var d=this._connectedLayers[b];if(d.layerView===a){if(d.eventHandles)for(var c=0;c<d.eventHandles;c++)d.eventHandles[c].remove();delete this._connectedLayers[b];this.setOverlayDirty();a._accessorProps&&(a._overlayUpdating=!1,a._evaluateUpdatingState())}}},setOverlayDirty:function(){this._dirty||(this._setOverlayUpdating(!0),this._dirty=!0)},_setOverlayUpdating:function(a){for(var b in this._connectedLayers){var d=this._connectedLayers[b].layerView;
if(!a||!d.suspended&&d.hasDraped)d._overlayUpdating=a,d._evaluateUpdatingState()}if(b=this._view._graphicsView)b._overlayUpdating=a,b._evaluateUpdatingState()},updateOverlay:function(){if(this._overlaySR){var a=this._computeOverlayExtents();if(a){this._overlays||this._initOverlays();for(var b=0;b<this._overlays.length;b++){var d;a:{d=a[b];for(var c=this._overlays[b].extent,f=1E-5*Math.max(d[2]-d[0],d[3]-d[1],c[2]-c[0],c[3]-c[1]),g=0;4>g;g++)if(Math.abs(c[g]-d[g])>f){d=!0;break a}d=!1}if(d){l.set(a[b],
this._overlays[b].extent);for(var e in this._connectedLayers)d=this._connectedLayers[e].layerView,d.setDrapingExtent&&d.setDrapingExtent(b,a[b],this._overlaySR,2048)}}this._setOverlayUpdating(!1);this._drawOverlays();this.terrainSurface._updateTileOverlayParams();this._dirty=!1}}},overlaysNeedUpdate:function(){return this._dirty&&this._overlaySR},updateOpacity:function(a){var b=1;if(this._overlays){var d=this._scale;a=this._view.renderCoordsHelper.getAltitude(a);3.5*a<d&&(b=Math.sqrt(n.clamp((a-d/
10)/(d/3.5-d/10),0,1)))}return b},setOverlayParamsOfTile:function(b,d,c){b=b.extent;var f=-1;this._rectInsideRect(b,this._overlays[0].extent)?f=0:this._rectanglesOverlap(b,this._overlays[1].extent)&&(f=1);if(0<=f){var g=this._overlays[f].extent;d.overlayTexScale[0]=(b[2]-b[0])/(g[2]-g[0]);d.overlayTexScale[1]=(b[3]-b[1])/(g[3]-g[1]);var e=b[0];if(this._longitudeCyclical){var e=this._longitudeCyclical.minimalMonotonic(g[0],e),m=this._longitudeCyclical.minimalMonotonic(g[0],b[2]);e>m&&(e=m-(b[2]-b[0]))}a.set2((e-
g[0])/(g[2]-g[0]),(b[1]-g[1])/(g[3]-g[1]),d.overlayTexOffset);d.overlayTexId=this._overlays[f].texture.getId();d.overlayOpacity=void 0!==c?c:1}else d.overlayTexId=null},overlayPixelSizeInMapUnits:function(a){var b;this._overlays&&(this._overlays[0]&&this._pointIsInExtent(a,this._overlays[0].extent)?b=this._overlays[0].extent:this._overlays[1]&&(b=this._overlays[1].extent));return b?(b[2]-b[0])/2048:0},_initOverlays:function(){this._overlays=Array(2);for(var a=0;2>a;a++){var d=new g(null,"overlay",
{wrapClamp:!0,mipmap:!0});this._stage.add(b.ModelContentType.TEXTURE,d);this._overlays[a]={texture:d,extent:l.create()}}},_disposeOverlays:function(){if(this._overlays){var a=this._stage;this._overlays.forEach(function(d){a.remove(b.ModelContentType.TEXTURE,d.texture.getId())});this._overlays=null}},_overlayExtentIncTable:[[0,-1,2,1],[0,-2,2,0],[-1,-2,1,0],[-2,-2,0,0],[-2,-1,0,1],[-2,0,0,2],[-1,0,1,2],[0,0,2,2]],_computeOverlayExtents:function(){var b=this._view.navigation.currentCamera,d=this.terrainSurface.extent,
c=r.create();r.set(b.center,c);this._scale=this._view.renderCoordsHelper.getAltitude(b.eye);var f=h.vectorToPoint(c,this._renderSR,this.terrainSurface.spatialReference);(f=this.terrainSurface.getElevation(f))?this._view.renderCoordsHelper.setAltitude(f,c):this._view.navigation.getCenterIntersectManifold(b.eye,b.center,c);var g=r.dist(b.eye,c),f=b.angleOfElevation;if(!isNaN(f)){this._overlaySREqualsRenderSR||h.vectorToVector(c,this._renderSR,c,this._overlaySR);var g=2*1024*b.perPixelRatio*g,e=!1,m=
Infinity;this._isSpherical&&(this._overlaySR.isWebMercator?(g/=Math.cos(h.webMercator.y2lat(c[1])),m=this.terrainSurface.extent[3],m*=0.999):(e=!0,g/=k.metersPerDegree,m=90),g>=m&&(g=m,c[1]=0,this._overlaySR.isWebMercator&&(c[0]=0)));var p=1;e&&(p=1/Math.max(0.2,Math.cos(Math.abs(n.deg2rad(c[1])))),180<g*p&&(p=180/g));var t=g*p,q=u[0];q[0]=c[0]-t;q[1]=c[1]-g;q[2]=c[0]+t;q[3]=c[1]+g;this._isSpherical&&this._shiftExtentToFitBounds(q,Infinity,m);e=u[1];l.set(q,e);6*t>d[2]-d[0]?l.set(d,e):f>0.25*Math.PI?
(e[0]-=t,e[1]-=g,e[2]+=t,e[3]+=g):(h.vectorToVector(b.eye,this._renderSR,v,this._overlaySR),a.subtract(c,v,x),b=-Math.atan2(x[1],x[0])+0.125*Math.PI,0>b&&(b+=2*Math.PI),l.scale(this._overlayExtentIncTable[Math.floor(b/(0.25*Math.PI))],2*g,x),x[0]*=p,x[2]*=p,l.add(e,x,e));this._isSpherical&&(e[0]=this._longitudeCyclical.clamp(e[0]),e[2]=this._longitudeCyclical.clamp(e[2]),e[1]=Math.max(e[1],-m),e[3]=Math.min(e[3],m));this.opacity=1;return u}},_drawOverlays:function(){for(var a=this._overlays[0].extent[2]-
this._overlays[0].extent[0],b=this._stage.getTextureGraphicsRenderer(),d=0;d<this._overlays.length;d++){var c=this._overlays[d].extent,f=this._longitudeCyclical?c[2]>this._longitudeCyclical.max:!1,g=this._longitudeCyclical?c[0]<this._longitudeCyclical.min:!1;if(f||g){m.views=t;var g=Math.round(2048*((f?this._longitudeCyclical.max-c[0]:this._longitudeCyclical.min-c[0])/(c[2]-c[0]))),e=m.views[0];l.set4(0,0,g,2048,e.viewport);l.set4(c[0],c[1],this._longitudeCyclical.max,c[3],e.extent);f||(e.extent[0]+=
this._longitudeCyclical.range);e=m.views[1];l.set4(g,0,2048-g,2048,e.viewport);l.set4(this._longitudeCyclical.min,c[1],c[2],c[3],e.extent);f&&(e.extent[2]-=this._longitudeCyclical.range)}else m.views=p,l.set(c,m.views[0].extent),l.set4(0,0,2048,2048,m.views[0].viewport);m.width=2048;m.height=2048;m.pixelRatio=a/(c[2]-c[0]);b.draw(this._overlays[d].texture,m)}},_rectanglesOverlap:function(a,b){return this._longitudeCyclical?(this._longitudeCyclical.contains(b[0],b[2],a[0])||this._longitudeCyclical.contains(b[0],
b[2],a[2]))&&!(a[1]>b[3]||a[3]<b[1]):!(a[0]>b[2]||a[2]<b[0]||a[1]>b[3]||a[3]<b[1])},_rectInsideRect:function(a,b){return this._longitudeCyclical?this._longitudeCyclical.contains(b[0],b[2],a[0])&&this._longitudeCyclical.contains(b[0],b[2],a[2])&&a[1]>b[1]&&a[3]<b[3]:a[0]>b[0]&&a[2]<b[2]&&a[1]>b[1]&&a[3]<b[3]},_pointIsInExtent:function(a,b){if(this._longitudeCyclical)return this._longitudeCyclical.contains(b[0],b[2],a.x)&&a.y>=b[1]&&a.y<=b[3];var d=a.x,c=a.y;return d>b[0]&&d<b[2]&&c>b[1]&&c<b[3]},_shiftExtentToFitBounds:function(a,
b,d){var c=0,f=0;a[0]<-b?c=a[0]+b:a[2]>b&&(c=b-a[2]);a[1]<-d?f=a[1]+d:a[3]>d&&(f=d-a[3]);e.offset(a,c,f)}})})},"esri/views/3d/terrain/SurfaceExtentHelper":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declare dojo/_base/lang ../../../core/Accessor ../../../core/arrayUtils ../../../core/HandleRegistry ../../../geometry/support/webMercatorUtils ../../../views/3d/support/aaBoundingRect ./terrainUtils ./TerrainConst".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l){s=function(a){function b(){a.apply(this,arguments)}n(b,a);Object.defineProperty(b.prototype,"layerViewsExtent",{get:function(){return this._computeLayerViewsExtent()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"tiledLayersExtent",{get:function(){return this._computeTiledLayersExtent()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"spatialReference",{set:function(a){this.tilingScheme||this._set("spatialReference",a)},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"tilingScheme",{set:function(a){this._set("tilingScheme",a);this._set("spatialReference",a.spatialReference)},enumerable:!0,configurable:!0});b.prototype.normalizeCtorArgs=function(a){a=e.mixin({},a);this._layers=a.layers;delete a.layers;this._layerViews=a.layerViews;delete a.layerViews;return a};k([h.property({readOnly:!0})],b.prototype,"layerViewsExtent",null);k([h.property({readOnly:!0,dependsOn:["spatialReference","tilingScheme"]})],b.prototype,
"tiledLayersExtent",null);k([h.property()],b.prototype,"spatialReference",null);k([h.property()],b.prototype,"tilingScheme",null);k([h.property()],b.prototype,"defaultTiledLayersExtent",void 0);return b=k([h.subclass()],b)}(h.declared(c));c=function(a){function b(){a.apply(this,arguments)}n(b,a);b.prototype._computeLayerViewsExtent=function(){return this._getGlobalExtent()};b.prototype._computeTiledLayersExtent=function(){return this._getGlobalExtent()};b.prototype._getGlobalExtent=function(){return this.spatialReference.isWebMercator?
l.WEBMERCATOR_WORLD_EXTENT:l.GEOGRAPHIC_WORLD_EXTENT};k([h.property({dependsOn:["spatialReference"]})],b.prototype,"layerViewsExtent",void 0);return b=k([h.subclass()],b)}(h.declared(s));q.SurfaceExtentHelperGlobal=c;s=function(d){function c(){d.call(this);this._changeListeners=new g}n(c,d);c.prototype.initialize=function(){this._changeListeners.add(this._layers.on("change",this.notifyChange.bind(this,"tiledLayersExtent")));this._changeListeners.add(this._layerViews.on("change",this.notifyChange.bind(this,
"layerViewsExtent")))};c.prototype.destroy=function(){this._changeListeners.destroy();this._changeListeners=null};c.prototype._computeLayerViewsExtent=function(){var d=a.create(a.NEGATIVE_INFINITY),c=this.spatialReference;this._layerViews.forEach(function(b){b.isResolved()&&((b=b.fullExtentInViewSpatialReference||b.layer.fullExtent)&&!b.spatialReference.equals(c)&&(b=f.canProject(b.spatialReference,c)?f.project(b,c):null),b&&a.expand(d,b))});var g=a.allFinite(d)?d:null,e=this._get("layerViewsExtent");
return b.equals(g,e)?e:g};c.prototype._computeTiledLayersExtent=function(){var d=this.tilingScheme;if(!d)return null;var c=this.spatialReference,f=a.create(a.NEGATIVE_INFINITY);this._layers.forEach(function(b){r.isTiledLayer(b)&&d.compatibleWith(b.tileInfo)&&(b.fullExtent&&b.fullExtent.spatialReference.equals(c))&&a.expand(f,b.fullExtent)});this.defaultTiledLayersExtent&&a.expand(f,this.defaultTiledLayersExtent);var g=a.allFinite(f)?f:null,e=this._get("tiledLayersExtent");return b.equals(g,e)?e:g};
return c=k([h.subclass()],c)}(h.declared(s));q.SurfaceExtentHelperLocal=s})},"esri/views/3d/terrain/terrainUtils":function(){define("require exports ./terrainUtilsPlanar ./terrainUtilsSpherical ../../../layers/TiledLayer ../../../support/basemapDefinitions".split(" "),function(s,q,n,k,h,e){function c(a){return"esri.views.3d.layers.TiledLayerView3D"===a.declaredClass}function b(a){return"esri.views.3d.layers.ElevationLayerView3D"===a.declaredClass}function g(){a={};for(var b in e)e[b].baseMapLayers.forEach(function(b){a[b.url]=
19});a["//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"]=20}var f={planar:n,spherical:k};q.weakAssert=function(a,b){a||console.warn("Terrain: "+b)};q.autoUpdateSkirtsVisibility=function(a,b){f[a.manifold].autoUpdateSkirtsVisibility(a,b)};q.isTiledLayer=function(a){return a.isInstanceOf(h)};q.isTiledMapLayerView=c;q.isElevationLayerView=b;q.isTiledLayerView=function(a){return c(a)||b(a)};var a=null;q.getKnownTiledServiceLevelCap=function(b){a||g();b=b&&b.replace(/https?:/,
"");return b in a?a[b]:Infinity};q.prepareKnownTiledServiceLevelCaps=g})},"esri/views/3d/terrain/terrainUtilsPlanar":function(){define(["require","exports","../support/aaBoundingRect","../lib/glMatrix"],function(s,q,n,k){function h(a,f,d,e){c.set(d,b);b[e]=f[e];e=c.subtract(b,f);var h=c.subtract(a,f,g),h=c.dot(h,e),k=c.dot(e,e);f=0>=h?f:k<=h?d:c.add(f,c.scale(e,h/k),b);a=c.subtract(a,f,b);return Math.PI/2-Math.atan(a[2]/Math.sqrt(a[0]*a[0]+a[1]*a[1]))}function e(b,c){var d=b.getElevationBounds(),
g=b.extent,d=0.5*(d[0]+d[1]);f[0]=g[0];f[1]=g[1];f[2]=d;a[0]=g[2];a[1]=g[3];a[2]=d;d=g=Infinity;c[0]<f[0]?g=h(c,f,a,0):c[0]>a[0]&&(g=h(c,a,f,0));c[1]<f[1]?d=h(c,f,a,1):c[1]>a[1]&&(d=h(c,a,f,1));return Math.min(g,d)}var c=k.vec3d,b=c.create(),g=c.create(),f=c.create(),a=c.create();q.autoUpdateSkirtsVisibility=function(a,b){var d,c=!0,f=a.extent,g=n.contains(f,b);g?d=a.getElevation(b):(d=a.getElevationBounds(),d=0.5*(d[0]+d[1]));d>b[2]?c=!1:g||(g=Math.min(f[2]-f[0],f[3]-f[1]),n.containsWithMargin(f,
b,a.hideSkirtsDistanceFromExtentMargin*g)?e(a,b)>a.hideSkirtsMinimumCameraTilt&&(c=!1):c=!1);c!==a.skirts&&(a.skirts=c)};q.tiltOnEdge=h;q.tiltToExtentEdge=e})},"esri/views/3d/terrain/terrainUtilsSpherical":function(){define(["require","exports"],function(s,q){q.autoUpdateSkirtsVisibility=function(n,k){}})},"esri/views/3d/terrain/SurfaceTilingSchemeLogic":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/typescript ../../../core/Accessor ../../../core/HandleRegistry ../../../geometry/SpatialReference ./TilingScheme ./terrainUtils".split(" "),
function(s,q,n,k,h,e,c,b,g,f){return function(a){function e(){a.apply(this,arguments)}n(e,a);e.prototype.dojoConstructor=function(){this._changeHandles=new c};e.prototype.normalizeCtorArgs=function(a){this._layers=a.layers;this._extentHelper=a.extentHelper;this._manifold=a.manifold;return{changeCallback:a.changeCallback,viewSpatialReference:a.viewSpatialReference}};e.prototype.initialize=function(){var a=this;this._changeHandles.add(this._layers.on("change",function(){return a._update()}));this._changeHandles.add(this._extentHelper.watch("layerViewsExtent",
function(){return a._setAdHocTilingScheme()}));this._update();this.tilingSchemeLocked||this._setAdHocTilingScheme()};e.prototype.destroy=function(){this._changeHandles.destroy();this._changeHandles=null};e.prototype._update=function(){var a=this;this._waitTask=null;if(!this.tilingSchemeLocked){var b=this._layers.find(function(b){if(f.isTiledLayer(b))return b.isResolved()&&!a._isTileInfoSupported(b.tileInfo)?!1:!b.isRejected()});if(b)if(b.isResolved()){var c=new g(b.tileInfo),b=f.getKnownTiledServiceLevelCap(b.url);
Infinity>b&&c.capMaxLod(b);this._lockTilingScheme(c)}else this._updateWhen(b)}};e.prototype._updateWhen=function(a){var b=this,c=a.always(function(){c===b._waitTask&&b._update()});this._waitTask=c};e.prototype._lockTilingScheme=function(a){var b=this;this.tilingSchemeLocked=!0;this.tilingScheme=a;this._extentHelper.tilingScheme=this.tilingScheme;this._updateTiledLayerExtent();this._changeHandles.removeAll();this._changeHandles.add(this._extentHelper.watch("tiledLayersExtent",function(){return b._updateTiledLayerExtent()}));
this._signalChange()};e.prototype._updateTiledLayerExtent=function(){this.extent=this._extentHelper.tiledLayersExtent};e.prototype._setAdHocTilingScheme=function(){if("spherical"===this._manifold)this.tilingScheme=this._extentHelper.spatialReference.isWebMercator?g.WebMercatorAuxiliarySphere:g.makeWGS84WithTileSize(256),this.extent=this._extentHelper.layerViewsExtent,this._signalChange();else{var a=this._extentHelper.layerViewsExtent;a&&(this.tilingScheme=g.fromExtent(a,this._extentHelper.spatialReference),
this.extent=a,this._signalChange())}};e.prototype._isTileInfoSupported=function(a){if("spherical"===this._manifold){if(a.spatialReference.isWebMercator)return g.WebMercatorAuxiliarySphere.compatibleWith(a);if(a.spatialReference.equals(b.WGS84))return g.makeWGS84WithTileSize(a.rows).compatibleWith(a)}else return!g.checkUnsupported(a)&&a.spatialReference.equals(this.viewSpatialReference)};e.prototype._signalChange=function(){this.changeCallback&&this.changeCallback()};k([h.property()],e.prototype,"tilingScheme",
void 0);k([h.property()],e.prototype,"extent",void 0);k([h.property({value:!1})],e.prototype,"tilingSchemeLocked",void 0);k([h.property()],e.prototype,"changeCallback",void 0);k([h.property()],e.prototype,"viewSpatialReference",void 0);return e=k([h.subclass()],e)}(e)})},"esri/views/3d/terrain/SphericalTile":function(){define("./TileBase ./TileGeometryFactory ./TerrainConst ../support/ObjectPool ../support/mathUtils ../support/earthUtils ../lib/glMatrix".split(" "),function(s,q,n,k,h,e,c){var b=c.vec3d,
g=e.earthRadius;b.create();var f=function(a,b,c,d){c=g+c;var f=Math.cos(a);d[0]=Math.cos(b)*f*c;d[1]=Math.sin(b)*f*c;d[2]=Math.sin(a)*c};e=function(a,c,f,d){s.call(this);this.tileUp=b.create();this.obb=Array(8);this._isWebMercator=!1;for(var g=0;8>g;g++)this.obb[g]=b.create();void 0!==a&&this.init(a,c,f,d)};e.prototype=new s;e.prototype.constructor=e;e.prototype.init=function(a,c,e,d){s.prototype.init.call(this,a,c,e,d);this._isWebMercator=d.spatialReference.isWebMercator;c=a[0];d.getExtent(c,a[1],
a[2],this.extent,this.extentWGS84Rad);a=this.extentWGS84Rad[0];var m=this.extentWGS84Rad[1];d=this.extentWGS84Rad[2];var p=this.extentWGS84Rad[3];e=h.lerp(m,p,0.5);var k=h.lerp(a,d,0.5);c=0===c?0:Math.min(Math.abs(m),Math.abs(p));this.edgeLen=(d-a)*Math.cos(c)*g;f(e,k,0,this.centerAtSeaLevel);b.set(this.centerAtSeaLevel,this.tileUp);b.normalize(this.tileUp);this._updateOBB();this.updateRadiusAndCenter()};e.prototype.isVisible=function(a,b){if(!this.intersectsClippingArea)return!1;if(9<this.lij[0])for(var c=
this.obb,d=0;6>d;d++){for(var f=0;8>f&&!(0>a[d][0]*c[f][0]+a[d][1]*c[f][1]+a[d][2]*c[f][2]+a[d][3]);f++);if(8===f)return!1}else if(c=this.radius,d=this.center,a[0][0]*d[0]+a[0][1]*d[1]+a[0][2]*d[2]+a[0][3]>c||a[1][0]*d[0]+a[1][1]*d[1]+a[1][2]*d[2]+a[1][3]>c||a[2][0]*d[0]+a[2][1]*d[1]+a[2][2]*d[2]+a[2][3]>c||a[3][0]*d[0]+a[3][1]*d[1]+a[3][2]*d[2]+a[3][3]>c||a[4][0]*d[0]+a[4][1]*d[1]+a[4][2]*d[2]+a[4][3]>c||a[5][0]*d[0]+a[5][1]*d[1]+a[5][2]*d[2]+a[5][3]>c)return!1;return!0};e.prototype.updateElevationBounds=
function(){s.prototype.updateElevationBounds.call(this);this._updateOBB()};e.prototype.updateRadiusAndCenter=function(){if(0===this.lij[0])b.set3(0,0,0,this.center),this.radius=g+this.elevationBounds[1];else{s.prototype.updateRadiusAndCenter.call(this);var a=Math.max(b.dist2(this.center,this.obb[0]),b.dist2(this.center,this.obb[1]));this.radius=Math.sqrt(a)}};e.prototype._numSubdivisionsAtLevel=[128,64,32,16,16,8,8,4];e.prototype.createGeometry=function(a,b,c){var d=this._isPole(this.lij[1],this.lij[0]);
a.needsUpdate=!1;return q.createSphericalGlobeTile(a.numVertsPerRow,this.extent,this.extentWGS84Rad,this._isWebMercator,a.samplerData,b,d,c)};e.prototype._updateOBB=function(){var a=this.extentWGS84Rad,c=this.obb,e;for(e=0;2>e;e++){var d=this.elevationBounds[e],m=4*e;f(a[1],a[0],d,c[m++]);f(a[3],a[0],d,c[m++]);f(a[3],a[2],d,c[m++]);f(a[1],a[2],d,c[m++])}this._isWebMercator&&(a=this._isPole(this.lij[1],this.lij[0]),2===a?(b.set3(0,0,g,c[1]),b.set3(0,0,g,c[2]),b.set3(0,0,g,c[5]),b.set3(0,0,g,c[6])):
1===a&&(b.set3(0,0,-g,c[0]),b.set3(0,0,-g,c[3]),b.set3(0,0,-g,c[4]),b.set3(0,0,-g,c[7])))};e.prototype._isPole=function(a,b){var c=0;a===(1<<b)-1&&(c+=1);0===a&&(c+=2);return c};e.prototype.elevationStartsAtLevel=n.Spherical.ELEVATION_STARTS_AT_LEVEL;k.on(e,400);return e})},"esri/views/3d/terrain/TileBase":function(){define("./terrainUtils ./TileUtils ./TerrainConst ./TileGeometryFactory ./UpsampleInfo ./ElevationData ../support/mathUtils ../lib/glMatrix ../../../core/arrayUtils".split(" "),function(s,
q,n,k,h,e,c,b,g){function f(a){this.waitingAgents=[];this.init(a)}var a=b.vec3d,r=b.vec2d,l=b.vec4d,d=b.mat4d,m=s.weakAssert,p=a.create(),t=l.create(),x=l.create(),v=a.create(),u={},z=n.LayerClass.LAYER_CLASS_COUNT,w=n.LayerClass.MAP,C=n.LayerClass.ELEVATION,A=n.TileUpdateTypes;s=function(b,c,d){this.lij=[0,0,0];this.extent=l.create();this.extentWGS84Rad=l.create();this.centerAtSeaLevel=a.create();this.center=a.create();this.tileUp=v;this.elevationBounds=r.create();this.children=[null,null,null,null];
this.layerInfo=Array(z);this.intersectsClippingArea=this.isWithinClippingArea=!0;this.clippingArea=null;this._maxTesselation=0};s.prototype.init=function(a,b,c,d){this.lij[0]=a[0];this.lij[1]=a[1];this.lij[2]=a[2];l.set4(0,0,0,0,this.extent);l.set4(0,0,0,0,this.extentWGS84Rad);this.intersectsClippingArea=this.isWithinClippingArea=!0;this.clippingArea=null;this.radius=this.edgeLen=0;this.vlevel=a?a[0]:0;b&&b.elevationBounds?r.set(b.elevationBounds,this.elevationBounds):r.set2(0,0,this.elevationBounds);
this.parent=b;for(a=0;4>a;a++)this.children[a]=null;this.pendingUpdates=0;this.renderData=null;this.renderOrder=this.screenDepth=0;this.visible=!1;this.parentSurface=c;for(a=0;a<z;a++)if(c){var f=c.numLayers(a),g;this.layerInfo[a]?(g=this.layerInfo[a],g.length=f):(g=Array(f),this.layerInfo[a]=g);for(var e=0;e<f;e++)g[e]=y(a,g[e]),b&&a==C&&(g[e].elevationBounds=b.layerInfo[a][e].elevationBounds)}else this.layerInfo[a]=null;this._maxTesselation=Math.min(d.pixelSize[0],n.MAX_TILE_TESSELATION)};s.prototype.dispose=
function(){for(var a=0;a<z;a++)for(var b=this.layerInfo[a],c=0;c<b.length;c++){var d=b[c];d.upsampleFromTile&&(h.Pool.release(d.upsampleFromTile),d.upsampleFromTile=null)}};s.prototype.updateScreenDepth=function(b){a.set(this.center,x);x[3]=1;d.multiplyVec4(b,x,x);this.screenDepth=x[2]/x[3]};s.prototype.shouldSplit=function(b,d){var f=this.lij[0];if(1>f)return A.SPLIT;a.subtract(this.center,d,p);var g=a.length(p),g=this.edgeLen/(2*b[0]*g);return g<b[1]?this.vlevel!==this.lij[0]?(this.vlevel=this.lij[0],
A.VSPLITMERGE):A.NONE:f>=b[4]?(f+=Math.ceil(-c.log2(b[1]/g)),f!==this.vlevel?(this.vlevel=f,A.VSPLITMERGE):A.NONE):10<f&&(a.scale(this.tileUp,a.dot(this.tileUp,p),t),a.subtract(t,p),a.length2(t)>this.radius*this.radius&&(a.scale(t,this.radius/a.length(t)),a.add(t,this.centerAtSeaLevel),a.subtract(d,t,t),Math.abs(a.dot(t,this.tileUp)/a.length(t))*g<0.15*b[1]))?A.NONE:A.SPLIT};s.prototype.createElevationDataFromLERC=function(a){var b;try{b=e.createFromLERC(this.lij,this.extent,a,{noDataValue:n.ELEVATION_NODATA_VALUE})}catch(c){console.warn("Error decoding %s: %s",
a.url,c.message)}return b};s.prototype.getWGS84Extent=function(){return this.extentWGS84Rad.map(c.rad2deg)};s.prototype.load=function(a){for(var b=0;b<z;b++)this.layerInfo[b]&&this._createOrUpdateAgents(0,b);a.loadTile(this)};s.prototype.unload=function(a){this.renderData&&a.unloadTile(this);for(a=0;a<z;a++)for(var b=this.layerInfo[a],c=0;c<b.length;c++){var d=b[c];d.loadingAgent&&d.loadingAgent!==u&&(d.loadingAgent.dispose(),this.parentSurface.agentTypeByLayerIndex(c,a).Pool.release(d.loadingAgent),
d.loadingAgent=null);d.pendingUpdates=0}this.pendingUpdates&=~n.TileUpdateTypes.UPDATE_GEOMETRY;this.pendingUpdates&=~n.TileUpdateTypes.UPDATE_TEXTURE};s.prototype.updateClippingStatus=function(a){g.equals(a,this.clippingArea)||(a?(this.intersectsClippingArea=this._intersectsExtent(a),this.isWithinClippingArea=this._isWithinExtent(a)):this.isWithinClippingArea=this.intersectsClippingArea=!0,this.clippingArea=a,this.renderData&&this.updateGeometry())};s.prototype.updateVisibility=function(a,b,c){a=
c||this.isVisible(a,b)&&this.intersectsClippingArea;if(a!==this.visible){this.visible=a;b=this.layerInfo[0];for(c=0;c<b.length;c++){var d=b[c];d.loadingAgent&&d.loadingAgent!==u&&d.loadingAgent.setSuspension(!a)}}return a};s.prototype.getLayerInfo=function(a,b){return this.layerInfo[b][a]};s.prototype.hasLayerData=function(a,b){var c=this.layerInfo[b][a];return c&&c.data};s.prototype.tileDataAvailable=function(a,b,c){return(b=this.layerInfo[c][b].tilemapData)?null!=b.dataValue?b.dataValue:b.isTileAvailable(a.lij[1],
a.lij[2]):!0};s.prototype.requestLayerData=function(a,b,c){n.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d requested by tile %s",this.lij.toString(),b,a,c.tile.lij.toString());var d=this.layerInfo[b][a];if(-1<d.waitingAgents.indexOf(c))return console.warn("agent already requested this piece of map data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),c.tile.lij.toString(),b,a),!0;if(d.data)return console.warn("agent requested existing data (tile %s, agent tile %s, layer: %d/%d)",
this.lij.toString(),c.tile.lij.toString(),b,a),d.waitingAgents.push(c),setTimeout(c.dataArrived.bind(c,this),0),!0;if(d.pendingUpdates&A.DECODE_LERC)return d.waitingAgents.push(c),!0;d.waitingAgents.push(c);if(!d.requestPromise){var f=this.parentSurface.requestTileData(this,a,b);a=function(){d.requestPromise===f&&(d.requestPromise=null)};d.requestPromise=f;f.then(a,a)}return d.requestPromise?!0:!1};s.prototype.descendants=function(a){a||(a=[]);for(var b=0;4>b;b++){var c=this.children[b];c&&(c.descendants(a),
a.unshift(this.children[b]))}return a};s.prototype.isLij=function(a){return this.lij[0]===a[0]&&this.lij[1]===a[1]&&this.lij[2]==a[2]};s.prototype.findByLij=function(a){if(this.isLij(a))return this;for(var b=0;4>b;b++){var c=this.children[b];if(c&&(c=c.findByLij(a)))return c}return null};s.prototype.unrequestLayerData=function(a,b,c){n.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d canceled by tile %s",this.lij.toString(),b,a,c.tile.lij.toString());var d=this.layerInfo[b][a],f=d.waitingAgents;
c=f.indexOf(c);m(-1<c,"agent has not requested this piece of map data");f[c]=f[f.length-1];f.length--;1>f.length&&(m(d.requestPromise||d.rawData,"no pending operations on layerInfo that agents were waiting for"),d.requestPromise&&(this.parentSurface.cancelRequest(d.requestPromise),d.requestPromise=null),n.TILE_LOADING_DEBUGLOG&&console.log("tile %s layer %d/%d request/loading canceled",this.lij.toString(),b,a))};s.prototype.dataArrived=function(a,b,c){a=this.layerInfo[b][a];a.data=c;for(c=0;c<a.waitingAgents.length;c++)a.waitingAgents[c].dataArrived(this);
a.waitingAgents.length=0};s.prototype.dataMissing=function(a,b,c){c.notInTilemap||console.error("Tile %s layer %d/%d error",this.lij.toString(),b,a);a=this.layerInfo[b][a];for(b=0;b<a.waitingAgents.length;b++)a.waitingAgents[b].dataMissing(this);a.waitingAgents.length=0};s.prototype.updateTexture=function(a){this.renderData&&(a?this.parentSurface._renderer.updateTileTexture(this):(this.pendingUpdates|=n.TileUpdateTypes.UPDATE_TEXTURE,this.parentSurface._pendingUpdates=!0))};s.prototype.updateElevationBounds=
function(){r.set2(Number.MAX_VALUE,-Number.MAX_VALUE,this.elevationBounds);for(var a=this.layerInfo[C],b=!1,c=0;c<a.length;c++){var d=a[c];if(d.elevationBounds){var f=this.parentSurface.layerViewByIndex(c,C);q.fallsWithinLayer(this,f,!1)&&(this.elevationBounds[0]=Math.min(this.elevationBounds[0],d.elevationBounds[0]),this.elevationBounds[1]=Math.max(this.elevationBounds[1],d.elevationBounds[1]),b=!0)}}b||r.set2(0,0,this.elevationBounds);this.updateRadiusAndCenter()};s.prototype.updateRadiusAndCenter=
function(){a.scale(this.tileUp,0.5*(this.elevationBounds[0]+this.elevationBounds[1]),t);a.add(this.centerAtSeaLevel,t,this.center)};s.prototype.setLayerElevationBounds=function(a,b){var c=this.layerInfo[C][a];if(!c.elevationBounds||c.elevationBounds[2]<b[2])c.elevationBounds=b,this.updateElevationBounds()};s.prototype.updateGeometry=function(){this.pendingUpdates|=n.TileUpdateTypes.UPDATE_GEOMETRY;this.parentSurface._pendingUpdates=!0};s.prototype.modifyLayers=function(a,b,c){for(var d=b.length,f=
this.layerInfo[c],g=Array(d),e=0;e<f.length;e++){var m=f[e];m.loadingAgent&&m.loadingAgent!==u&&(m.loadingAgent.dispose(),this.parentSurface.agentTypeByLayerIndex(e,c).Pool.release(m.loadingAgent),m.loadingAgent=null);m.waitingAgents.length=0}if(c===w)for(e=0;e<f.length;e++)void 0===a[e]&&(m=f[e],m.data instanceof WebGLTexture&&this.parentSurface._renderer.releaseTileTexture(m.data));for(e=0;e<d;e++)a=b[e],g[e]=-1<a?f[a]:y(c);this.layerInfo[c]=g};s.prototype.restartAgents=function(a){if(this.renderData)if(this._createOrUpdateAgents(0,
a),a===C){this.updateGeometry();a=this.layerInfo[a];for(var b=0;b<a.length;b++)a[b].pendingUpdates|=n.TileUpdateTypes.UPDATE_GEOMETRY;this.parentSurface._pendingUpdates=!0}else this.updateTexture(!0)};s.prototype.updateAgents=function(a){if(this.renderData){for(var b=this.layerInfo[a],c=0;c<b.length;c++){var d=b[c];d.loadingAgent===u&&(d.loadingAgent=null)}this._createOrUpdateAgents(0,a)}};s.prototype.agentDone=function(a,b){var c=this.layerInfo[b],d=c[a];d.loadingAgent=u;!d.data&&!d.upsampleFromTile&&
a<c.length-1&&this._createOrUpdateAgents(a+1,b)};s.prototype._createOrUpdateAgents=function(a,b){var c;c=b===C?!1:!this.visible;for(var d=a,f=this.layerInfo[b];d<f.length;){var g=f[d],e=!1,m=this.parentSurface.layerViewByIndex(d,b);if(null!==g.loadingAgent&&g.loadingAgent!==u)e=g.loadingAgent.update();else if(g.loadingAgent!==u&&q.fallsWithinLayer(this,m,!1)){var l=this.parentSurface.agentTypeByLayerIndex(d,b),h=l.Pool.acquire();(e=h.init(this,d,b,c))?g.loadingAgent=h:(l.Pool.release(h),g.loadingAgent=
u)}if(e&&!m.isTransparent())break;d++}};s.prototype.geometryState=function(a){var b,d=this._getElevationInfo(a?a.samplerData:null),f=this.lij[0],e=!1;d.samplerData?(b=this.vlevel-f,b=Math.max(f-d.maxTileLevel,n.ELEVATION_DESIRED_RESOLUTION_LEVEL-b),f=this._maxTesselation,b=c.clamp((f>>b)+1,2,f+1)):b=8>f?this._numSubdivisionsAtLevel[f]+1:2;b=k.supportedNumVertsPerRow(b);f=this.clippingArea;if(!this.intersectsClippingArea||this.isWithinClippingArea)f=null;a?(a.numVertsPerRow!==b&&(a.numVertsPerRow=
b,e=!0),d.changed&&(a.samplerData=d.samplerData,e=!0),g.equals(a.clippingArea,f)||(a.clippingArea=f,e=!0),a.needsUpdate=e):a={numVertsPerRow:b,samplerData:d.samplerData,needsUpdate:!0,clippingArea:f};return a};s.prototype._getElevationInfo=function(a){for(var b=this.layerInfo[C],c=b.length,d=Array(c),f=0,g=0,e=!1,m=0;m<c;m++){var l=b[m];if(l.upsampleFromTile){var l=l.upsampleFromTile.tile,h=l.layerInfo[C][m].data;if(!a||a[f]!==h.samplerData)e=!0;d[f++]=h.samplerData;g=Math.max(g,l.lij[0])}else if(l.data&&
(h=this.parentSurface.layerViewByIndex(m,C),q.fallsWithinLayer(this,h,!1))){if(!a||a[f]!==l.data.samplerData)e=!0;d[f++]=l.data.samplerData;g=this.lij[0]}}a&&a.length!==f&&(e=!0);0<f?d.length=f:d=null;return{changed:e,samplerData:d,maxTileLevel:g}};s.prototype._isWithinExtent=function(a){var b=this.extent;return b[0]>=a[0]&&a[2]>=b[2]&&b[1]>=a[1]&&a[3]>=b[3]};s.prototype._intersectsExtent=function(a){var b=this.extent;return b[2]>=a[0]&&a[2]>=b[0]&&b[3]>=a[1]&&a[3]>=b[1]};f.prototype.init=function(a){this.waitingAgents.length=
0;this.rawData=this.requestPromise=this.loadingAgent=this.upsampleFromTile=this.tilemapRequest=this.tilemapData=this.data=null;this.pendingUpdates=0;a===C&&(this.elevationBounds=null)};var y=function(a,b){return b?(b.init(a),b):new f(a)};return s})},"esri/views/3d/terrain/ElevationData":function(){define(["require","exports","../../../layers/support/rasterFormats/LercCodec","./TerrainConst"],function(s,q,n,k){return function(){function h(e,c,b,g){this.samplerData=null;this.level=e;this.i=c;this.j=
b;this.extent=g}h.prototype.computeMinMaxValue=function(e,c,b,g){var f=Number.MAX_VALUE,a=-Number.MAX_VALUE,h=e-this.level;if(c>>h===this.i&&b>>h===this.j&&0<h){e=this.samplerData.width-1;var l=e/Math.pow(2,h);c-=this.i<<h;b-=this.j<<h;for(h=b*l;h<=(b+1)*l;h++)for(var d=c*l;d<=(c+1)*l;d++){var m=this.samplerData.pixelData[h+d*(e+1)];m!==k.ELEVATION_NODATA_VALUE&&(f=Math.min(f,m),a=Math.max(a,m))}}g[0]=f===Number.MAX_VALUE?this.samplerData.minValue:f;g[1]=a===-Number.MAX_VALUE?this.samplerData.maxValue:
a};h.createFromLERC=function(e,c,b,g){b=n.decode(b,{noDataValue:k.ELEVATION_NODATA_VALUE});e=new h(e[0],e[1],e[2],c);e.samplerData={pixelData:b.pixelData,width:b.width,height:b.height,minValue:b.minValue,maxValue:b.maxValue,noDataValue:b.noDataValue,safeWidth:0.99999999*(b.width-1),dx:(b.width-1)/(e.extent[2]-e.extent[0]),dy:(b.width-1)/(e.extent[3]-e.extent[1]),x0:e.extent[0],y1:e.extent[3]};e.bounds=[e.samplerData.minValue,-3E38<e.samplerData.maxValue?e.samplerData.maxValue:0];return e};return h}()})},
"esri/layers/support/rasterFormats/LercCodec":function(){define([],function(){var s={defaultNoDataValue:-3.4027999387901484E38,decode:function(n,k){var h;k=k||{};var e=k.inputOffset||0,c=k.encodedMaskData||null===k.encodedMaskData,b={},g=new Uint8Array(n,e,10);b.fileIdentifierString=String.fromCharCode.apply(null,g);if("CntZImage"!=b.fileIdentifierString.trim())throw"Unexpected file identifier string: "+b.fileIdentifierString;var e=e+10,f=new DataView(n,e,24);b.fileVersion=f.getInt32(0,!0);b.imageType=
f.getInt32(4,!0);b.height=f.getUint32(8,!0);b.width=f.getUint32(12,!0);b.maxZError=f.getFloat64(16,!0);e+=24;if(!c)if(f=new DataView(n,e,16),b.mask={},b.mask.numBlocksY=f.getUint32(0,!0),b.mask.numBlocksX=f.getUint32(4,!0),b.mask.numBytes=f.getUint32(8,!0),b.mask.maxValue=f.getFloat32(12,!0),e+=16,0<b.mask.numBytes){var c=new Uint8Array(Math.ceil(b.width*b.height/8)),f=new DataView(n,e,b.mask.numBytes),g=f.getInt16(0,!0),a=2,r=0;do{if(0<g)for(;g--;)c[r++]=f.getUint8(a++);else for(var l=f.getUint8(a++),
g=-g;g--;)c[r++]=l;g=f.getInt16(a,!0);a+=2}while(a<b.mask.numBytes);if(-32768!==g||r<c.length)throw"Unexpected end of mask RLE encoding";b.mask.bitset=c;e+=b.mask.numBytes}else 0===(b.mask.numBytes|b.mask.numBlocksY|b.mask.maxValue)&&(c=new Uint8Array(Math.ceil(b.width*b.height/8)),b.mask.bitset=c);f=new DataView(n,e,16);b.pixels={};b.pixels.numBlocksY=f.getUint32(0,!0);b.pixels.numBlocksX=f.getUint32(4,!0);b.pixels.numBytes=f.getUint32(8,!0);b.pixels.maxValue=f.getFloat32(12,!0);e+=16;c=b.pixels.numBlocksX;
g=b.pixels.numBlocksY;c+=0<b.width%c?1:0;g+=0<b.height%g?1:0;b.pixels.blocks=Array(c*g);a=1E9;for(l=r=0;l<g;l++)for(var d=0;d<c;d++){var m=0,f=new DataView(n,e,Math.min(10,n.byteLength-e)),p={};b.pixels.blocks[r++]=p;var t=f.getUint8(0);m++;p.encoding=t&63;if(3<p.encoding)throw"Invalid block encoding ("+p.encoding+")";if(2===p.encoding)e++,a=Math.min(a,0);else{if(0!==t&&2!==t){t>>=6;p.offsetType=t;if(2===t)p.offset=f.getInt8(1),m++;else if(1===t)p.offset=f.getInt16(1,!0),m+=2;else if(0===t)p.offset=
f.getFloat32(1,!0),m+=4;else throw"Invalid block offset type";a=Math.min(p.offset,a);if(1===p.encoding)if(t=f.getUint8(m),m++,p.bitsPerPixel=t&63,t>>=6,p.numValidPixelsType=t,2===t)p.numValidPixels=f.getUint8(m),m++;else if(1===t)p.numValidPixels=f.getUint16(m,!0),m+=2;else if(0===t)p.numValidPixels=f.getUint32(m,!0),m+=4;else throw"Invalid valid pixel count type";}e+=m;if(3!=p.encoding)if(0===p.encoding){f=(b.pixels.numBytes-1)/4;if(f!==Math.floor(f))throw"uncompressed block has invalid length";
m=new ArrayBuffer(4*f);t=new Uint8Array(m);t.set(new Uint8Array(n,e,4*f));m=new Float32Array(m);for(t=0;t<m.length;t++)a=Math.min(a,m[t]);p.rawData=m;e+=4*f}else 1===p.encoding&&(f=Math.ceil(p.numValidPixels*p.bitsPerPixel/8),m=Math.ceil(f/4),m=new ArrayBuffer(4*m),t=new Uint8Array(m),t.set(new Uint8Array(n,e,f)),p.stuffedData=new Uint32Array(m),e+=f)}}b.pixels.minValue=a;b.eofOffset=e;var e=null!=k.noDataValue?k.noDataValue:s.defaultNoDataValue,g=k.encodedMaskData,m=k.returnMask,a=0,r=b.pixels.numBlocksX,
l=b.pixels.numBlocksY,d=Math.floor(b.width/r),p=Math.floor(b.height/l),f=2*b.maxZError,g=g||(b.mask?b.mask.bitset:null),x,c=new (k.pixelType||Float32Array)(b.width*b.height);m&&g&&(x=new Uint8Array(b.width*b.height));for(var m=new Float32Array(d*p),v,u,t=0;t<=l;t++){var z=t!==l?p:b.height%l;if(0!==z)for(var w=0;w<=r;w++){var C=w!==r?d:b.width%r;if(0!==C){var A=t*b.width*p+w*d,y=b.width-C,B=b.pixels.blocks[a],D,F;if(2>B.encoding){if(0===B.encoding)D=B.rawData;else{D=B.stuffedData;F=B.bitsPerPixel;
v=B.numValidPixels;u=B.offset;var H=f,N=m,G=b.pixels.maxValue,O=(1<<F)-1,M=0,I=void 0,Z=0,V=void 0,L=void 0,Y=Math.ceil((G-u)/H),I=4*D.length-Math.ceil(F*v/8);D[D.length-1]<<=8*I;for(I=0;I<v;I++)0===Z&&(L=D[M++],Z=32),Z>=F?(V=L>>>Z-F&O,Z-=F):(Z=F-Z,V=(L&O)<<Z&O,L=D[M++],Z=32-Z,V+=L>>>Z),N[I]=V<Y?u+V*H:G;D=m}F=0}else h=2===B.encoding?0:B.offset;var E;if(g)for(u=0;u<z;u++){A&7&&(E=g[A>>3],E<<=A&7);for(v=0;v<C;v++)A&7||(E=g[A>>3]),E&128?(x&&(x[A]=1),c[A++]=2>B.encoding?D[F++]:h):(x&&(x[A]=0),c[A++]=
e),E<<=1;A+=y}else if(2>B.encoding)for(u=0;u<z;u++){for(v=0;v<C;v++)c[A++]=D[F++];A+=y}else for(u=0;u<z;u++){for(v=0;v<C;v++)c[A++]=h;A+=y}if(1===B.encoding&&F!==B.numValidPixels)throw"Block and Mask do not match";a++}}}h=x;x={width:b.width,height:b.height,pixelData:c,minValue:b.pixels.minValue,maxValue:b.pixels.maxValue,noDataValue:e};h&&(x.maskData=h);k.returnEncodedMask&&b.mask&&(x.encodedMaskData=b.mask.bitset?b.mask.bitset:null);if(k.returnFileInfo&&(x.fileInfo=q(b),k.computeUsedBitDepths)){h=
x.fileInfo;E=b.pixels.numBlocksX*b.pixels.numBlocksY;D={};for(F=0;F<E;F++)e=b.pixels.blocks[F],0===e.encoding?D.float32=!0:1===e.encoding?D[e.bitsPerPixel]=!0:D[0]=!0;b=Object.keys(D);h.bitDepths=b}return x}},q=function(n){return{fileIdentifierString:n.fileIdentifierString,fileVersion:n.fileVersion,imageType:n.imageType,height:n.height,width:n.width,maxZError:n.maxZError,eofOffset:n.eofOffset,mask:n.mask?{numBlocksX:n.mask.numBlocksX,numBlocksY:n.mask.numBlocksY,numBytes:n.mask.numBytes,maxValue:n.mask.maxValue}:
null,pixels:{numBlocksX:n.pixels.numBlocksX,numBlocksY:n.pixels.numBlocksY,numBytes:n.pixels.numBytes,maxValue:n.pixels.maxValue,minValue:n.pixels.minValue,noDataValue:this.noDataValue}}};return s})},"esri/views/3d/terrain/PlanarTile":function(){define("./TileBase ./TileGeometryFactory ./TerrainConst ../support/ObjectPool ../support/mathUtils ../lib/glMatrix".split(" "),function(s,q,n,k,h,e){var c=e.vec3d.createFrom(0,0,1);e=function(b,g,f,a){s.call(this);this.tileUp=c;void 0!==b&&this.init(b,g,f,
a)};e.prototype=new s;e.prototype.constructor=e;e.prototype.init=function(b,c,f,a){s.prototype.init.call(this,b,c,f,a);a.getExtent(b[0],b[1],b[2],this.extent,this.extentWGS84Rad);this.edgeLen=this.extent[2]-this.extent[0];this.centerAtSeaLevel[0]=h.lerp(this.extent[0],this.extent[2],0.5);this.centerAtSeaLevel[1]=h.lerp(this.extent[1],this.extent[3],0.5);this.centerAtSeaLevel[2]=0;this.updateRadiusAndCenter()};e.prototype.updateRadiusAndCenter=function(){s.prototype.updateRadiusAndCenter.call(this);
var b=(this.extent[2]-this.extent[0])*Math.SQRT1_2,c=0.5*(this.elevationBounds[0]-this.elevationBounds[1]);this.radius=Math.sqrt(b*b+c*c)};e.prototype.isVisible=function(b){if(!this.intersectsClippingArea)return!1;var c=this.extent[0],f=this.extent[1],a=this.elevationBounds[0],e=this.extent[2],l=this.extent[3],d=this.elevationBounds[1];return 0<b[0][0]*(0<b[0][0]?c:e)+b[0][1]*(0<b[0][1]?f:l)+b[0][2]*(0<b[0][2]?a:d)+b[0][3]||0<b[1][0]*(0<b[1][0]?c:e)+b[1][1]*(0<b[1][1]?f:l)+b[1][2]*(0<b[1][2]?a:d)+
b[1][3]||0<b[2][0]*(0<b[2][0]?c:e)+b[2][1]*(0<b[2][1]?f:l)+b[2][2]*(0<b[2][2]?a:d)+b[2][3]||0<b[3][0]*(0<b[3][0]?c:e)+b[3][1]*(0<b[3][1]?f:l)+b[3][2]*(0<b[3][2]?a:d)+b[3][3]||0<b[4][0]*(0<b[4][0]?c:e)+b[4][1]*(0<b[4][1]?f:l)+b[4][2]*(0<b[4][2]?a:d)+b[4][3]||0<b[5][0]*(0<b[5][0]?c:e)+b[5][1]*(0<b[5][1]?f:l)+b[5][2]*(0<b[5][2]?a:d)+b[5][3]?!1:!0};e.prototype._numSubdivisionsAtLevel=[2,2,2,2,2,2,2,2];e.prototype.createGeometry=function(b,c,f){b.needsUpdate=!1;return q.createPlanarGlobeTile(b.numVertsPerRow,
this.extent,b.samplerData,c,f,b.clippingArea)};e.prototype.elevationStartsAtLevel=n.Planar.ELEVATION_STARTS_AT_LEVEL;k.on(e,400);return e})},"esri/views/3d/terrain/TilemapOnlyTile":function(){define(["./TerrainConst","./TileBase"],function(s,q){var n=function(k){this.lij=k;this.layerInfo=Array(s.LayerClass.LAYER_CLASS_COUNT)};n.prototype.tileDataAvailable=q.prototype.tileDataAvailable;n.prototype.modifyLayers=function(k,h,e){k=h.length;for(var c=this.layerInfo[e],b=Array(k),g=0;g<k;g++){var f=h[g];
b[g]=-1<f?c[f]:{tilemapData:null,tilemapRequest:null,pendingUpdates:0}}this.layerInfo[e]=b};return n})},"esri/views/3d/terrain/MapTileAgent":function(){define(["./TileAgentBase","./TileUtils","./UpsampleInfo","../support/ObjectPool"],function(s,q,n,k){var h=function(){s.apply(this,arguments)};h.prototype=new s;h.prototype.constructor=h;h.prototype.dataArrived=function(e){e!==this.tile?this._setUpsamplingTile(e):this.tile.updateTexture();this._dataRequested=null;e!==this.tile&&this._requestNext()};
h.prototype._findNextDownload=function(){var e,c=this.layerIdx,b=this.layerClass,g=this.tile.parentSurface.layerViewByIndex(c,b),f=g.minDataLevel,a=g.maxDataLevel;if(this._tileLayerInfo.data||f>this.tile.lij[0])e=null;else{for(var h=0,l=this.tile,d=this.tile.parentSurface,m=d.getTilemapTile(l),d=d.tilemapStats,p=!1;l&&4>=h&&q.fallsWithinLayer(l,g,!1)&&l.lij[0]>=f;){if(l.layerInfo[b][c].data){this._setUpsamplingTile(l);break}m&&!m.tileDataAvailable(l,c,b)?p=!0:l.lij[0]<=a&&(e=l);l=l.parent;m=m?m.parent:
null;h++}!e&&p&&d.tilesNotPresent++}return e};h.prototype._setUpsamplingTile=function(e){this._tileLayerInfo.upsampleFromTile&&this._tileLayerInfo.upsampleFromTile.tile===e||(this._tileLayerInfo.upsampleFromTile&&n.Pool.release(this._tileLayerInfo.upsampleFromTile),this._tileLayerInfo.upsampleFromTile=q.computeUpsampleInfoForAncestor(this.tile,e),this.tile.updateTexture())};k.on(h,400);return h})},"esri/views/3d/terrain/TileAgentBase":function(){define(["./UpsampleInfo"],function(s){var q=Error("Abstract method called on TileAgentBase"),
n=function(){};n.prototype.init=function(h,e,c,b){this.tile=h;this.layerIdx=e;this.layerClass=c;this._tileLayerInfo=h.getLayerInfo(e,c);this._dataRequested=null;this.suspended=b;if(!h.data)return(h=this._findAncestorWithData())?(this._setUpsamplingTile(h.tile),s.Pool.release(h)):(this._tileLayerInfo.upsampleFromTile&&s.Pool.release(this._tileLayerInfo.upsampleFromTile),this._tileLayerInfo.upsampleFromTile=null),this._requestNext(!0)};n.prototype.dispose=function(){this._dataRequested&&(this._dataRequested.unrequestLayerData(this.layerIdx,
this.layerClass,this),this._dataRequested=null);this._tileLayerInfo=this.tile=null};n.prototype.setSuspension=function(h){h!==this.suspended&&((this.suspended=h)?this._dataRequested&&(this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this),this._dataRequested=null):this._tileLayerInfo.data||this.update())};n.prototype.update=function(){var h=this._findAncestorWithData();h&&this._tileLayerInfo.upsampleFromTile&&h.tile!==this._tileLayerInfo.upsampleFromTile.tile?this._setUpsamplingTile(h.tile):
h&&s.Pool.release(h);return this._requestNext()};n.prototype.dataArrived=function(h){throw q;};n.prototype.dataMissing=function(h){this._dataRequested=null;this._agentDone()};n.prototype._agentDone=function(){this.tile.agentDone(this.layerIdx,this.layerClass);this.dispose()};n.prototype._requestNext=function(h){if(this.suspended)return!0;var e=this._findNextDownload();if(this._dataRequested){if(e===this._dataRequested)return!0;this._dataRequested.unrequestLayerData(this.layerIdx,this.layerClass,this);
this._dataRequested=null}e?e.requestLayerData(this.layerIdx,this.layerClass,this)&&(this._dataRequested=e):h||this._agentDone();return!!this._dataRequested};n.prototype._findAncestorWithData=function(){return k(this.tile,this.layerIdx,this.layerClass,1,0,0,0)};var k=function(h,e,c,b,g,f,a){if(!h.parent||6<a)return null;b*=0.5;g*=0.5;f*=0.5;h.lij[2]&1&&(g+=0.5);0===(h.lij[1]&1)&&(f+=0.5);return h.parent.hasLayerData(e,c)?(e=s.Pool.acquire(),e.init(h.parent,g,f,b),e):k(h.parent,e,c,b,g,f,a+1)};n.prototype._findNextDownload=
function(){throw q;};return n})},"esri/views/3d/terrain/ElevationTileAgent":function(){define(["./TileAgentBase","./TerrainConst","./UpsampleInfo","../support/ObjectPool"],function(s,q,n,k){var h=function(){s.apply(this,arguments)};h.prototype=new s;h.prototype.constructor=h;h.prototype.dataArrived=function(e){e!==this.tile?this._setUpsamplingTile(e):this.updateGeometry();this._dataRequested=null;this._requestNext()};h.prototype.updateGeometry=function(){this._tileLayerInfo.pendingUpdates|=q.TileUpdateTypes.UPDATE_GEOMETRY;
this.tile.updateGeometry()};h.prototype._findAncestorWithData=function(){if(this.tile.lij[0]<this.tile.elevationStartsAtLevel)return null;for(var e=this.layerClass,c=this.layerIdx,b=this.tile,g=b.vlevel,f;b&&(!b.layerInfo[e][c].data||!(f=b,g-b.lij[0]>=q.ELEVATION_DESIRED_RESOLUTION_LEVEL));)b=b.parent;return f?(e=n.Pool.acquire(),e.init(f,0,0,1),e):null};h.prototype._findNextDownload=function(){var e,c=this.layerIdx,b=this.layerClass,g=this.tile.parentSurface.layerViewByIndex(c,b),f=g.minDataLevel,
g=g.maxDataLevel,a=q.ELEVATION_DESIRED_RESOLUTION_LEVEL-(this.tile.vlevel-this.tile.lij[0]),h=4+a;if(this._tileLayerInfo.data||this.tile.lij[0]<Math.max(f,this.tile.elevationStartsAtLevel))e=null;else{for(var l=this.tile,d=l.lij[0],m=0,p=this._tileLayerInfo.upsampleFromTile?this._tileLayerInfo.upsampleFromTile.tile.lij[0]:-1,k=this.tile.parentSurface,n=k.getTilemapTile(l),k=k.tilemapStats,v=!1;l&&m<=h&&l.lij[0]>=f;){if(l.layerInfo[this.layerClass][this.layerIdx].data&&d-l.lij[0]>=a){l.lij[0]>p&&this._setUpsamplingTile(l);
break}n&&!n.tileDataAvailable(l,c,b)?(v=!0,e=null):l.lij[0]<=g&&(e=l);l=l.parent;n=n?n.parent:null;m++}e&&(d-e.lij[0]<a&&this._tileLayerInfo.upsampleFromTile)&&(e=null);!e&&v&&k.tilesNotPresent++}return e};h.prototype._setUpsamplingTile=function(e){this._tileLayerInfo.upsampleFromTile&&n.Pool.release(this._tileLayerInfo.upsampleFromTile);var c=n.Pool.acquire();c.init(e,0,0,1);this._tileLayerInfo.upsampleFromTile=c;this.tile.updateElevationBounds();this.updateGeometry()};k.on(h,400);return h})},"esri/views/3d/layers/graphics/LabelManager":function(){define("../../../../core/declare ../../support/PreallocArray ../../lib/glMatrix ../../support/eventUtils ../../webgl-engine/lib/Util ../../webgl-engine/materials/HUDMaterial".split(" "),
function(s,q,n,k,h,e){function c(a,b){return b.posView-a.posView}var b=n.mat4d,g=n.vec3d,f=n.vec2d,a=n.vec4d,r=h.lerp,l=h.VertexAttrConstants,d=[[-1,-1],[1,-1],[1,1],[-1,1]],m=a.create(),p=a.create(),t=a.create(),x=a.create(),v=f.create(),u=f.create(),z=a.create(),w=a.create(),C=a.create(),A=g.create(),y=f.create(),B=a.create(),D=g.create(),F=g.create(),H=b.create(),N=g.create(),G=a.create(),O=new q(100);n=function(a,b){this.constructor=a;this.releaser=b;this.list=[];this.currentIndex=0};n.prototype.alloc=
function(){this.currentIndex>=this.list.length&&this.list.push(this.constructor.apply(this,arguments));return this.list[this.currentIndex++]};n.prototype.freeAll=function(a){a=this.currentIndex;for(var b=this.releaser,c=this.list;0<=--a;)b(c[a]);this.currentIndex=0};var M=new n(function(){return{labelGraphics:null,c3dGraphic:null,positions:[f.create(),f.create(),f.create(),f.create()],xMin:0,xMax:0,yMin:0,yMax:0,posView:0,layerView:null,labelId:0}},function(a){a.layerGraphics=null;a.c3dGraphic=null;
a.layerView=null});return s(null,{constructor:function(a){this.layerViews=[];this.view=a;this.stage=a._stage;this._deconflictTimeoutId=0;this._cameraListener=k.on(a,"navigation.targetViewChanged",this._targetViewChanged,this);this._viewReadyWatcher=a.watch("ready",function(a){!a&&this._deconflictTimeoutId&&(clearTimeout(this._deconflictTimeoutId),this._deconflictTimeoutId=0)}.bind(this))},destroy:function(){this._cameraListener.remove();0!==this._deconflictTimeoutId&&(clearTimeout(this._deconflictTimeoutId),
this._deconflictTimeoutId=0);this._viewReadyWatcher.remove()},addSceneServiceLayerView:function(a){this.layerViews.push(a)},setDirty:function(){this._deconflictLabelsTimeout(10)},setInitialLabelGraphicState:function(a){a.setVisibilityFlag("VISIBILITY_LABELMANAGER",!1)},removeSceneServiceLayerView:function(a){a=this.layerViews.indexOf(a);0<=a&&this.layerViews.splice(a,1)},_drawPoly:function(a,b,c){a.beginPath();a.lineWidth="1";a.strokeStyle=c;a.moveTo(b[0][0],b[0][1]);for(c=1;4>c;c++)a.lineTo(b[c][0],
b[c][1]),a.stroke();a.lineTo(b[0][0],b[0][1]);a.stroke();a.closePath()},_tmp_vec:f.create(),_doesIntersectExistingPoly:function(a){var b=this._tmp_vec,c=a.positions,d={},g,e,m,l,h,p,k,r,n,t,u,q,B,x;for(g=Math.floor(a.xMin/this._accBinsSizeX);g<=Math.floor(a.xMax/this._accBinsSizeX);g++)if(!(0>g||g>=this._accBinsNumX))for(e=Math.floor(a.yMin/this._accBinsSizeY);e<=Math.floor(a.yMax/this._accBinsSizeY);e++)if(!(0>e||e>=this._accBinsNumY)){m=this._accBins[g][e];l=0;a:for(;l<m.length;l++)if(h=m.data[l],
null==d[h.labelId]){d[h.labelId]=!0;h=h.positions;this._accNumTests++;for(r=0;2>r;r++){p=0===r?c:h;k=0===r?h:c;B=0;b:for(;4>B;B++){n=p[B];t=p[(B+1)%4];u=p[(B+2)%4];b[0]=t[0]-n[0];b[1]=t[1]-n[1];t=f.normalize(b);q=t[1];t[1]=t[0];t[0]=-q;q=t[0]*n[0]+t[1]*n[1];x=t[0]*u[0]+t[1]*u[1]<q;for(n=0;4>n;n++)if(u=k[n],u=t[0]*u[0]+t[1]*u[1],x&&u<q||!x&&u>q)continue b;continue a}}return!0}}return!1},_accBinsNumX:15,_accBinsNumY:20,_accBinsSizeX:0,_accBinsSizeY:0,_accBins:null,_accNumTests:0,_initBins:function(a,
b){var c,d,f;if(null==this._accBins){this._accBins=[];for(c=0;c<this._accBinsNumX;c++){this._accBins.push([]);f=this._accBins[this._accBins.length-1];for(d=0;d<this._accBinsNumY;d++)f.push(new q(10))}}for(c=0;c<this._accBinsNumX;c++)for(d=0;d<this._accBinsNumY;d++)this._accBins[c][d].clear();this._accBinsSizeX=a/this._accBinsNumX;this._accBinsSizeY=b/this._accBinsNumY;this._accNumTests=0},_addToBins:function(a){var b,c;for(b=Math.floor(a.xMin/this._accBinsSizeX);b<=Math.floor(a.xMax/this._accBinsSizeX);b++)if(!(0>
b||b>=this._accBinsNumX))for(c=Math.floor(a.yMin/this._accBinsSizeY);c<=Math.floor(a.yMax/this._accBinsSizeY);c++)0>c||c>=this._accBinsNumY||this._accBins[b][c].push(a)},_accDrawDebug:function(a){var b=[f.create(),f.create(),f.create(),f.create()],c=0,d,g,e,m,l,h,p;for(d=0;d<this._accBinsNumX;d++)for(g=0;g<this._accBinsNumY;g++)e=this._accBins[d][g],c+=e.length,m=d*this._accBinsSizeX,l=(d+1)*this._accBinsSizeX,h=g*this._accBinsSizeY,p=(g+1)*this._accBinsSizeY,b[0][0]=m,b[0][1]=h,b[1][0]=l,b[1][1]=
h,b[2][0]=l,b[2][1]=p,b[3][0]=m,b[3][1]=p,a.fillText(e.length.toFixed(),m+5,h+15),this._drawPoly(a,b,"blue");a.fillText("total totalShownLabels: "+c,70,40)},_targetViewChanged:function(){this._deconflictLabelsTimeout()},_deconflictLabelsTimeout:function(a){0===this._deconflictTimeoutId&&(this._deconflictTimeoutId=setTimeout(this._deconflictLabels.bind(this),a||200))},_deconflictLabels:function(){var h=this.view;this._deconflictTimeoutId=0;M.freeAll();var k=h.navigation.targetCamera,n=k.viewMatrix,
q=1/Math.tan(k.fovX/2),s=k.projectionMatrix,E=k.fullWidth,ba=k.fullHeight;O.clear();for(var W={},R=!1,T=0;T<this.layerViews.length;T++){var J=this.layerViews[T];if(null!=J.layerLabelsEnabled&&J.layerLabelsEnabled()&&!(null==J.getGraphics3DGraphics||null==J.getGraphics3DGraphicsKeys)){R||(this._initBins(E,ba),R=!0);for(var S=J.getGraphics3DGraphics(),K=J.getGraphics3DGraphicsKeys(),Q=0;Q<K.length;Q++){var U=S[K[Q]];if(!(null==U._labelGraphics||1>U._labelGraphics.length)&&U.areVisibilityFlagsSet(void 0,
"VISIBILITY_LABELMANAGER")){var X=U._labelGraphics[0],P=X.stageObject,$=P.getGeometryRecord(0);if(null!=$){var ea=$.materials[0];if(!(null==ea||!(ea instanceof e)||null==$.origin)){var h=n,P=P.getCenter(),ca=$.origin.vec3;a.set4(P[0]-ca[0],P[1]-ca[1],P[2]-ca[2],1,m);b.translate(h,ca,H);h=H;b.multiplyVec4(h,m,p);var ha=$.geometry.getData().getVertexAttr()[l.AUXPOS1];if(null!=ha&&0>ha.data[3])for(ca=0;3>ca;ca++)p[ca]+=ha.data[ca];b.multiplyVec4(s,p,t);a.scale(t,1/Math.abs(t[3]),x);f.set2(r(0,E,0.5+
0.5*x[0]),r(0,ba,0.5+0.5*x[1]),y);if(-1>x[0]||-1>x[1]||-1>x[2]||1<=x[0]||1<=x[1]){h=!1;for($=0;$<U._labelGraphics.length;$++)h=h||U._labelGraphics[$].setVisibilityFlag("VISIBILITY_LABELMANAGER",!1);h&&(W[J]=!0)}else{ca=ea.getParams();ea=$.geometry.getData().getVertexAttr()[l.SIZE].data;f.subtract(ca.anchorPos,[0.5,0.5],v);f.scale(ca.screenOffset,0.5,u);$=M.alloc();if(ca.direction){var fa=g.set3(X.geometry.normal[0],X.geometry.normal[1],X.geometry.normal[2],D),ha=g.normalize(g.subtract(k.eye,k.center,
z),z),da=g.normalize(g.set(ca.direction,F)),ga,X=0;g.scale(da,g.dot(da,ha),A);g.subtract(ha,A,A);g.normalize(A);ga=Math.abs(g.dot(A,fa));0.985>Math.abs(g.dot(ha,da))&&0.5>ga?0.422>ga?(ha=da,ga=fa,X=0.5):(ha=da,ga=N,g.cross(da,A,ga),X=g.dot(ga,fa)/2):(ha=da,ga=g.normalize(g.cross(fa,da)));fa=2*(g.dist(k.eye,P)/q/k.width);P=fa*ca.screenMinMaxSize[0];da=fa*ca.screenMinMaxSize[1];ca.worldScale?(fa=1,0<P&&P>ea[1]&&(fa=P/ea[1]),0<da&&ea[1]>da&&(fa=da/ea[1])):fa=0.5*t[3]/E;for(ca=0;4>ca;ca++)a.set(m,G),
g.add(G,g.scale(ha,d[ca][0]*ea[0]*fa,w)),g.add(G,g.scale(ga,(d[ca][1]+X)*ea[1]*fa,C)),b.multiplyVec4(h,G,z),P=b.multiplyVec4(s,z,w),a.scale(P,1/Math.abs(P[3]),P),$.positions[ca][0]=r(0,E,0.5+0.5*P[0]),$.positions[ca][1]=ba-r(0,ba,0.5+0.5*P[1])}else if(ca.worldScale){fa=2*(g.dist(k.eye,P)/q/k.width);P=fa*ca.screenMinMaxSize[0];da=fa*ca.screenMinMaxSize[1];fa=1;0<P&&P>ea[1]&&(fa=P/ea[1]);0<da&&ea[1]>da&&(fa=da/ea[1]);for(ca=0;4>ca;ca++)B[0]=p[0]+(0.5*d[ca][0]-v[0])*ea[0]*fa,B[1]=p[1]+(0.5*d[ca][1]-
v[1])*ea[1]*fa,P=b.multiplyVec4(s,B,z),a.scale(P,1/Math.abs(P[3]),P),$.positions[ca][0]=r(0,E,0.5+0.5*P[0])+u[0],$.positions[ca][1]=ba-r(0,ba,0.5+0.5*P[1])-u[1]}else{h=g.dist(k.eye,m);for(ca=0;4>ca;ca++)$.positions[ca][0]=y[0]+(0.5*d[ca][0]-v[0])*ea[0]+u[0],$.positions[ca][1]=ba-y[1]+(0.5*d[ca][1]+v[1])*ea[1]-u[1]}h=p[2];U.areVisibilityFlagsSet("VISIBILITY_LABELMANAGER",void 0)&&(h*=0.7);$.labelId=O.length;$.xMin=Number.MAX_VALUE;$.yMin=Number.MAX_VALUE;$.xMax=-Number.MAX_VALUE;$.yMax=-Number.MAX_VALUE;
for(ea=0;4>ea;ea++)$.xMin=Math.min($.positions[ea][0],$.xMin),$.yMin=Math.min($.positions[ea][1],$.yMin),$.xMax=Math.max($.positions[ea][0],$.xMax),$.yMax=Math.max($.positions[ea][1],$.yMax);$.labelGraphics=U._labelGraphics;$.c3dGraphic=U;$.posView=h;$.layerView=J;O.push($)}}}}}}}O.sort(c);for(T=0;T<O.length;T++){k=O.data[T];h=!1;J=k.layerView;if(this._doesIntersectExistingPoly(k))for(ca=0;ca<k.labelGraphics.length;ca++)h=h||k.labelGraphics[ca].setVisibilityFlag("VISIBILITY_LABELMANAGER",!1);else{this._addToBins(k);
for(ca=0;ca<k.labelGraphics.length;ca++)h=h||k.labelGraphics[ca].setVisibilityFlag("VISIBILITY_LABELMANAGER",!0)}h&&k.c3dGraphic.isDraped()&&(W[J]=!0);Object.keys(W).forEach(function(a){a.emit&&a.emit("draped-data-change")})}}})})},"esri/views/3d/layers/GraphicsView3D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessoireSupport/typescript ../../layers/GraphicsView ./graphics/Graphics3DCore ./graphics/Graphics3DSpatialIndex ./graphics/Graphics3DSharedResources ./graphics/Graphics3DElevationAlignment ../support/PromiseLightweight".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a){return function(e){function l(a){e.call(this);this.elevation=this.sharedResources=this.spatialIndex=this.graphicsCore=null;this.supportsDraping=!0;this._overlayUpdating=!1;this._progressMaxNumNodes=0;this._eventHandles=null}n(l,e);l.prototype.initialize=function(){var a=this;this.loadedGraphics=this.graphics;this.graphicsCore=new c;this.spatialIndex=new b;this.sharedResources=new g;this.elevation=new f;this.supportsDraping=!0;this._overlayUpdating=!1;this._progressMaxNumNodes=
0;this._eventHandles=[];this.mockLayerId="__sceneView.graphics-"+Date.now().toString(16);var e={id:this.mockLayerId};this.sharedResources.initialize(this.view._stage,this.view.resourceController,null);this.spatialIndex.initialize(this,e,this.view.spatialReference,this.graphicsCore);this.elevation.initialize(this,function(b,c,f){a.spatialIndex.intersects(b,c,f)},this.graphicsCore,this.view.basemapTerrain);this.graphicsCore.initialize(this,e,this.elevation,this.sharedResources,null,this.spatialIndex,
null,null,null,this.view.basemapTerrain);this._eventHandles.push(this.view.watch("clippingArea",function(){return a.updateClippingExtent()}));this.updateClippingExtent();this.view.resourceController.registerIdleFrameWorker(this,{needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate})};l.prototype.destroy=function(){this._eventHandles.forEach(function(a){return a.remove()});this._eventHandles=null;this.view.resourceController.deregisterIdleFrameWorker(this);this.spatialIndex&&(this.spatialIndex.destroy(),
this.spatialIndex=null);this.elevation&&(this.elevation.destroy(),this.elevation=null);this.graphicsCore&&(this.graphicsCore.destroy(),this.graphicsCore=null);this.sharedResources&&(this.sharedResources.destroy(),this.sharedResources=null);this.loadedGraphics=null};l.prototype.getGraphicsFromStageObject=function(b,c){var f=b.getMetadata().graphicId,g=null;this.loadedGraphics&&this.loadedGraphics.some(function(a){return a.id===f?(g=a,!0):!1});var e=new a.Promise;null!==g?e.done(g):e.reject();return e};
l.prototype.whenGraphicBounds=function(a){return this.graphicsCore.whenGraphicBounds(a)};l.prototype._needsIdleUpdate=function(){return this.elevation.needsIdleUpdate()};l.prototype._idleUpdate=function(a){this.elevation.idleUpdate(a)};l.prototype._notifySuspendedChange=function(){};l.prototype._notifyDrapedDataChange=function(){this.view.basemapTerrain&&this.view.basemapTerrain.overlayManager.setOverlayDirty()};l.prototype._evaluateUpdatingState=function(){if(this.elevation){var a;a=0+this.elevation.numNodesUpdating();
a+=this.graphicsCore.numNodesUpdating();this.updating=a=(a=0<a||this._overlayUpdating)||this.spatialIndex.isUpdating()}else this.updating=!1};l.prototype.updateClippingExtent=function(){this.graphicsCore.setClippingExtent(this.view.clippingArea,this.view.spatialReference)&&this.graphicsCore.recreateAllGraphics()};k([h.shared("esri.views.3d.layers.GraphicsView3D")],l.prototype,"declaredClass",void 0);k([h.property({setter:function(a){a!==this.loadedGraphics&&(this.loadedGraphics=a);return a}})],l.prototype,
"graphics",void 0);k([h.property()],l.prototype,"loadedGraphics",void 0);k([h.property({value:!0})],l.prototype,"updating",void 0);k([h.property({value:!1})],l.prototype,"suspended",void 0);return l=k([h.subclass([])],l)}(e)})},"esri/views/layers/GraphicsView":function(){define(["../../core/Accessoire","../../core/declare"],function(s,q){return q([s],{declaredClass:"esri.views.layers.GraphicsView",graphics:null,renderer:null,view:null,getRenderer:function(n){if(!n||n.symbol)return null;var k=this._rndForScale||
this.renderer;n&&(k&&k.getObservationRenderer)&&(k=k.getObservationRenderer(n));return k},getSymbol:function(n){if(n.symbol)return n.symbol;var k=this.getRenderer(n);return k&&k.getSymbol(n)},getRenderingInfo:function(n){var k=this.getRenderer(n),h=this.getSymbol(n);if(!h)return null;h={renderer:k,symbol:h};if(k&&k.visualVariables){var e=this.view.view.state,k=k.getVisualVariableValues(n,{resolution:e.resolution,scale:e.scale});n=["proportional","proportional","proportional"];for(e=0;e<k.length;e++){var c=
k[e],b=c.variable.type;"color"===b?h.color=c.value:"size"===b?c.variable.target?h.outlineSize=c.value:(b=c.variable.axis,c=c.variable.useSymbolValue?"symbolValue":c.value,"width"===b?n[0]=c:"depth"===b?n[1]=c:"height"===b?n[2]=c:n[0]="width-and-depth"===b?n[1]=c:n[1]=n[2]=c):"opacity"===b?h.opacity=c.value:"rotation"===b&&(h.rotationAngle=c.value)}if(isFinite(n[0])||isFinite(n[1])||isFinite(n[2]))h.size=n}return h},_evalSDRenderer:function(n){}})})},"esri/views/3d/layers/graphics/Graphics3DCore":function(){define("require exports ../../../../core/watchUtils ../../../../core/arrayUtils ../../support/projectionUtils ../../../../geometry/Point ../../../../geometry/Extent ../../webgl-engine/Stage ../../webgl-engine/lib/Util ../../webgl-engine/lib/Layer ../../webgl-engine/lib/FloatingBoxLocalOriginFactory ../../lib/glMatrix ../graphics/SymbolConverter ../graphics/Graphics3DGraphic ../graphics/Graphics3DSymbol ../graphics/graphicUtils ../../../../core/Error ../../support/aaBoundingBox ../../support/mathUtils ../../../../core/promiseUtils dojo/Deferred".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u,z){s=r.vec3d;var w=new e,C=s.create(),A=function(){return function(){this.localOriginFactory=this.layer=this.overlaySR=this.renderCoordsHelper=this.renderSpatialReference=this.clippingExtent=this.layerOrder=this.stage=this.renderer=this.elevationProvider=this.streamDataSupplier=this.sharedResources=null}}();return function(){function e(){this.graphics={};this.graphicsDrapedIds={};this.graphicsBySymbol={};this.graphicsKeys=[];this.symbols={};this.computedExtent=
null;this.symbolCreationContext=new A;this.hasDraped=!1;this.updatingGraphicIds={};this.graphicTransformFunc=this.onComputedExtentChange=this.stage=this.labelStageLayer=this.stageLayer=this.tilingSchemeHandle=null;this.eventHandles=[];this.labeling=this.spatialIndex=this.scaleVisibility=this.elevation=this.layer=this.layerView=this.viewSR=null;this.whenGraphics3DGraphicRequests={}}e.prototype.initialize=function(b,c,d,f,g,e,m,l,h,p){var k=this;this.layerView=b;this.layer=c;this.viewSR=b.view.spatialReference;
this.elevation=d;this.scaleVisibility=g;this.spatialIndex=e;this.labeling=m;this.onComputedExtentChange=l;this.graphicTransformFunc=h;this.initializeStage(this.layerView.view,this.layer.id);this.symbolCreationContext.sharedResources=f;this.symbolCreationContext.renderer=this.layer.renderer;this.symbolCreationContext.stage=this.stage;this.symbolCreationContext.streamDataSupplier=f.streamDataSupplier;this.symbolCreationContext.renderSpatialReference=this.layerView.view.renderSpatialReference;this.symbolCreationContext.renderCoordsHelper=
this.layerView.view.renderCoordsHelper;this.symbolCreationContext.layer=this.layer;this.symbolCreationContext.layerOrder=0;this.symbolCreationContext.localOriginFactory=new a(5E6,16);this.symbolCreationContext.elevationProvider=p;this.tilingSchemeHandle=n.when(p,"tilingScheme",function(a){a.spatialReference.equals(k.symbolCreationContext.overlaySR)||(k.symbolCreationContext.overlaySR=p.spatialReference,k.recreateAllGraphics())});this.eventHandles.push(this.layerView.watch("suspended",function(){return k.suspendedChange()}));
this.eventHandles.push(n.on(b,"loadedGraphics","change",function(a){return k.graphicsCollectionChanged(a)},function(){k.clearSymbolsAndGraphics();k.graphicsCollectionChanged({added:k.layerView.loadedGraphics.toArray(),removed:[]})}))};e.prototype.destroy=function(){var a=this;this.clear();if(this.stage){var c=[this.stageLayer.getId()];this.labelStageLayer&&c.push(this.labelStageLayer.getId());this.stage.removeFromViewContent(c);c.forEach(function(c){return a.stage.remove(b.ModelContentType.LAYER,
c)});this.stage=this.labelStageLayer=this.stageLayer=null}this.tilingSchemeHandle&&(this.tilingSchemeHandle.remove(),this.tilingSchemeHandle=null);this.eventHandles.forEach(function(a){return a.remove()});this.layerView=this.labeling=this.scaleVisibility=this.viewSR=this.onComputedExtentChange=this.eventHandles=null;for(var d in this.whenGraphics3DGraphicRequests)this.whenGraphics3DGraphicRequests[d].reject(new t("graphic:layer-destroyed","Layer has been destroyed"));this.whenGraphics3DGraphicRequests=
null};e.prototype.clear=function(){var a=!1,b;for(b in this.graphics)a=a||this.graphics[b].isDraped(),this.graphics[b].destroy();this.graphics={};this.graphicsKeys=null;for(var c in this.symbols)this.symbols[c].destroy();this.symbols={};this.graphicsBySymbol={};this.hasDraped=!1;a&&this.layerView._notifyDrapedDataChange()};e.prototype.initializeStage=function(a,c){this.stage=a._stage;this.stageLayer=new f(c,{state:this.layerView.suspended?"HIDDEN":"VISIBLE"},c);this.stage.add(b.ModelContentType.LAYER,
this.stageLayer);var d=[this.stageLayer.getId()];this.labeling&&(this.labelStageLayer=new f(c,{state:this.layerView.suspended?"HIDDEN":"IGNORED"},c+"_labels"),this.stage.add(b.ModelContentType.LAYER,this.labelStageLayer),d.push(this.labelStageLayer.getId()));this.stage.addToViewContent(d)};e.prototype.setDrawingOrder=function(a){this.symbolCreationContext.layerOrder=a;var b={},c={},d;for(d in this.graphics)this.graphics[d].setDrawOrder(a,b,c);for(var f in c)this.symbols[f].setDrawOrder(a,b);g.objectEmpty(b)||
(this.stage.getTextureGraphicsRenderer().updateRenderOrder(b),this.layerView._notifyDrapedDataChange())};e.prototype.suspendedChange=function(){!0===this.layerView.suspended?(this.stageLayer.setState("HIDDEN"),this.labelStageLayer&&this.labelStageLayer.setState("HIDDEN"),this.hideAllGraphics()):!1===this.layerView.suspended&&(this.stageLayer.setState("VISIBLE"),this.labelStageLayer&&this.labelStageLayer.setState("IGNORED"),this.updateAllGraphicsVisibility())};e.prototype.getGraphics3DGraphics=function(){return this.graphics};
e.prototype.getGraphics3DGraphicById=function(a){return this.graphics[a]};e.prototype.getGraphics3DGraphicsKeys=function(){null===this.graphicsKeys&&(this.graphicsKeys=Object.keys(this.graphics));return this.graphicsKeys};e.prototype.numNodesUpdating=function(){return Object.keys(this.updatingGraphicIds).length};e.prototype.whenGraphics3DGraphic=function(a){var b=this.graphics[a.id];if(b)return u.resolve(b);b=this.whenGraphics3DGraphicRequests[a.id];b||(b=new z,this.whenGraphics3DGraphicRequests[a.id]=
b);return b};e.prototype.boundsForGraphics3DGraphic=function(a,b){void 0===b&&(b=x.create());var c=this.layerView.view.spatialReference,d=this.layerView.view.renderSpatialReference,f=this.layerView.view.basemapTerrain.spatialReference,g=a.getProjectedBoundingBox(function(a,b,f){return h.bufferToBuffer(a,d,b,a,c,b,f)},function(a,b,d){return h.bufferToBuffer(a,f,b,a,c,b,d)},b);if(!g)return null;var e=a.isDraped(),m=this.symbolCreationContext.elevationProvider;e&&m&&(x.center(g,C),w.x=C[0],w.y=C[1],
w.z=void 0,w.spatialReference=c,e=m.getElevation(w)||0,g[2]=Math.min(g[2],e),g[5]=Math.max(g[5],e));return g};e.prototype.whenGraphicBounds=function(a){var b=this;return n.whenOnce(this.layerView,"loadedGraphics").then(function(){if(b.layerView.loadedGraphics.some(function(b){return b===a}))return b.whenGraphics3DGraphic(a);throw new t("internal:graphic-not-part-of-view","Graphic is not part of this view");}).then(function(a){return b.boundsForGraphics3DGraphic(a)})};e.prototype.graphicsCollectionChanged=
function(a){var b=this.graphicTransformFunc?this.graphicTransformFunc(a.added):a.added;this.add(b);this.remove(a.removed)};e.prototype.graphicUpdateHandler=function(a){var b=this.graphics[a.graphic.id];if(b)switch(a.property){case "visible":b.setVisibilityFlag("VISIBILITY_GRAPHIC",a.newValue)&&(b.isDraped()&&this.layerView._notifyDrapedDataChange(),this.labeling&&this.layerView.view.labelManager.setDirty())}};e.prototype.beginGraphicUpdate=function(a){this.updatingGraphicIds[a.id]=!0;this.layerView.get("symbols-updating")||
this.layerView.set("symbols-updating",!0);this.layerView._evaluateUpdatingState()};e.prototype.endGraphicUpdate=function(a){a&&delete this.updatingGraphicIds[a.id];this.layerView.get("symbols-updating")&&g.objectEmpty(this.updatingGraphicIds)&&(this.layerView.view.flushDisplayModifications(),this.layerView.set("symbols-updating",!1));this.layerView._evaluateUpdatingState()};e.prototype.expandComputedExtent=function(a){var b,d,f,g,m,l;if("point"===a.type)b=d=a.x,f=g=a.y,a.z&&(m=l=a.z);else if("polygon"===
a.type){l=a.extent;if(!l)return;b=l.xmin;d=l.xmax;f=l.ymin;g=l.ymax;m=l.zmin;l=l.zmax}var p=this.viewSR,k=e.tmpVec;!a.spatialReference.equals(p)&&h.xyzToVector(b,f,0,a.spatialReference,k,p)&&(b=k[0],f=k[1],h.xyzToVector(d,g,0,a.spatialReference,k,p),d=k[0],g=k[1]);v.isFinite(b)&&(v.isFinite(d)&&v.isFinite(f)&&v.isFinite(g))&&((p=this.computedExtent)?(p.xmin=Math.min(b,p.xmin),p.xmax=Math.max(d,p.xmax),p.ymin=Math.min(f,p.ymin),p.ymax=Math.max(g,p.ymax)):this.computedExtent=p=new c(b,f,d,g,a.spatialReference),
v.isFinite(m)&&!v.isFinite(l)&&(p.zmin=null!=p.zmin?Math.min(m,p.zmin):m,p.zmax=null!=p.zmax?Math.max(l,p.zmax):l),this.onComputedExtentChange&&this.onComputedExtentChange())};e.prototype.updateHasDraped=function(){this.hasDraped=!1;for(var a in this.graphicsDrapedIds)if(this.graphicsDrapedIds.hasOwnProperty(a)){this.hasDraped=!0;break}};e.prototype.elevationInfoChange=function(){this.labeling&&this.labeling.elevationInfoChange();for(var a in this.graphicsBySymbol){var b=this.graphicsBySymbol[a];
if(this.symbols[a].layerPropertyChanged("elevationInfo",b))for(var c in b)for(var d=b[c],f=d.graphic,d=d._labelGraphics,g=0;g<d.length;g++){var e=d[g];e.graphics3DSymbolLayer.updateGraphicElevationInfo(f,e)}else this.recreateSymbol(a)}};e.prototype.clearSymbolsAndGraphics=function(){this.clear();this.elevation&&this.elevation.clear();this.labeling&&this.labeling.clear()};e.prototype.recreateAllGraphics=function(){this.clearSymbolsAndGraphics();this.computedExtent=null;this.onComputedExtentChange&&
this.onComputedExtentChange();this.layerView.loadedGraphics&&this.layerView.view.basemapTerrain.tilingScheme&&this.add(this.layerView.loadedGraphics.toArray())};e.prototype.recreateSymbol=function(a){var b=this.graphicsBySymbol[a],c=[],d=!1,f;for(f in b){var g=b[f];g.isDraped()&&(delete this.graphicsDrapedIds[f],d=!0);c.push(g.graphic);g.destroy();this.graphics[f]=null}this.graphicsBySymbol[a]={};this.symbols[a].destroy();this.symbols[a]=null;this.updateHasDraped();d&&this.layerView._notifyDrapedDataChange();
this.add(c)};e.prototype.add=function(a){if(this.layerView.view.basemapTerrain.tilingScheme){for(var b=a.length,c=Array(b),d=Array(b),f=Array(b),g=0;g<b;g++){var e=a[g],m=e.geometry;if(m&&(this.expandComputedExtent(m),(m=this.layerView.getRenderingInfo?this.layerView.getRenderingInfo(e):{symbol:e.symbol})&&m.symbol))if(d[g]=m.symbol,f[g]=m,m=this.getOrCreateGraphics3DSymbol(d[g],m.renderer))c[g]=m,this.beginGraphicUpdate(e)}for(g=0;g<b;g++)this.waitForSymbol(c[g],d[g],a[g],f[g])}};e.prototype.waitForSymbol=
function(a,b,c,d){var f=this;a&&a.then(function(){f.graphicsBySymbol[b.id]||(f.graphicsBySymbol[b.id]={});f.createGraphics3DGraphic(a,c,d);f.endGraphicUpdate(c);f.labeling&&f.layerView.view.labelManager.setDirty()},function(){f.endGraphicUpdate(c)})};e.prototype.remove=function(a){for(var b=!1,c=a.length,d=0;d<c;d++){var f=a[d].id,g=this.graphics[f];if(g){g.isDraped()&&(delete this.graphicsDrapedIds[f],b=!0);var e=g.graphics3DSymbol.symbol.id;g.destroy();delete this.graphics[f];delete this.graphicsBySymbol[e][f];
this.graphicsKeys=null}}this.updateHasDraped();b&&this.layerView._notifyDrapedDataChange();this.labeling&&this.layerView.view.labelManager.setDirty()};e.prototype.getOrCreateGraphics3DSymbol=function(a,b){var c=this.symbols[a.id];if(!c){var d=l.toWeb3DSymbol(a,!0,!1);if(d){c=void 0;if(b&&b.backgroundFillSymbol){var f=l.toWeb3DSymbol(b.backgroundFillSymbol,!1,!0);f&&(c=f.symbolLayers)}c=new m(d,this.symbolCreationContext,c);this.symbols[a.id]=c}}return c};e.prototype.createGraphics3DGraphic=function(a,
b,c){if(!this.graphics[b.id]&&(c=a.createGraphics3DGraphic(b,c),this.labeling&&this.labeling.layerLabelsEnabled()&&(c=this.labeling.createLabelsForGraphic(b,c)),this.graphics[b.id]=c,this.graphicsKeys=null,this.graphicsBySymbol[a.symbol.id][b.id]=c,c.initialize(this.stageLayer,this.labelStageLayer,this.stage),c.isDraped()&&(this.hasDraped=this.graphicsDrapedIds[b.id]=!0,this.layerView._notifyDrapedDataChange()),c.centroid=null,"point"!==b.geometry.type&&c instanceof d&&(c.centroid=p.computeCentroid(b.geometry,
this.viewSR)),a=this.scaleVisibility&&this.scaleVisibility.scaleRangeActive(),this.spatialIndex&&this.spatialIndex.shouldAddToSpatialIndex(b,c,a)&&this.spatialIndex.addGraphicToSpatialIndex(b,c),a&&this.scaleVisibility.updateGraphicScaleVisibility(b,c),c.setVisibilityFlag("VISIBILITY_GRAPHIC",b.visible&&!this.layerView.suspended),a=this.whenGraphics3DGraphicRequests[b.id]))a.resolve(c),delete this.whenGraphics3DGraphicRequests[b.id]};e.prototype.rendererChange=function(a){this.symbolCreationContext.renderer=
a;this.recreateAllGraphics()};e.prototype.opacityChange=function(){var a=!1,b;for(b in this.graphicsBySymbol){var c=this.graphicsBySymbol[b];this.symbols[b].layerPropertyChanged("opacity");if(!a)for(var d in c)if(c[d].isDraped()){this.layerView._notifyDrapedDataChange();a=!0;break}}};e.prototype.setClippingExtent=function(a,b){var c=this.symbolCreationContext.clippingExtent,d=[];h.extentToBoundingRect(a,d,b)?this.symbolCreationContext.clippingExtent=[d[0],d[1],-Infinity,d[2],d[3],Infinity]:this.symbolCreationContext.clippingExtent=
null;return!k.equals(this.symbolCreationContext.clippingExtent,c)};e.prototype.updateAllGraphicsVisibility=function(){var a=this;if(this.layerView.loadedGraphics){var b=!1;this.layerView.loadedGraphics.forEach(function(c){var d=a.getGraphics3DGraphicById(c.id);if(d){var f=d.setVisibilityFlag("VISIBILITY_GRAPHIC",c.visible);a.scaleVisibility&&(c=a.scaleVisibility.updateGraphicScaleVisibility(c,d),f=f||c);f&&d.isDraped()&&(b=!0)}});b&&this.layerView._notifyDrapedDataChange();this.layerView.view.labelManager.setDirty()}};
e.prototype.hideAllGraphics=function(){var a=this;if(this.layerView.loadedGraphics){var b=!1;this.layerView.loadedGraphics.forEach(function(c){(c=a.getGraphics3DGraphicById(c.id))&&c.setVisibilityFlag("VISIBILITY_GRAPHIC",!1)&&c.isDraped()&&(b=!0)});b&&this.layerView._notifyDrapedDataChange();this.layerView.view.labelManager.setDirty()}};e.tmpVec=r.vec3d.create();return e}()})},"esri/views/3d/webgl-engine/lib/Layer":function(){define("require exports dojo/has ./IdGen ./Octree ./PerformanceTimer ./Util ./gl-matrix ./ModelContentType".split(" "),
function(s,q,n,k,h,e,c,b,g){var f=b.vec3d;return function(){function a(b,c,d){this._parentStages=[];this._children=[];this.id=a._idGen.gen(d);this.name=b;c=c||{};this.group=c.group||"";this.state=c.state||"VISIBLE";this.interaction=c.interaction||"PICKABLE";this.translation=f.create(c.translation);this._extent=[f.createFrom(0,0,0),f.createFrom(1E3,1E3,1E3)];this._extentDirty=!0}a.prototype.getId=function(){return this.id};a.prototype.getParentStages=function(){return this._parentStages};a.prototype.addParentStage=
function(a){-1===this._parentStages.indexOf(a)&&this._parentStages.push(a)};a.prototype.removeParentStage=function(a){a=this._parentStages.indexOf(a);-1<a&&this._parentStages.splice(a,1)};a.prototype.getName=function(){return this.name};a.prototype.getGroup=function(){return this.group};a.prototype.getState=function(){return this.state};a.prototype.getInteraction=function(){return this.interaction};a.prototype.getTranslation=function(){return this.translation};a.prototype.getObjectIds=function(){return this._children.map(function(a){return a.getId()})};
a.prototype.getObjects=function(){return this._children};a.prototype.setState=function(a){this.state=a};a.prototype.getExtent=function(){this._updateExtent();return this._extent};a.prototype.addObject=function(a){this._children.push(a);a.addParentLayer(this);this.notifyDirty("layObjectAdded",a);this._invalidateExtent();this._spatialAccelerator&&this._spatialAccelerator.add(a)};a.prototype.hasObject=function(a){return-1<this._children.indexOf(a)};a.prototype.removeObject=function(a){var b=this._children.indexOf(a);
return-1<b?(this._children.splice(b,1),a.removeParentLayer(this),this.notifyDirty("layObjectRemoved",a),this._invalidateExtent(),this._spatialAccelerator&&this._spatialAccelerator.remove(a),!0):!1};a.prototype.replaceObject=function(a,b){var d=this._children.indexOf(a);c.assert(-1<d,"Layer.replaceObject: layer doesn't contain specified object");this._children[d]=b;a.removeParentLayer(this);b.addParentLayer(this);this.notifyDirty("layObjectReplaced",[a,b]);this._invalidateExtent();this._spatialAccelerator&&
(this._spatialAccelerator.remove(a),this._spatialAccelerator.add(b))};a.prototype.notifyObjectBBChanged=function(a,b){this._spatialAccelerator&&this._spatialAccelerator.update(a,b)};a.prototype.getCenter=function(){this._updateExtent();var a=f.create();return f.lerp(this._extent[0],this._extent[1],0.5,a)};a.prototype.getBSRadius=function(){this._updateExtent();return 0.5*f.dist(this._extent[0],this._extent[1])};a.prototype.getSpatialQueryAccelerator=function(){if(this._spatialAccelerator)return this._spatialAccelerator;
if(50<this._children.length)return this._createOctree(),this._spatialAccelerator};a.prototype.notifyDirty=function(a,b,c,f){c=c||g.LAYER;f=f||this;for(var e=0;e<this._parentStages.length;e++)this._parentStages[e].notifyDirty(c,f,a,b)};a.prototype._createOctree=function(){for(var a=this.getExtent(),b=0,c=0;3>c;c++)b=Math.max(b,a[1][c]-a[0][c]);c=f.create();f.lerp(a[0],a[1],0.5,c);this._spatialAccelerator=new h(c,1.2*b);this._spatialAccelerator.add(this._children)};a.prototype._invalidateExtent=function(){this._extentDirty=
!0};a.prototype._updateExtent=function(){if(this._extentDirty)if(0===this._children.length)this._extent=[[0,0,0],[0,0,0]];else{var a=this._children[0];this._extent=[f.create(a.getBBMin()),f.create(a.getBBMax())];for(a=0;a<this._children.length;++a)for(var b=this._children[a],c=b.getBBMin(),b=b.getBBMax(),g=0;3>g;++g)this._extent[0][g]=Math.min(this._extent[0][g],c[g]),this._extent[1][g]=Math.max(this._extent[1][g],b[g]);this._extentDirty=!1}};a._idGen=new k;return a}()})},"esri/views/3d/webgl-engine/lib/Octree":function(){define("require exports ./gl-matrix ./Util dojo/has ./PerformanceTimer".split(" "),
function(s,q,n,k,h,e){function c(a,b,c){c=c||a;c[0]=a[0]+b;c[1]=a[1]+b;c[2]=a[2]+b;return c}function b(a,b){var c=a.indexOf(b);return-1!==c?(a.splice(c,1),b):null}var g=n.vec3d;s=function(){function a(b,c,d){this._maximumObjectsPerNode=10;this._maximumDepth=20;this._autoResize=!0;this._outsiders=[];d&&(void 0!==d.maximumObjectsPerNode&&(this._maximumObjectsPerNode=d.maximumObjectsPerNode),void 0!==d.maximumDepth&&(this._maximumDepth=d.maximumDepth),void 0!==d.autoResize&&(this._autoResize=d.autoResize));
isNaN(b[0])||isNaN(b[1])||isNaN(b[2])||isNaN(c)?this._root=new f(null,g.createFrom(0,0,0),0.5):this._root=new f(null,b,c/2)}Object.defineProperty(a.prototype,"center",{get:function(){return this._root.center},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return 2*this._root.halfSize},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"root",{get:function(){return this._root.node},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"outsiders",{get:function(){return this._outsiders.slice()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maximumObjectsPerNode",{get:function(){return this._maximumObjectsPerNode},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maximumDepth",{get:function(){return this._maximumDepth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"autoResize",{get:function(){return this._autoResize},enumerable:!0,configurable:!0});a.prototype.add=function(a){a=
this._objectOrObjectsArray(a);this._grow(a);for(var b=f.acquire(),c=0;c<a.length;c++){var d=a[c];b.init(this._root);0===d.getBSRadius()||isNaN(d.getBSRadius())||!this._autoResize&&!this._fitsInsideTree(this._boundingSphereFromObject(d,t))?this._outsiders.push(d):this._add(d,b)}f.release(b)};a.prototype.remove=function(a,c){for(var d=this._objectOrObjectsArray(a),g=f.acquire(),e=!0,m=0;m<d.length;m++){var e=d[m],l=this._boundingSphereFromObject(c||e,t);0===l.radius||isNaN(l.radius)||!this._autoResize&&
!this._fitsInsideTree(l)?e=null!=b(this._outsiders,e):(g.init(this._root),e=this._remove(e,l,g))}f.release(g);this._shrink();return e};a.prototype.update=function(a,b){this.remove(a,b);this.add(a)};a.prototype.forEachAlongRay=function(a,b,f){this._forEachTest(function(f){c(f.center,2*-f.halfSize,d);c(f.center,2*f.halfSize,m);return k.rayBoxTest(a,b,d,m)},f)};a.prototype.forEachInBoundingBox=function(a,b,c){this._forEachTest(function(c){for(var d=2*c.halfSize,f=0;3>f;f++)if(c.center[f]+d<a[f]||c.center[f]-
d>b[f])return!1;return!0},c)};a.prototype.forEachNode=function(a){this._forEachNode(this._root,function(b){return a(b.node,b.center,2*b.halfSize)})};a.prototype._forEachTest=function(a,b){this._outsiders.forEach(b);this._forEachNode(this._root,function(c){return a(c)?(c=c.node,c.terminals.forEach(b),null!==c.residents&&c.residents.forEach(b),!0):!1})};a.prototype._forEachNode=function(a,b){for(var c=f.acquire().init(a),d=[c];0!==d.length;){c=d.pop();if(b(c)&&!c.isLeaf())for(var g=0;g<c.node.children.length;g++)c.node.children[g]&&
d.push(f.acquire().init(c).advance(g));f.release(c)}};a.prototype._objectOrObjectsArray=function(a){Array.isArray(a)||(r[0]=a,a=r);return a};a.prototype._remove=function(a,c,d){p.length=0;d.advanceTo(c,function(a,b){p.push(a.node,b)})?(a=null!=b(d.node.terminals,a),d=0===d.node.terminals.length):(a=null!=b(d.node.residents,a),d=0===d.node.residents.length);if(d)for(d=p.length-2;0<=d&&this._purge(p[d],p[d+1]);d-=2);return a};a.prototype._nodeIsEmpty=function(a){if(0!==a.terminals.length)return!1;if(null!==
a.residents)return 0===a.residents.length;for(var b=0;b<a.children.length;b++)if(a.children[b])return!1;return!0};a.prototype._purge=function(a,b){0<=b&&(a.children[b]=null);return this._nodeIsEmpty(a)?(null===a.residents&&(a.residents=[]),!0):!1};a.prototype._add=function(a,b){b.advanceTo(this._boundingSphereFromObject(a,t))?b.node.terminals.push(a):(b.node.residents.push(a),b.node.residents.length>this._maximumObjectsPerNode&&b.depth<this._maximumDepth&&this._split(b))};a.prototype._split=function(a){var b=
a.node.residents;a.node.residents=null;for(var c=0;c<b.length;c++){var d=f.acquire().init(a);this._add(b[c],d);f.release(d)}};a.prototype._grow=function(a){if(0!==a.length&&this._autoResize&&(a=this._boundingSphereFromObjects(a,this._boundingSphereFromObject,x),!isNaN(a.radius)&&!(0===a.radius||this._fitsInsideTree(a))))if(this._nodeIsEmpty(this._root.node))g.set(a.center,this._root.center),this._root.halfSize=1.25*a.radius;else{var b=f.acquire();this._rootBoundsForRootAsSubNode(a,b);this._placingRootViolatesMaxDepth(b)?
this._rebuildTree(a,b):this._growRootAsSubNode(b);f.release(b)}};a.prototype._rebuildTree=function(a,b){var c=this;g.set(b.center,v.center);v.radius=b.halfSize;var d=this._boundingSphereFromObjects([a,v],function(a){return a},u),e=f.acquire().init(this._root);this._root.initFrom(null,d.center,1.25*d.radius);this._forEachNode(e,function(a){c.add(a.node.terminals);null!==a.node.residents&&c.add(a.node.residents);return!0});f.release(e)};a.prototype._placingRootViolatesMaxDepth=function(a){var b=0;this._forEachNode(this._root,
function(a){b=Math.max(b,a.depth);return!0});return b+Math.log(a.halfSize/this._root.halfSize)*Math.LOG2E>this._maximumDepth};a.prototype._rootBoundsForRootAsSubNode=function(a,b){for(var c=a.radius,d=a.center,f=-Infinity,g=this._root.center,e=this._root.halfSize,m=0;3>m;m++){var h=d[m]+c-(g[m]+e),p=Math.max(0,Math.ceil((g[m]-e-(d[m]-c))/(2*e))),h=Math.max(0,Math.ceil(h/(2*e)))+1,k=Math.pow(2,Math.ceil(Math.log(p+h)*Math.LOG2E)),f=Math.max(f,k);z[m].min=p;z[m].max=h}for(m=0;3>m;m++)p=z[m].min,h=z[m].max,
c=(f-(p+h))/2,p+=Math.ceil(c),h+=Math.floor(c),l[m]=g[m]-e-2*p*e+(h+p)*e;return b.initFrom(null,l,f*e,0)};a.prototype._growRootAsSubNode=function(a){var b=this._root.node;g.set(this._root.center,x.center);x.radius=this._root.halfSize;this._root.init(a);a.advanceTo(x,null,!0);a.node.children=b.children;a.node.residents=b.residents;a.node.terminals=b.terminals};a.prototype._shrink=function(){if(this._autoResize)for(;;){var a=this._findShrinkIndex();if(-1===a)break;this._root.advance(a);this._root.depth=
0}};a.prototype._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var a=null,b=this._root.node.children,c=0,d=0;d<b.length&&null==a;)c=d++,a=b[c];for(;d<b.length;)if(b[d++])return-1;return c};a.prototype._fitsInsideTree=function(a){var b=this._root.center,c=this._root.halfSize,d=a.center;return a.radius<=c&&d[0]>=b[0]-c&&d[0]<=b[0]+c&&d[1]>=b[1]-c&&d[1]<=b[1]+c&&d[2]>=b[2]-c&&d[2]<=b[2]+c};a.prototype._boundingSphereFromObject=function(a,b){g.set(a.getCenter(),
b.center);b.radius=a.getBSRadius();return b};a.prototype._boundingSphereFromObjects=function(a,b,c){if(1===a.length){var f=b(a[0],x);g.set(f.center,c.center);c.radius=f.radius}else{d[0]=Infinity;d[1]=Infinity;d[2]=Infinity;m[0]=-Infinity;m[1]=-Infinity;m[2]=-Infinity;for(var e=0;e<a.length;e++){var f=b(a[e],x),l=d,h=f.center,p=f.radius;l[0]=Math.min(l[0],h[0]-p);l[1]=Math.min(l[1],h[1]-p);l[2]=Math.min(l[2],h[2]-p);l=m;h=f.center;f=f.radius;l[0]=Math.max(l[0],h[0]+f);l[1]=Math.max(l[1],h[1]+f);l[2]=
Math.max(l[2],h[2]+f)}g.scale(g.add(d,m,c.center),0.5);c.radius=Math.max(m[0]-d[0],m[1]-d[1],m[2]-d[2])/2}return c};return a}();var f=function(){function b(a,c,d,f){void 0===d&&(d=0);this.center=g.create();this.initFrom(a,c,d,0)}b.prototype.init=function(a){return this.initFrom(a.node,a.center,a.halfSize,a.depth)};b.prototype.initFrom=function(a,c,d,f){void 0===a&&(a=null);void 0===d&&(d=this.halfSize);void 0===f&&(f=this.depth);this.node=a||b.createEmptyNode();c&&g.set(c,this.center);this.halfSize=
d;this.depth=f;return this};b.prototype.advance=function(c){var d=this.node.children[c];d||(d=b.createEmptyNode(),this.node.children[c]=d);this.node=d;this.halfSize/=2;this.depth++;c=a[c];this.center[0]+=c[0]*this.halfSize;this.center[1]+=c[1]*this.halfSize;this.center[2]+=c[2]*this.halfSize;return this};b.prototype.advanceTo=function(a,b,c){for(void 0===c&&(c=!1);;){if(this.isTerminalFor(a))return b&&b(this,-1),!0;if(this.isLeaf()&&!c)return b&&b(this,-1),!1;this.isLeaf()&&(this.node.residents=null);
var d=this._childIndex(a);b&&b(this,d);this.advance(d)}};b.prototype.isLeaf=function(){return null!=this.node.residents};b.prototype.isTerminalFor=function(a){return a.radius>this.halfSize/2};b.prototype._childIndex=function(a){a=a.center;for(var b=this.center,c=0,d=0;3>d;d++)b[d]<a[d]&&(c|=1<<d);return c};b.createEmptyNode=function(){return{children:[null,null,null,null,null,null,null,null],terminals:[],residents:[]}};b.acquire=function(){if(0===this._pool.length)return new b;var a=this._pool[this._pool.length-
1];this._pool.length--;return a};b.release=function(a){this._pool.push(a)};b._pool=[];return b}(),a=[[-1,-1,-1],[1,-1,-1],[-1,1,-1],[1,1,-1],[-1,-1,1],[1,-1,1],[-1,1,1],[1,1,1]],r=[null],l=g.create(),d=g.create(),m=g.create(),p=[],t={center:g.create(),radius:0},x={center:g.create(),radius:0},v={center:g.create(),radius:0},u={center:g.create(),radius:0},z=[{min:0,max:0},{min:0,max:0},{min:0,max:0}];return s})},"esri/views/3d/webgl-engine/lib/FloatingBoxLocalOriginFactory":function(){define(["require",
"exports","./gl-matrix"],function(s,q,n){var k=n.vec3d;s=function(){function c(b,c){this._origins=[];this._boxSize=b;this._maxNumOrigins=c}c.prototype.getOrigin=function(b){for(var g=this._origins.length,f,a=!1,r=Number.MAX_VALUE,l=0;l<g;l++){var d=this._origins[l];k.subtract(b,d.vec3,e);e[0]=Math.abs(e[0]);e[1]=Math.abs(e[1]);e[2]=Math.abs(e[2]);var m=e[0]+e[1]+e[2];m<r&&(f=d,r=m,a=e[0]<this._boxSize&&e[1]<this._boxSize&&e[2]<this._boxSize)}if(!a&&(!f||null==this._maxNumOrigins||this._origins.length<
this._maxNumOrigins))g=c.OFFSET,f={vec3:[b[0]+g,b[1]+g,b[2]+g],id:h+this._origins.length},this._origins.push(f);return f};c.OFFSET=1.11;return c}();var h="fb_",e=k.create();return s})},"esri/views/3d/layers/graphics/SymbolConverter":function(){define("dojo/_base/lang ../../../../symbols/Font ../../../../symbols/SimpleLineSymbol ../../../../symbols/SimpleMarkerSymbol ../../../../symbols/PictureMarkerSymbol ../../../../symbols/SimpleFillSymbol ../../../../symbols/TextSymbol ../../../../symbols/Symbol3D ../../../../symbols/Symbol ../../../../symbols/LineSymbol3D ../../../../symbols/PointSymbol3D ../../../../symbols/PolygonSymbol3D ../../../../symbols/LabelSymbol3D ../../../../renderers/support/jsonUtils".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d){function m(a){return a.toRgb().map(function(a){return a})}function p(a){return Math.round(100*(1-a.a))}var t=function(d,g,t){var z;if(d instanceof n)z=f.fromJSON({symbolLayers:[{type:"Line",enable:!0,size:d.width||1,material:{color:d.color?m(d.color):[255,255,255],transparency:d.color?p(d.color):100}}]});else if(d instanceof h||d instanceof k){z=d.color?m(d.color):[255,255,255];var w=null==d.color?100:p(d.color),C,A;d instanceof h?(d.color&&0===d.color.r+d.color.g+
d.color.b&&(z=[255,255,255]),C=d.source.imageData&&d.source.contentType?{dataURI:"data:"+d.source.contentType+";base64,"+d.source.imageData}:"data:"===d.url.substring(0,5)?{dataURI:d.url}:{href:d.url},A=d.width):(C=d.style,A={},A[k.STYLE_CIRCLE]="circle",A[k.STYLE_CROSS]="cross",A[k.STYLE_DIAMOND]="kite",A[k.STYLE_SQUARE]="square",A[k.STYLE_X]="x",C in A?C=A[C]:(console.log(C+' cannot be mapped to Icon symbol. Fallback to "circle"'),C="circle"),C={primitive:C},A=d.size);z={type:"Icon",enable:!0,size:A,
screenOffset:[d.xoffset,d.yoffset],resource:C,material:{color:z,transparency:w}};d.outline&&(d.outline.color&&0<d.outline.width)&&(z.outline={size:d.outline.width,color:m(d.outline.color),transparency:p(d.outline.color)});z=a.fromJSON({symbolLayers:[z]})}else if(d instanceof e)z={symbolLayers:[{type:"Fill",enable:!0,material:{color:d.color?m(d.color):[255,255,255],transparency:d.color?p(d.color):100}}]},z=r.fromJSON(z),d.outline&&d.outline.color&&(z.symbolLayers.getItemAt(0).outline={size:d.outline.width||
0,color:d.outline.color});else if(d instanceof c){switch(d.verticalAlignment){case "top":z="top";break;case "middle":z="center";break;case "bottom":z="bottom";break;default:z="center"}switch(d.horizontalAlignment){case "left":z+="Left";break;case "center":z+="Center";break;case "right":z+="Right";break;default:z+="Center"}w=s.clone(q.defaultProps);d.font&&s.mixin(w,d.font);z=l.fromJSON({symbolLayers:[{type:"Text",enable:!0,size:w.size,font:{family:w.family,weight:w.weight,style:w.style},material:{color:m(d.color)},
placement:z,screenOffset:[d.xoffset,d.yoffset],text:d.text}]})}else d instanceof b?z=d:console.warn("SymbolConverter: don't know how to convert symbol of type '%s'",d.type||d.declaredClass);g&&z&&(z.id=d.id);if(t&&z)for(d=0;d<z.symbolLayers.length;++d)z.symbolLayers.getItemAt(d)._ignoreDrivers=!0;return z};return{toWeb3DSymbol:t,toWeb3DRenderer:function(a){function c(a){return a instanceof g&&!(a instanceof b)?t(a,!1,!1):a}var f=d.fromJSON(a.toJSON());f.defaultSymbol=c(f.defaultSymbol);f.symbol=c(f.symbol);
var e=f.classBreakInfos||f.uniqueValueInfos;Array.isArray(e)&&e.forEach(function(a){a.symbol=c(a.symbol)});"undefined"!==typeof a.isMaxInclusive&&(f.isMaxInclusive=a.isMaxInclusive);return f}}})},"esri/views/3d/layers/graphics/Graphics3DGraphic":function(){define(["../../../../core/declare","../../support/aaBoundingBox","../../support/aaBoundingRect"],function(s,q,n){var k=q.create(),h=n.create();return s(null,{constructor:function(e,c,b){this.graphics3DSymbol=c;this.graphic=e;this._graphics=b;this._labelGraphics=
[];this.addedToSpatialIndex=!1},initialize:function(e,c,b){var g=function(c,a){a&&a.initialize(c,b)};this._graphics.forEach(g.bind(this,e));c&&this._labelGraphics.forEach(g.bind(this,c))},addLabelGraphic:function(e){this._labelGraphics.push(e)},isDraped:function(){for(var e=0;e<this._graphics.length;e++){var c=this._graphics[e];if(c&&c.isDraped())return!0}return!1},areVisibilityFlagsSet:function(e,c){for(var b=!0,g=0;g<this._graphics.length;g++){var f=this._graphics[g];f&&(b=b&&f.areVisibilityFlagsSet(e,
c))}for(g=0;g<this._labelGraphics.length;g++)(f=this._labelGraphics[g])&&(b=b&&f.areVisibilityFlagsSet(e,c));return b},setVisibilityFlag:function(e,c){var b=!1,g=function(f){f&&(b=f.setVisibilityFlag(e,c)||b)};this._graphics.forEach(g);this._labelGraphics.forEach(g);return b},destroy:function(){var e=function(c){c&&c.destroy()};this._graphics.forEach(e);this._graphics.length=0;this._labelGraphics.forEach(e);this._labelGraphics.length=0},getBSRadius:function(){var e=0;this._graphics.forEach(function(c){e=
Math.max(e,c.getBSRadius())});return e},getCenterObjectSpace:function(){return this._graphics[0].getCenterObjectSpace()},getProjectedBoundingBox:function(e,c,b){b?q.set(b,q.NEGATIVE_INFINITY):b=q.create(q.NEGATIVE_INFINITY);for(var g=0;g<this._graphics.length;g++){var f=this._graphics[g];if(f){var a=f.isDraped()?c:e;f&&f.getProjectedBoundingBox(a,k)&&q.expand(b,f.isDraped()?q.toRect(k,h):k)}}return q.allFinite(b)||n.allFinite(q.toRect(b,h))?b:null},mustAlignToTerrain:function(){for(var e=this._graphics.length,
c=0;c<e;c++){var b=this._graphics[c];if(b&&b.mustAlignToTerrain())return!0}e=this._labelGraphics.length;for(c=0;c<e;c++)if((b=this._labelGraphics[c])&&b.mustAlignToTerrain())return!0;return!1},alignWithElevation:function(e,c){for(var b=this._graphics.length,g=0;g<b;g++){var f=this._graphics[g];f&&f.alignWithElevation(e,c)}b=this._labelGraphics.length;for(g=0;g<b;g++)(f=this._labelGraphics[g])&&this._labelGraphics[g].alignWithElevation(e,c)},setDrawOrder:function(e,c,b){b[this.graphics3DSymbol.symbol.id]=
!0;for(var g=this._graphics.length,f=0;f<g;f++){var a=this._graphics[f];a&&a.setDrawOrder(e+(1-(1+f)/g),c,b)}}})})},"esri/views/3d/layers/graphics/Graphics3DSymbol":function(){define(["../../../../core/declare","../../support/PromiseLightweight","./Graphics3DSymbolLayerFactory","./Graphics3DGraphic"],function(s,q,n,k){return s(q.Promise,{constructor:function(h,e,c){this.symbol=h;h=h.symbolLayers;c&&(h=c.concat(h));c=h.length;this.childGraphics3DSymbols=Array(h.length);this.childGraphics3DSymbolPromises=
Array(h.length);for(var b=e.layerOrder,g=0,f=0,a=!1,k=function(b,c){c&&(this.childGraphics3DSymbols[b]=c,f++);g--;!this.isRejected()&&(a&&1>g)&&(0<f?this.resolve():this.reject())},l=0;l<c;l++){var d=h.getItemAt(l);if(!1!==d.enable&&(e.layerOrder=b+(1-(1+l)/c),e.layerOrderDelta=1/c,d=n.make(d,e,d._ignoreDrivers)))g++,this.childGraphics3DSymbolPromises[l]=d,d.then(k.bind(this,l,d),k.bind(this,l,null))}e.layerOrder=b;a=!0;!this.isRejected()&&1>g&&(0<f?this.resolve():this.reject())},createGraphics3DGraphic:function(h,
e){for(var c=Array(this.childGraphics3DSymbols.length),b=0;b<this.childGraphics3DSymbols.length;b++){var g=this.childGraphics3DSymbols[b];g&&(c[b]=g.createGraphics3DGraphic(h,e))}return new k(h,this,c)},layerPropertyChanged:function(h,e){for(var c=this.childGraphics3DSymbols.length,b=0;b<c;b++){var g=this.childGraphics3DSymbols[b];if(g&&!g.layerPropertyChanged(h,e,b))return!1}return!0},setDrawOrder:function(h,e){for(var c=this.childGraphics3DSymbols.length,b=1/c,g=0;g<c;g++){var f=this.childGraphics3DSymbols[g];
f&&f.setDrawOrder(h+(1-(1+g)/c),b,e)}},destroy:function(){this.isFulfilled()||this.reject();for(var h=0;h<this.childGraphics3DSymbolPromises.length;h++)this.childGraphics3DSymbolPromises[h]&&this.childGraphics3DSymbolPromises[h].destroy()}})})},"esri/views/3d/layers/graphics/Graphics3DSymbolLayerFactory":function(){define("./Graphics3DIconSymbolLayer ./Graphics3DObjectSymbolLayer ./Graphics3DLineSymbolLayer ./Graphics3DPathSymbolLayer ./Graphics3DFillSymbolLayer ./Graphics3DExtrudeSymbolLayer ./Graphics3DTextSymbolLayer ../../webgl-engine/lib/Util".split(" "),
function(s,q,n,k,h,e,c,b){var g=b.assert,f={Icon:s,Object:q,Line:n,Path:k,Fill:h,Extrude:e,Text:c};return{make:function(a,b,c){var d=f[a.type];g(d,"unknown symbol type "+a.type);return new d(a,b,c)}}})},"esri/views/3d/layers/graphics/Graphics3DIconSymbolLayer":function(){define("../../../../core/declare dojo/_base/lang dojo/when ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./SignedDistanceFunctions ../../../../core/urlUtils ../../../../core/screenUtils ../../../../config ../../../../Color ../../../../geometry/Polygon ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/Texture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u,z,w){function C(a){return"cross"===a||"x"===a}function A(a){var b,c=N,d=c*G;"primitive:"===a.substring(0,10)&&(a=a.substring(10));switch(a){case O.PRIM_CIRCLE:b=g.computeSignedDistancefieldCicle(c,d);break;case O.PRIM_SQUARE:b=g.computeSignedDistancefieldSquare(c,d,!1);break;case O.PRIM_KITE:b=g.computeSignedDistancefieldSquare(c,d,!0);break;case O.PRIM_CROSS:b=g.computeSignedDistancefieldCrossAndX(c,d,!1);break;case O.PRIM_X:b=g.computeSignedDistancefieldCrossAndX(c,
d,!0)}return new z(b,"sdf_"+a,{mipmap:!1,wrapClamp:!0,width:N,height:N,components:4})}var y=p.vec3d,B=p.mat4d.identity(),D=[0,0,1],F=[0,0,0,0],H="center bottom top left right bottom-left bottom-right top-left top-right".split(" "),N=128,G=0.5,O={PRIM_CIRCLE:"circle",PRIM_SQUARE:"square",PRIM_CROSS:"cross",PRIM_X:"x",PRIM_KITE:"kite"};s=s([k],{_prepareResources:function(){var b=this.symbol,c=null!=b.size?a.pt2px(b.size):16;this._size=null;this._symbolTextureRatio=1;this._primitive=null;var d=this._getStageIdHint();
this._isPropertyDriven("size")&&64>c&&(c=64);var f=b.resource||{primitive:"circle"},g={anchorPos:this._getAnchorPos(b)},e=f.href||f.dataURI;e?(g.color=this._getFillColor(b,null),g.outlineColor=this._getOutlineColor(b),g.outlineSize=this._getOutlineSize(b,null),g.textureIsSignedDistanceField=!1,this._prepareImageResources(e,c,g,d)):(f=f.primitive||"circle",e="primitive:"+f,this._primitive=f,g.color=this._getFillColor(b,f),g.outlineColor=this._getOutlineColor(b),g.outlineSize=this._getOutlineSize(b,
f),C(f)&&0===g.outlineSize?this.reject():(this.texture=this._context.sharedResources.textures.acquire(e,A),this._textureURI=e,g.textureIsSignedDistanceField=!0,g.textureId=this.texture.getId(),this._createMaterialsAndAddToStage(g,this._context.stage,d),this._size=[c,c],this._symbolTextureRatio=1/G,this.resolve()))},_getOutlineDefaultSize:function(a){return C(a)?1.5:0},_getOutlineSize:function(b,c){return b.outline?null!=b.outline.size?a.pt2px(b.outline.size):this._getOutlineDefaultSize(c):this._getOutlineDefaultSize(c)},
_getOutlineColor:function(a){var b=this._getLayerOpacity();if(a.outline&&null!=a.outline.color){var c=l.toUnitRGB(a.outline.color);return[c[0],c[1],c[2],a.outline.color.a*b]}return[0,0,0,b]},_getFillColor:function(a,b){return C(b)?F:this._getMaterialOpacityAndColor()},_getAnchorPos:function(a){return-1<H.indexOf(a.anchor)?a.anchor:"center"},_prepareImageResources:function(a,b,c,d){0===a.indexOf("http")&&"https:"===location.protocol&&(a=a.replace(/^http:/i,"https:"));var g=function(a){if(!this.isRejected()){var f=
a.params,g=f.width/f.height;this._size=b?1<g?[b,b/g]:[b*g,b]:[f.width,f.height];c.textureId=a.getId();this._createMaterialsAndAddToStage(c,this._context.stage,d);this.resolve()}}.bind(this),e="data:image/svg"===a.substring(0,14),m=".svg"===a.substring(a.length-4,a.length);if(!e&&!m)n(this._context.sharedResources.textures.acquire(a),g,function(){this.reject()}.bind(this)),this._textureURI=a;else{0===a.indexOf("//")&&(a=window.location.protocol+a);var l=new Image,m=!e&&f.hasSameOrigin(a,window.location.href);
e||(m||f.canUseXhr(a)?m||(l.crossOrigin="anonymous"):r.request.proxyUrl&&(a=r.request.proxyUrl+"?"+a));l.src=a;l.onerror=function(){this.reject()}.bind(this);l.onload=function(){var a=l.width,c=l.height,d=1;a&&c&&(d=a/c);null!=b&&(1<d?(a=b,c=Math.round(b/d)):(c=b,a=Math.round(b*d)));d=document.createElement("canvas");d.width=a;d.height=c;d.getContext("2d").drawImage(l,0,0,a,c);a=d.toDataURL();n(this._context.sharedResources.textures.acquire(a),g,function(){this.reject()});this.textureURI=a}.bind(this);
l.onerror=function(){console.warn("Failed to create Icon primitive");this.reject()}.bind(this)}},_createMaterialsAndAddToStage:function(a,b,c){var d=q.clone(a);d.occlusionTest=!1;d.shaderPolygonOffset=0;this._drapedMaterial=new w(d,c+"_iconDraped");b.add(t.ModelContentType.MATERIAL,this._drapedMaterial);a.occlusionTest=!0;this._material=new w(a,c+"_icon");b.add(t.ModelContentType.MATERIAL,this._material)},destroy:function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(t.ModelContentType.MATERIAL,
this._material.getId()),this._material=null);this._drapedMaterial&&(this._context.stage.remove(t.ModelContentType.MATERIAL,this._drapedMaterial.getId()),this._drapedMaterial=null);this._textureURI&&(this._context.sharedResources.textures.release(this._textureURI),this._textureURI=null)},createGraphics3DGraphic:function(c,f,g){var e=c.geometry;"extent"===e.type&&(e=d.fromExtent(e));if("polyline"===e.type)e=b.placePointOnPolyline(e);else if("polygon"===e.type)e=b.placePointOnPolygon(e);else if("point"!==
e.type)return this._logWarning("unsupported geometry type for icon symbol: "+e.type),null;var m="graphic"+c.id,l=1;if(this._isPropertyDriven("size")&&f.size){for(var h=0;3>h;h++)f.size[h]&&(f.size[h]=a.pt2px(f.size[h]));h=this._size[0]>this._size[1]?this._size[0]:this._size[1];isFinite(f.size[0])?l=f.size[0]/h:"symbolValue"===f.size[0]?l=1:isFinite(f.size[2])&&(l=f.size[2]/h)}f=this._getVertexOpacityAndColor(f);l*=this._symbolTextureRatio;l=[this._size[0]*l,this._size[1]*l];h=this._getGraphicElevationInfo(c);
return h.mode===b.ELEV_MODES.ON_THE_GROUND?this._createAsOverlay(c,e,f,l,h,m,c.id,g):this._createAs3DShape(c,e,f,l,h,m,c.id,g)},layerPropertyChanged:function(a,d,f){if("opacity"===a)return d=this._getFillColor(this.symbol,this._primitive),this._drapedMaterial.setParameterValues({color:d}),this._material.setParameterValues({color:d}),d=this._getOutlineColor(this.symbol),this._drapedMaterial.setParameterValues({outlineColor:d}),this._material.setParameterValues({outlineColor:d}),!0;if("elevationInfo"===
a){var g=this._elevationInfo.mode;this._updateElevationInfo();a=this._elevationInfo.mode;var e=b.ELEV_MODES;if(g===e.ON_THE_GROUND&&a===e.ON_THE_GROUND)return!0;if(g!==a&&(g===e.ON_THE_GROUND||a===e.ON_THE_GROUND))return!1;var g=this._context.elevationProvider,m=this._context.renderCoordsHelper,l=c.perObjectElevationAligner,h;for(h in d){var p=d[h],k=p._graphics[f];k&&(p=this._getGraphicElevationInfo(p.graphic),k.elevationAligner=a===e.RELATIVE_TO_GROUND?l:null,k.elevationInfo.set(p),l(k,g,m))}return!0}return!1},
setDrawOrder:function(a,b,c){this._drapedMaterial&&(this._drapedMaterial.setRenderPriority(a),c[this._drapedMaterial.getId()]=!0)},_defaultElevationInfoNoZ:{mode:b.ELEV_MODES.RELATIVE_TO_GROUND,offset:0},_getGraphicElevationInfo:function(a){var c=this.inherited(arguments);c.mode===b.ELEV_MODES.RELATIVE_TO_GROUND&&(0===c.offset&&!a.geometry.get("hasZ"))&&(c.offset=1/this._context.renderCoordsHelper.unitInMeters);return c},_createAs3DShape:function(a,d,f,g,e,m,l){a=v.createPointGeometry(D,null,f,g);
a=[new x(a,m)];m=b.createStageObjectForPoint.call(this,d,a,[[this._material]],null,null,e,m,this._context.layer.id,l);if(null===m)return null;l=null;e.mode===b.ELEV_MODES.RELATIVE_TO_GROUND&&(l=c.perObjectElevationAligner);e=new h(this,m,a,null,null,l,e);e.getScreenSize=function(a,b){return function(){return[a,b]}}(g[0]/this._symbolTextureRatio,g[1]/this._symbolTextureRatio);b.extendPointGraphicElevationInfo(e,d,this._context.elevationProvider);return e},_createAsOverlay:function(a,c,d,f,g,l,h){this._drapedMaterial.setRenderPriority(this._symbolLayerOrder);
a=y.create();m.pointToVector(c,a,this._context.overlaySR);a[2]=this._getDrapedZ();if((c=this._context.clippingExtent)&&!b.pointInBox2D(a,c))return null;d=v.createPointGeometry(D,a,d,f,!0);c=new u(d);c.material=this._drapedMaterial;c.center=a;c.bsRadius=0;c.transformation=B;c.name=l;c.uniqueName=l+"#"+d.id;l=new e(this,[c],null,null);l.getScreenSize=function(a,b){return function(){return[a,b]}}(f[0]/this._symbolTextureRatio,f[1]/this._symbolTextureRatio);return l}});s.VALID_ANCHOR_STRINGS=H;return s})},
"esri/views/3d/layers/graphics/Graphics3DSymbolLayer":function(){define("../../../../core/declare ../../../../core/Logger dojo/_base/lang ../../support/PromiseLightweight ./ElevationInfo ../../../../Color".split(" "),function(s,q,n,k,h,e){var c=new h,b=q.getLogger("esri.symbols.Symbol3D");return s([k.Promise],{constructor:function(b,c,a){this.symbol=b;this._context=c;this._symbolLayerOrder=c.layerOrder;this._symbolLayerOrderDelta=c.layerOrderDelta;this._elevationInfo=new h;this._updateDrivenProperties(a);
this._updateElevationInfo();this._prepareResources()},_logWarning:function(c){b.warn(c)},_prepareResources:function(b){throw Error("This is an abstract base class");},_defaultElevationInfoNoZ:{mode:h.MODES.ON_THE_GROUND,offset:0},_defaultElevationInfoZ:{mode:h.MODES.ABSOLUTE_HEIGHT,offset:0},_updateElevationInfo:function(){for(var b in this._elevationInfo)this._elevationInfo[b]=void 0;if(b=this._context.layer.elevationInfo)this._elevationInfo=n.mixin(this._elevationInfo,b);this.symbol.elevationInfo&&
(this._elevationInfo=n.mixin(this._elevationInfo,this.symbol.elevationInfo))},_getGraphicElevationInfo:function(b){b=b.geometry.hasZ?this._defaultElevationInfoZ:this._defaultElevationInfoNoZ;c.mode=this._elevationInfo.mode||b.mode;c.offset=null!=this._elevationInfo.offset?this._elevationInfo.offset:b.offset;c.featureExpression=this._elevationInfo.featureExpression;c.offset/=this._context.renderCoordsHelper.unitInMeters;return c},_getDrapedZ:function(){return-2},_updateDrivenProperties:function(b){var c=
{color:!1,opacity:!1,size:!1};if(!b&&(b=this._context.renderer))c.color=!!b.colorInfo,c.size=!!b.sizeInfo,b.visualVariables&&b.visualVariables.forEach(function(a){switch(a.type){case "color":var b,e;c.color=!0;if(a.colors)for(b=0;b<a.colors.length;b++)if((e=a.colors[b])&&(Array.isArray(e)&&3<e.length&&255!==e[3]||void 0!==e.a&&255!==e.a))c.opacity=!0;if(a.stops)for(b=0;b<a.stops.length;b++)if((e=a.stops[b].color)&&(Array.isArray(e)&&3<e.length&&255!==e[3]||void 0!==e.a&&255!==e.a))c.opacity=!0;break;
case "opacity":case "transparencyInfo":c.opacity=!0;break;case "size":c.size=!0}});this._drivenProperties=c},_isPropertyDriven:function(b){return this._drivenProperties[b]},_getLayerOpacity:function(){var b=this._context.layer.opacity;return null!=b?b:1},_getMaterialOpacity:function(){var b;b=1*this._getLayerOpacity();var c=this.symbol.material;c&&!this._isPropertyDriven("opacity")&&(b*=c.color.a);return b},_getMaterialOpacityAndColor:function(){var b=this.symbol.material,c=this._getMaterialOpacity(),
b=this._isPropertyDriven("color")||!b?null:e.toUnitRGB(b.color);return this._mixinColorAndOpacity(b,c)},_getVertexOpacityAndColor:function(b,c,a){var e=this._isPropertyDriven("color")?b.color:null;b=this._isPropertyDriven("opacity")?b.opacity:null;e=this._mixinColorAndOpacity(e,b);a&&(e[0]*=a,e[1]*=a,e[2]*=a,e[3]*=a);return c?new c(e):e},_mixinColorAndOpacity:function(b,c){var a=[1,1,1,1];null!=b&&(a[0]=b[0],a[1]=b[1],a[2]=b[2]);null!=c?a[3]=c:null!=b&&3<b.length&&(a[3]=b[3]);return a},_getStageIdHint:function(){return this._context.layer.id+
"_symbol"},setDrawOrder:function(b,c,a){this._material&&(this._material.setRenderPriority(b),a[this._material.getId()]=!0)},createGraphics3DGraphic:function(b,c){throw Error("This is an abstract base class");},destroy:function(){throw Error("This is an abstract base class");}})})},"esri/views/3d/layers/graphics/ElevationInfo":function(){define(["dojo/_base/lang"],function(s){var q=function(n){n?this.set(n):(this.mode=null,this.offset=0,this.featureExpression=null)};q.prototype.set=function(n){this.mode=
n.mode;this.offset=n.offset;this.featureExpression=n.featureExpression?s.clone(n.featureExpression):null};q.MODES={ABSOLUTE_HEIGHT:"absolute-height",RELATIVE_TO_GROUND:"relative-to-ground",ON_THE_GROUND:"on-the-ground"};return q})},"esri/views/3d/layers/graphics/Graphics3DGraphicLayer":function(){define(["../../../../core/declare","./ElevationInfo","../../webgl-engine/Stage","../../support/aaBoundingBox","../../lib/glMatrix"],function(s,q,n,k,h){var e=h.vec3d,c=h.mat4d,b=s(null,{constructor:function(c,
f,d,e,g,h,k,n){this.graphics3DSymbolLayer=c;this.uniqueMaterials=e;this.uniqueGeometries=d;this.uniqueTextures=g;this.stageObject=f;this.elevationAligner=h;this.elevationInfo=new a(k);this.stageLayer=this.stage=null;this._shown=!1;this._visibilityFlags={};this.visibilityMode=null!=n?n:b.VisibilityModes.HIDE_FACERANGE},initialize:function(a,b){this.stageLayer=a;this.stage=b;var c;if(this.uniqueMaterials)for(c=0;c<this.uniqueMaterials.length;c++)b.add(n.ModelContentType.MATERIAL,this.uniqueMaterials[c]);
if(this.uniqueGeometries)for(c=0;c<this.uniqueGeometries.length;c++)b.add(n.ModelContentType.GEOMETRY,this.uniqueGeometries[c]);if(this.uniqueTextures)for(c=0;c<this.uniqueTextures.length;c++)b.add(n.ModelContentType.TEXTURE,this.uniqueTextures[c]);b.add(n.ModelContentType.OBJECT,this.stageObject)},isDraped:function(){return!1},areVisibilityFlagsSet:function(a,b){for(var c=!0,f=Object.keys(this._visibilityFlags),e=0;e<f.length;e++){var g=f[e];if(g!==b){if(g===a)return this._visibilityFlags[g];c=c&&
this._visibilityFlags[g]}}return c},setVisibilityFlag:function(a,b){this._visibilityFlags[a]=b;return this._calcAndSetVisibility()},_calcAndSetVisibility:function(){if(null!=this.stage){var a=this.areVisibilityFlagsSet();return this._shown!=a?((this._shown=a)?this.stageLayer.hasObject(this.stageObject)?this.stageObject.unhideAllFaceRange():this.stageLayer.addObject(this.stageObject):this.visibilityMode===b.VisibilityModes.HIDE_FACERANGE?this.stageObject.hideAllFaceRanges():this.stageLayer.removeObject(this.stageObject),
!0):!1}},destroy:function(){if(this.stageLayer){var a,b=this.stage;if(this.uniqueMaterials)for(a=0;a<this.uniqueMaterials.length;a++)b.remove(n.ModelContentType.MATERIAL,this.uniqueMaterials[a].getId());if(this.uniqueGeometries)for(a=0;a<this.uniqueGeometries.length;a++)b.remove(n.ModelContentType.GEOMETRY,this.uniqueGeometries[a].getId());if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)b.remove(n.ModelContentType.TEXTURE,this.uniqueTextures[a].getId())}b.remove(n.ModelContentType.OBJECT,
this.stageObject.getId());this.stageLayer.hasObject(this.stageObject)&&this.stageLayer.removeObject(this.stageObject);this._shown=!1;this.stage=this.stageLayer=null},mustAlignToTerrain:function(){return this.elevationInfo.mode!==q.MODES.ABSOLUTE_HEIGHT},alignWithElevation:function(a,b){this.elevationAligner&&this.elevationAligner(this,a,b)},setDrawOrder:function(){},getBSRadius:function(){return this.stageObject.getBSRadius()},getCenterObjectSpace:function(){return this.stageObject.getCenter(!0)},
getBoundingBoxObjectSpace:function(a){var b=this.stageObject;a||(a=k.create());k.setMin(a,b.getBBMin(!0));k.setMax(a,b.getBBMax(!0));return a},getProjectedBoundingBox:function(a,b){var d=this.getBoundingBoxObjectSpace(b),e=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],h;for(h=0;h<e.length;h++){var n=e[h];f[0]=d[n[0]];f[1]=d[n[1]];f[2]=d[n[2]];c.multiplyVec3(this.stageObject.objectTransformation,f);g[3*h+0]=f[0];g[3*h+1]=f[1];g[3*h+2]=f[2]}if(a(g,0,8)){k.set(d,k.NEGATIVE_INFINITY);
for(h=0;h<g.length;h+=3)for(e=0;3>e;e++)d[e]=Math.min(d[e],g[h+e]),d[e+3]=Math.max(d[e+3],g[h+e]);return d}return null},getScreenSize:function(){throw Error("Not implemented for this symbol layer/graphic type");}});b.VisibilityModes={REMOVE_OBJECT:0,HIDE_FACERANGE:1};var g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=e.create(),a=function(a){q.call(this,a);this.centerPointInElevationSR=null};a.prototype=new q;a.prototype.constructor=a;return b})},"esri/views/3d/layers/graphics/Graphics3DDrapedGraphicLayer":function(){define(["../../../../core/declare",
"../../webgl-engine/Stage","../../webgl-engine/lib/Util","../../support/aaBoundingRect","../../support/aaBoundingBox"],function(s,q,n,k,h){var e=n.assert;s=s(null,{constructor:function(b,c,a,e,l){this.graphics3DSymbolLayer=b;this.renderGeometries=c;this.uniqueMaterials=a;this.uniqueTextures=e;this.boundingBox=l;this.stage=null;this._visibilityFlags={};this._shown=!1},initialize:function(b,c){this.stage=c;var a;if(this.uniqueMaterials)for(a=0;a<this.uniqueMaterials.length;a++)c.add(q.ModelContentType.MATERIAL,
this.uniqueMaterials[a]);if(this.uniqueTextures)for(a=0;a<this.uniqueTextures.length;a++)c.add(q.ModelContentType.TEXTURE,this.uniqueTextures[a])},isDraped:function(){return!0},areVisibilityFlagsSet:function(b,c){for(var a=!0,e=Object.keys(this._visibilityFlags),l=0;l<e.length;l++){var d=e[l];if(d!==c){if(d===b)return this._visibilityFlags[d];a=a&&this._visibilityFlags[d]}}return a},setVisibilityFlag:function(b,c){this._visibilityFlags[b]=c;return this._calcAndSetVisibility()},_calcAndSetVisibility:function(){var b=
this.areVisibilityFlagsSet();return this._shown!=b?(this._shown=b,e(this.stage,"Graphics3DDrapedGraphicLayer must be initialized first"),this._shown?this.stage.getTextureGraphicsRenderer().addRenderGeometries(this.renderGeometries):this.stage.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries),!0):!1},destroy:function(){if(this.stage){var b,c=this.stage;this._shown&&c.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries);this._shown=!1;if(this.uniqueMaterials)for(b=
0;b<this.uniqueMaterials.length;b++)c.remove(q.ModelContentType.MATERIAL,this.uniqueMaterials[b].getId());if(this.uniqueTextures)for(b=0;b<this.uniqueTextures.length;b++)c.remove(q.ModelContentType.TEXTURE,this.uniqueTextures[b].getId());this.stage=null}},mustAlignToTerrain:function(){return!1},alignWithElevation:function(){},setDrawOrder:function(b,c,a){this.uniqueMaterials&&this.uniqueMaterials.forEach(function(a){a.setRenderPriority(b);this._shown&&(c[a.getId()]=!0)}.bind(this))},getBSRadius:function(){var b=
0;this.renderGeometries.forEach(function(c){b=Math.max(b,c.bsRadius)});return b},getCenterObjectSpace:function(){return[0,0,0]},getProjectedBoundingBox:function(b,f){h.set(f,h.NEGATIVE_INFINITY);for(var a=0;a<this.renderGeometries.length;a++)this._getRenderGeometryProjectedBoundingRect(this.renderGeometries[a],c,b),h.expand(f,c);return f},_getRenderGeometryProjectedBoundingRect:function(c,f,a){if(this.boundingBox)h.set(b,this.boundingBox);else{var e=c.center;c=c.bsRadius;b[0]=e[0]-c;b[1]=e[1]-c;b[2]=
e[2]-c;b[3]=e[0]+c;b[4]=e[1]+c;b[5]=e[2]+c}a(b,0,2);return h.toRect(b,f)}});var c=k.create(),b=[0,0,0,0,0,0];return s})},"esri/views/3d/layers/graphics/ElevationAligners":function(){define(["../../../../geometry/Point","../../lib/glMatrix","../../webgl-engine/lib/Util","./Graphics3DSymbolCommonCode"],function(s,q,n,k){var h=n.VertexAttrConstants;q=q.vec3d;var e=new s,c=q.create(),b=q.create(),g=q.create();return{perVertexElevationAligner:function(f,a,r){var l=f.stageObject;f=f.elevationInfo;e.spatialReference=
a.spatialReference;for(var d=l.getGeometryRecords(),m=d.length,p=0;p<m;p++){var n=d[p].geometry,q=d[p].transformation;b[0]=q[12];b[1]=q[13];b[2]=q[14];n.invalidateBoundingInfo();for(var q=n.getData().getVertexAttr(),n=q[h.POSITION].data,q=q.mapPos.data,s=n.length/2,u=0,z=0,w=!1,C=0;C<s;C++){e.x=q[z++];e.y=q[z++];e.z=q[z++];g[0]=n[u];g[1]=n[u+1];g[2]=n[u+2];var A=k.computeElevation(a,e,f);c[0]=n[u]+b[0];c[1]=n[u+1]+b[1];c[2]=n[u+2]+b[2];r.setAltitude(A,c,0);n[u]=c[0]-b[0];n[u+1]=c[1]-b[1];n[u+2]=c[2]-
b[2];A=0.01/r.unitInMeters;if(Math.abs(g[0]-n[u])>A||Math.abs(g[1]-n[u+1])>A||Math.abs(g[2]-n[u+2])>A)w=!0;u+=3}w&&l.geometryVertexAttrsUpdated(p)}},perObjectElevationAligner:function(b,a,c){var e=b.elevationInfo,d=k.computeElevation(a,e.centerPointInElevationSR,e);a=b.stageObject.getObjectTransformation();e=[a[12],a[13],a[14]];c.setAltitudeOfTransformation(d,a);c=0.01/c.unitInMeters;(Math.abs(a[12]-e[0])>c||Math.abs(a[13]-e[1])>c||Math.abs(a[14]-e[2])>c)&&b.stageObject.setObjectTransformation(a)}}})},
"esri/views/3d/layers/graphics/Graphics3DSymbolCommonCode":function(){define("../../../../geometry/Point ../../../../geometry/support/mathUtils ./graphicUtils ./ElevationInfo ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/lib/Object3D".split(" "),function(s,q,n,k,h,e,c){var b=e.mat4d,g=e.vec3d.create(),f=b.identity(),a={x:0,y:0,z:0,spatialReference:null},r={createStageObjectForPoint:function(a,b,e,h,k,n,q,u,s){var w=b?b.length:0,C=this._context.clippingExtent;r.reprojectPoint(a,
g,this._context.elevationProvider.spatialReference);if(C&&!r.pointInBox2D(g,C))return null;r.reprojectPoint(a,g,this._context.renderSpatialReference);C=this._context.localOriginFactory.getOrigin(g);q=new c({castShadow:!1,metadata:{layerId:u,graphicId:s},idHint:q});for(u=0;u<w;u++)q.addGeometry(b[u],e[u],h?h[u]:f,k,C);r.setObjectElevation(q,a,n,this._context.renderSpatialReference,this._context.elevationProvider);return q},extendPointGraphicElevationInfo:function(a,b,c){a=a.elevationInfo;c=c.spatialReference;
r.reprojectPoint(b,g,c);a.centerPointInElevationSR={x:g[0],y:g[1],z:b.hasZ?g[2]:void 0,spatialReference:c}},placePointOnPolyline:function(a){var b=a.paths[0],b=q.getPointOnPath(b,q.getPathLength(b)/2);return new s(b[0],b[1],b[2],a.spatialReference)},placePointOnPolygon:function(a){return n.computeCentroid(a)},computeElevation:function(a,b,c){var f=0,e=b.z||0,g=0,g=c.mode,h=c.offset||0;g===k.MODES.ON_THE_GROUND?f=g=a.getElevation(b)||0:g===k.MODES.RELATIVE_TO_GROUND?(g=a.getElevation(b)||0,f=g+h,null==
c.featureExpression&&(f+=e)):g===k.MODES.ABSOLUTE_HEIGHT&&(f=e+h);return f},applyElevation:function(b,c,f,e,g,h,r){var n=r.mode,q=r.offset,s=0,s=0;a.spatialReference=b.spatialReference;f*=3;g*=3;for(var C=0;C<h;++C)a.x=c[f+0],a.y=c[f+1],a.z=c[f+2],n===k.MODES.ON_THE_GROUND?s=b.getElevation(a)||0:n===k.MODES.RELATIVE_TO_GROUND?(s=b.getElevation(a)||0,s+=q,null==r.featureExpression&&(s+=a.z)):n===k.MODES.ABSOLUTE_HEIGHT&&(s=a.z+q),e[g+0]=c[f+0],e[g+1]=c[f+1],e[g+2]=s,f+=3,g+=3},setObjectElevation:function(a,
b,c,f,e){c=r.computeElevation(e,b,c);e=a.getObjectTransformation();g[0]=b.x;g[1]=b.y;g[2]=c;h.computeLinearTransformation(b.spatialReference,g,e,f)?a.setObjectTransformation(e):console.warn("Could not locate symbol object properly, it might be misplaced")},getSingleSizeDriver:function(a){return isFinite(a[0])?a[0]:null},isCounterClockwise:function(a){for(var b=0,c=a.length-1,f=0;f<c;f++)b+=a[f][0]*a[f+1][1]-a[f+1][0]*a[f][1];return 0<=b},copyPointData:function(a,b,c,f,e,g){f*=3;for(var h=0;h<e;++h){var k=
a[b++];c[f++]=k[0];c[f++]=k[1];c[f++]=g?k[2]:0}return f/3},copyPathData:function(a,b){for(var c=a.length,f=Array(c),e=Array(c),g=Array(c),h=0,k=0,n=0,q=0,s=0;s<c;++s)q+=a[s].length;for(var q=new Float64Array(3*q),A=0,y=c-1;0<=y;y--){var B=a[y];if(r.isCounterClockwise(B))f[h++]=B;else{for(var D=B.length,s=0;s<h;++s)D+=f[s].length;s={index:A,pathLengths:Array(h+1),count:D,holeIndices:Array(h)};s.pathLengths[0]=B.length;0<B.length&&(g[n++]={index:A,count:B.length});A=r.copyPointData(B,0,q,A,B.length,
b);for(B=0;B<h;++B)D=f[B],s.holeIndices[B]=A,s.pathLengths[B+1]=D.length,0<D.length&&(g[n++]={index:A,count:D.length}),A=r.copyPointData(D,0,q,A,D.length,b);h=0;0<s.count&&(e[k++]=s)}}for(B=0;B<h;++B)D=f[B],0<D.length&&(g[n++]={index:A,count:D.length}),A=r.copyPointData(D,0,q,A,D.length,b);k<c&&(e.length=k);n<c&&(g.length=n);return{vertexData:q,polygons:e,outlines:g}},copyVertices:function(a,b,c,f,e){b*=3;f*=3;for(var g=0;g<e;++g)c[f++]=a[b++],c[f++]=a[b++],c[f++]=a[b++]},chooseOrigin:function(a,
b,c,f){b=Math.floor(b+(c-1)/2);f[0]=a[3*b+0];f[1]=a[3*b+1];f[2]=a[3*b+2]},subtractCoordinates:function(a,b,c,f){b*=3;for(var e=0;e<c;++e)a[b++]-=f[0],a[b++]-=f[1],a[b++]-=f[2]},setZ:function(a,b,c,f){b*=3;for(var e=0;e<c;++e)a[b+2]=f,b+=3},offsetZ:function(a,b,c,f){b*=3;for(var e=0;e<c;++e)a[b+2]+=f,b+=3},scaleZ:function(a,b,c,f){b*=3;for(var e=0;e<c;++e)a[b+2]*=f,b+=3},flatArrayToArrayOfArrays:function(a,b,c){var f=[];b*=3;for(var e=0;e<c;++e)f.push([a[b++],a[b++],a[b++]]);return f},reproject:function(a,
b,c,f,e,g,k){h.bufferToBuffer(a,c,b,f,g,e,k)},reprojectPoint:function(a,b,c){h.pointToVector(a,b,c)},getGeometryVertexData3D:function(a,b,c,f,e,g){var h=e.spatialReference;a=r.copyPathData(a,b);b=a.vertexData;var k=b.length/3,n=new Float64Array(b.length);c.equals(h)?r.copyVertices(b,0,n,0,b.length):r.reproject(b,0,c,n,0,h,k);r.applyElevation(e,n,0,b,0,k,g);h.equals(f)||r.reproject(b,0,h,b,0,f,k);return{geometryData:a,vertexData:b,eleVertexData:n}},getGeometryVertexDataDraped:function(a,b,c){a=r.copyPathData(a,
!1);var f=a.vertexData,e=f.length/3;b.equals(c)||h.bufferToBuffer(f,b,0,f,c,0,e);return{geometryData:a,vertexData:f}},computeBoundingBox:function(a,b,c,f){f[0]=Number.MAX_VALUE;f[1]=Number.MAX_VALUE;f[2]=Number.MAX_VALUE;f[3]=-Number.MAX_VALUE;f[4]=-Number.MAX_VALUE;f[5]=-Number.MAX_VALUE;b*=3;for(var e=0;e<c;++e){var g=a[b++],h=a[b++],k=a[b++];g<f[0]&&(f[0]=g);h<f[1]&&(f[1]=h);k<f[2]&&(f[2]=k);g>f[3]&&(f[3]=g);h>f[4]&&(f[4]=h);k>f[5]&&(f[5]=k)}return f},pointInBox2D:function(a,b){return!(a[0]>b[3]||
a[0]<b[0]||a[1]>b[4]||a[1]<b[1])},boxesIntersect2D:function(a,b){return!(b[0]>a[3]||b[3]<a[0]||b[1]>a[4]||b[4]<a[1])},boundingBoxClipped:function(a,b){return b?!r.boxesIntersect2D(a,b):!1},ELEV_MODES:k.MODES};return r})},"esri/views/3d/layers/graphics/graphicUtils":function(){define("require exports ../../../../geometry/SpatialReference ../../../../geometry/Point ../../../../geometry/support/webMercatorUtils ../../lib/glMatrix".split(" "),function(s,q,n,k,h,e){function c(b,c){var a=b.spatialReference;
a.equals(c)||(a.isWebMercator&&c.wkid===n.WGS84.wkid?h.webMercatorToGeographic(b,!1,b):c.isWebMercator&&a.wkid===n.WGS84.wkid&&h.geographicToWebMercator(b,!1,b))}var b=e.vec4d;q.computeCentroid=function(b,f){if("extent"===b.type)return b.center;for(var a=b["polygon"===b.type?"rings":"paths"],e=0,h=0,d=0,m=b.hasZ,p=0,n=0;n<a.length;n++){for(var q=a[n],s=0;s<q.length;s++)e+=q[s][0],h+=q[s][1],m&&(d+=q[s][2]);p+=q.length}a=new k({x:e/p,y:h/p,z:m?d/p:void 0,spatialReference:b.spatialReference});f&&c(a,
f);return a};q.convertToSR=c;q.enlargeExtent=function(c,f,a){if(c){f||(f=b.create());var e=0.5*c.width*(a-1);a=0.5*c.height*(a-1);c.width<1E-7*c.height?e+=a/20:c.height<1E-7*c.width&&(a+=e/20);b.set4(c.xmin-e,c.ymin-a,c.xmax+e,c.ymax+a,f);return f}return null}})},"esri/views/3d/webgl-engine/lib/Object3D":function(){define("require exports ./IdGen ./Util ./gl-matrix ./ModelContentType ./IntervalUtilities ./GeometryRecord".split(" "),function(s,q,n,k,h,e,c,b){var g=k.assert,f=h.mat4d,a=h.vec3d,r=k.VertexAttrConstants;
s=function(){function d(a){this.hiddenIndexRanges={};this.visibleIndexRanges={};this._bvObjectSpace=new l;this._bvWorldSpace=new l;this._bvDirty=!0;this.id=d._idGen.gen(a.idHint);this.name=a.name;this.castShadow=null!=a.castShadow?a.castShadow:!0;this.metadata=a.metadata;this.objectTransformation=f.identity();this._initializeGeometryRecords(a.geometries,a.materials,a.transformations,a.instanceParameters)}d.prototype._initializeGeometryRecords=function(a,c,d,e){if(Array.isArray(a)){g(c.length===a.length,
"Object3D: materials don't match geometries");g(d.length===a.length,"Object3D: transformations don't match geometries");this.geometryRecords=Array(a.length);this.geometries=a.slice();for(var h=0;h<a.length;h++)g(Array.isArray(c[h]),"Object3D: materials parameter must be array of array"),this.geometryRecords[h]=new b(a[h],c[h].slice(),f.create(d[h]),e?e.slice():null)}else this.geometryRecords=[],this.geometries=[]};d.prototype.getId=function(){return this.id};Object.defineProperty(d.prototype,"parentLayer",
{get:function(){return this._parentLayer},set:function(a){g(null==this._parentLayer||null==a,"Object3D can only be added to a single Layer");this._parentLayer=a},enumerable:!0,configurable:!0});d.prototype.getParentLayer=function(){return this.parentLayer};d.prototype.addParentLayer=function(a){this.parentLayer=a};d.prototype.removeParentLayer=function(a){this.parentLayer=null};d.prototype.getNumGeometryRecords=function(){return this.geometryRecords.length};d.prototype.getFirstGeometryIndex=function(a){a=
this.geometries.indexOf(a);g(-1<a,"Object3D.getFirstGeometryIndex: geometry not found");return a};d.prototype.findGeometryRecords=function(a){for(var b=[],c=0;c<this.geometries.length;c++)this.geometries[c]===a&&b.push(this.geometryRecords[c]);return b};d.prototype.getGeometryRecord=function(a){g(0<=a&&a<this.geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range");return this.geometryRecords[a]};d.prototype.getGeometryRecords=function(){return this.geometryRecords};d.prototype.addGeometry=
function(a,c,d,e,h){g(Array.isArray(c),"Object3D.addGeometry: materials must be array");this.geometries.push(a);a=new b(a,c.slice(),f.create(d),e,h);this.geometryRecords.push(a);this._notifyDirty("objGeometryAdded",a);this._invalidateBoundingVolume();return a};d.prototype.hasGeometry=function(a){return-1<this.geometries.indexOf(a)};d.prototype.removeGeometry=function(a){var b=this.geometryRecords.splice(a,1)[0];this.geometries.splice(a,1);this._notifyDirty("objGeometryRemoved",b);this._invalidateBoundingVolume();
return b};d.prototype.replaceGeometry=function(a,c){g(0<=a&&a<this.geometryRecords.length,"Object3d.replaceGeometry: index out of range");var d=this.geometryRecords[a],f=new b(c,d.materials,d.transformation);this.geometryRecords[a]=f;this.geometries[a]=c;this._notifyDirty("objGeometryReplaced",[d,f]);this._invalidateBoundingVolume();return d.geometry};d.prototype.replaceGeometryMaterials=function(a,c){g(0<=a&&a<this.geometryRecords.length,"Object3d.replaceGeometryMaterials: index out of range");var d=
this.geometryRecords[a],f=d.materials,e=new b(d.geometry,c.slice(),d.transformation);this.geometryRecords[a]=e;this._notifyDirty("objGeometryReplaced",[d,e]);return f};d.prototype.geometryVertexAttrsUpdated=function(a){this._notifyDirty("vertexAttrsUpdated",this.geometryRecords[a]);this._invalidateBoundingVolume()};d.prototype.geometryColorAttrsUpdated=function(a){this._notifyDirty("colorAttrsUpdated",this.geometryRecords[a])};d.prototype.getHiddenIndexRanges=function(a){return this.hiddenIndexRanges[a.getId()]};
d.prototype.getVisibleIndexRanges=function(a){return this.visibleIndexRanges[a.getId()]};d.prototype.isAllHidden=function(){for(var a=0;a<this.geometryRecords.length;a++){var b=this.geometryRecords[a],c=b.geometry.data.faces.length,b=this.getVisibleIndexRanges(b);if(!b)return!1;for(var d=0;d<c;d++){var f=b[d];if(!f||0<f.length)return!1}}return!0};d.prototype.setFacerangeColors=function(a,b){var c=this.geometryRecords;if(1!==c.length)console.warn("face range colors currently support only one geometry record");
else if(!a.every(function(a){return null==a.color})){var c=c[0].geometry,d=c.data.vertexAttributes;null===c.originalColors&&(c.originalColors=d[r.COLOR].data,d[r.COLOR].data=new c.originalColors.constructor(c.originalColors));d=d[r.COLOR].data;if(null!=d){for(var f=0;f<a.length;f++){var e=a[f],g=null==e.faceRanges?0:12*e.faceRanges[0],h=null==e.faceRanges?d.length:12*(e.faceRanges[1]+1);if(null!=e.color)if("blend"===b)for(var l=e.color[0],k=e.color[1],n=e.color[2],e=e.color[3];g<h;g+=4)d[g+0]=c.originalColors[g+
0]*l,d[g+1]=c.originalColors[g+1]*k,d[g+2]=c.originalColors[g+2]*n,d[g+3]=c.originalColors[g+3]*e;else{l=255*e.color[0];k=255*e.color[1];n=255*e.color[2];for(e=255*e.color[3];g<h;g+=4)d[g+0]=l,d[g+1]=k,d[g+2]=n,d[g+3]=e}else for(;g<h;g++)d[g]=c.originalColors[g]}this.geometryColorAttrsUpdated(0)}}};d.prototype.isPartiallyHidden=function(){for(var a=0;a<this.geometryRecords.length;a++){var b=this.geometryRecords[a],c=b.geometry.data.faces.length;if(b=this.getHiddenIndexRanges(b))for(var d=0;d<c;d++){var f=
b[d];if(f&&0<f.length)return!0}}return!1};d.prototype.hideFaceRange=function(a,b){var d=a.id;null==this.hiddenIndexRanges[d]&&(this.hiddenIndexRanges[d]=[],this.visibleIndexRanges[d]=[]);for(var f=0;f<a.geometry.data.faces.length;f++){null==this.hiddenIndexRanges[d][f]&&(this.hiddenIndexRanges[d][f]=[],this.visibleIndexRanges[d][f]=[]);var e=c.copyIntervals(b);c.convertFaceToIndexRange(e,3);var g=a.geometry.data.faces[f].componentRange,e=c.intersectIntervals(e,g),e=c.offsetIntervals(e,-g[0]);this.hiddenIndexRanges[d][f]=
this.hiddenIndexRanges[d][f].concat(e);this.hiddenIndexRanges[d][f]=c.mergeIntervals(this.hiddenIndexRanges[d][f]);0===this.hiddenIndexRanges[d].length?(delete this.visibleIndexRanges[d],delete this.hiddenIndexRanges[d]):this.visibleIndexRanges[d][f]=c.invertIntervals(this.hiddenIndexRanges[d][f],a.geometry.data.faces[f].indices.position.length-1)}this._notifyDirty("hideFaceRange",a)};d.prototype.hideAllFaceRanges=function(){this.hiddenIndexRanges={};this.visibleIndexRanges={};for(var a=0;a<this.geometryRecords.length;a++){var b=
this.geometryRecords[a],c=b.getId();this.hiddenIndexRanges[c]=[];this.visibleIndexRanges[c]=[];for(var d=b.geometry.data.faces.length,f=0;f<d;f++)this.hiddenIndexRanges[c][f]=[[0,b.geometry.data.faces[f].indices.position.length-1]],this.visibleIndexRanges[c][f]=[];this._notifyDirty("hideFaceRange",b)}return!0};d.prototype.unhideAllFaceRange=function(){this.hiddenIndexRanges={};this.visibleIndexRanges={};this._notifyDirty("unhideAllFaceRange")};d.prototype.getFaceRangeIndexFromTriangleNr=function(a){var b=
this.metadata.faceRanges;if(null!=b)for(var c=0;c<b.length;c++)if(b[c][0]<=a&&b[c][1]>=a)return c};d.prototype.getFaceRangeFromTriangleNr=function(a){a=this.getFaceRangeIndexFromTriangleNr(a);var b=this.metadata.faceRanges;return a?[b[a]]:null};d.prototype.setGeometryTransformation=function(a,c){g(0<=a&&a<this.geometryRecords.length,"Object3d.setGeometryTransformation: index out of range");var d=this.geometryRecords[a],e=new b(d.geometry,d.materials,f.create(c));this.geometryRecords[a]=e;this._notifyDirty("objGeometryReplaced",
[d,e]);this._invalidateBoundingVolume()};d.prototype.getObjectTransformation=function(){return f.create(this.objectTransformation)};d.prototype.setObjectTransformation=function(a){f.set(a,this.objectTransformation);this._invalidateBoundingVolume();this._notifyDirty("objTransformation")};d.prototype.getCombinedTransformation=function(a,b){b=b||f.create();f.multiply(this.objectTransformation,a.transformation,b);return b};d.prototype.getCastShadow=function(){return this.castShadow};d.prototype.setCastShadow=
function(a){this.castShadow=a};d.prototype.getMetadata=function(){return this.metadata};d.prototype.getName=function(){return this.name};d.prototype.getBBMin=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin};d.prototype.getBBMax=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax};d.prototype.getCenter=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.center:this._bvWorldSpace.center};
d.prototype.getBSRadius=function(a){this._validateBoundingVolume();return a?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius};d.prototype.calcFacerangeBoundingSphere=function(a){var b=null;null!=a&&(1===this.geometries.length&&1===this.geometries[0].numGroups)&&(b=this.getFaceRangeFromTriangleNr(a));if(null==b||1!==b.length)return{center:this.getCenter(),radius:this.getBSRadius()};a=this.geometries[0].calculateBoundingInfo(0,b[0]);b=a.getCenter();f.multiplyVec3(this.geometryRecords[0].transformation,
b);f.multiplyVec3(this.objectTransformation,b);return{center:b,radius:a.getBSRadius()*this._getScaleFactor(this.geometryRecords[0].transformation)*this._getScaleFactor(this.objectTransformation)}};d.prototype._validateBoundingVolume=function(){if(this._bvDirty){this._bvObjectSpace.init();this._bvWorldSpace.init();for(var b=a.create(),c=a.create(),d=0;d<this.geometryRecords.length;++d)for(var e=this.geometries[d],g=this.geometryRecords[d].transformation,h=0,l=e.getNumGroups();h<l;++h){var k=e.getBoundingInfo(h);
f.multiplyVec3(g,k.getBBMin(),b);f.multiplyVec3(g,k.getBBMax(),c);for(var r=0;3>r;++r)this._bvObjectSpace.bbMin[r]=Math.min(this._bvObjectSpace.bbMin[r],b[r],c[r]),this._bvObjectSpace.bbMax[r]=Math.max(this._bvObjectSpace.bbMax[r],b[r],c[r]);f.multiplyVec3(this.objectTransformation,b);f.multiplyVec3(this.objectTransformation,c);for(r=0;3>r;++r)this._bvWorldSpace.bbMin[r]=Math.min(this._bvWorldSpace.bbMin[r],b[r],c[r]),this._bvWorldSpace.bbMax[r]=Math.max(this._bvWorldSpace.bbMax[r],b[r],c[r])}a.lerp(this._bvObjectSpace.bbMin,
this._bvObjectSpace.bbMax,0.5,this._bvObjectSpace.center);a.lerp(this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,0.5,this._bvWorldSpace.center);r=this._getScaleFactor(this.objectTransformation);for(d=0;d<this.geometryRecords.length;++d)for(var e=this.geometries[d],g=this.geometryRecords[d].transformation,n=this._getScaleFactor(g),h=0,l=e.getNumGroups();h<l;++h){k=e.getBoundingInfo(h);f.multiplyVec3(g,k.getCenter(),b);var q=a.dist(b,this._bvObjectSpace.center),k=k.getBSRadius()*n;this._bvObjectSpace.bsRadius=
Math.max(this._bvObjectSpace.bsRadius,q+k);f.multiplyVec3(this.objectTransformation,b,c);q=a.dist(c,this._bvWorldSpace.center);this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,q+k*r)}this._bvDirty=!1}};d.prototype._getScaleFactor=function(a){var b=Math.sqrt(a[0]*a[0]+a[4]*a[4]+a[8]*a[8]),c=Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9]);a=Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]);return Math.max(Math.max(b,c),a)};d.prototype._invalidateBoundingVolume=function(){this._bvDirty=!0;this._parentLayer&&
this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace)};d.prototype._notifyDirty=function(a,b,c,d){this._parentLayer&&(c=c||e.OBJECT,this._parentLayer.notifyDirty(a,b,c,d||this))};d._idGen=new n;return d}();var l=function(){function b(){this.bbMin=a.create();this.bbMax=a.create();this.center=a.create();this.bsRadius=0}b.prototype.init=function(){a.set3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,this.bbMin);a.set3(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,this.bbMax);
a.set3(0,0,0,this.center);this.bsRadius=0};b.prototype.getCenter=function(){return this.center};b.prototype.getBSRadius=function(){return this.bsRadius};return b}();return s})},"esri/views/3d/webgl-engine/lib/GeometryRecord":function(){define(["require","exports","./IdGen"],function(s,q,n){return function(){function k(h,e,c,b,g){this.id=k._idGen.gen(h.getId());this.geometry=h;this.materials=e;this.transformation=c;this.instanceParameters=b;this.origin=g}k.prototype.getId=function(){return this.id};
k._idGen=new n;return k}()})},"esri/views/3d/layers/graphics/SignedDistanceFunctions":function(){define(["require","exports","../../support/mathUtils"],function(s,q,n){function k(b,c,f){b=n.clamp(b,0,0.9999991);var a=b*h[0]-Math.floor(b*h[0]),k=b*h[1]-Math.floor(b*h[1]),l=b*h[2]-Math.floor(b*h[2]);b=b*h[3]-Math.floor(b*h[3]);c[f+0]=256*(a-a*e[0]);c[f+1]=256*(k-a*e[1]);c[f+2]=256*(l-k*e[2]);c[f+3]=256*(b-l*e[3])}var h=[16777216,65536,256,1],e=[0,1/256,1/256,1/256],c=[1/16777216,1/65536,1/256,1];q.packFloat=
k;q.unpackFloat=function(b,e){var f=b[e+1]/256,a=b[e+2]/256,h=b[e+3]/256,l;l=0+b[e+0]/256*c[0];l+=f*c[1];l+=a*c[2];return l+=h*c[3]};q.computeSignedDistancefieldCicle=function(b,c){for(var f=new Uint8Array(4*b*b),a=b/2-0.5,e=c/2,h=0;h<b;h++)for(var d=0;d<b;d++){var m=d+b*h,p=d-a,n=h-a,p=Math.sqrt(p*p+n*n)-e,p=p/b+0.5;k(p,f,4*m)}return f};q.computeSignedDistancefieldSquare=function(b,c,f){f&&(c/=Math.SQRT2);for(var a=new Uint8Array(4*b*b),e=0;e<b;e++)for(var h=0;h<b;h++){var d=h-0.5*(b-0.5),m=e-0.5*
(b-0.5),p=e*b+h;if(f)var n=(d+m)/Math.SQRT2,m=(m-d)/Math.SQRT2,d=n;d=Math.max(Math.abs(d),Math.abs(m))-0.5*c;d=d/b+0.5;k(d,a,4*p)}return a};q.computeSignedDistancefieldCrossAndX=function(b,c,f){f&&(c*=Math.SQRT2);c*=0.5;for(var a=new Uint8Array(4*b*b),e=0;e<b;e++)for(var h=0;h<b;h++){var d=h-0.5*b-0.5,m=e-0.5*b-0.5,p=e*b+h;if(f)var n=(d+m)/Math.SQRT2,m=(m-d)/Math.SQRT2,d=n;d=Math.abs(d);m=Math.abs(m);n=void 0;n=d>m?d>c?Math.sqrt((d-c)*(d-c)+m*m):m:m>c?Math.sqrt(d*d+(m-c)*(m-c)):d;n=n/b+0.5;k(n,a,
4*p)}return a}})},"esri/views/3d/layers/graphics/Graphics3DObjectSymbolLayer":function(){define("../../../../core/declare ../../../../Color ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ../i3s/I3SSymbolLoader ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util".split(" "),function(s,q,n,k,h,e,c,b,g,f,a,r,l){var d=l.assert,
m=b.mat4d,p=b.vec3d,t=[1,1,1],x=[10,10,10],v=[g.ModelContentType.MATERIAL,g.ModelContentType.TEXTURE,g.ModelContentType.GEOMETRY];return s([n],{_prepareResources:function(){var a=this.symbol,b=this._getStageIdHint();a.resource&&a.resource.href?((a=a.resource.href)&&(0===a.indexOf("http")&&"https:"===location.protocol)&&(a=a.replace(/^http:/i,"https:")),this._prepareModelResources(a,b)):this._preparePrimitiveResources(a.resource?a.resource.primitive:"sphere",b)},_sizeToScale:function(a,b,c,d){for(var f=
Array(3),e=2;0<=e;e--){var g=a[e];null!==g&&isFinite(g)?f[e]=g/(b[e+3]-b[e]):f[e]="symbolValue"===g?c?c[e]:1:null}a=d;b=0;for(e=2;0<=e;e--)g=f[e],null!==g&&(a=g,b=Math.max(b,Math.abs(g)));for(e=2;0<=e;e--)null===f[e]?f[e]=a:0===f[e]&&(f[e]=0.0010*b);return f},_computeSymbolScale:function(a,b){var c=[a.width,a.depth,a.height];return c[0]||c[1]||c[2]?this._sizeToScale(c,b,null,1):null},_preparePrimitiveResources:function(b,c){var d=this.symbol;if("sphere"===b)this._geometryData=a.createPolySphereGeometry(0.5,
2,!0),this._geometryOrigin="center";else if("cube"===b)this._geometryData=a.createBoxGeometry(1),this._geometryOrigin="center";else if("cylinder"===b)this._geometryData=a.createCylinderGeometry(1,0.5,16,[0,0,1],[0,0,0.5]),this._geometryOrigin="bottom";else if("cone"===b)0>d.height?(this._geometryData=a.createConeGeometry(1,0.5,15,!0),d.height=-d.height):this._geometryData=a.createConeGeometry(1,0.5,15,!1),a.cgToGIS(this._geometryData),this._geometryOrigin="bottom";else if("tetrahedron"===b)this._geometryData=
a.createTetrahedronGeometry(1),a.cgToGIS(this._geometryData),this._geometryOrigin="bottom";else if("diamond"===b)this._geometryData=a.createDiamondGeometry(1),a.cgToGIS(this._geometryData),this._geometryOrigin="center";else{console.warn("Unknown object symbol primitive: "+b);this.reject();return}this._geometry=new f(this._geometryData,c);this._context.stage.add(g.ModelContentType.GEOMETRY,this._geometry);var e=[-0.5,-0.5,-0.5,0.5,0.5,0.5];this._symbolScale=this._computeSymbolScale(d,e);this._boundingBox=
e;e=this._getMaterialOpacity();e={specular:[0,0,0],shininess:3,opacity:e,transparent:1>e||this._isPropertyDriven("opacity"),instanced:this._hasPerInstanceColor()?["transformation","color"]:["transformation"]};this._isPropertyDriven("color")?(e.ambient=t,e.diffuse=t):(d=d.material?q.toUnitRGB(d.material.color):t,e.ambient=d,e.diffuse=d);this._material=new r(e,c+"_objectmat");this._context.stage.add(g.ModelContentType.MATERIAL,this._material);this.resolve()},_prepareModelResources:function(a,b){var d=
{materialParamsMixin:{instanced:this._hasPerInstanceColor()?["transformation","color"]:["transformation"]},idHint:b};(new c(this._context.streamDataSupplier)).fetchSymbol(a,d).then(function(a){if(!this.isRejected()){var b=a.stageResources,c=this._context.stage,d=this.symbol.material,f;this._isPropertyDriven("color")?f={ambient:t,diffuse:t}:d&&d.color&&(d=q.toUnitRGB(d.color),f={ambient:d.map(function(a){return a/1.5}),diffuse:d});var e=this._computeModelOpacityOverride();a.originalMaterialOpacities=
Array(b[g.ModelContentType.MATERIAL].length);b[g.ModelContentType.MATERIAL].forEach(function(b,c){var d=b.getParameterValues();a.originalMaterialOpacities[c]=d.opacity;f&&b.setParameterValues(f);e.overwrite?b.setParameterValues({opacity:e.overwrite,transparent:e.blendingRequired}):null!=e.multiply&&(d.opacity*=e.multiply,d.transparent=1>d.opacity,b.setParameterValues({opacity:d.opacity,transparent:d.transparent}))});v.forEach(function(a){for(var d=b[a],f=0;d&&f<d.length;f++)c.add(a,d[f])});for(var h=
b[g.ModelContentType.GEOMETRY],d=a.geometryTransformations,l=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],k=[0,0,0],r=[0,0,0],n=0;n<h.length;n++)for(var u=h[n],s=0,x=u.getNumGroups();s<x;++s){var w=u.getBoundingInfo(s);m.multiplyVec3(d[n],w.getBBMin(),k);m.multiplyVec3(d[n],w.getBBMax(),r);for(w=0;3>w;++w){if(k[w]>r[w]){var z=k[w];k[w]=r[w];r[w]=z}l[w]=Math.min(l[w],k[w]);l[w+3]=Math.max(l[w+3],r[w])}}this._boundingBox=l;this._symbolScale=
this._computeSymbolScale(this.symbol,l);p.scale(a.pivotOffset,-1);h=d.length;for(l=0;l<h;l++)m.translate(d[l],a.pivotOffset);p.scale(a.pivotOffset,-1);this._i3sModel=a;this.resolve()}}.bind(this),function(){this.reject()}.bind(this))},_computeModelOpacityOverride:function(){var a={overwrite:null,blendingRequired:!1,multiply:null},b=this._getMaterialOpacity();this._isPropertyDriven("opacity")?(a.overwrite=b,a.blendingRequired=!0):this.symbol.material&&void 0!==this.symbol.material.transparency?(a.overwrite=
b,a.blendingRequired=1>a.overwrite):1>b&&(a.multiply=b,a.blendingRequired=!0);return a},destroy:function(){this.isFulfilled()||this.reject();var a=this._context.stage;if(this._i3sModel){var b=this._i3sModel.stageResources;v.forEach(function(c){for(var d=b[c],f=0;d&&f<d.length;f++)a.remove(c,d[f].getId())})}else this._material&&a.remove(g.ModelContentType.MATERIAL,this._material.getId()),this._geometry&&a.remove(g.ModelContentType.GEOMETRY,this._geometry.getId())},createGraphics3DGraphic:function(a,
b){var c=a.geometry;if("polyline"===c.type)c=e.placePointOnPolyline(c);else if("polygon"===c.type)c=e.placePointOnPolygon(c);else if("extent"===c.type)c=c.get("center");else if("point"!==c.type)return this._logWarning("unsupported geometry type for object symbol: "+c.type),null;var d="graphic"+a.id,f=this._getGraphicElevationInfo(a);return this._createAs3DShape(a,c,b,f,d,a.id)},layerPropertyChanged:function(a,b,c){if("opacity"===a){if(this._i3sModel){var d=this._computeModelOpacityOverride();this._i3sModel.stageResources[g.ModelContentType.MATERIAL].forEach(function(a,
b){if(d.overwrite)a.setParameterValues({opacity:d.overwrite,transparent:d.blendingRequired});else{var c=this._i3sModel.originalMaterialOpacities[b];null!=d.multiply&&(c*=d.multiply);a.setParameterValues({opacity:c,transparent:1>c})}}.bind(this))}else b=this._getMaterialOpacity(),this._material.setParameterValues({opacity:b,transparent:1>b||this._isPropertyDriven("opacity")});return!0}if("elevationInfo"===a){this._updateElevationInfo();a=this._context.elevationProvider;var f=this._context.renderCoordsHelper,
m=h.perObjectElevationAligner,l=e.ELEV_MODES.ABSOLUTE_HEIGHT,k;for(k in b){var p=b[k],r=p._graphics[c];r&&(p=this._getGraphicElevationInfo(p.graphic),r.elevationAligner=p.mode!==l?m:null,r.elevationInfo.set(p),m(r,a,f))}return!0}return!1},_createAs3DShape:function(a,b,c,d,f,l){a=this._hasPerInstanceColor()?{color:this._mixinColorAndOpacity(c.color,c.opacity)}:null;c=this._computeObjectScale(c,!this._i3sModel);var p=this._context.layer.id;if(this._i3sModel){var r=this._i3sModel.stageResources[g.ModelContentType.GEOMETRY],
n=this._i3sModel.materialsByComponent,t=this._i3sModel.geometryTransformations;f=e.createStageObjectForPoint.call(this,b,null,null,null,null,d,f,p,l);if(null===f)return null;for(l=0;l<r.length;l++){p=t[l];if(c){var q=m.identity();m.scale(q,c);m.multiply(q,p);p=q}for(var q=n[l],s=q.length,x=Array(s),v=0;v<s;v++)x[v]=a;f.addGeometry(r[l],q,p,x)}}else n=this.symbol,"bottom"===n.anchor&&"center"===this._geometryOrigin?r=[0,0,0.5]:"center"===n.anchor&&"bottom"===this._geometryOrigin&&(r=[0,0,-0.5]),n=
m.identity(),c&&m.scale(n,c),r&&m.translate(n,r),f=e.createStageObjectForPoint.call(this,b,[this._geometry],[[this._material]],[n],[a],d,f,p,l);if(null===f)return null;f.setCastShadow(!0);a=null;d.mode!==e.ELEV_MODES.ABSOLUTE_HEIGHT&&(a=h.perObjectElevationAligner);d=new k(this,f,null,null,null,a,d,k.VisibilityModes.REMOVE_OBJECT);e.extendPointGraphicElevationInfo(d,b,this._context.elevationProvider);return d},_computeObjectScale:function(a,b){var c;a.size&&this._isPropertyDriven("size")?(c=this._sizeToScale(a.size,
this._boundingBox,this._symbolScale,null),d(null!=c[0],"sizeInfo has no values")):c=this._symbolScale?this._symbolScale.slice(0):b?x.slice(0):[1,1,1];for(var f=this._context.renderCoordsHelper.unitInMeters,e=2;0<=e;e--)c[e]/=f;return 1!==c[0]||1!==c[1]||1!==c[2]?c:null},_hasPerInstanceColor:function(){return this._isPropertyDriven("color")||this._isPropertyDriven("opacity")}})})},"esri/views/3d/layers/i3s/I3SSymbolLoader":function(){define("../../../../core/declare dojo/_base/lang ../../support/PromiseLightweight ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Util ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/Material ../../webgl-engine/lib/Texture".split(" "),
function(s,q,n,k,h,e,c,b,g,f){var a=k.mat4d,r=e.assert;return s(null,{constructor:function(a){this.streamDataSupplier=a},destroy:function(){},fetchSymbol:function(a,b){b=b||{};var c=new n.Promise;this.streamDataSupplier.request(a,"json").then(function(a,f){var e=this._createStageResources(f,b);c.done(e)}.bind(this),function(){c.reject()});return c},_gatherExternalTextures:function(a){for(var b in a.textureDefinitions)for(var c=a.textureDefinitions[b],f=0;f<c.images.length;f++)"href"in c.images[f]&&
console.warn("External image resources not yet supported");return{}},_extractTextureImageFromBin:function(a,b){var c=new n.Promise,f=new Uint8Array(a,b.byteOffset,b.length),f=new Blob([f],{type:b.encoding}),e=window.URL.createObjectURL(f),g=new Image;g.onerror=function(){window.URL.revokeObjectURL(e);c.reject();g.url="";g.onerror=void 0;g.onload=void 0};g.onload=function(){window.URL.revokeObjectURL(e);b.img=g;c.done();g.url="";g.onerror=void 0;g.onload=void 0};g.src=e;return c},_createStageResources:function(e,
d){var m=[],k=[],n=[],s=[],v=[],u=[],z="meshsymbol_"+e.model.name,w=e.textureDefinitions,C={},A;for(A in w){var y=w[A],B=y.images[0].data;r(B,"symbol resources must have embedded texture data (at the moment)");var D="/textureDefinitions/"+A,B=new f(y.encoding+";base64,"+B,z,{noUnpackFlip:!0});v.push(B);C[D]={engineTexObj:B,transparent:"rgba"===y.channels}}w=e.model.geometries;A=e.materialDefinitions;for(y=0;y<w.length;y++){D=w[y];D.params.components||this._createSingleComponent(D);var B=D.params.components,
F=B.length,H=D.params.faces,N=D.params.vertexAttributes,G=D.params.topology||"Indexed",O={},M;for(M in N){var I=N[M];r(I.values,"symbol resources with external geometry bin not yet supported");O[M]={data:I.values,size:I.valuesPerElement}}var Z,N=Array(F);if("Indexed"===G)for(M in Z=H.componentIndices,H);else"PerAttributeArray"!==G?console.warn("I3S symbol loader: unsupported topology type "+G):1!==F&&console.warn("I3S symbol loader: if topology is not Indexed, only single component geometries are supported");
n.push([]);for(F=0;F<B.length;F++){G=B[F];I={type:"triangle",positionKey:"position",indices:{}};if(Z)for(M in H){if("componentIndices"!==M){var V=H[M];r(V.values,"symbol resources with external geometry bin not yet supported");I.indices[M]=new Uint32Array(V.values)}}else{for(var V=O.position.data.length/O.position.size,L=new Uint32Array(V),Y=0;Y<V;Y++)L[Y]=Y;V=L;for(M in O)I.indices[M]=V}N[F]=I;var E;G.texture&&(E=C[G.texture].engineTexObj.getId());I=s[G.material]?s[G.material][G.texture]:null;I||
(I=G.material.substring(G.material.lastIndexOf("/")+1),I=A[I].params,1===I.transparency&&(I.transparency=0),I={ambient:I.diffuse,diffuse:I.diffuse,specular:I.specular,shininess:I.shininess,opacity:1-I.transparency,textureId:E,doubleSided:!0,cullFace:"none",flipV:!1},I.transparent=1>I.opacity,d.materialParamsMixin&&q.mixin(I,d.materialParamsMixin),I=new g(I,z),s[G.material]||(s[G.material]={}),s[G.material][G.texture]=I,k.push(I));n[y].push(I)}B=new c(new b(N,O),z);D=a.create(D.transformation);m.push(B);
u.push(D)}s={stageResources:{}};s.stageResources[h.ModelContentType.TEXTURE]=v;s.stageResources[h.ModelContentType.MATERIAL]=k;s.stageResources[h.ModelContentType.GEOMETRY]=m;s.geometryTransformations=u;s.materialsByComponent=n;s.pivotOffset=e.model.pivotOffset;return s},_createSingleComponent:function(a){var b=a.params;r(b.material);b.components=[{id:1,material:a.params.material,texture:a.params.texture,region:a.params.texture}];b.faces&&(b.faces.componentIndices=[b.faces.position.count])}})})},
"esri/views/3d/layers/graphics/Graphics3DLineSymbolLayer":function(){define("../../../../core/declare ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./lineUtils ../../../../core/screenUtils ../../../../geometry/Polygon ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/RenderGeometry".split(" "),function(s,q,n,k,h,e,c,b,g,f,a,r,l,d){var m=
f.vec3d,p=f.mat4d;return s([q],{_prepareResources:function(){var b=this.symbol,d=this._isPropertyDriven("size"),f={idHint:this._getStageIdHint(),width:this._getWidth(b),color:this._getMaterialOpacityAndColor()};if(d||2<f.width)d&&(f.width=0),f.miterLimit=b.miterLimit,f.join=b.join,this._isNativeLineMaterial=!1,this._material=c.createRibbonMaterial(f);else if(0<f.width)this._isNativeLineMaterial=!0,this._material=c.createNativeMaterial(f);else{this.reject();return}this._context.stage.add(a.ModelContentType.MATERIAL,
this._material);this.resolve()},_getWidth:function(a){return null!=a.size?b.pt2px(a.size):1},destroy:function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(a.ModelContentType.MATERIAL,this._material.getId()),this._material=null)},createGraphics3DGraphic:function(a,c){var d=a.geometry;if("polyline"!==d.type&&"polygon"!==d.type&&"extent"!==d.type)return this._logWarning("unsupported geometry type for line symbol: "+d.type),null;var d="polygon"===d.type||"extent"===
d.type?"rings":"paths",f="graphic"+a.id,g=this._getVertexOpacityAndColor(c,Float32Array,255),h=0;c.size&&this._isPropertyDriven("size")&&(h=e.getSingleSizeDriver(c.size),h=b.pt2px(h));var m=this._getGraphicElevationInfo(a);return m.mode===e.ELEV_MODES.ON_THE_GROUND?this._createAsOverlay(a,d,g,h,m,f):this._createAs3DShape(a,d,g,h,m,f,a.id)},layerPropertyChanged:function(a,b,c){if("opacity"===a)return this._isNativeLineMaterial?(b=this._material.getColor(),b[3]=this._getMaterialOpacity(),this._material.setColor(b)):
(b=this._material.getParameterValues(),b.color[3]=this._getMaterialOpacity(),this._material.setParameterValues({color:b.color})),!0;if("elevationInfo"===a){a=this._elevationInfo.mode;this._updateElevationInfo();var d=this._elevationInfo.mode;if(null==a||null==d)return!1;var f=e.ELEV_MODES;if(a===f.ON_THE_GROUND&&d===f.ON_THE_GROUND)return!0;if(a!==d&&(a===f.ON_THE_GROUND||d===f.ON_THE_GROUND))return!1;a=d===f.RELATIVE_TO_GROUND?h.perVertexElevationAligner:null;var d=this._context.elevationProvider,
f=this._context.renderCoordsHelper,g;for(g in b){var m=b[g],l=m._graphics[c];l&&(m=m.graphic,l.elevationAligner=a,l.elevationInfo.set(this._getGraphicElevationInfo(m)),h.perVertexElevationAligner(l,d,f))}return!0}return!1},_getOutlineGeometry:function(a,b){return a._outlineSegments?c.createOutlineGeometryFromSegments(b,a._outlineSegments):b},_getGeometry:function(a){a=a.geometry;"extent"===a.type&&(a=g.fromExtent(a));return a},_createAs3DShape:function(a,b,d,f,g,k,q){var s=this._getGeometry(a),y=
s.hasZ,B=this._getOutlineGeometry(s,s[b]);if(0<B.length){a=[];for(var D=[],F=[],H=m.create(),N=Array(6),B=e.getGeometryVertexData3D(B,y,s.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,g),s=B.geometryData.outlines,y=B.eleVertexData,B=B.vertexData,G=0;G<s.length;++G){var O=s[G],M=O.index,I=O.count;if(this._context.clippingExtent&&(e.computeBoundingBox(y,M,I,N),e.boundingBoxClipped(N,this._context.clippingExtent)))continue;e.chooseOrigin(B,M,I,H);e.subtractCoordinates(B,
M,I,H);O=new Float64Array(y.buffer,3*M*y.BYTES_PER_ELEMENT,3*I);M=new Float64Array(B.buffer,3*M*B.BYTES_PER_ELEMENT,3*I);M=c.createPolylineGeometry(M,O,"rings"===b,d,f,!1);M=new l(M,k+"path"+G);M.singleUse=!0;a.push(M);D.push([this._material]);M=p.identity();p.translate(M,H,M);F.push(M)}b=new r({geometries:a,materials:D,transformations:F,castShadow:!1,metadata:{layerId:this._context.layer.id,graphicId:q},idHint:k});d=null;g.mode===e.ELEV_MODES.RELATIVE_TO_GROUND&&(d=h.perVertexElevationAligner);return new n(this,
b,a,null,null,d,g)}this._logWarning("no paths found for line symbol");return null},_createAsOverlay:function(a,b,f,g,h,l){var r=this._getGeometry(a);this._material.setRenderPriority(this._symbolLayerOrder);var n=this._getOutlineGeometry(r,r[b]);if(0<n.length){a=[];h=Array(6);for(var q=m.create(),n=e.getGeometryVertexDataDraped(n,r.spatialReference,this._context.overlaySR),r=n.vertexData,n=n.geometryData.outlines,s=0;s<n.length;++s){var D=n[s],F=D.index,D=D.count;e.computeBoundingBox(r,F,D,h);if(!e.boundingBoxClipped(h,
this._context.clippingExtent)){e.chooseOrigin(r,F,D,q);e.subtractCoordinates(r,F,D,q);e.setZ(r,F,D,this._getDrapedZ());D=new Float64Array(r.buffer,3*F*r.BYTES_PER_ELEMENT,3*D);F=p.identity();p.translate(F,q,F);var D=c.createPolylineGeometry(D,null,"rings"===b,f,g,!0),H=new d(D);H.material=this._material;H.center=[0.5*(h[0]+h[3]),0.5*(h[1]+h[4]),0];H.bsRadius=0.5*Math.sqrt((h[3]-h[0])*(h[3]-h[0])+(h[4]-h[1])*(h[4]-h[1]));H.transformation=F;H.name=l;H.uniqueName=l+"#"+D.id;a.push(H)}}return new k(this,
a,null,null,h)}return null}})})},"esri/views/3d/layers/graphics/lineUtils":function(){define("require exports ../../webgl-engine/materials/RibbonLineMaterial ../../webgl-engine/materials/NativeLineMaterial ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/Util".split(" "),function(s,q,n,k,h,e){function c(b){var c=b.length;return b[0]===b[c-3]&&b[1]===b[c-2]&&b[2]===b[c-1]}var b=e.VertexAttrConstants;q.createRibbonMaterial=function(b){var c={width:b.width,color:b.color,miterLimit:b.miterLimit,
polygonOffset:!0};"miter"===b.join||"bevel"===b.join?c.join=b.join:(c.join="miter",b.join&&console.warn("unsupported join type for line symbol: "+b.join));return new n(c,b.idHint+"_ribbonlinemat")};q.createNativeMaterial=function(b){return new k(b.width,b.color,b.idHint+"_nativelinemat")};q.createOutlineGeometryFromSegments=function(b,c){for(var a=0;a<c.length;a++)for(var e=b[a],h=0;h<c[a].length;h++){for(var d=c[a][h],m=[],k=d[0];k<d[1];k++)m.push(e[k]);0<m.length&&(void 0).push(m)}};q.isClosed=
c;q.createPolylineGeometry=function(e,f,a,k,l,d){var m,p,n;if(a=a&&!c(e)){a=new Float32Array(e.length+3);for(p=0;p<e.length;p++)a[p]=e[p];p=a.length;a[p-3]=e[0];a[p-2]=e[1];a[p-1]=e[2];m=e.length/3+1;p=new Uint32Array(2*(m-1));n=new Uint32Array(2*(m-1))}else m=e.length/3,p=new Uint32Array(2*(m-1)),n=new Uint32Array(2*(m-1)),a=e;e=new Float32Array(1);e[0]=l;for(var q=l=0,s=0;s<m-1;s++)p[l++]=s,p[l++]=s+1,n[q++]=0,n[q++]=0;m={};l={};m[b.POSITION]=p;m[b.COLOR]=n;m[b.SIZE]=n;l[b.POSITION]={size:3,data:a};
l[b.COLOR]={size:4,data:k};l[b.SIZE]={size:1,data:e};f&&(m.mapPos=p,l.mapPos={size:3,data:f});f=[{type:"line",indices:m,positionKey:b.POSITION}];return d?{faces:f[0],vertexAttr:l,id:h.getNewId().toString()}:new h(f,l)}})},"esri/views/3d/webgl-engine/materials/NativeLineMaterial":function(){define(["./internal/MaterialUtil","../lib/Util","../lib/gl-matrix","../lib/RenderSlot"],function(s,q,n,k){var h=n.vec3d,e=n.vec2d,c=n.mat4d,b=q.VertexAttrConstants,g=h.create(),f=h.create(),a=h.create(),r=h.create(),
l=e.create(),d=e.create(),m=h.create(),p=h.create(),t=function(e,k,n,w){"string"===typeof n&&(w=n,n=void 0);s.basicMaterialConstructor(this,w);this.lineType=n||t.LINES;var C=s.Layouts.Pos,A=C.getStride();this.canBeMerged=this.lineType===t.LINES;this.setColor=function(a){k=a;this.notifyDirty("matChanged")};this.getColor=function(){return k};this.dispose=function(){};this.getOutputAmount=function(a){a=a/2+1;if(this.lineType===t.STRIP)return a*A;if(this.lineType===t.LINES)return(2*a-2)*A};this.getVertexBufferLayout=
function(){return C};this.fillInterleaved=function(a,c,d,f,e,g){a=a.vertexAttr[b.POSITION].data;if(c||this.lineType===t.LINES){f=a.length/3;for(d=0;d<f;d++){var h=3*d,m=a[h],l=a[h+1],k=a[h+2];if(c)var h=m,p=l,m=c[0]*h+c[4]*p+c[8]*k+c[12],l=c[1]*h+c[5]*p+c[9]*k+c[13],k=c[2]*h+c[6]*p+c[10]*k+c[14];e[g++]=m;e[g++]=l;e[g++]=k;this.lineType===t.LINES&&(0!==d&&d!==f-1)&&(e[g++]=m,e[g++]=l,e[g++]=k)}}else for(d=0;d<a.length;d++)e[g++]=a[d]};this.intersect=function(b,e,k,n,t,u,s,A,v,x,w,z){if(z){b=b.getData().getVertexAttr("position").position.data;
e=Number.MAX_VALUE;for(s=0;s<b.length-5;s+=3){g[0]=b[s];g[1]=b[s+1];g[2]=b[s+2];c.multiplyVec3(k,g);f[0]=b[s+3];f[1]=b[s+4];f[2]=b[s+5];c.multiplyVec3(k,f);v.projectPoint(g,l);v.projectPoint(f,d);if(0>l[2]&&0<d[2])h.subtract(g,f,a),A=v.frustumPlanes,x=-(h.dot(A[4],g)+A[4][3]),A=x/h.dot(a,A[4]),h.scale(a,A,a),h.add(g,a,g),v.projectPoint(g,l);else if(0<l[2]&&0>d[2])h.subtract(f,g,a),A=v.frustumPlanes,x=-(h.dot(A[4],f)+A[4][3]),A=x/h.dot(a,A[4]),h.scale(a,A,a),h.add(f,a,f),v.projectPoint(f,d);else if(0>
l[2]&&0>d[2])continue;A=q.projectVectorVector2D(l,d,n);A<e&&(e=A,h.set(g,m),h.set(f,p))}2>e&&(k=q.linelineDistance3D(m,p,t,u),n=Number.MAX_VALUE,k[0]&&(h.subtract(k[2],t,r),k=h.length(r),h.scale(r,1/k),n=0.98*k/h.dist(t,u)),w(n,r))}};this.getGLMaterials=function(){return{color:x,depthShadowMap:void 0,normal:void 0,depth:void 0,highlight:void 0}};this.getAllTextureIds=function(){return[]}};t.STRIP=1;t.LINES=2;var x=function(a,b){s.basicGLMaterialConstructor(this,a);var c=b.get("simple"),d=a.getColor();
this.beginSlot=function(a){return a===k.OPAQUE_MATERIAL};this.getProgram=function(){return c};this.bind=function(b,f){c.use();c.uniform4fv("color",d);a.getVertexBufferLayout().enableVertexAttribArrays(b,c);1>d[3]&&b.enable(b.BLEND)};this.release=function(b){a.getVertexBufferLayout().disableVertexAttribArrays(b,c);1>d[3]&&b.disable(b.BLEND)};this.bindView=function(a,b){s.bindView(b.origin,b.view,c)};this.bindInstance=function(a,b){c.uniformMatrix4fv("model",b.transformation)};this.getDrawMode=function(b){return a.lineType===
t.STRIP?b.LINE_STRIP:b.LINES}};return t})},"esri/views/3d/layers/graphics/Graphics3DPathSymbolLayer":function(){define("../../../../core/declare ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ../../support/projectionUtils ../../../../views/3d/lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util".split(" "),function(s,
q,n,k,h,e,c,b,g,f,a,r){var l=e.vec3d,d=e.mat4d,m=r.assert,p=l.create(),t={};s=s([q],{_prepareResources:function(){var b="c3dsymbol"+this.symbol.id,d=this._getMaterialOpacityAndColor(),f=l.create(d),d=d[3],f={diffuse:f,ambient:f,opacity:d,transparent:1>d||this._isPropertyDriven("opacity"),vertexColors:this._isPropertyDriven("color")||this._isPropertyDriven("opacity")};this._material=new a(f,b+"_3dlinemat");this._context.stage.add(c.ModelContentType.MATERIAL,this._material);this.resolve()},destroy:function(){this.isFulfilled()||
this.reject();this._material&&(this._context.stage.remove(c.ModelContentType.MATERIAL,this._material.getId()),this._material=null)},createGraphics3DGraphic:function(a,b){var c=a.geometry;if("polyline"!==c.type)return this._logWarning("unsupported geometry type for path symbol: "+c.type),null;var c="polygon"===c.type?"rings":"paths",d="graphic"+a.id,f=this._getGraphicElevationInfo(a);return this._createAs3DShape(a,c,b,f,d,a.id)},layerPropertyChanged:function(a,b,c){if("opacity"===a)return b=this._getMaterialOpacity(),
c=1>b||this._isPropertyDriven("opacity"),this._material.setParameterValues({opacity:b,transparent:c}),!0;if("elevationInfo"===a){this._updateElevationInfo();a=this._context.elevationProvider;var d=this._context.renderCoordsHelper,f=k.ELEV_MODES.ABSOLUTE_HEIGHT,e;for(e in b){var g=b[e],h=g._graphics[c];h&&(g=this._getGraphicElevationInfo(g.graphic),h.elevationAligner=g.mode!==f?v:null,h.elevationInfo.set(g),v(h,a,d))}return!0}return!1},_getPathSize:function(a,b){var c=a.size&&this._isPropertyDriven("size")?
k.getSingleSizeDriver(a.size):this.symbol.size||this.symbol.width||1;return c/=this._context.renderCoordsHelper.unitInMeters},_createAs3DShape:function(a,c,e,m,p,r){var t=a.geometry,q=t.hasZ,s=t[c];if(0<s.length){c=[];a=[];for(var x=[],N=l.create(),G=this._context.renderSpatialReference===h.SphericalRenderSpatialReference,O=Array(6),M=this._getPathSize(e,this.symbol),s=k.getGeometryVertexData3D(s,q,t.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,m),t=s.geometryData.outlines,
q=s.eleVertexData,s=s.vertexData,I=0;I<t.length;++I){var Z=t[I],V=Z.index,L=Z.count;if(this._context.clippingExtent&&(k.computeBoundingBox(q,V,L,O),k.boundingBoxClipped(O,this._context.clippingExtent)))continue;k.chooseOrigin(s,V,L,N);k.subtractCoordinates(s,V,L,N);Z=new Float64Array(q.buffer,3*V*q.BYTES_PER_ELEMENT,3*L);V=k.flatArrayToArrayOfArrays(s,V,L);V=f.createTubeGeometry(V,0.5*M,10,G,N);V.getVertexAttr().mapPos={size:3,data:Z};this._material.getParams().vertexColors&&(Z=this._getVertexOpacityAndColor(e),
V=f.addVertexColors(V,Z,!0));Z=new g(V,p+"path"+I);Z.singleUse=!0;c.push(Z);a.push([this._material]);Z=d.identity();d.translate(Z,N,Z);x.push(Z)}e=new b({geometries:c,materials:a,transformations:x,castShadow:!0,metadata:{layerId:this._context.layer.id,graphicId:r},idHint:p});p=null;m.mode!==k.ELEV_MODES.ABSOLUTE_HEIGHT&&(p=v);return new n(this,e,c,null,null,p,m)}this._logWarning("no paths found for line symbol");return null}});var x=r.VertexAttrConstants,v=function(a,b,c){var d=a.stageObject;a=a.elevationInfo;
for(var f=d.getGeometryRecords(),e=f.length,g=0;g<e;g++){var h=f[g].geometry,l=[f[g].transformation[12],f[g].transformation[13],f[g].transformation[14]],r=h.getData().getVertexAttr(),n=r[x.POSITION].data,q=r.zOffset.data,r=r.mapPos.data,s=r.length/3;m(n.length/3===10*s+2,"unexpected tube geometry");var v=0,I=0;t.spatialReference=b.spatialReference;for(var Z=0;Z<s;Z++){t.x=r[3*Z];t.y=r[3*Z+1];t.z=r[3*Z+2];var V=k.computeElevation(b,t,a),L=10;(0===Z||Z===s-1)&&L++;for(var Y=0;Y<L;Y++)p[0]=n[v]+l[0],
p[1]=n[v+1]+l[1],p[2]=n[v+2]+l[2],c.setAltitude(V+q[I],p,0),n[v]=p[0]-l[0],n[v+1]=p[1]-l[1],n[v+2]=p[2]-l[2],v+=3,I+=1;h.invalidateBoundingInfo()}d.geometryVertexAttrsUpdated(g)}};return s})},"esri/views/3d/layers/graphics/Graphics3DFillSymbolLayer":function(){define("../../../../core/declare ../../../../core/screenUtils ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DDrapedGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./lineUtils ../../../../geometry/Polygon ../../../../Color ../../lib/glMatrix ../../support/aaBoundingBox ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/lib/Util ./earcut/earcut".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u){var z=v.VertexAttrConstants;v=a.vec3d;var w=a.mat4d;s=s([n],{_prepareResources:function(){this._prepareFillResources();this._prepareOutlineResources();this.resolve()},_prepareFillResources:function(){var a=this._getStageIdHint(),b=this._getMaterialOpacityAndColor(),b={color:b,transparent:1>b[3]||this._isPropertyDriven("opacity"),polygonOffset:!1,vertexColors:!0};this._material=new x(b,a+"_colormat");this._context.stage.add(l.ModelContentType.MATERIAL,
this._material)},_prepareOutlineResources:function(){var a=this.symbol.outline;if(this._hasOutline=!(!a||!a.size||!a.color))a={idHint:this._getStageIdHint()+"_outline",color:this._getOutlineColor(),width:q.pt2px(this.symbol.outline.size)},this._outlineMaterial=2<a.width?b.createRibbonMaterial(a):b.createNativeMaterial(a),this._context.stage.add(l.ModelContentType.MATERIAL,this._outlineMaterial)},destroy:function(){this.isFulfilled()||this.reject();this._material&&(this._context.stage.remove(l.ModelContentType.MATERIAL,
this._material.getId()),this._material=null);this._outlineMaterial&&(this._context.stage.remove(l.ModelContentType.MATERIAL,this._outlineMaterial.getId()),this._outlineMaterial=null)},createGraphics3DGraphic:function(a,b){var d=a.geometry;if("polyline"!==d.type&&"polygon"!==d.type&&"extent"!==d.type)return this._logWarning("unsupported geometry type for fill symbol: "+d.type),null;var d="graphic"+a.id,f=this._getVertexOpacityAndColor(b,Uint8Array,255),e=this._getGraphicElevationInfo(a);return e.mode===
c.ELEV_MODES.ON_THE_GROUND?this._createAsOverlay(a,f,e,d):this._createAs3DShape(a,f,e,d,a.id)},layerPropertyChanged:function(a,b,d){if("opacity"===a)return b=this._material.getColor(),b[3]=this._getMaterialOpacity(),this._material.setColor(b),this._material.setTransparent(1>b[3]),!0;if("elevationInfo"===a){a=this._elevationInfo.mode;this._updateElevationInfo();var f=this._elevationInfo.mode;if(null==a||null==f)return!1;var g=c.ELEV_MODES;if(a===g.ON_THE_GROUND&&f===g.ON_THE_GROUND)return!0;if(a!==
f&&(a===g.ON_THE_GROUND||f===g.ON_THE_GROUND))return!1;a=f===g.RELATIVE_TO_GROUND?e.perVertexElevationAligner:null;var f=this._context.elevationProvider,g=this._context.renderCoordsHelper,h;for(h in b){var m=b[h],l=m._graphics[d];l&&(m=m.graphic,l.elevationAligner=a,l.elevationInfo.set(this._getGraphicElevationInfo(m)),e.perVertexElevationAligner(l,f,g))}return!0}return!1},setDrawOrder:function(a,b,c){this._material&&(this._material.setRenderPriority(a+b/2),c[this._material.getId()]=!0);this._outlineMaterial&&
(this._outlineMaterial.setRenderPriority(a),c[this._outlineMaterial.getId()]=!0)},_createAs3DShape:function(a,b,f,g,h){var m=this._getPolyGeometry(a),l=m.hasZ;a=!1;var p;null!=m.rings?(a=!0,p=m.rings):p=m.paths;if(0===p.length)return this._logWarning("no paths found for line symbol"),null;p=this._getOutlineGeometry(m,p);m=c.getGeometryVertexData3D(p,l,m.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,f);B.idHint=g;B.color=b;B.isRings=a;B.data=m;var r;this._hasOutline&&
(r=new m.vertexData.constructor(m.vertexData));B.outNum=0;B.outGeometries=[];B.outTransforms=[];B.outMaterials=[];this._createAs3DShapeFill(B);B.data.vertexData=r;this._createAs3DShapeOutline(B);if(0===B.outNum)return null;b=new d({geometries:B.outGeometries,materials:B.outMaterials,transformations:B.outTransforms,castShadow:!1,metadata:{layerId:this._context.layer.id,graphicId:h},idHint:g});g=null;f.mode===c.ELEV_MODES.RELATIVE_TO_GROUND&&(g=e.perVertexElevationAligner);return new k(this,b,B.outGeometries,
null,null,g,f)},_createAs3DShapeFill:function(a){for(var b=a.data.geometryData.polygons,d=a.data.eleVertexData,f=a.data.vertexData,e=0;e<b.length;++e){var g=b[e],h=g.count,l=g.index;if(this._context.clippingExtent&&(c.computeBoundingBox(d,l,h,C),c.boundingBoxClipped(C,this._context.clippingExtent)))continue;var k=new Float64Array(d.buffer,3*l*d.BYTES_PER_ELEMENT,3*h),p=new Float64Array(f.buffer,3*l*f.BYTES_PER_ELEMENT,3*h),g=g.holeIndices.map(function(a){return a-l}),g=u(k,g,3);0!==g.length&&(c.chooseOrigin(f,
l,h,A),c.subtractCoordinates(f,l,h,A),h=this._createFillGeometry(g,0,p,k,a.color,!1),h=new m(h,a.idHint),h.singleUse=!0,k=w.identity(),w.translate(k,A,k),a.outGeometries.push(h),a.outMaterials.push([this._material]),a.outTransforms.push(k),a.outNum++)}},_createAs3DShapeOutline:function(a){if(this._hasOutline)for(var d=a.data.geometryData.outlines,f=a.data.eleVertexData,e=a.data.vertexData,g=0;g<d.length;++g){var h=d[g],l=h.index,k=h.count;if(this._context.clippingExtent&&(c.computeBoundingBox(f,l,
k,C),c.boundingBoxClipped(C,this._context.clippingExtent)))continue;c.chooseOrigin(e,l,k,A);c.subtractCoordinates(e,l,k,A);h=new Float64Array(f.buffer,3*l*f.BYTES_PER_ELEMENT,3*k);l=new Float64Array(e.buffer,3*l*e.BYTES_PER_ELEMENT,3*k);l=b.createPolylineGeometry(l,h,a.isRings,y,0,!1);l=new m(l,a.idHint+"outline"+g);l.singleUse=!0;h=w.identity();w.translate(h,A,h);a.outGeometries.push(l);a.outMaterials.push([this._outlineMaterial]);a.outTransforms.push(h);a.outNum++}},_createAsOverlay:function(a,
b,d,f){d=this._getPolyGeometry(a);a=!1;var e;null!=d.rings?(a=!0,e=d.rings):e=d.paths;e=this._getOutlineGeometry(d,e);if(0===e.length)return null;this._material.setRenderPriority(this._symbolLayerOrder+this._symbolLayerOrderDelta/2);this._hasOutline&&this._outlineMaterial.setRenderPriority(this._symbolLayerOrder);d=c.getGeometryVertexDataDraped(e,d.spatialReference,this._context.overlaySR);B.idHint=f;B.color=b;B.isRings=a;B.data=d;var g;this._hasOutline&&(g=new d.vertexData.constructor(d.vertexData));
B.outNum=0;B.outGeometries=[];B.outBoundingBox=r.create(r.NEGATIVE_INFINITY);this._createAsOverlayFill(B);B.data.vertexData=g;this._createAsOverlayOutline(B);return 0<B.outNum?new h(this,B.outGeometries,null,null,B.outBoundingBox):null},_createAsOverlayFill:function(a){for(var b=a.data.vertexData,d=a.data.geometryData.polygons,f=0;f<d.length;++f){var e=d[f],g=e.count,h=e.index,m=new Float64Array(b.buffer,3*h*b.BYTES_PER_ELEMENT,3*g),e=e.holeIndices.map(function(a){return a-h}),m=u(m,e,3);if(0!==m.length&&
(c.computeBoundingBox(b,h,g,C),!c.boundingBoxClipped(C,this._context.clippingExtent))){r.expand(a.outBoundingBox,C);c.chooseOrigin(b,h,g,A);c.subtractCoordinates(b,h,g,A);c.setZ(b,h,g,this._getDrapedZ());g=w.identity();w.translate(g,A,g);m=this._createFillGeometry(m,h,b,null,a.color,!0);e=new t(m);e.material=this._material;var l=C;e.center=[0.5*(l[0]+l[3]),0.5*(l[1]+l[4]),0];e.bsRadius=0.5*Math.sqrt((l[3]-l[0])*(l[3]-l[0])+(l[4]-l[1])*(l[4]-l[1]));e.transformation=g;e.name=a.idHint;e.uniqueName=a.idHint+
"#"+m.id;a.outGeometries.push(e);a.outNum++}}},_createAsOverlayOutline:function(a){if(this._hasOutline)for(var d=a.data.vertexData,f=a.data.geometryData.outlines,e=0;e<f.length;++e){var g=f[e],h=g.index,g=g.count;c.computeBoundingBox(d,h,g,C);if(!c.boundingBoxClipped(C,this._context.clippingExtent)){r.expand(a.outBoundingBox,C);c.chooseOrigin(d,h,g,A);c.subtractCoordinates(d,h,g,A);c.setZ(d,h,g,this._getDrapedZ());g=new Float64Array(d.buffer,3*h*d.BYTES_PER_ELEMENT,3*g);h=w.identity();w.translate(h,
A,h);var g=b.createPolylineGeometry(g,null,a.isRings,y,0,!0),m=new t(g);m.material=this._outlineMaterial;var l=C;m.center=[0.5*(l[0]+l[3]),0.5*(l[1]+l[4]),0];m.bsRadius=0.5*Math.sqrt((l[3]-l[0])*(l[3]-l[0])+(l[4]-l[1])*(l[4]-l[1]));m.transformation=h;m.name=a.idHint+"outline";m.uniqueName=a.idHint+"outline#"+g.id;a.outGeometries.push(m);a.outNum++}}},_getOutlineGeometry:function(a,c){return a._outlineSegments?b.createOutlineGeometryFromSegments(c,a._outlineSegments):c},_getOutlineColor:function(){var a=
this._getLayerOpacity(),b=this.symbol.outline.color,a=a*b.a;return this._mixinColorAndOpacity(f.toUnitRGB(b),a)},_getPolyGeometry:function(a){a=a.geometry;"extent"===a.type&&(a=g.fromExtent(a));return a},_createFillGeometry:function(a,b,c,d,f,e){for(var g=a.length,h=new Uint32Array(g),l=new Uint32Array(g),m=0;m<g;m++)h[m]=a[m]+b,l[m]=0;b={};a={};b[z.POSITION]=h;b[z.COLOR]=l;a[z.POSITION]={size:3,data:c};a[z.COLOR]={size:4,data:f};d&&(a.mapPos={size:3,data:d},b.mapPos=h);c=[{type:"triangle",indices:b,
positionKey:z.POSITION}];return e?{faces:c[0],vertexAttr:a,id:p.getNewId().toString()}:new p(c,a)}});var C=r.create(),A=v.create(),y=new Float32Array([255,255,255,255]),B={idHint:null,color:null,isRings:!1,data:null,outNum:0,outBoundingBox:null,outGeometries:null,outMaterials:null,outTransforms:null};return s})},"esri/views/3d/layers/graphics/earcut/earcut":function(){define([],function(){function s(b,c,f,e,g){var h=0,k,r,n;k=c;for(r=f-e;k<f;k+=e)h+=(b[r]-b[k])*(b[k+1]+b[r+1]),r=k;if(g===0<h)for(k=
c;k<f;k+=e)n=a(k,n);else for(k=f-e;k>=c;k-=e)n=a(k,n);return n}function q(a,c,f){f||(f=c);var e;do if(e=!1,!c.steiner&&(a[c.i]===a[c.next.i]&&a[c.i+1]===a[c.next.i+1]||0===b(a,c.prev.i,c.i,c.next.i))){c.prev.next=c.next;c.next.prev=c.prev;c.prevZ&&(c.prevZ.nextZ=c.nextZ);c.nextZ&&(c.nextZ.prevZ=c.prevZ);c=f=c.prev;if(c===c.next)return null;e=!0}else c=c.next;while(e||c!==f);return f}function n(a,c,h,k,r,s,v,u){if(c){if(!u&&void 0!==r){var z=c,w=z;do null===w.z&&(w.z=e(a[w.i],a[w.i+1],r,s,v)),w.prevZ=
w.prev,w=w.nextZ=w.next;while(w!==z);w.prevZ.nextZ=null;w.prevZ=null;var z=w,C,A,y,B,D,F,H=1;do{w=z;y=z=null;for(B=0;w;){B++;A=w;for(C=D=0;C<H&&!(D++,A=A.nextZ,!A);C++);for(F=H;0<D||0<F&&A;)0===D?(C=A,A=A.nextZ,F--):0===F||!A?(C=w,w=w.nextZ,D--):w.z<=A.z?(C=w,w=w.nextZ,D--):(C=A,A=A.nextZ,F--),y?y.nextZ=C:z=C,C.prevZ=y,y=C;w=A}y.nextZ=null;H*=2}while(1<B)}for(z=c;c.prev!==c.next;){w=c.prev;A=c.next;a:{y=a;B=c;C=r;F=s;var N=v;D=B.prev.i;var G=B.i,H=B.next.i,O=y[D],M=y[D+1],I=y[G],Z=y[G+1],V=y[H],L=
y[H+1],G=O*Z-M*I,Y=O*L-M*V,E=G-Y-(V*Z-L*I);if(0>=E)y=!1;else{var ba=L-M,W=O-V,R=M-Z,T=I-O,J=void 0,S=void 0,K=void 0,Q=K=S=J=void 0;if(void 0!==C){Q=O>I?O>V?O:V:I>V?I:V;J=M>Z?M>L?M:L:Z>L?Z:L;O=e(O<I?O<V?O:V:I<V?I:V,M<Z?M<L?M:L:Z<L?Z:L,C,F,N);C=e(Q,J,C,F,N);for(Q=B.nextZ;Q&&Q.z<=C;)if(J=Q.i,Q=Q.nextZ,!(J===D||J===H))if(S=y[J],K=y[J+1],J=ba*S+W*K-Y,0<=J&&(S=R*S+T*K+G,0<=S&&(K=E-J-S,0<=K&&(J&&S||J&&K||S&&K)))){y=!1;break a}for(Q=B.prevZ;Q&&Q.z>=O;)if(J=Q.i,Q=Q.prevZ,!(J===D||J===H))if(S=y[J],K=y[J+1],
J=ba*S+W*K-Y,0<=J&&(S=R*S+T*K+G,0<=S&&(K=E-J-S,0<=K&&(J&&S||J&&K||S&&K)))){y=!1;break a}}else for(Q=B.next.next;Q!==B.prev;)if(J=Q.i,Q=Q.next,S=y[J],K=y[J+1],J=ba*S+W*K-Y,0<=J&&(S=R*S+T*K+G,0<=S&&(K=E-J-S,0<=K&&(J&&S||J&&K||S&&K)))){y=!1;break a}y=!0}}if(y)h.push(w.i/k),h.push(c.i/k),h.push(A.i/k),A.prev=w,w.next=A,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ),z=c=A.next;else if(c=A,c===z){if(u)if(1===u){u=a;y=c;c=h;z=k;A=y;do B=A.prev,w=A.next.next,B.i!==w.i&&(b(u,B.i,A.i,A.next.i)!==
b(u,B.i,A.i,w.i)&&b(u,A.next.i,w.i,B.i)!==b(u,A.next.i,w.i,A.i)&&g(u,B,w)&&g(u,w,B))&&(c.push(B.i/z),c.push(A.i/z),c.push(w.i/z),B.next=w,w.prev=B,y=A.prevZ,A=A.nextZ&&A.nextZ.nextZ,y&&(y.nextZ=A),A&&(A.prevZ=y),A=y=w),A=A.next;while(A!==y);c=A;n(a,c,h,k,r,s,v,2)}else{if(2===u)a:{u=c;do{for(z=u.next.next;z!==u.prev;){if(w=u.i!==z.i){w=a;A=u;y=z;B=void 0;if(B=A.next.i!==y.i)if(B=void 0,B=A.prev.i!==y.i){B=B=void 0;b:{B=A.i;D=y.i;H=A;do{C=H.i;F=H.next.i;if(C!==B&&F!==B&&C!==D&&F!==D&&b(w,C,F,B)!==b(w,
C,F,D)&&b(w,B,D,C)!==b(w,B,D,F)){B=!0;break b}H=H.next}while(H!==A);B=!1}if(B=!B)if(B=void 0,B=g(w,A,y))if(B=void 0,B=g(w,y,A)){H=A.i;C=y.i;y=A;B=!1;D=(w[H]+w[C])/2;H=(w[H+1]+w[C+1])/2;do C=y.i,F=y.next.i,w[C+1]>H!==w[F+1]>H&&D<(w[F]-w[C])*(H-w[C+1])/(w[F+1]-w[C+1])+w[C]&&(B=!B),y=y.next;while(y!==A)}}w=B}if(w){c=f(u,z);u=q(a,u,u.next);c=q(a,c,c.next);n(a,u,h,k,r,s,v);n(a,c,h,k,r,s,v);break a}z=z.next}u=u.next}while(u!==c)}}else n(a,q(a,c),h,k,r,s,v,1);break}}}}function k(a,b,f,e){var g=[],k,r,n,
z;k=0;for(r=b.length;k<r;k++)n=b[k]*e,z=k<r-1?b[k+1]*e:a.length,n=s(a,n,z,e,!1),n===n.next&&(n.steiner=!0),(n=q(a,n))&&g.push(c(a,n));g.sort(function(b,c){return a[b.i]-a[c.i]});for(k=0;k<g.length;k++)h(a,g[k],f),f=q(a,f,f.next);return f}function h(a,b,c){var e=c,h=b.i,k=a[h],h=a[h+1],r=-Infinity,n,s,w;do{s=e.i;w=e.next.i;if(h<=a[s+1]&&h>=a[w+1]){var C=a[s]+(h-a[s+1])*(a[w]-a[s])/(a[w+1]-a[s+1]);C<=k&&C>r&&(r=C,n=a[s]<a[w]?e:e.next)}e=e.next}while(e!==c);if(n){c=a[n.i];e=a[n.i+1];s=k*e-h*c;w=k*h-
h*r;for(var C=h-h,A=k-r,y=h-e,B=c-k,r=s-w-(r*e-h*c),D=0>=r?-1:1,F=n,H=Infinity,N,G,O,M,e=n.next;e!==F;)N=a[e.i],G=a[e.i+1],O=k-N,0<=O&&N>=c&&(M=(C*N+A*G-w)*D,0<=M&&(N=(y*N+B*G+s)*D,0<=N&&0<=r*D-M-N&&(G=Math.abs(h-G)/O,G<H&&g(a,e,b)&&(n=e,H=G)))),e=e.next;c=n}else c=null;c&&(b=f(c,b),q(a,b,b.next))}function e(a,b,c,f,e){a=1E3*(a-c)/e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=1E3*(b-f)/e;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|
b<<1)&1431655765)<<1}function c(a,b){var c=b,f=b;do a[c.i]<a[f.i]&&(f=c),c=c.next;while(c!==b);return f}function b(a,b,c,f){a=(a[c+1]-a[b+1])*(a[f]-a[c])-(a[c]-a[b])*(a[f+1]-a[c+1]);return 0<a?1:0>a?-1:0}function g(a,c,f){return-1===b(a,c.prev.i,c.i,c.next.i)?-1!==b(a,c.i,f.i,c.next.i)&&-1!==b(a,c.i,c.prev.i,f.i):-1===b(a,c.i,f.i,c.prev.i)||-1===b(a,c.i,c.next.i,f.i)}function f(a,b){var c=new r(a.i),f=new r(b.i),e=a.next,g=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;f.next=c;c.prev=f;g.next=f;f.prev=
g;return f}function a(a,b){var c=new r(a);b?(c.next=b.next,c.prev=b,b.next.prev=c,b.next=c):(c.prev=c,c.next=c);return c}function r(a){this.i=a;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}return function(a,b,c){c=c||2;var f=b&&b.length,e=f?b[0]*c:a.length,g=q(a,s(a,0,e,c,!0)),h=[];if(!g)return h;var r,z,w,C;f&&(g=k(a,b,g,c));if(a.length>80*c){r=b=a[0];z=f=a[1];for(var A=c;A<e;A+=c)w=a[A],C=a[A+1],w<r&&(r=w),C<z&&(z=C),w>b&&(b=w),C>f&&(f=C);w=Math.max(b-r,f-z)}n(a,g,h,c,r,
z,w);return h}})},"esri/views/3d/layers/graphics/Graphics3DExtrudeSymbolLayer":function(){define("../../../../core/declare ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./Graphics3DSymbolCommonCode ../../../../geometry/Polygon ../../support/projectionUtils ../../lib/glMatrix ../../webgl-engine/Stage ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryData ../../webgl-engine/materials/Material ../../webgl-engine/lib/Util ./earcut/earcut".split(" "),function(s,
q,n,k,h,e,c,b,g,f,a,r,l,d){function m(a,b,c,d,f,e,g,h,m,l,k,p,r,n){var q=c.length/3,s=0;k+=2*d.count;var u=d.index,B=d.count,x=m,y=k;v.set(r,w);var z=0<p?1:-1,u=3*u,D=x;r=3*D;for(var ga=x+B,x=3*ga,O=0;O<B;++O)n&&(w[0]=a[u+0],w[1]=a[u+1],w[2]=a[u+2],v.normalize(w)),f[r+0]=a[u+0],f[r+1]=a[u+1],f[r+2]=a[u+2],e[r+0]=b[u+0],e[r+1]=b[u+1],e[r+2]=b[u+2],g[r+0]=-z*w[0],g[r+1]=-z*w[1],g[r+2]=-z*w[2],h[D]=0,f[x+0]=a[u+0]+p*w[0],f[x+1]=a[u+1]+p*w[1],f[x+2]=a[u+2]+p*w[2],e[x+0]=b[u+0],e[x+1]=b[u+1],e[x+2]=b[u+
2],g[x+0]=z*w[0],g[x+1]=z*w[1],g[x+2]=z*w[2],h[ga]=p,r+=3,x+=3,u+=3,D+=1,ga+=1;u=0;r=3*(y+q);x=3*y;a=C;b=A;0>p&&(a=A,b=C);for(O=0;O<q;++O)l[r+0]=c[u+a[0]],l[r+1]=c[u+a[1]],l[r+2]=c[u+a[2]],l[x+0]=c[u+b[0]]+B,l[x+1]=c[u+b[1]]+B,l[x+2]=c[u+b[2]]+B,r+=3,x+=3,u+=3;m+=2*d.count;k=k+2*q-(2*d.count+2*q);t(f,e,h,g,s,d.pathLengths[0],d.count,m,l,k,p);m+=4*d.pathLengths[0];k+=2*d.pathLengths[0];s+=d.pathLengths[0];for(c=1;c<d.pathLengths.length;++c)t(f,e,h,g,s,d.pathLengths[c],d.count,m,l,k,p),m+=4*d.pathLengths[c],
k+=2*d.pathLengths[c],s+=d.pathLengths[c]}function p(a,b,c,d,f,e,g){d[e]=d[g];g*=3;e*=3;a[e+0]=a[g+0];a[e+1]=a[g+1];a[e+2]=a[g+2];b[e+0]=b[g+0];b[e+1]=b[g+1];b[e+2]=b[g+2];c[e+0]=f[0];c[e+1]=f[1];c[e+2]=f[2]}function t(a,b,c,d,f,e,g,h,m,l,k){var r=f,n=f+1,t=f+g,q=f+g+1,s=h,u=h+1,A=h+2*e;h=h+2*e+1;0>k&&(r=f+g+1,q=f);l*=3;for(var x=0;x<e;++x){x===e-1&&(0<k?(n=f,q=f+g):(n=f,r=f+g));var y=a,w=r,z=n,C=t,O=B,w=3*w,z=3*z,C=3*C;v.set3(y[w++],y[w++],y[w++],D);v.set3(y[z++],y[z++],y[z++],F);v.set3(y[C++],y[C++],
y[C++],H);v.subtract(F,D,N);v.subtract(H,D,G);v.cross(G,N,O);v.normalize(O,O);p(a,b,d,c,B,s,r);p(a,b,d,c,B,u,n);p(a,b,d,c,B,A,t);p(a,b,d,c,B,h,q);m[l++]=s;m[l++]=A;m[l++]=h;m[l++]=s;m[l++]=h;m[l++]=u;r++;n++;t++;q++;s+=2;u+=2;A+=2;h+=2}}var x=l.VertexAttrConstants,v=c.vec3d,u=c.mat4d,z=v.create(),w=v.create(),C=[0,2,1],A=[0,1,2],y={};s=s([q],{_prepareResources:function(){var a=this._getStageIdHint(),c=this._getMaterialOpacityAndColor(),d=v.create(c),c=c[3],d={diffuse:d,ambient:d,opacity:c,transparent:1>
c||this._isPropertyDriven("opacity"),vertexColors:!0};this._material=new r(d,a+"_3dlinemat");this._context.stage.add(b.ModelContentType.MATERIAL,this._material);this.resolve()},destroy:function(){this.isFulfilled()||this.reject();this._material&&this._context.stage.remove(b.ModelContentType.MATERIAL,this._material.getId())},createGraphics3DGraphic:function(a,b){var c=a.geometry;if("polygon"!==c.type&&"extent"!==c.type)return this._logWarning("unsupported geometry type for extrude symbol: "+c.type),
null;var c="polygon"===c.type||"extent"===c.type?"rings":"paths",d="graphic"+a.id,f=this._getVertexOpacityAndColor(b,Float32Array,255),e=this._getGraphicElevationInfo(a);return this._createAs3DShape(a,c,b,f,e,d,a.id)},layerPropertyChanged:function(a,b,c){if("opacity"===a)return b=this._getMaterialOpacity(),c=1>b||this._isPropertyDriven("opacity"),this._material.setParameterValues({opacity:b,transparent:c}),!0;if("elevationInfo"===a){this._updateElevationInfo();a=this._context.elevationProvider;var d=
this._context.renderCoordsHelper,f=k.ELEV_MODES.ABSOLUTE_HEIGHT,e;for(e in b){var g=b[e],h=g._graphics[c];h&&(g=this._getGraphicElevationInfo(g.graphic),h.elevationAligner=g.mode!==f?I:null,h.elevationInfo.set(g),I(h,a,d))}return!0}return!1},_getExtrusionSize:function(a,b){var c=a.size&&this._isPropertyDriven("size")?k.getSingleSizeDriver(a.size):this.symbol.size||1;return c/=this._context.renderCoordsHelper.unitInMeters},_createAs3DShape:function(a,b,c,l,p,r,t){var q=a.geometry;"extent"===q.type&&
(q=h.fromExtent(q));var s=q[b],A=q.hasZ;if(0<s.length){b=[];a=[];var B=[],x=v.create(),Q=Array(6),y=this._context.renderSpatialReference===e.SphericalRenderSpatialReference;c=this._getExtrusionSize(c,this.symbol.size);var w=v.create();y||this._context.renderCoordsHelper.worldUpAtPosition(null,w);for(var A=k.getGeometryVertexData3D(s,A,q.spatialReference,this._context.renderSpatialReference,this._context.elevationProvider,p),q=A.geometryData.polygons,s=A.eleVertexData,A=A.vertexData,z=A.length/3,C=
new Float64Array(18*z),D=new Float64Array(18*z),O=new Float64Array(18*z),z=new Float64Array(6*z),F=0,G=0;G<q.length;++G){var M=q[G],ga=M.count,ka=M.index;if(this._context.clippingExtent&&(k.computeBoundingBox(s,ka,ga,Q),k.boundingBoxClipped(Q,this._context.clippingExtent)))continue;var H=new Float64Array(s.buffer,3*ka*C.BYTES_PER_ELEMENT,3*ga),N=M.holeIndices.map(function(a){return a-ka}),H=d(H,N,3);if(0<H.length){k.chooseOrigin(A,ka,ga,x);var N=new Uint32Array(6*ga+2*H.length),ia=6*ga,pa=new Float64Array(C.buffer,
3*F*C.BYTES_PER_ELEMENT,3*ia),na=new Float64Array(D.buffer,3*F*D.BYTES_PER_ELEMENT,3*ia),oa=new Float64Array(O.buffer,3*F*O.BYTES_PER_ELEMENT,3*ia),qa=new Float64Array(z.buffer,1*F*z.BYTES_PER_ELEMENT,1*ia);m(A,s,H,M,pa,oa,na,qa,0,N,0,c,w,y);k.subtractCoordinates(pa,0,ia,x);F+=6*ga;M=this._createExtrudeGeometry(N,{positions:pa,elevation:oa,normals:na,heights:qa},l,!1);M=new f(M,r+"path"+G);M.singleUse=!0;b.push(M);a.push([this._material]);M=u.identity();u.translate(M,x,M);B.push(M)}}return 0<b.length?
(l=new g({geometries:b,materials:a,transformations:B,castShadow:!0,metadata:{layerId:this._context.layer.id,graphicId:t},idHint:r}),r=null,p.mode!==k.ELEV_MODES.ABSOLUTE_HEIGHT&&(r=I),new n(this,l,b,null,null,r,p)):null}this._logWarning("no paths found for extrusion symbol");return null},_createExtrudeGeometry:function(b,c,d,f){for(var e=b.length,g=new Uint32Array(e),h=0;h<e;h++)g[h]=0;h={};e={};h[x.POSITION]=b;h[x.NORMAL]=b;h[x.COLOR]=g;e[x.POSITION]={size:3,data:c.positions};e[x.NORMAL]={size:3,
data:c.normals};e[x.COLOR]={size:4,data:d};e[x.SIZE]={size:1,data:c.heights};c.elevation&&(e.mapPos={size:3,data:c.elevation},h.mapPos=b);b=[{type:"triangle",indices:h,positionKey:x.POSITION}];return f?{faces:b[0],vertexAttr:e,id:a.getNewId().toString()}:new a(b,e)}});var B=v.create(),D=v.create(),F=v.create(),H=v.create(),N=v.create(),G=v.create(),O=v.create(),M=v.create(),I=function(a,b,c){var d=a.stageObject;a=a.elevationInfo;var f=c.setAltitude;y.spatialReference=b.spatialReference;for(var e=
d.getGeometryRecords(),g=e.length,h=0;h<g;h++){var m=e[h].geometry,l=e[h].transformation;M[0]=l[12];M[1]=l[13];M[2]=l[14];m.invalidateBoundingInfo();for(var p=m.getData().getVertexAttr(),m=p[x.POSITION].data,l=p[x.SIZE].data,p=p.mapPos.data,r=m.length/3,n=0,t=0,q=!1,s=0;s<r;s++){y.x=p[t];y.y=p[t+1];y.z=p[t+2];O[0]=m[n];O[1]=m[n+1];O[2]=m[n+2];var u=k.computeElevation(b,y,a);z[0]=m[n]+M[0];z[1]=m[n+1]+M[1];z[2]=m[n+2]+M[2];f(u+l[n/3],z,0);m[n]=z[0]-M[0];m[n+1]=z[1]-M[1];m[n+2]=z[2]-M[2];u=0.01/c.unitInMeters;
if(Math.abs(O[0]-m[n])>u||Math.abs(O[1]-m[n+1])>u||Math.abs(O[2]-m[n+2])>u)q=!0;t+=3;n+=3}q&&d.geometryVertexAttrsUpdated(h)}};return s})},"esri/views/3d/layers/graphics/Graphics3DTextSymbolLayer":function(){define("../../../../core/declare ../../../../core/screenUtils ../../../../Color ./Graphics3DSymbolLayer ./Graphics3DGraphicLayer ./ElevationAligners ./Graphics3DSymbolCommonCode ./Graphics3DIconSymbolLayer ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/TextTexture ../../webgl-engine/materials/HUDMaterial".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r){var l=[1,1,1],d=[0,0,1],m=e.perObjectElevationAligner;return s([k],{_prepareResources:function(){var a=this.symbol;this._anchor=-1<b.VALID_ANCHOR_STRINGS.indexOf(a.anchor)?a.anchor:"center";this.resolve()},destroy:function(){this.isFulfilled()||this.reject()},createGraphics3DGraphic:function(a,b,d,f){var e=a.geometry,g=!1;if("polyline"===e.type)e=c.placePointOnPolyline(e),g=!0;else if("polygon"===e.type)e=c.placePointOnPolygon(e);else if("extent"===e.type)e=e.get("center");
else if("point"!==e.type)return this._logWarning("unsupported geometry type for text symbol: "+e.type),null;var h=this._context.layer.id+"_label_"+a.id,m=b.text||this.symbol.text;if(!m||1>m.length)return null;var l=this._getGraphicElevationInfo(a);return this._createAs3DShape(this.symbol,e,m,l,h,a.id,b,d,f,g)},layerPropertyChanged:function(a,b,c){if("opacity"===a)console.warn("layer opacity change not yet implemented in Graphics3DTextSymbolLayer");else if("elevationInfo"===a){this._updateElevationInfo();
if(b)for(var d in b){a=b[d];var f=a._graphics[c];f&&this.updateGraphicElevationInfo(a.graphic,f)}return!0}return!1},updateGraphicElevationInfo:function(a,b){var d=this._context,f=this._getGraphicElevationInfo(a);b.elevationAligner=f.mode!==c.ELEV_MODES.ABSOLUTE_HEIGHT?m:null;b.elevationInfo.set(f);m(b,d.elevationProvider,d.renderCoordsHelper)},_defaultElevationInfoNoZ:{mode:c.ELEV_MODES.RELATIVE_TO_GROUND,offset:0},_getGraphicElevationInfo:function(a){var b=this.inherited(arguments);b.mode===c.ELEV_MODES.ON_THE_GROUND?
(b.mode=c.ELEV_MODES.RELATIVE_TO_GROUND,b.offset=1/this._context.renderCoordsHelper.unitInMeters,b.featureExpression={value:0}):b.mode===c.ELEV_MODES.RELATIVE_TO_GROUND&&(0===b.offset&&!a.geometry.get("hasZ"))&&(b.offset=1/this._context.renderCoordsHelper.unitInMeters);return b},_createAs3DShape:function(b,m,k,s,u,z,w,C,A,y){var B=w.centerOffset||[0,0,0,0],D=w.screenOffset||[0,0],F=w.translation||[0,0,0,0],H=w.anchor||this._anchor||"center";this._anchor=H;var N=b.material?n.toUnitRGB(b.material.color):
l,G={shadowColor:0.35<0.299*N[0]+0.587*N[1]+0.114*N[2]?"black":"white",shadowBlur:1};w=null!=A;b=new a(k,{size:q.pt2px(b.size)||12,color:N,font:{family:b.font&&b.font.family?b.font.family:"Arial",weight:b.font&&b.font.weight?b.font.weight:"normal",style:b.font&&b.font.style?b.font.style:"normal"},canvasStyle:G},u,w);k=w?A.addTextTexture(b):null;N=this._getMaterialOpacity();D={textureId:w?k.texture.getId():b.getId(),texCoordScale:b.getTexcoordScale(),occlusionTest:!0,screenOffset:D,anchorPos:H,polygonOffset:!0,
color:[1,1,1,N],transparent:1>N};y&&(D.shaderPolygonOffset=1E-4);y=null;H=JSON.stringify(D);null!=C?(y=C.getMaterial(H),null==y?(y=new r(D,u),C.addMaterial(H,y)):w&&y.setTextureDirty()):y=new r(D,u);w=[y];y=[b.getTextWidth(),b.getTextHeight()];B=f.createPointGeometry(d,F,void 0,y,void 0,B,k?k.uvMinMax:null);B=[new g(B,u)];u=c.createStageObjectForPoint.call(this,m,B,[w],null,null,s,u,this._context.layer.id,z);z=null;s.mode!==c.ELEV_MODES.ABSOLUTE_HEIGHT&&(z=e.perObjectElevationAligner);s=new h(this,
u,B,null==C?w:null,null==A?[b]:null,z,s);c.extendPointGraphicElevationInfo(s,m,this._context.elevationProvider);return s}})})},"esri/views/3d/webgl-engine/lib/TextTexture":function(){define(["require","exports","./Texture","./Util"],function(s,q,n,k){return function(){function h(e,c,b){this._idHint=b;this._text=e;this._textLines=e.split(/\r?\n/);this._params=c||{color:[0,0,0]};this._params.size=this._params.size||18;this._params.font=this._params.font||{family:"Arial"};this._params.font.family=this._params.font.family||
"Arial";this._params.font.weight=this._params.font.weight||"normal";this._params.font.style=this._params.font.style||"normal";this._fillStyle="rgb("+this._params.color.map(function(b){return Math.floor(255*b)}).toString()+")"}h.prototype.getId=function(){null==this._id&&(this._id=n.idGen.gen(this._idHint));return this._id};h.prototype.getParams=function(){return this._params};h.prototype.getString=function(){return this._text};h.prototype.renderGl=function(e,c){this._createTextTexture(e,c);c._isTracingEnabled&&
(e._debugTracingType="TextTexture")};h.prototype.getTextWidth=function(){var e=this._create2DCanvas().getContext("2d");this._setTextProperties(e,this._params.size);var c=0,b;for(b in this._textLines){var g=e.measureText(this._textLines[b]).width;g>c&&(c=g)}b=this._params.font;if("italic"===b.style||"oblique"===b.style||"string"===typeof b.weight&&("bold"===b.weight||"bolder"===b.weight)||"number"===typeof b.weight&&600<b.weight)c+=0.3*e.measureText("A").width;return c};h.prototype.getTextHeight=function(){return this.getLineHeight()*
this._textLines.length};h.prototype.getTexcoordScale=function(){if(this._params.enableMipmapping){var e=this.getTextHeight(),c=this.getTextWidth();return[c/k.nextHighestPowerOfTwo(c),e/k.nextHighestPowerOfTwo(e)]}return[1,1]};h.prototype.getLineHeight=function(){return Math.floor(1.2*this._params.size)};h.prototype.setUnloadFunc=function(e){this._unloadFunc=e};h.prototype.unload=function(){this._unloadFunc&&(this._unloadFunc(this._id),this._unloadFunc=null)};h.prototype.renderText=function(e,c,b,
g,f,a){void 0===f&&(f=0);void 0===a&&(a=0);b=this.getLineHeight()*e;this._setTextProperties(g,this._params.size*e);e="center"===g.textAlign?0.5*c:"right"===g.textAlign?c:0;e+=f;f=0+a;for(var h in this._textLines)g.fillText(this._textLines[h],e,f),f+=b};h.prototype._create2DCanvas=function(){null==h._textCanvas2D&&(h._textCanvas2D=document.createElement("canvas"),h._textCanvas2D.setAttribute("id","canvas2d"),h._textCanvas2D.setAttribute("width","1024"),h._textCanvas2D.setAttribute("height","1024"),
h._textCanvas2D.setAttribute("style","display:none"));return h._textCanvas2D};h.prototype._setTextProperties=function(e,c){e.fillStyle=this._fillStyle;var b=this._params.font;e.font=b.style+" "+b.weight+" "+c+"px "+b.family;e.textAlign="left";e.textBaseline="top";this._params.canvasStyle&&k.mergeObjects(e,this._params.canvasStyle,e)};h.prototype._createTextTexture=function(e,c){var b=this._create2DCanvas(),g=b.getContext("2d");g.save();var f=this.getTextWidth(),a=this.getTextHeight();this._params.enableMipmapping&&
(f=k.nextHighestPowerOfTwo(f),a=k.nextHighestPowerOfTwo(a));c.bindTexture(c.TEXTURE_2D,e);b.setAttribute("width",f.toString());b.setAttribute("height",a.toString());this.renderText(1,f,a,g);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,b);f=c.LINEAR;this._params.enableMipmapping&&(c.generateMipmap(c.TEXTURE_2D),h.MIPMAP_CREATE?(h.MIPMAP_CREATE(b,c),f=c.LINEAR_MIPMAP_LINEAR):(this._renderMipmap(c),f=c.LINEAR_MIPMAP_NEAREST));c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);
c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,f);c.bindTexture(c.TEXTURE_2D,null);g.restore()};h.prototype._renderMipmap=function(e){var c=this._create2DCanvas(),b=c.getContext("2d"),g=parseInt(c.getAttribute("width"),10)/2,f=parseInt(c.getAttribute("height"),10)/2,a=0.5,h=1;do c.setAttribute("width",g.toString()),c.setAttribute("height",f.toString()),this.renderText(a,g,
f,b),e.texSubImage2D(e.TEXTURE_2D,h,0,0,e.RGBA,e.UNSIGNED_BYTE,c),a*=0.5,g*=0.5,f*=0.5,h++;while(1<g&&1<f)};return h}()})},"esri/views/3d/layers/graphics/Graphics3DSpatialIndex":function(){define(["require","exports","../../../../processors/SpatialIndex","../../../../geometry/SpatialReference","../../../../geometry/support/webMercatorUtils"],function(s,q,n,k,h){return function(){function e(){this.spatialIndex=new n;this.spatialIndexNumPendingQueries=this.spatialIndexNumGraphics=0;this.graphicsCore=
this.viewSR=this.layer=this.layerView=null}e.prototype.initialize=function(c,b,e,f){this.layerView=c;this.layer=b;this.viewSR=e;this.graphicsCore=f};e.prototype.destroy=function(){this.spatialIndex&&(this.spatialIndex.destroy(),this.spatialIndex=null);this.graphicsCore=this.layerView=this.viewSR=null};e.prototype.numNodesUpdating=function(){return 0};e.prototype.isUpdating=function(){return 0<this.spatialIndexNumPendingQueries};e.prototype.hasGraphics=function(){return 0<this.spatialIndexNumGraphics};
e.prototype.intersects=function(c,b,e){var f=this;this.hasGraphics()&&(this.spatialIndexNumPendingQueries++,this.spatialIndex.intersects(c,void 0,void 0,!0).then(function(a){f.spatialIndexNumPendingQueries--;e(a.results,a.results.length);f.layerView._evaluateUpdatingState()}))};e.prototype.shouldAddToSpatialIndex=function(c,b,e){return e||b.mustAlignToTerrain()};e.prototype.addGraphicsToSpatialIndex=function(c){if(this.layerView.loadedGraphics)for(var b=this.layerView.loadedGraphics.toArray(),e=b.length,
f=0;f<e;f++){var a=b[f],h=this.graphicsCore.getGraphics3DGraphicById(a.id);h&&!h.addedToSpatialIndex&&this.shouldAddToSpatialIndex(a,h,c)&&this.addGraphicToSpatialIndex(a,h)}};e.prototype.addGraphicToSpatialIndex=function(c,b){var e=c.geometry.spatialReference,f=this.viewSR,a={id:c.id,geometry:null};if(e.equals(f))a.geometry=c.geometry.toJSON();else{var r=void 0;if(e.wkid===k.WGS84.wkid&&f.isWebMercator)r=h.geographicToWebMercator(c.geometry);else if(e.isWebMercator&&f.wkid===k.WGS84.wkid)r=h.webMercatorToGeographic(c.geometry);
else return console.warn("Cannot convert graphic geometry to map spatial reference, elevation and scale updates are disabled"),!1;a.geometry=r.toJSON()}this.spatialIndexNumGraphics++;this.spatialIndex.runProcess([a],this.layer.id);return b.addedToSpatialIndex=!0};return e}()})},"esri/processors/SpatialIndex":function(){define("../core/declare dojo/Deferred dojo/_base/lang ./Processor ../workers/WorkerClient ../layers/FeatureLayer".split(" "),function(s,q,n,k,h,e){return s([k],{declaredClass:"esri.processors.SpatialIndex",
index:null,indexType:"rtree",workerCallback:["./scripts/helpers","./scripts/indexInterface","./indexWorker"],autostart:!1,constructor:function(c){c=c||{};var b=!1!==c.autostart;n.mixin(this,c);if(!this.fetchWithWorker){var e=this;this.workerClient=new h("./mutableWorker");this.workerCallback.push("./libs/"+this.indexType);this.workerClient.importScripts(this.workerCallback).then(function(){e._attachedSystem=!0;b&&e.start()})}this._featCache={}},destroy:function(){this.workerClient&&this.workerClient.terminate()},
addLayer:function(c,b){if(c.graphics&&c.graphics.length||b||c.isInstanceOf(e))if(this._attachedSystem)this.inherited(arguments,[c]);else{var g=this.workerClient,f=this;this.inherited(arguments,[c,!0]);g.importScripts("./libs/"+this.indexType).then(function(){f.runProcess(c.graphics,c.id);f._attachedSystem=!0})}},unsetMap:function(){this.stop();this.workerClient.terminate();this.fetchWithWorker||(this.workerClient=new h(this.workerCallback));this.inherited(arguments);this.start()},removeLayer:function(c){this.inherited(arguments)},
runProcess:function(c,b){if(c&&c.length){var e=this,f=this.workerClient,a=c[0]._graphicsLayer;!b&&0!==b&&(b=a?a.id:"rawFeatures_"+Object.keys(this._featCache).length);this._featCache[b]||(this._featCache[b]={});for(var h,l,d=[],m=c.length,k=a&&a.objectIdField;m--;)if(l=c[m],h=l.attributes&&k?l.attributes[k]:l.id,null==h||!this._featCache[b][h])this._featCache[b][h]=1,l.declaredClass?d.push({id:h,geometry:l.geometry.toJSON(!0),attributes:l.attributes}):d.push(l);f.postMessage({insert:d,system:this.indexType,
options:this.indexOptions,idField:a&&a.objectIdField,layerId:b}).then(function(b){a&&a.emit("process-end",{processor:e,results:{insert:b.insert}})});a&&a.emit("process-start",{processor:this})}},_sendFeaturesFromLayer:function(c,b){var e=b.graphic,f=this.workerClient,a=this,h=e.attributes[c.objectIdField];this._featCache[c.id]||(this._featCache[c.id]={});this._featCache[c.id][h]||(this._featCache[c.id][h]=1,f.postMessage({insert:[{attributes:e.attributes,geometry:e.geometry.toJSON(!0)}],system:this.indexType,
options:this.indexOptions,idField:c.objectIdField,layerId:c.id}).then(function(b){c.emit("process-end",{processor:a,results:{insert:b.insert}})}),c.emit("process-start",{processor:a}))},_notifyProcessStart:function(c,b){},_sendFeaturesFromTask:function(c,b){var e=b.featureSet.features,f=[],a=this.workerClient,h=this,l=e.length,d,m;for(this._featCache[c.id]||(this._featCache[c.id]={});l--;)m=e[l],d=m.attributes[c.objectIdField],this._featCache[c.id][d]||(this._featCache[c.id][d]=1,f.push(m));a.postMessage({insert:f,
system:this.indexType,options:this.indexOptions,idField:c.objectIdField,layerId:c.id}).then(function(a){c.emit("process-end",{processor:h,results:{insert:a.insert}})});c.emit("process-start",{processor:h})},get:function(){},intersects:function(c,b,e,f){return"rtree"!=this.indexType?(console.error("Index.intersects only works with rtree indexes"),c=new q,c.reject({message:"Index.intersects only works with rtree indexes"}),c.promise):this.workerClient.postMessage({search:c,layerId:b,returnNode:e,onlyIds:f})},
within:function(c,b,e){if("rtree"!=this.indexType)return console.error("Index.within only works with rtree indexes"),c=new q,c.reject({message:"Index.within only works with rtree indexes"}),c.promise},nearest:function(c){return"kdtree"!=this.indexType?(console.error("Index.nearest only works with kdtree indexes"),c=new q,c.reject({message:"Index.nearest only works with kdtree indexes"}),c.promise):this.workerClient.postMessage({search:c})}})})},"esri/processors/Processor":function(){define("../core/sniff ../core/declare dojo/_base/lang dojo/_base/array dojo/Evented ../workers/RequestClient ../layers/GraphicsLayer".split(" "),
function(s,q,n,k,h,e,c){return q([h],{declaredClass:"esri.processors.Processor",layers:null,results:null,passFeatures:!0,drawFeatures:!0,requireWorkerSupport:!0,fetchWithWorker:!1,workerCallback:null,workerClient:null,_started:null,_handlers:null,constructor:function(b){b=b||{};n.mixin(this,b);!s("esri-workers")&&(!1!==this.requireWorkerSupport||!1!==b.requireWorkerSupport)?(console.log("Browser doesn't support workers \x26 worker support is required for this processor"),this.addLayer=this.setMap=
this.start=this.runProcess=function(){},this._disabled=!0):(this._handlers={},this._notifyProcessStart=n.hitch(this,this._notifyProcessStart),this._sendFeaturesFromTask=n.hitch(this,this._sendFeaturesFromTask),this._sendFeaturesFromLayer=n.hitch(this,this._sendFeaturesFromLayer),!1!==b.autostart&&this.start())},addLayer:function(b,c){var f=b._task,a=this._handlers[b.id]=[],h="complete";!1===this.drawFeatures&&(b._params.drawMode=!1);this.fetchWithWorker?(this.workerClient||(this.workerClient=e.getClient(this.workerCallback)),
f.requestOptions={workerOptions:{worker:this.workerClient}},this.passFeatures&&a.push(f.on(h,n.partial(this._notifyProcessStart,b)))):this.passFeatures?(h=this.drawFeatures?"graphic-draw":"graphic-add",a.push(b.on(h,n.partial(this._sendFeaturesFromLayer,b)))):a.push(f.on(h,n.partial(this._sendFeaturesFromTask,b)));!0!==c&&b.graphics&&this.runProcess(b.graphics,b.id)},removeLayer:function(b){k.forEach(this._handlers[b.id],function(b){b.remove()});delete this._handlers[b.id]},setMap:function(b){if(this.map)if(b!=
this.map)this.unsetMap();else return;var e=this;k.forEach(this.layers,e.removeLayer);k.forEach(b.graphicsLayerIds,function(c){e.addLayer(b.findLayerById(c))});this._handlers.map=[b.on("layer-add",function(b){b=b.layer;b.isInstanceOf(c)&&e.addLayer(b)}),b.on("layer-remove",function(b){b=b.layer;b.isInstanceOf(c)&&e.removeLayer(b)})];this.map=b},unsetMap:function(){this.map&&(k.forEach(this._handlers.map,function(b){b.remove()}),delete this._handlers.map,k.forEach(this.layers,this.removeLayer),this.map=
null)},start:function(){this.map?this.setMap(this.map):this.layers&&(n.isArray(this.layers)||(this.layers=[this.layers]),k.forEach(this.layers,this.addLayer));this._started=!0;this.emit("start",{processor:this});console.log("processor started")},stop:function(){this._started=!1;for(var b in this._handlers)this._handlers.hasOwnProperty(b)&&(this._handlers[b].remove(),delete this._handlers[b]);this.emit("stop",{processor:this});console.log("processor stopped")},runProcess:function(b,c){},_sendFeaturesFromTask:function(){},
_sendFeaturesFromLayer:function(){},_notifyProcessStart:function(){}})})},"esri/workers/RequestClient":function(){define(["../core/declare","dojo/_base/xhr","../config","./WorkerClient"],function(s,q,n,k){function h(f,a){var g=new e;g.addWorkerCallback(f,a);c.unshift({id:a?f+"::"+a:f,client:g});c.length>b&&c.pop().client.terminate();return g}var e=s([k],{declaredClass:"esri.workers.RequestClient",constructor:function(){this.setWorker(["./mutableWorker","./requestWorker"])},get:function(b){return this._send("GET",
b)},post:function(b){return this._send("POST",b)},_send:function(b,a){var c=q._ioSetArgs(a);c.xhr=null;var e=c.ioArgs,d=e.url;delete e.url;delete e.args;this.postMessage({method:b,url:d,options:e}).then(this._getSuccessHandler(c),this._getErrorHandler(c),this._getProgressHandler(c));return c},_addHeaderFunctions:function(b){b.getResponseHeader=function(a){var c,e=b.headers;Object.keys(e).forEach(function(b){if(b.toLowerCase()==a.toLowerCase())return c=e[b],!1});return c};b.getAllResponseHeaders=function(){var a=
[],c=b.headers;Object.keys(c).forEach(function(b){a.push(b+": "+c[b])});return a=a.join("\n")};return b},_getSuccessHandler:function(b){var a=this,c=b.ioArgs;return function(e){b.xhr=a._addHeaderFunctions(e);e=b.xhr.getResponseHeader("content-type");if(("xml"==c.handleAs||-1<e.indexOf("xml"))&&"string"==typeof b.xhr.response)b.xhr.response=(new DOMParser).parseFromString(b.xhr.response,"text/xml");b.resolve(b.xhr.response,b.xhr)}},_getErrorHandler:function(b){return function(a){b.reject(a)}},_getProgressHandler:function(b){return function(a){b.progress(a)}}}),
c=[],b=n.request.maxWorkers,g=new e;e.getClient=function(b,a){if(b){var e;c.some(function(c){if(c.id==(a?b+"::"+a:b))e=c.client;return!0});return e||h(b,a)}return g};e.setLimit=function(c){b=n.request.maxWorkers=c};return e})},"esri/workers/WorkerClient":function(){define("dojo/Evented ../core/declare dojo/Deferred dojo/_base/lang dojo/request ../core/sniff ../core/urlUtils require".split(" "),function(s,q,n,k,h,e,c,b){var g=window.Blob||window.webkitBlob||window.mozBlob,f=window.URL||window.webkitURL||
window.mozURL;return q([s],{declaredClass:"esri.workers.WorkerClient",worker:null,_queue:null,constructor:function(a){this._isIE=e("ie");this._queue={};this._acceptMessage=k.hitch(this,this._acceptMessage);this._errorMessage=k.hitch(this,this._errorMessage);a&&(this.worker=this.setWorker(a))},setWorker:function(a){if(a instanceof Array){var b=a;a=b.shift()}a=this._getUrl(a);var e=!c.hasSameOrigin(c.getAbsoluteUrl(a),location.href),d;if(!1===a)return console.log("Can not resolve worker path"),!1;this.worker&&
(d=this.worker,d.removeEventListener("message",this._acceptMessage,!1),d.removeEventListener("error",this._errorMessage,!1),d.terminate(),d=null);if(e){var h=this._getUrl("./mutableWorker",!0);try{var k=this._getRemoteText(h,!0);d=new Worker(f.createObjectURL(new g([k],{type:"text/javascript"})))}catch(n){try{h=c.getProxyUrl(h).path+"?"+encodeURI(h),d=new Worker(h),this._useProxy=!0}catch(q){return console.log("Can not create worker"),!1}}}else d=new Worker(a);d.addEventListener("message",this._acceptMessage,
!1);d.addEventListener("error",this._errorMessage,!1);this.worker=d;e&&this.importScripts(a);b&&this.importScripts(b);return d},postMessage:function(a,b){if(a instanceof Array||"object"!=typeof a)a={data:a};var c=Math.floor(64E9*Math.random()).toString(36);a.msgId=c;c=this._queue[c]=new n;this.worker?(b?this.worker.postMessage(a,b):this.worker.postMessage(a),this.emit("start-message",{target:this,message:a})):c.reject({message:"No worker was set."});return c.promise},terminate:function(){var a=Object.keys(this._queue);
this.worker&&this.worker.terminate();for(var b=a.length-1;0<=b;b--)this._queue[a[b]].cancel("terminated"),delete this._queue[a[b]]},addWorkerCallback:function(a,b){var c;c=this._getUrl(a,!0);return!1===c?(c=new n,c.reject({message:"Could not load text from "+a}),c.promise):this.postMessage({action:"add-callback",url:c,cbName:b||"main"}).then(k.hitch(this,function(a){a.target=this;this.emit("callback-added",a)}))},importScripts:function(a){Array.isArray(a)||(a=[a]);a=a.map(function(a){a=this._getUrl(a,
!0);this._useProxy&&!c.hasSameOrigin(a,location.href)&&(a=c.getProxyUrl(a).path+"?"+encodeURI(a));return a},this);return this.postMessage({action:"import-script",url:a}).then(k.hitch(this,function(a){a.target=this;this.emit("scripts-imported",a)}))},_acceptMessage:function(a){var b=a.data,c=b.msgId;if(b.status&&"debug"==b.status)console[b.showAs||"debug"](b);else if(c&&c in this._queue){var d=this._queue[c];"progress"==b.status?d.progress(a.data):("error"==b.status?d.reject(a.data):d.resolve(a.data),
delete this._queue[c])}this.emit("message",{message:a.data,event:a,target:this})},_errorMessage:function(a){this.onerror||this.onError?this.onerror?this.onerror(a):this.onError(a):console.log("Worker Error: "+a.message+"\nIn "+a.filename+" on "+a.lineno)},_getUrl:function(a,f){if(!a)return console.error("can not resolve empty path"),!1;a.match(/\.js$/)||(a+=".js");var e=b.toUrl(a);return f?c.getAbsoluteUrl(e):e},_getRemoteText:function(a,b){var c="";(a=this._getUrl(a))&&h.get(a,{sync:b,handleAs:"text",
headers:{"X-Requested-With":"","Content-Type":"text/plain"}}).then(function(a){c=a});return c},_startBlobWorker:function(){var a=this._xdSource;a||(a=this._getUrl("./mutableWorker"),a=new g(["if(!self._mutable){importScripts('"+a+"');}"],{type:"text/javascript"}),a=this._xdSource=f.createObjectURL(a));try{return new Worker(a)}catch(b){return console.log(b.message),!1}}})})},"esri/layers/GraphicsLayer":function(){define("../core/Accessor ../core/Collection ../core/promiseUtils ./Layer ../Graphic dojo/_base/lang".split(" "),
function(s,q,n,k,h,e){var c=s.createSubclass({properties:{layer:null,layerView:null,graphics:null}});return k.createSubclass({declaredClass:"esri.layers.GraphicsLayer",viewModulePaths:{"2d":"../views/2d/layers/GraphicsLayerView2D","3d":"../views/3d/layers/FeatureLayerView3D"},getDefaults:function(b){return e.mixin(this.inherited(arguments),{graphics:[]})},destroy:function(){this.removeAll()},_gfxHdl:null,properties:{elevationInfo:null,graphics:{type:q.ofType(h),set:function(b){var c=this._get("graphics");
c||(b.forEach(function(b){b.layer=this},this),this._gfxHdl=b.on("change",function(b){var a,c,e;e=b.added;for(a=0;c=e[a];a++)c.layer=this;e=b.removed;for(a=0;c=e[a];a++)c.layer=null}.bind(this)),this._set("graphics",b),c=b);c.removeAll();c.addMany(b)}}},add:function(b){this.graphics.add(b);return this},addMany:function(b){this.graphics.addMany(b);return this},removeAll:function(){this.graphics.removeAll();return this},createGraphicsController:function(b){return n.resolve(new c({layer:this,layerView:b.layerView,
graphics:this.graphics}))},remove:function(b){this.graphics.remove(b)},removeMany:function(b){this.graphics.removeMany(b)},graphicChanged:function(b){this.emit("graphic-update",b)}})})},"esri/views/3d/layers/graphics/Graphics3DSharedResources":function(){define("require exports dojo/io-query ../graphics/TextureCollection ../../support/ResourceController ../../../../core/urlUtils".split(" "),function(s,q,n,k,h,e){return function(){function c(){this.canUseXhr=this.streamDataSupplier=this.textures=null}
c.prototype.initialize=function(b,c,f){var a=this;this.canUseXhr=null;this.streamDataSupplier=c.registerClient(this,h.ClientType.SYMBOLOGY,function(b){return a.addUrlToken(b,f)});this.textures=new k(this.streamDataSupplier,b,{wrapClamp:!0})};c.prototype.destroy=function(){this.streamDataSupplier=this.textures=null};c.prototype.addUrlToken=function(b,c){if(-1!==b.indexOf("?token\x3d")||0===b.indexOf("data:"))return b;var f={};c&&(f.token=c.token);f=n.objectToQuery(f);b+=f?"?"+f:"";null==this.canUseXhr&&
(this.canUseXhr=e.canUseXhr(b));return!this.canUseXhr?e.addProxy(b):b};return c}()})},"esri/views/3d/layers/graphics/TextureCollection":function(){define("../../../../core/declare dojo/Deferred dojo/_base/lang ../../webgl-engine/Stage ../../webgl-engine/lib/Texture ../../webgl-engine/lib/Util".split(" "),function(s,q,n,k,h,e){var c=e.assert;return s(null,{constructor:function(b,c,f){this._streamDataSupplier=b;this._stage=c;this._textureRecords={};this._loadedHandler=this._loadedHandler.bind(this);
this._errorHandler=this._errorHandler.bind(this);this._textureOptions=f||{}},acquire:function(b,c){var f;if(f=this._textureRecords[b])return f.referenceCount++,f.texture||f.clientDfd;if(c){var a=c(b);this._stage.add(k.ModelContentType.TEXTURE,a);f={texture:a,referenceCount:1};this._textureRecords[b]=f;return a}f=new q;a=this._streamDataSupplier.request(b,"image");this._textureRecords[b]={clientDfd:f,loaderDfd:a,texture:null,referenceCount:1};a.then(this._loadedHandler,this._errorHandler);return f.promise},
release:function(b){var c=this._textureRecords[b];c?(1>c.referenceCount&&console.warn("TextureCollection: reference count is \x3c 1 for "+b),c.referenceCount--,1>c.referenceCount&&(c.texture?(this._stage.remove(k.ModelContentType.TEXTURE,c.texture.getId()),c.texture=null):this._streamDataSupplier.cancelRequest(c.loaderDfd),delete this._textureRecords[b])):console.warn("TextureCollection: texture doesn't exist: "+b)},isInUse:function(b){b=this._textureRecords[b];c(!b||0<b.referenceCount,"texture record with zero reference count");
return!!b},_loadedHandler:function(b,e,f){b=this._textureRecords[b];c(b&&!b.texture);f=n.mixin({width:e.width,height:e.height},this._textureOptions);e=new h(e,"symbol",f);this._stage.add(k.ModelContentType.TEXTURE,e);b.texture=e;b.clientDfd.resolve(e)},_errorHandler:function(b){b=this._textureRecords[b];c(b&&!b.texture);b.clientDfd.reject()}})})},"esri/views/3d/layers/graphics/Graphics3DElevationAlignment":function(){define(["require","exports"],function(s,q){return function(){function n(){this.elevationDirtyGraphicsQueue=
[];this.elevationDirtyGraphicsSet={};this.elevationUpdateEventHandle=null;this.eventHandles=[];this.updateElevation=!1;this.graphicsCore=this.layerView=null}n.prototype.initialize=function(k,h,e,c){var b=this;this.layerView=k;this.graphicsCore=e;this.elevationChangedCallback=h;this.elevationUpdateEventHandle=c.on("elevation-change",function(c){return b.elevationUpdateHandler(c)});this.eventHandles.push(this.layerView.watch("suspended",function(){return b.suspendedChange()}))};n.prototype.destroy=
function(){this.elevationDirtyGraphicsSet=this.elevationDirtyGraphicsQueue=null;this.elevationUpdateEventHandle&&(this.elevationUpdateEventHandle.remove(),this.elevationUpdateEventHandle=null);this.eventHandles.forEach(function(k){return k.remove()});this.elevationChangedCallback=this.graphicsCore=this.layerView=this.eventHandles=null};n.prototype.clear=function(){this.elevationDirtyGraphicsSet={};this.elevationDirtyGraphicsQueue=[]};n.prototype.suspendedChange=function(){!0===this.layerView.suspended?
this.updateElevation=!1:!1===this.layerView.suspended&&this.updateElevation&&this.markAllGraphicsElevationDirty()};n.prototype.isUpdating=function(){return 0<this.elevationDirtyGraphicsQueue.length};n.prototype.numNodesUpdating=function(){return this.elevationDirtyGraphicsQueue.length};n.prototype.needsIdleUpdate=function(){return this.layerView.view.basemapTerrain&&0<this.elevationDirtyGraphicsQueue.length};n.prototype.idleUpdate=function(k){if(!k.done()){var h=this.layerView.view,e=this.elevationDirtyGraphicsQueue.length;
if(0<e){for(var c=this.graphicsCore.stageLayer.getId(),b=this.graphicsCore.labelStageLayer?this.graphicsCore.labelStageLayer.getId():null,g=0,f=0,f=0;f<e;f++){var a=this.elevationDirtyGraphicsQueue[f],n=this.graphicsCore.graphics[a];n&&n.alignWithElevation(h.basemapTerrain,h.renderCoordsHelper);delete this.elevationDirtyGraphicsSet[a];g++;if(20<=g){h._stage.processDirtyLayer(c);null!=b&&h._stage.processDirtyLayer(b);if(k.done())break;g=0}}h._stage.processDirtyLayer(c);null!=b&&h._stage.processDirtyLayer(b);
this.elevationDirtyGraphicsQueue.splice(0,f+1);h.labelManager.setDirty();this.layerView._evaluateUpdatingState()}}};n.prototype.markAllGraphicsElevationDirty=function(){for(var k in this.graphicsCore.graphics)this.markGraphicElevationDirty(this.graphicsCore.graphics[k].graphic.id);this.layerView._evaluateUpdatingState()};n.prototype.markGraphicElevationDirty=function(k){this.elevationDirtyGraphicsSet[k]||(this.elevationDirtyGraphicsSet[k]=!0,this.elevationDirtyGraphicsQueue.push(k))};n.prototype.elevationUpdateHandler=
function(k){var h=this,e=k.extent;if(this.layerView.suspended){if(!this.updateElevation&&(k=this.graphicsCore.computedExtent)&&e[2]>k.xmin&&e[0]<k.xmax&&e[3]>k.ymin&&e[1]<k.ymax)this.updateElevation=!0}else-Infinity===e[0]?this.markAllGraphicsElevationDirty():this.elevationChangedCallback(e,k.spatialReference,function(c,b){for(var e=!1,f=0;f<b;f++){var a=c[f],k=h.graphicsCore.graphics[a];k&&k.mustAlignToTerrain()&&(h.markGraphicElevationDirty(a),e=!0)}e&&h.layerView._evaluateUpdatingState()})};return n}()})},
"esri/views/3d/navigation/spherical/NavigationSpherical":function(){define("../Navigation ./ConstraintsSpherical ./AnimationSpherical ./actions/PanSpherical ./actions/ZoomSpherical ./actions/RotateSpherical ../../lib/glMatrix".split(" "),function(s,q,n,k,h,e,c){var b=c.vec3d,g=c.mat4d,f=b.create(),a=b.create(),r=g.create();return s.createSubclass([q,n],{declaredClass:"esri.views.3d.navigation.spherical.NavigationSpherical",initialize:function(){this.pan=new k(this);this.zoom=new h(this);this.rotate=
new e(this)},fixTargetUpVector:function(){this.cameras.target.computeUpOnSphere()},setPoiAuto:function(a,c){var e=this.picker.pickAlongRay(this.cameras.target.eye,this.cameras.target.center,null,a);this.picker.pickedIntersectionPoint(e,f)&&(this.setCameraFromEyeAndCenter(this.cameras.target.eye,f),b.set(this.cameras.target.center,this.cameras.current.center),c&&this.setCurrentToTarget())},rotateCameraWithPointsOnSphere:function(c,d,f,e,h){var k;null==h&&(h=b.length(c));1E-4<=Math.abs(b.length(c)-
h)&&(console.error("[NavigationSpherical.rotateCameraWithPointsOnSphere]: invalid radius for source point (got "+h+", but expected "+b.length(c)+", "+c+")"),k=b.length(c));1E-4<=Math.abs(b.length(d)-h)&&(console.error("[NavigationSpherical.rotateCameraWithPointsOnSphere: invalid radius for target point (got "+h+", but expected "+b.length(d)+")"),void 0===k&&(k=b.length(d)));void 0!==k&&(h=k);c=this.rotationFromPointsOnSphere(c,d,h,a);g.identity(r);g.rotate(r,c,a);g.multiplyVec3(r,f.eye,e.eye);g.multiplyVec3(r,
f.center,e.center);g.multiplyVec3(r,f.up,e.up)},rotationFromPointsOnSphere:function(a,c,f,e){b.cross(a,c,e);return-Math.acos(1-b.dist2(a,c)/(2*f*f))}})})},"esri/views/3d/navigation/Navigation":function(){define(["../../../core/Accessoire","../../../core/Evented","../../../core/watchUtils","./Picker","./mixins/CamerasMixin"],function(s,q,n,k,h){return s.createSubclass([h,q],{classMetadata:{properties:{interacting:{getter:function(){return this._interacting},readOnly:!0},renderUnitInMeters:{dependsOn:["renderCoordsHelper"],
getter:function(){return this.renderCoordsHelper?this.renderCoordsHelper.unitInMeters:1}},picker:{},constraints:{}}},initialize:function(){this._mapCoordsHelperHandle=n.init(this.view,"mapCoordsHelper",function(e){this.mapCoordsHelper=e}.bind(this));this._renderCoordsHelperHandle=n.init(this.view,"renderCoordsHelper",this.updateRenderCoordsHelper.bind(this));this.picker=new k(this,this.view);this._interacting=!1},destroy:function(){this._mapCoordsHelperHandle.remove();this._renderCoordsHelperHandle.remove()},
updateRenderCoordsHelper:function(e){this.renderCoordsHelper=e;this.inherited(arguments)},begin:function(e){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this._interacting=!0;this.notifyChange("interacting")},end:function(e){this._interacting=!1;this.notifyChange("interacting")}})})},"esri/views/3d/navigation/Picker":function(){define(["../../../core/declare","../support/RenderCoordsHelper","../lib/glMatrix","../webgl-engine/lib/Selector"],function(s,q,n,k){var h=n.vec3d,e=h.create(),
c=h.create();return s([],{constructor:function(b,c){this.navigation=b;this.pickAlongRay=c._pickRay.bind(c);this.createPickRay=c._pickRayWithBeginPoint.bind(c);this.selector=new k},pickPointInScreen:function(b,c){return this.pickedIntersectionPoint(this.pickInScreen(b,!1),c)},pickFreePointInScreen:function(b,g){this.createPickRay(b,void 0,this.navigation.currentCamera.viewMatrix,e,c);g||(g=h.create());h.subtract(c,e);h.normalize(c);var f=this.navigation.view.dataExtent,a=Math.max(f.xmax-f.xmin,f.ymax-
f.ymin,f.zmax-f.zmin),k=this.navigation.currentCamera,l=Math.max(0,f.xmin-k.eye[0],k.eye[0]-f.xmax),f=Math.max(0,f.ymin-k.eye[1],k.eye[1]-f.ymax),l=Math.sqrt(l*l+f*f),f="global"==this.navigation.view.viewingMode?q.Spherical.prototype.getAltitude(k.eye):q.Planar.prototype.getAltitude(k.eye),k=this.navigation._getTerrainElevationBelowCamera(k),k=Math.abs(f-k)+Number.MIN_VALUE,k=Math.pow(Math.max(0,Math.log(a/k)),2),k=a/Math.max(1,k),k=Math.max(k,Math.min(l,a));h.scale(c,k);h.add(e,c,g)},pickInScreen:function(b,
g){this.createPickRay(b,void 0,this.navigation.currentCamera.viewMatrix,e,c);g&&h.set(this.navigation.currentCamera.eye,e);return this.pickAlongRay(e,c,b,b,null,null,this.selector)},pickedIntersectionPoint:function(b,c){if(!b)return!1;c||(c=h.create());return b.getMinResult().getIntersectionPoint(c)}})})},"esri/views/3d/navigation/mixins/CamerasMixin":function(){define("../../../../core/declare ../../../../core/Evented ../../webgl-engine/lib/Camera ../../support/earthUtils ../../support/mathUtils ../../lib/glMatrix dojo/on".split(" "),
function(s,q,n,k,h,e,c){var b=e.vec3d,g=e.vec4d.create();return s([q],{declaredClass:"esri.views.3d.navigation.mixins.CamerasMixin",classMetadata:{properties:{targetCamera:{getter:function(){return this.cameras.target}},currentCamera:{getter:function(){return this.cameras.current}},windowSize:{setter:function(b){var a=b[0],c=b[1],e=!1,d=this.cameras.target.x-this.cameras.target.padding[3],g=this.cameras.target.y-this.cameras.target.padding[2];if(this.cameras.target.width+d!==a||this.cameras.target.height+
g!==c)this.cameras.target.width=a-d,this.cameras.target.height=c-g,this.targetChanged(),e=!0;d=this.cameras.current.x-this.cameras.current.padding[3];g=this.cameras.current.y-this.cameras.current.padding[2];if(this.cameras.current.width+d!==a||this.cameras.current.height+g!==c)this.cameras.current.width=a-d,this.cameras.current.height=c-g,this.currentChanged(),e=!0;e&&this.currentHasReachedTarget()&&this.currentReachedTarget();return b}},padding:{setter:function(b){var a=!1,c=!1;g[0]=b.top;g[1]=b.right;
g[2]=b.bottom;g[3]=b.left;h.vectorEquals(this.cameras.current.padding,g)||(this.cameras.current.padding=g,c=!0);h.vectorEquals(this.cameras.target.padding,g)||(this.cameras.target.padding=g,a=!0);a&&this.targetChanged();c&&this.currentChanged();this.currentHasReachedTarget()&&(a||c)&&this.currentReachedTarget()}}}},initialize:function(){var c=new n(b.createFrom(4*k.earthRadius,0,0),b.createFrom(k.earthRadius,0,0),b.createFrom(0,0,1));this.cameras={current:c,target:c.copy()}},currentHasReachedTarget:function(){return this.cameras.current.equals(this.cameras.target)},
currentHasAlmostReachedTarget:function(){return this.cameras.current.almostEquals(this.cameras.target,5E-4/this.renderUnitInMeters)},setCamera:function(b,a){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this.cameras.target.copyFrom(b);var c=!(a&&a.internalUpdate)||!this._targetCameraChangedByElevationUpdate,e=this.constrainTargetEyeByElevation(c),e=this.applyConstraints(this.cameras.target,!0)||e;this.fixTargetUpVector();this.currentHasReachedTarget()?(this.targetChanged(),e&&c&&(this._targetCameraChangedByElevationUpdate=
!0),this.currentReachedTarget()):(void 0!==a&&void 0!==a.animate&&!a.animate?this.targetAndCurrentChanged(!0):this.targetAnimatedChanged(),e&&c&&(this._targetCameraChangedByElevationUpdate=!0),this._autoUpdateTiltConstraint())},getTargetCamera:function(){console.warn("[Navigation.getTargetCamera()] deprecated; use .targetCamera instead");return this.targetCamera},getCurrentCamera:function(){console.warn("[Navigation.getCurrentCamera()] deprecated; use .currentCamera instead");return this.currentCamera},
_cameraFromEyeCenterUp:function(b,a,c){var e=this.cameras.target.copy();e.eye=b;e.center=a;e.up=c;return e},setCameraFromEyeAndCenter:function(b,a,c){this.setCamera(this._cameraFromEyeCenterUp(b,a,this.cameras.target.up),c)},setCameraFromEyeCenterAndUp:function(b,a,c,e){this.setCamera(this._cameraFromEyeCenterUp(b,a,c),e)},_cameraEvents:{},_prepareCameraEvent:function(b,a){var c=this._cameraEvents[b];c||(c={camera:new n},this._cameraEvents[b]=c);c.camera.copyFrom(a);return c},emitWithCamera:function(b,
a){c.emit(this,b,this._prepareCameraEvent(b,a))},targetChanged:function(b){this.inherited(arguments);this.cameras.target.markViewDirty();var a=this._prepareCameraEvent("targetViewChanged",this.cameras.target);a.interruptedAnimation=!!b;a.finishedAnimation=!1;c.emit(this,"targetViewChanged",a)},targetAnimatedChanged:function(b){this.targetChanged(b);this.animationStarted()},targetAndCurrentChanged:function(b){this.targetChanged(b);this.setCurrentToTarget(!1,b)},currentChanged:function(){this.inherited(arguments);
this.cameras.current.markViewDirty();this.emitWithCamera("currentViewChanged",this.cameras.current)},currentReachedTarget:function(b,a){this.currentChanged();if(!this.pan||!this.pan.continuous||!this.pan.continuous.active){var e=this._prepareCameraEvent("currentViewReachedTarget",this.cameras.current);e.finishedAnimation=!!b;e.interruptedAnimation=!!a;c.emit(this,"currentViewReachedTarget",e)}},setCurrentToTarget:function(b,a){this.cameras.current.copyFrom(this.cameras.target);this.currentReachedTarget(b,
a)}})})},"esri/views/3d/navigation/spherical/ConstraintsSpherical":function(){define("../mixins/ConstraintsMixin ../../support/mathUtils ../../support/earthUtils ../../lib/glMatrix ../../constraints/SceneViewAltitudeConstraint ../../constraints/SceneViewTiltConstraint ../../webgl-engine/lib/Util".split(" "),function(s,q,n,k,h,e,c){var b=k.vec3d,g=b.create();return s.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.ConstraintsSpherical",defaultConstraints:{tilt:new s.Tilt({min:function(){return q.deg2rad(e.MAX_DEFAULT)},
max:q.makePiecewiseLinearFunction([[4E3,q.deg2rad(e.MIN_DEFAULT)],[5E4,q.deg2rad(88)],[6E6,q.deg2rad(88)],[2E7,q.deg2rad(e.MAX_DEFAULT)]])}),altitude:new s.Altitude({min:function(){return h.MIN_DEFAULT},max:function(){return h.MAX_DEFAULT}}),collision:new s.Collision},limitAltitude:function(c,a,e,h){b.scale(e,c/h,g);b.subtract(a,g,g);var d=this.renderCoordsHelper.getAltitude(g),m=this.constraints.altitude.apply(this,d);if(1E-6<Math.abs(d-m)){c=b.length(a);m+=n.earthRadius;a=b.dot(e,a)/(c*h);a*=-2*
c;e=a*a-4*(-(m*m)+c*c);if(0>e)return this.minPoiDist;e=Math.sqrt(e);return e<a?(a-e)/2:(e-a)/2}return c},limitTiltByAltitudeConstraints:function(c,a,e,g){a=b.length(a);var d=a*a,h=e*e,k=Math.sqrt(d+h-2*a*e*Math.cos(Math.PI-c))-n.earthRadius,t=this.constraints.altitude.min(),s=this.constraints.altitude.max(),v;if((void 0===g||0<g)&&k<t)v=t;else if((void 0===g||0>g)&&k>s)v=s;void 0!==v&&(c=v+n.earthRadius,c=Math.PI-q.acos((-(c*c)+d+h)/(2*a*e)));return c},distanceToSilhouette:function(c,a,e,g,d){d||
(d={maxFarNearRatio:0,distance:0});c=b.dot(c.eye,c.eye);a=n.earthRadius*n.earthRadius;d.maxFarNearRatio=this.maxFarNearRatio;c>a?(d.maxFarNearRatio=q.clamp(2E4-19E3*((Math.log(Math.sqrt(c)-n.earthRadius)-7.983)/9.011),1E3,2E4),d.distance=Math.sqrt(c-a)):d.distance=this.maxFarNearRatio*this.minNearDistance;d.distance*=1.2;return d},intersectManifold:function(b,a,e,g){return c.raySphereClosestPositive(b,a,n.earthRadius+e,g)},getCenterIntersectTerrainFallback:function(c,a,e){a=b.dot(c,c);var g=n.earthRadius*
n.earthRadius;a=a>g?Math.sqrt(a-g)/3:1;b.scale(e,a/b.length(e),e);b.add(e,c)}})})},"esri/views/3d/navigation/mixins/ConstraintsMixin":function(){define("../../../../core/declare ../../../../core/watchUtils ../../../../geometry/Point ../../support/mathUtils ../../lib/glMatrix ../../constraints/SceneViewAltitudeConstraint ../../webgl-engine/lib/Camera ../../webgl-engine/lib/IntervalUtilities".split(" "),function(s,q,n,k,h,e,c,b){function g(a){return new y.Tilt({min:function(){return 0.01},max:function(){return k.deg2rad(a.tilt.max)}})}
function f(a){return new y.Altitude({min:function(){return a.altitude.min},max:function(){return a.altitude.max}})}var a=h.vec3d,r=h.mat4d,l=new n,d=a.create(),m=a.create(),p=r.create(),t=a.create(),x=a.create(),v=a.create(),u=new c,z=new c,w=a.create(),C={tilt:0,distance:0},A={distance:0,maxFarNearRatio:0},y=s([],{declaredClass:"esri.views.3d.navigation.mixins.ConstraintsMixin",classMetadata:{properties:{userConstraints:{setter:function(a){this._disconnectUserConstraints();this._connectUserConstraints(a);
return a}},elevationProvider:{value:null,setter:function(a){null!==this._elevationChangeHandle&&(this._elevationChangeHandle.remove(),this._elevationChangeHandle=null);null!==this._elevationChangeTileHandle&&(this._elevationChangeTileHandle.remove(),this._elevationChangeTileHandle=null);null!==a&&(this._elevationChangeHandle=a.on("elevation-change",this._elevationChangeHandler.bind(this)),this._elevationChangeTileHandle=a.on("elevation-change-tile",this._elevationChangeTileHandler.bind(this)));return a}},
minPoiDist:{getter:function(){return this._minPoiDistInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},cameraElevationMargin:{getter:function(){return this._cameraElevationMarginInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},minNearDistance:{getter:function(){return this._minNearDistanceInMeters/this.renderUnitInMeters},dependsOn:["renderUnitInMeters"]},constraintsEnabled:{value:!0}}},constructor:function(){this._userConstraints=null;this._userConstraintsHandles=
[];this._clipDistanceHandles=[];this._tiltHandles=[];this._altitudeHandles=[];this.constraints={tilt:this.defaultConstraints.tilt,altitude:this.defaultConstraints.altitude,collision:this.defaultConstraints.collision};this._tiltModeHandler=this._tiltModeHandler.bind(this);this._tiltMaxHandler=this._tiltMaxHandler.bind(this);this._altitudeModeHandler=this._altitudeModeHandler.bind(this);this._altitudeMinMaxHandler=this._altitudeMinMaxHandler.bind(this);this._clipDistanceModeHandler=this._clipDistanceModeHandler.bind(this);
this._clipDistanceNearFarHandler=this._clipDistanceNearFarHandler.bind(this);this._collisionEnabledHandler=this._collisionEnabledHandler.bind(this);this.enableElevationUpdates=!0;this.updateTargetByElevationUpdates=y.UPDATE_TARGET_BY_ELEVATION_UPDATES_DEFAULT;this._recomputeTargetCenterForElevationChange=!1;this._terrainElevationAtCameraEye=this._terrainElevationBelowCamera=this._elevationChangeTileHandle=this._elevationChangeHandle=null;this._autoAltitudeConstraints={min:e.MIN_DEFAULT,max:e.MAX_DEFAULT};
this.maxFarNearRatio=2E4;this._minNearDistanceInMeters=2;this._minPoiDistInMeters=4;this._cameraElevationMarginInMeters=5},initialize:function(){this._targetCameraBeforeElevationUpdate=this.cameras.current.copy();this._sceneExtentChangeHandle=this.view.watch("dataExtent",function(a){this._dataExtentChanged()}.bind(this))},_dataExtentChanged:function(){this._updateAltitudeConstraintFromExtent(this.view.dataExtent);this._reapplyConstraints();this._camerasChanged()},_updateAutoAltitudeConstraints:function(a){},
updateRenderCoordsHelper:function(a,b){this.inherited(arguments);if(!this._userConstraints||"auto"===this._userConstraints.altitude.mode)this.constraints.altitude=y.Altitude.scale(this.defaultConstraints.altitude,a.unitInMeters);if(!this._userConstraints||"auto"===this._userConstraints.tilt.mode)this.constraints.tilt=y.Tilt.scale(this.defaultConstraints.tilt,a.unitInMeters);this._updateAltitudeConstraintFromExtent(this.view.dataExtent);this._reapplyConstraints();this._camerasChanged()},_updateAltitudeConstraintFromExtent:function(a){0<
a.xmax-a.xmin&&(this._updateAutoAltitudeConstraints(a),(!this._userConstraints||"auto"===this._userConstraints.altitude.mode)&&this._autoUpdateAltitudeConstraint())},destroy:function(){this._disconnectUserConstraints();this._sceneExtentChangeHandle.remove()},_updateTargetCenterForElevation:function(a){if(a||this.enableElevationUpdates&&this.updateTargetByElevationUpdates)(a=this.getCameraIntersectTerrain(this.cameras.target.eye,this.cameras.target.center,this.cameras.target.up,0.02))&&!a.equals(this.cameras.target)&&
this.setCamera(a,{internalUpdate:!0})},step:function(){if(!(this.pan&&this.pan.continuous&&this.pan.continuous.active||this.pan.active||this.zoom.active||this.rotate.active)&&this._recomputeTargetCenterForElevationChange){var a=this._targetCameraChangedByElevationUpdate;this._updateTargetCenterForElevation();a&&(this._targetCameraChangedByElevationUpdate=!0);this._recomputeTargetCenterForElevationChange=!1}this.inherited(arguments)},applyConstraints:function(b,c){if(!this.constraintsEnabled)return!1;
var e=this._cameraElevationAngle(b,C),f=this.constraints.tilt.min(e.distance),g=this.constraints.tilt.max(e.distance),h=0;!c&&e.tilt>g?h=e.tilt-g:e.tilt<f&&(h=e.tilt-f);e=!1;0.01<Math.abs(h)&&(a.cross(d,b.up,m),r.identity(p),r.rotate(p,h,m),r.multiplyVec3(p,d),a.add(b.center,d,b.eye),r.multiplyVec3(p,b.up),e=!0);a.subtract(b.center,b.eye,t);h=b.distance;f=this.limitAltitude(h,b.center,t,h);h!==f&&(a.scale(t,-f/h),a.add(b.center,t,b.eye),e=!0);this._autoUpdateTiltConstraint(g);return e},limitTiltByConstraints:function(a,
b,c,d){if(!this.constraintsEnabled)return a;var e=this.constraints.tilt.min(c),f=this.constraints.tilt.max(c);if((void 0===d||0<d)&&a>=f)a=f;else if((void 0===d||0>d)&&a<=e)a=e;a=this.limitTiltByAltitudeConstraints(a,b,c,d);this._autoUpdateTiltConstraint(f);return a},_autoUpdateAltitudeConstraint:function(){var a=this._userConstraints&&this._userConstraints.altitude;a&&"auto"===a.mode&&a.autoUpdate(this.constraints.altitude.min(this),this.constraints.altitude.max(this))},_autoUpdateTiltConstraint:function(a){var b=
this._userConstraints&&this._userConstraints.tilt;void 0===a&&(a=this.constraints.tilt.max(this.cameras.target.distance));b&&"auto"===b.mode&&b.autoUpdate(k.rad2deg(a))},_disconnectUserConstraints:function(){if(this._userConstraints){this._userConstraintsHandles.forEach(function(a){a.remove()});this._userConstraints=null;this._userConstraintsHandles.length=0;var a=this.renderUnitInMeters;this.constraints.tilt=y.Tilt.scale(this.defaultConstraints.tilt,a);this.constraints.altitude=y.Altitude.scale(this.defaultConstraints.altitude,
a)}},_connectUserConstraints:function(a){a&&(this._userConstraints=a,this._userConstraintsHandles.push(q.init(a,"tilt.mode",this._tiltModeHandler),q.init(a,"clipDistance.mode",this._clipDistanceModeHandler),q.init(a,"altitude.mode",this._altitudeModeHandler),q.init(a,"collision.enabled",this._collisionEnabledHandler)))},_camerasChanged:function(){this.targetChanged();this.currentChanged();this.currentHasReachedTarget()&&this.currentReachedTarget()},_reapplyConstraints:function(){var a=!1;this.applyConstraints(this.cameras.current)&&
(a=!0);this.applyConstraints(this.cameras.target)&&(a=!0);a&&this._camerasChanged()},_userConstraintsChanged:function(){this._reapplyConstraints()},_altitudeMinMaxHandler:function(a,b,c){this._userConstraintsChanged()},_tiltMaxHandler:function(a,b,c){this._userConstraintsChanged()},_tiltModeHandler:function(a){this._tiltHandles.forEach(function(a){a.remove()});this._tiltHandles.length=0;"auto"===a?this.constraints.tilt=y.Tilt.scale(this.defaultConstraints.tilt,this.renderUnitInMeters):(this._tiltHandles.push(this._userConstraints.watch("tilt.max",
this._tiltMaxHandler)),this.constraints.tilt=g(this._userConstraints));this._tiltMaxHandler()},_altitudeModeHandler:function(a){this._altitudeHandles.forEach(function(a){a.remove()});this._altitudeHandles.length=0;"auto"===a?(this.constraints.altitude=y.Altitude.scale(this.defaultConstraints.altitude,this.renderUnitInMeters),this._autoUpdateAltitudeConstraint()):(this._altitudeHandles.push(this._userConstraints.watch("altitude.min",this._altitudeMinMaxHandler),this._userConstraints.watch("altitude.max",
this._altitudeMinMaxHandler)),this.constraints.altitude=f(this._userConstraints));this._altitudeMinMaxHandler()},_collisionEnabledHandler:function(a,b,c){this.constraints.collision=new y.Collision(this._userConstraints.collision.enabled);this._userConstraintsChanged()},_clipDistanceNearFarHandler:function(a,b,c){"auto"!==this._userConstraints.clipDistance.mode&&(this.cameras.target.near=this._userConstraints.clipDistance.near,this.cameras.target.far=this._userConstraints.clipDistance.far,this.cameras.current.near=
this._userConstraints.clipDistance.near,this.cameras.current.far=this._userConstraints.clipDistance.far);this._camerasChanged()},_clipDistanceModeHandler:function(a){this._clipDistanceHandles.forEach(function(a){a.remove()});this._clipDistanceHandles.length=0;"auto"!==a&&this._clipDistanceHandles.push(this._userConstraints.watch(["clipDistance.near","clipDistance.far"],this._clipDistanceNearFarHandler));this._clipDistanceNearFarHandler()},_updateAutoNearFar:function(a){var b=this._userConstraints&&
this._userConstraints.clipDistance;if(!(b&&"auto"!==b.mode)){var c=this.renderUnitInMeters,d=this.distanceToSilhouette(a,this.view.dataExtent,c,this._getTerrainElevationBelowCamera(a),A);a.far=d.distance/c;a.far/d.maxFarNearRatio>this.minNearDistance?a.near=a.far/d.maxFarNearRatio:(a.near=this.minNearDistance,a.far=a.near*d.maxFarNearRatio);b&&a===this.cameras.current&&b.autoUpdate(a.near,a.far)}},constrainTargetEyeByElevation:function(a){if(!this.elevationProvider||!this.elevationProvider.spatialReference)return!1;
var b=this.cameras.target;a&&this._targetCameraBeforeElevationUpdate.copyFrom(b);return this._applyTargetEyeElevationConstraint(b.eye,this._getTerrainElevationBelowCamera(b))},constrainTargetEyeByElevationAndMoveLookAt:function(){a.set(this.cameras.target.eye,v);this.constrainTargetEyeByElevation()&&(a.subtract(v,this.cameras.target.eye),a.subtract(this.cameras.target.center,v))},targetChanged:function(a){this.inherited(arguments);this._targetCameraChangedByElevationUpdate=!1;this._updateAutoNearFar(this.cameras.target)},
currentChanged:function(){this._updateAutoNearFar(this.cameras.current);this.inherited(arguments)},_applyTargetEyeElevationConstraint:function(a,b){if(!this.constraintsEnabled)return!1;var c=this.renderCoordsHelper,d=c.getAltitude(a);return this.constraints.collision.enabled&&d-b<this.cameraElevationMargin?(c.setAltitude(b+this.cameraElevationMargin,a,0),!0):!1},_cameraElevationAngle:function(b,c){c=c||{tilt:0,distance:0};this.renderCoordsHelper.worldUpAtPosition(b.center,x);a.subtract(b.eye,b.center,
d);var e=a.length(d),f=Math.acos(a.dot(d,x)/e/a.length(x));c.tilt=f;c.distance=e;return c},_elevationChangeTileHandler:function(a){if(this.enableElevationUpdates&&this._targetCameraChangedByElevationUpdate&&this.constraintsEnabled){var b=!1;a=a.tile.extent;var c=this.renderCoordsHelper.fromRenderCoords(this._targetCameraBeforeElevationUpdate.eye,l,this.mapCoordsHelper.spatialReference);a[0]<c.x&&(a[1]<c.y&&a[2]>c.x&&a[3]>c.y)&&(u.copyFrom(this.cameras.target),this.cameras.target.copyFrom(this._targetCameraBeforeElevationUpdate),
this.constrainTargetEyeByElevation(),b=!z.equals(this.cameras.target),b=this.applyConstraints(this.cameras.target)||b);b&&(this.targetChanged(),this._targetCameraChangedByElevationUpdate=!0)}},_elevationChangeHandler:function(a){if(this.enableElevationUpdates&&this.constraintsEnabled){var c=this.renderCoordsHelper,d=this.mapCoordsHelper.spatialReference,e=this.cameras.target.eye,f=!1;a=a.extent;var g=c.fromRenderCoords(e,d);a[0]<g.x&&(a[1]<g.y&&a[2]>g.x&&a[3]>g.y)&&(this._targetCameraChangedByElevationUpdate||
this._targetCameraBeforeElevationUpdate.copyFrom(this.cameras.target),f=this._applyTargetEyeElevationConstraint(e,this._getTerrainElevationBelowCamera(this.cameras.target)));f&&(this.targetChanged(),this._targetCameraChangedByElevationUpdate=!0);this._recomputeTargetCenterForElevationChange||(f=c.fromRenderCoords(this.cameras.target.center,d),d=Math.max(f.x,g.x),e=Math.min(f.x,g.x),c=Math.max(f.y,g.y),g=Math.min(f.y,g.y),d=b.intersectIntervals([[e,d]],[[a[0],a[2]]]),a=b.intersectIntervals([[g,c]],
[[a[1],a[3]]]),0<d.length&&0<a.length&&(this._recomputeTargetCenterForElevationChange=!0))}},_getTerrainElevationBelowCamera:function(a){if(!this.elevationProvider||!this.elevationProvider.spatialReference)this._terrainElevationBelowCamera=0;else if(null===this._terrainElevationBelowCamera||this._terrainElevationAtCameraEye!==a.eye){var b=this.renderCoordsHelper.fromRenderCoords(a.eye,this.elevationProvider.spatialReference);this._terrainElevationBelowCamera=this.elevationProvider.getElevation(b)||
0;this._terrainElevationAtCameraEye=a.eye}return this._terrainElevationBelowCamera},getCenterIntersectTerrain:function(b,c,d){d||(d=a.create());a.set(c,d);var e=this.picker.pickAlongRay(b,d);this.picker.pickedIntersectionPoint(e,d)||this.getCenterIntersectManifold(b,c,d)||this.getCenterIntersectTerrainFallback(b,c,d);return d},getCenterIntersectManifold:function(b,c,d){a.subtract(c,b,d);return this.intersectManifold(b,d,0,d)},getCameraIntersectTerrain:function(b,c,e,f){var g=this.cameras.current.copy();
b&&(g.eye=b);c&&(g.center=c);e&&(g.up=e);this.getCenterIntersectTerrain(g.eye,g.center,w);a.dist2(g.eye,w)<this.minPoiDist&&this.constraintsEnabled&&(b=this.constraints.collision.enabled,a.scale(g.computeDirection(d),this.minPoiDist),b?a.subtract(w,d,g.eye):a.add(g.eye,d,w),c=this.renderCoordsHelper,e=c.getAltitude(g.eye),b&&e<this.cameraElevationMargin&&(a.subtract(w,g.eye,d),c.setAltitude(this.cameraElevationMargin,g.eye),a.add(g.eye,d,w)),g.markViewDirty());0<f?(b=a.dist(g.eye,g.center),a.dist(w,
g.center)>b*f&&(g.center=w)):g.center=w;return g}});y.UPDATE_TARGET_BY_ELEVATION_UPDATES_DEFAULT=!0;y.Tilt=function(a){this.min=a.min;this.max=a.max};y.Tilt.scale=function(a,b){return 1===b?a:new y.Tilt({min:function(c){return a.min(c*b)},max:function(c){return a.max(c*b)}})};y.Tilt.prototype.apply=function(a,b){return k.clamp(a,this.min(b),this.max(b))};y.Altitude=function(a){this.min=a.min;this.max=a.max};y.Altitude.scale=function(a,b){return 1===b?a:new y.Altitude({min:function(c){return a.min(c)/
b},max:function(c){return a.max(c)/b}})};y.Altitude.prototype.apply=function(a,b){return k.clamp(b,this.min(a),this.max(a))};y.Collision=function(a){this.enabled=null!=a?a:!0};return y})},"esri/views/3d/navigation/spherical/AnimationSpherical":function(){define(["../mixins/AnimationMixin","../../lib/glMatrix","../../support/mathUtils"],function(s,q,n){function k(a,b){var c=b[0]-a[0],e=b[1]-a[1],f=b[2]-a[2],g=b[3]-a[3];return c*c+e*e+f*f+g*g}function h(a,b){return Math.sqrt(k(a,b))}function e(b){this.interpolate=
function(b,c,e){e=Math.min(9*e,0.3);n.slerpOrLerp(b.center,c.center,e,b.center,a);n.slerpOrLerp(b.eye,c.eye,e,b.eye,a);n.slerp(b.up,c.up,e);b.fov=n.lerp(b.fov,c.fov,e);b.padding=g.lerp(b.padding,c.padding,e,f);b.computeUpOnSphere()}}function c(c,e,d){e=e||250;d=d||e;var m=0,k=0,t=0,q=0,s=function(c,f,g,h){var m=b.dist(c,f);if(0.1>m)return b.set(f,c),0;var k=Math.min(Math.sqrt(m*d),e);h=Math.min(h+d*g,k);g=Math.min(h/m*g,1);n.slerpOrLerp(c,f,g,c,a);return h};this.interpolate=function(a,b,w){m=s(a.eye,
b.eye,w,m);k=s(a.center,b.center,w,k);q=s(a.padding,b.padding,w,q,{dist:h,lerp:function(a,b,c){return g.lerp(a,b,c,f)},set:function(b){a.padding=b}});t=c.easeInOutInterpLinear(d,e,a.fov,b.fov,w,t,{dist:function(a,b){return Math.abs(b-a)},lerp:n.lerp,set:function(b){a.fov=b}});a.computeUpOnSphere()}}var b=q.vec3d,g=q.vec4d,f=g.create(),a=1E-4;return s.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.AnimationSpherical",constructor:function(){this.interpolationTypes={linear:e,easeInOut:c}}})})},
"esri/views/3d/navigation/mixins/AnimationMixin":function(){define(["../../../../core/declare","dojo/on"],function(s,q){return s([],{declaredClass:"esri.views.3d.navigation.mixins.AnimationMixin",classMetadata:{properties:{interpolation:{setter:function(n){if("string"===typeof n){var k=this.interpolationTypes[n];return!k?(console.error("[AnimationMixin] Invalid interpolation type "+n),this.interpolation):new k(this)}return n}}}},getDefaults:function(){return{interpolation:"linear"}},easeInOutInterpLinear:function(n,
k,h,e,c,b,g){var f=g.dist(h,e);if(f<0.1/this.renderUnitInMeters)return g.set(e,h),0;k=Math.min(Math.sqrt(f*n),k);b=Math.min(b+n*c,k);n=Math.min(b/f*c,1);g.set(g.lerp(h,e,n),h);return b},step:function(n){this.inherited(arguments);this.currentHasReachedTarget()?this.pan.updateContinuous(n):(this.currentHasAlmostReachedTarget()||this.interpolation.interpolate(this.cameras.current,this.cameras.target,0.0010*n),this.currentHasAlmostReachedTarget()?this.setCurrentToTarget(!0):this.currentChanged())},animationStarted:function(){q.emit(this,
"animationStarted")},stop:function(){this.pan&&this.pan.continuous&&this.pan.continuous.stop();this.currentHasAlmostReachedTarget()?this.currentReachedTarget(!0):this.setCurrentToTarget()}})})},"esri/views/3d/navigation/spherical/actions/PanSpherical":function(){define("./ActionSpherical ../../mixins/PanMixin ../../../lib/glMatrix ../../../support/earthUtils ../../../support/mathUtils ../../../webgl-engine/lib/Util ../../ContinuousAction ../../NavigationConstants".split(" "),function(s,q,n,k,h,e,
c,b){var g=n.vec2d,f=n.vec3d,a=n.vec4d,r=n.mat4d,l=f.create(),d=f.create(),m=f.create(),p=f.create(),t=f.create(),x=f.create(),v=r.create(),u=b.Pan.Mode,z=b.Pan.Direction,w=b.Pan.Vertical,C=b.Pan.Momentum;return s.createSubclass([q],{declaredClass:"esri.views.3d.navigation.spherical.actions.PanSpherical",constructor:function(){this._lastPanActionPtr=this._panMode=0;this._lastPanActions=[];this._plane=a.create();this._isMomentumPanning=!1;this.continuous=new c;for(var b=0;b<C.BUFFER_SIZE;b++)this._lastPanActions[b]=
{point:f.create(),pointScreen:g.create(),time:0}},begin:function(a,b){this.inherited(arguments);this.pickPointInScreen(a,this._navPickPoint)?this._navSphereRadius=f.length(this._navPickPoint):(this._navSphereRadius=f.length(this.targetCamera.center),this._navSphereRadius<0.9*k.earthRadius&&(this._navSphereRadius=k.earthRadius),this.createPickRay(a,a,this.currentCamera.viewMatrix,l,d),f.subtract(d,this.currentCamera.eye),this.intersectManifold(this.currentCamera.eye,d,this._navSphereRadius-k.earthRadius,
this._navPickPoint)||this.closestPointOnSphereSilhouette(this.currentCamera.eye,l,this._navSphereRadius,this._navPickPoint));var c=!1;this.renderCoordsHelper.getAltitude(this.currentCamera.eye)<w.ELEVATION_THRESHOLD&&(this._navSphereRadius>f.length(this.currentCamera.eye)?c=!0:(f.normalize(f.subtract(this.targetCamera.eye,this._navPickPoint,m)),c=Math.abs(0.5*Math.PI-Math.acos(f.dot(this._navPickPoint,m)/f.length(this._navPickPoint)))<w.ANGLE_THRESHOLD));c?(this._panMode=u.VERTICAL,f.normalize(f.subtract(this.targetCamera.eye,
this.targetCamera.center,m)),this.updatePlane(this._navPickPoint,m)):(this._panMode=u.HORIZONTAL,this._addToLastPanActions(void 0===b?e.performance.now():b,this._navPickPoint,a));g.set(a,this._dragLastPoint);g.set(a,this._dragBeginPoint);this._mouseDownCamera.copyFrom(this.targetCamera)},update:function(a,b){if(this._panMode===u.HORIZONTAL){if(0>=this._navSphereRadius)return;this.createPickRay(a,this._dragBeginPoint,this._mouseDownCamera.viewMatrix,l,d);f.subtract(d,this._mouseDownCamera.eye);this.intersectManifold(this._mouseDownCamera.eye,
d,this._navSphereRadius-k.earthRadius,this._targetOnSphere)||this.closestPointOnSphereSilhouette(this._mouseDownCamera.eye,l,this._navSphereRadius,this._targetOnSphere);this.rotateCameraWithPointsOnSphere(this._navPickPoint,this._targetOnSphere,this._mouseDownCamera,this.targetCamera,this._navSphereRadius);this._addToLastPanActions(void 0===b?e.performance.now():b,this._targetOnSphere,a)}else{this.createPickRay(this._dragLastPoint,this._dragBeginPoint,this.currentCamera.viewMatrix,l,d);f.subtract(d,
l);if(!e.rayPlane(l,d,this._plane,p))return;this.createPickRay(a,this._dragBeginPoint,this.currentCamera.viewMatrix,l,d);f.subtract(d,l);if(!e.rayPlane(l,d,this._plane,t))return;f.subtract(t,p);f.subtract(this.targetCamera.eye,t);f.subtract(this.targetCamera.center,t);g.set(a,this._dragLastPoint)}this.constrainTargetEyeByElevationAndMoveLookAt();g.set(a,this._dragLastPoint);this.fixTargetUpVector();this.targetAndCurrentChanged();this.inherited(arguments)},end:function(a,b){this._panMode===u.HORIZONTAL&&
this._initiateMomentumPanning(a,b);this._navSphereRadius=0;this.inherited(arguments)},_initiateMomentumPanning:function(a,b){if(0<g.dist(this._dragLastPoint,a)&&0<this._navSphereRadius){this.update(a,b);var c=this._lastPanActionPtr;do if(c=(c-1+C.BUFFER_SIZE)%C.BUFFER_SIZE,this._lastPanActions[this._lastPanActionPtr].time-this._lastPanActions[c].time>1E3*C.INPUT_FILTER)break;while(this._lastPanActionPtr!==c);c++;c%=C.BUFFER_SIZE;c===this._lastPanActionPtr&&(c=(this._lastPanActionPtr-1+C.BUFFER_SIZE)%
C.BUFFER_SIZE);var d=0.0010*(this._lastPanActions[this._lastPanActionPtr].time-this._lastPanActions[c].time);if(0<d){var e=this.rotationFromPointsOnSphere(this._lastPanActions[c].point,this._lastPanActions[this._lastPanActionPtr].point,this._navSphereRadius,this.continuous.direction);this.continuous.velocity=e/d;var e=g.create(),f=g.create();this.normalizeCoordinate(this._lastPanActions[c].pointScreen,e);this.normalizeCoordinate(this._lastPanActions[this._lastPanActionPtr].pointScreen,f);c=Math.min(g.dist(e,
f)/d/C.DURATION_LONG_VEL,1);this.continuous.timer=C.DURATION_SHORT+c*(C.DURATION_LONG-C.DURATION_SHORT);this._isMomentumPanning=!0;this.animationStarted();return!0}this.currentReachedTarget()}else this.setPoiAuto(a,!0);return!1},beginContinuous:function(a){this.inherited(arguments);this.setCurrentToTarget();0===this.continuous.status&&f.set3(0,0,0,this.continuous.direction);if(!(this.continuous.status&a)){this.continuous.status|=a;if(a&(z.LEFT|z.RIGHT|z.FORWARD|z.BACKWARD))this._computePanAxis(a,
x),f.add(this.continuous.direction,x);else{var b=this.continuous.status&(z.UP|z.DOWN);this.continuous.radiusChange=b===z.UP?1:b===z.DOWN?-1:0}this.continuous.velocity=this._computePanVelocity()}this.continuous.timer=0},updateContinuous:function(a){if(this.continuous)if(this.continuous.active){a=this.continuous.step(a);var b=0.01<f.dot(this.continuous.direction,this.continuous.direction);if(0<Math.abs(this.continuous.radiusChange)){var c=1+a*this.continuous.radiusChange;f.scale(this.targetCamera.center,
c);f.scale(this.targetCamera.eye,c);this.continuous.velocity=this._computePanVelocity();b||(this.constrainTargetEyeByElevationAndMoveLookAt(),this.targetAndCurrentChanged(!0))}b&&(r.identity(v),r.rotate(v,a,this.continuous.direction),r.multiplyVec3(v,this.targetCamera.eye),r.multiplyVec3(v,this.targetCamera.center),r.multiplyVec3(v,this.targetCamera.up),this.constrainTargetEyeByElevationAndMoveLookAt(),this.fixTargetUpVector(),this.targetAndCurrentChanged())}else this._isMomentumPanning&&(this._isMomentumPanning=
!1,this.targetAndCurrentChanged(!0))},endContinuous:function(a){this.continuous.status&=~a;if(0===this.continuous.status)this.continuous.stop(),this.continuous.radiusChange=0;else if(a&(z.LEFT|z.RIGHT|z.FORWARD|z.BACKWARD))this._computePanAxis(a,x),f.subtract(this.continuous.direction,x),0.01>f.length(this.continuous.direction)&&f.set3(0,0,0,this.continuous.direction);else{var b=this.continuous.status&(z.UP|z.DOWN);this.continuous.radiusChange=b==z.UP?1:b==z.DOWN?-1:0}this.inherited(arguments)},_computePanAxis:function(a,
b){f.subtract(this.targetCamera.center,this.targetCamera.eye,b);f.cross(b,this.targetCamera.up);if(a===z.LEFT||a===z.RIGHT)f.normalize(b),f.cross(b,this.targetCamera.center);(a===z.RIGHT||a===z.FORWARD)&&f.negate(b);f.normalize(b)},_computePanVelocity:function(){var a=0.5*Math.abs(f.length(this.targetCamera.eye)-k.earthRadius),a=h.clamp(a,1,2*k.earthRadius);return h.acos(1-a*a/(2*k.earthRadius*k.earthRadius))},_addToLastPanActions:function(a,b,c){this._lastPanActionPtr=(this._lastPanActionPtr+1)%
5;this._lastPanActions[this._lastPanActionPtr].time=a;f.set(b,this._lastPanActions[this._lastPanActionPtr].point);g.set(c,this._lastPanActions[this._lastPanActionPtr].pointScreen)},updatePlane:function(b,c){a.set4(c[0],c[1],c[2],-f.dot(c,b),this._plane)}})})},"esri/views/3d/navigation/spherical/actions/ActionSpherical":function(){define(["../../Action","../../../support/mathUtils","../../../lib/glMatrix"],function(s,q,n){var k=n.vec3d,h=n.mat4d,e=k.create(),c=h.create();return s.createSubclass({declaredClass:"esri.views.3d.navigation.spherical.actions.ActionSpherical",
constructor:function(){this._targetOnSphere=k.create();this._navSphereRadius=0},closestPointOnSphereSilhouette:function(b,g,f,a){k.cross(b,g,e);k.cross(e,b,a);k.scale(a,1/k.length(a)*f);b=-q.asin(f/k.length(b));h.identity(c);h.rotate(c,b,e);h.multiplyVec3(c,a)},rotateCameraWithPointsOnSphere:function(b,c,e,a,h){return this.navigation.rotateCameraWithPointsOnSphere(b,c,e,a,h)},rotationFromPointsOnSphere:function(b,c,e,a){return this.navigation.rotationFromPointsOnSphere(b,c,e,a)}})})},"esri/views/3d/navigation/Action":function(){define(["../../../core/Accessoire",
"../../../core/Evented","../webgl-engine/lib/Camera","../lib/glMatrix","dojo/on"],function(s,q,n,k,h){var e=k.vec3d,c=k.vec2d;return s.createSubclass([q],{classMetadata:{properties:{type:{},picker:{getter:function(){return this.navigation.picker},readOnly:!0},currentCamera:{getter:function(){return this.navigation.currentCamera}},targetCamera:{getter:function(){return this.navigation.targetCamera}},constraints:{getter:function(){return this.navigation.constraints},readOnly:!0},renderCoordsHelper:{getter:function(){return this.navigation.renderCoordsHelper},
readOnly:!0},minPoiDist:{getter:function(){return this.navigation.minPoiDist},readOnly:!0}}},constructor:function(b){this._tmpEvent={type:null,phase:null,x:void 0,y:void 0};this._mouseDownCamera=new n;this._navPickPoint=e.create();this._dragLastPoint=c.create();this._dragBeginPoint=c.create();this.navigation=b;var g=this;["minPoiDist","renderCoordsHelper","constraints","picker"].forEach(function(c){b.watch(c,function(){g.notifyChange(c)})});this.active=!1},emit:function(b,c,e){this._tmpEvent.type=
this.type;this._tmpEvent.phase=b;this._tmpEvent.x=c;this._tmpEvent.y=e;h.emit(this,b,this._tmpEvent);h.emit(this.navigation,this.type,this._tmpEvent)},intersectManifold:function(b,c,e,a){return this.navigation.intersectManifold(b,c,e,a)},fixTargetUpVector:function(){return this.navigation.fixTargetUpVector()},setPoiAuto:function(b,c){return this.navigation.setPoiAuto(b,c)},normalizeCoordinate:function(b,c){c[0]=b[0]/this.currentCamera.width;c[1]=b[1]/this.currentCamera.height},worldUpAtPosition:function(b,
c){return this.renderCoordsHelper.worldUpAtPosition(b,c)},applyConstraints:function(b,c){return this.navigation.applyConstraints(b,c)},constrainTargetEyeByElevation:function(b){return this.navigation.constrainTargetEyeByElevation(b)},constrainTargetEyeByElevationAndMoveLookAt:function(){return this.navigation.constrainTargetEyeByElevationAndMoveLookAt()},targetAndCurrentChanged:function(b){return this.navigation.targetAndCurrentChanged(b)},targetAnimatedChanged:function(b){return this.navigation.targetAnimatedChanged(b)},
currentReachedTarget:function(b){return this.navigation.currentReachedTarget(b)},setCurrentToTarget:function(){return this.navigation.setCurrentToTarget()},animationStarted:function(){return this.navigation.animationStarted()},limitAltitude:function(b,c,e,a){return this.navigation.limitAltitude(b,c,e,a)},limitTiltByConstraints:function(b,c,e,a){return this.navigation.limitTiltByConstraints(b,c,e,a)},createPickRay:function(b,c,e,a,h){return this.picker.createPickRay(b,c,e,a,h)},pickAlongRay:function(b,
c,e,a,h,l){return this.picker.pickAlongRay(b,c,e,a,h,l)},pickPointInScreen:function(b,c){return this.picker.pickPointInScreen(b,c)},pickFreePointInScreen:function(b,c){return this.picker.pickFreePointInScreen(b,c)},pickInScreen:function(b){return this.picker.pickInScreen(b)}})})},"esri/views/3d/navigation/mixins/PanMixin":function(){define(["../../../../core/declare"],function(s){return s([],{declaredClass:"esri.views.3d.navigation.mixins.PanMixin",type:"pan",begin:function(q){this.navigation.begin(this);
this.active=!0;this.emit("begin")},update:function(q){this.emit("update")},end:function(q){this.active=!1;this.emit("end");this.navigation.end(this)},beginContinuous:function(q){this.navigation.begin(this);this.active=!0;this.emit("begin")},updateContinuous:function(q){this.continuous&&this.continuous.active&&this.emit("update")},endContinuous:function(q){this.active=!1;this.emit("end");this.navigation.end(this)}})})},"esri/views/3d/navigation/ContinuousAction":function(){define(["../../../core/Accessoire",
"../lib/glMatrix"],function(s,q){var n=q.vec3d;return s.createSubclass({classMetadata:{properties:{active:{getter:function(){return 0!==this.velocity},dependsOn:["velocity"],readOnly:!0}}},constructor:function(){this.direction=n.create();this.status=this.timer=this.velocity=0},stop:function(){this.status=this.velocity=this.timer=0;n.set3(0,0,0,this.direction)},step:function(k){var h;k*=0.0010;0<this.timer?(k=Math.min(k,this.timer),h=this.velocity*k*(1-k/(2*this.timer)),this.velocity*=1-k/this.timer,
this.timer-=k):h=this.velocity*k;return h}})})},"esri/views/3d/navigation/NavigationConstants":function(){define([],function(){return{Pan:{Direction:{LEFT:1,RIGHT:2,FORWARD:4,BACKWARD:8,UP:16,DOWN:32},Mode:{HORIZONTAL:0,VERTICAL:1},Momentum:{DURATION_SHORT:1,DURATION_LONG:3,DURATION_LONG_VEL:8,INPUT_FILTER:0.2,BUFFER_SIZE:5},Vertical:{ELEVATION_THRESHOLD:3E4,ANGLE_THRESHOLD:8/180*Math.PI}},Rotate:{PivotPoint:{POI:1,EYE:2}}}})},"esri/views/3d/navigation/spherical/actions/ZoomSpherical":function(){define(["./ActionSpherical",
"../../mixins/ZoomMixin","../../../lib/glMatrix","../../../support/earthUtils"],function(s,q,n,k){var h=n.vec2d,e=n.vec3d,c=n.mat4d,b=e.create(),g=e.create(),f=e.create(),a=c.create(),r=e.create(),l=e.create();return s.createSubclass([q],{declaredClass:"esri.views.3d.navigation.spherical.actions.ZoomSpherical",constructor:function(){},begin:function(a){this.inherited(arguments);this.pickPointInScreen(a,this._navPickPoint)?this._navSphereRadius=e.length(this._navPickPoint):(this._navSphereRadius=e.length(this.targetCamera.center),
this._navSphereRadius<0.9*k.earthRadius&&(this._navSphereRadius=k.earthRadius),this.createPickRay(a,a,this.currentCamera.viewMatrix,b,g),e.subtract(g,this.currentCamera.eye),this.intersectManifold(this.currentCamera.eye,g,this._navSphereRadius-k.earthUtils,this._navPickPoint)||(this._navSphereRadius=0));this._mouseDownCamera.copyFrom(this.targetCamera)},update:function(d){var m=this.targetCamera;m.copyFrom(this._mouseDownCamera);e.subtract(m.center,m.eye,f);var l=e.length(f);this.normalizeCoordinate(d,
b);var n=12*(b[1]-this.normalizedAnchorPoint[1]);d=l*Math.pow(2,n);0>n&&d<this.navigation.minPoiDist&&(d=this.navigation.minPoiDist);d=this.limitAltitude(d,m.center,f,l,0>n?-1:1);1E-6>Math.abs(l-d)||(0<this._navSphereRadius&&d<l&&(n=1-(1-d/l)*(1-this._navSphereRadius/e.length(m.center)),e.scale(m.center,n)),e.scale(f,-d/l),e.add(m.center,f,m.eye),l=!1,0<this._navSphereRadius&&(c.lookAt(m.eye,m.center,m.up,a),this.createPickRay(this._dragBeginPoint,this._dragBeginPoint,a,b,g),e.normalize(e.subtract(g,
m.eye)),this.intersectManifold(m.eye,g,this._navSphereRadius-k.earthRadius,this._targetOnSphere)||(this.closestPointOnSphereSilhouette(m.eye,b,this._navSphereRadius,this._targetOnSphere),l=!0),this.rotateCameraWithPointsOnSphere(this._navPickPoint,this._targetOnSphere,m,m,this._navSphereRadius),this.fixTargetUpVector()),this.applyConstraints(m),this.constrainTargetEyeByElevation(),this.targetAndCurrentChanged(),h.set(this._dragBeginPoint,this._dragLastPoint),l&&(c.lookAt(m.eye,m.center,m.up,a),this._dragLastPoint=
this.currentCamera.projectPoint(this._navPickPoint,a)),m=this._toYDownCoord(this._dragLastPoint),this.emit("update",m[0],m[1]))},stepAtPoint:function(d,f,h,n){e.set(f,l);f=e.length(l);e.subtract(this.targetCamera.eye,this.targetCamera.center,r);var q=e.length(r),s=q*d,s=(d=1>=d)&&s<this.minPoiDist?this.minPoiDist:this.limitAltitude(s,l,r,-q,d?-1:1);d=s/q;1E-6>Math.abs(q-s)||(n&&(q=e.length(this.targetCamera.center),e.scale(this.targetCamera.center,(f+d*(q-f))/q)),e.scale(r,d),e.add(this.targetCamera.center,
r,this.targetCamera.eye),n&&h&&(c.lookAt(this.targetCamera.eye,this.targetCamera.center,this.targetCamera.up,a),this.createPickRay(h,h,a,b,g),e.normalize(e.subtract(g,this.targetCamera.eye)),f<e.length(this.targetCamera.eye)&&this.intersectManifold(this.targetCamera.eye,g,f-k.earthRadius,this._targetOnSphere)?this.rotateCameraWithPointsOnSphere(l,this._targetOnSphere,this.targetCamera,this.targetCamera,f):n=!1),this.applyConstraints(this.targetCamera),this.constrainTargetEyeByElevation(),n&&this.fixTargetUpVector(),
this.navigation.currentHasAlmostReachedTarget()?this.targetAndCurrentChanged():this.targetAnimatedChanged())}})})},"esri/views/3d/navigation/mixins/ZoomMixin":function(){define(["../../../../core/declare","../../lib/glMatrix"],function(s,q){var n=q.vec2d,k=q.vec3d,h=k.create();return s([],{declaredClass:"esri.views.3d.navigation.mixins.ZoomMixin",type:"zoom",constructor:function(){this.normalizedAnchorPoint=n.create()},begin:function(e){this.navigation.begin(this);n.set(e,this._dragBeginPoint);this.normalizeCoordinate(e,
this.normalizedAnchorPoint);e=this._toYDownCoord(this._dragBeginPoint);this.active=!0;this.emit("begin",e[0],e[1])},update:function(e){},end:function(e){this.active=!1;e=this._toYDownCoord(this._dragBeginPoint);this.emit("end",e[0],e[1]);this.navigation.end(this)},stepScreen:function(e,c){this.active||(k.set(this.currentCamera.center,h),0<e&&!this.pickPointInScreen(c,h)&&"local"===this.navigation.view.viewingMode&&this.pickFreePointInScreen(c,h),this.step(Math.pow(0.6,e),h,c))},step:function(e,c,
b){if(!this.active){this.navigation.begin(this);this.targetCamera.copyFrom(this.currentCamera);var g=1E-6<k.dist(c,this.targetCamera.center);this.stepAtPoint(e,c,b,g);this.navigation.end(this)}},stepAtPoint:function(e,c,b,g){},_toYDownCoord:function(e){return[e[0],this.currentCamera.height-e[1]]}})})},"esri/views/3d/navigation/spherical/actions/RotateSpherical":function(){define(["./ActionSpherical","../../mixins/RotateMixin"],function(s,q){return s.createSubclass([q],{declaredClass:"esri.views.3d.navigation.spherical.actions.RotateSpherical"})})},
"esri/views/3d/navigation/mixins/RotateMixin":function(){define(["../../../../core/declare","../../lib/glMatrix","../../support/mathUtils","../NavigationConstants"],function(s,q,n,k){var h=q.vec2d,e=q.vec3d,c=q.mat4d,b=e.create(),g=e.create(),f=h.create(),a=c.create(),r=e.create(),l=[3,1.5],d=k.Rotate.PivotPoint;return s([],{declaredClass:"esri.views.3d.navigation.mixins.RotateMixin",type:"rotate",constructor:function(){this._rotLastPoint=h.create()},begin:function(a,b){this.navigation.begin(this);
this.active=!0;this.emit("begin");this.setPoiAuto(a);this.normalizeCoordinate(a,this._rotLastPoint)},update:function(a,b){void 0===b&&(b=d.POI);var c,e;switch(b){case d.EYE:c=this.targetCamera.center;e=this.targetCamera.eye;break;default:c=this.targetCamera.eye,e=this.targetCamera.center,b!==d.POI&&console.error("[RotateMixin.update]: invalid pivot specified")}this._applyRotation(a,b,c,e);this.constrainTargetEyeByElevation();this.fixTargetUpVector();this.targetAndCurrentChanged();this.emit("update")},
_applyRotation:function(m,k,q,s){this.renderCoordsHelper.worldUpAtPosition(s,b);this.normalizeCoordinate(m,f);m=(f[1]-this._rotLastPoint[1])*l[k-1];var v=(f[0]-this._rotLastPoint[0])*l[k-1];e.subtract(q,s,g);var u=e.length(g),z=n.acos(e.dot(g,b)/u);k===d.POI?m=this.limitTiltByConstraints(z+m,s,u)-z:(z=0.5*Math.PI-z,u=0.495*Math.PI,m=z-Math.max(-u,Math.min(u,z+-0.5*m)));c.identity(a);e.cross(this.targetCamera.up,g,r);k==d.POI&&(v=-v);c.rotate(a,v,b);c.rotate(a,m,r);c.multiplyVec3(a,g);e.add(s,g,q);
c.multiplyVec3(a,this.targetCamera.up);h.set(f,this._rotLastPoint)},end:function(a){this.active=!1;this.emit("end");this.navigation.end(this)}})})},"esri/views/3d/navigation/planar/NavigationPlanar":function(){define("../Navigation ./ConstraintsPlanar ./AnimationPlanar ./actions/PanPlanar ./actions/RotatePlanar ./actions/ZoomPlanar ../../lib/glMatrix".split(" "),function(s,q,n,k,h,e,c){var b=c.vec3d,g=b.create(),f=b.create(),a=b.create(),r=b.create();return s.createSubclass([q,n],{declaredClass:"esri.views.3d.navigation.planar.NavigationPlanar",
initialize:function(){this.pan=new k(this);this.zoom=new e(this);this.rotate=new h(this)},fixTargetUpVector:function(){var a=this.renderCoordsHelper.worldUp,c=this.cameras.target;b.direction(c.center,c.eye,r);var e=b.dot(r,a);0.9999<Math.abs(e)||(b.scale(r,e,r),b.subtract(a,r,c.up),b.normalize(c.up))},setPoiAuto:function(c,d){var e=this.picker.pickAlongRay(this.cameras.target.eye,this.cameras.target.center,null,c);if(e.getMinResult().getIntersectionPoint(g)&&e.getMaxResult().getIntersectionPoint(f)){var h=
5/this.renderUnitInMeters,k=e.getMinResult().dist-h,h=e.getMaxResult().dist+h,n=b.dist(this.cameras.target.eye,this.cameras.target.center);if(n<=k||n>=h){if(e.getMinResult().object){e.getMaxResult().dist=void 0;e.intersectObject(e.getMinResult().object);if(void 0===e.getMaxResult().dist){console.error("[NavigationPlanar.setPoiAuto] Did not obtain maximum intersection distance");return}e.getMaxResult().getIntersectionPoint(f);b.lerp(g,f,0.5,a)}else b.set(g,a);this.setCameraFromEyeAndCenter(this.cameras.target.eye,
a,{animate:!1})}}}})})},"esri/views/3d/navigation/planar/ConstraintsPlanar":function(){define("../mixins/ConstraintsMixin ../../support/mathUtils ../../support/earthUtils ../../support/RenderCoordsHelper ../../constraints/SceneViewTiltConstraint ../../lib/glMatrix ../../webgl-engine/lib/Util ../../../../geometry/support/scaleUtils".split(" "),function(s,q,n,k,h,e,c,b){var g=e.vec3d,f=e.vec4d,a=f.create(),r=g.create(),l=g.create();return s.createSubclass({declaredClass:"esri.views.3d.navigation.planar.ConstraintsPlanar",
defaultConstraints:{tilt:new s.Tilt({min:function(){return q.deg2rad(h.MAX_DEFAULT)},max:q.makePiecewiseLinearFunction([[4E3,q.deg2rad(h.MIN_DEFAULT)],[1E4,q.deg2rad(88)],[6E6,q.deg2rad(88)]])}),altitude:new s.Altitude({min:function(a){return a._autoAltitudeConstraints.min},max:function(a){return a._autoAltitudeConstraints.max}}),collision:new s.Collision},_updateAutoAltitudeConstraints:function(a){var c=Math.max(a.xmax-a.xmin,a.ymax-a.ymin);a=b.getUnitValueForSR(a.spatialReference);this._autoAltitudeConstraints.max=
3*c/Math.atan((this._targetCameraBeforeElevationUpdate||this.targetCamera)._fov/2);this._autoAltitudeConstraints.min=-this._autoAltitudeConstraints.max;this._autoAltitudeConstraints.min*=a;this._autoAltitudeConstraints.max*=a},limitAltitude:function(a,b,c,e){return this.constraints.altitude.apply(this,a)},limitTiltByAltitudeConstraints:function(a,b,c,e){return a},distanceToSilhouette:function(a,b,c,e,f){f||(f={maxFarNearRatio:0,distance:0});f.maxFarNearRatio=this.maxFarNearRatio;var h=k.Planar.prototype.getAltitude(a.eye),
s=h*=c;e=h-e;var z=this.elevationProvider?this.elevationProvider.getElevationBounds():null;z&&(h=0<=e?s-c*z[0]:c*z[1]-s);s=Math.max(b.xmax-b.xmin,b.ymax-b.ymin,b.zmax-b.zmin);g.subtract(a.center,a.eye,l);r[0]=0<l[0]?b.xmax:b.xmin;r[1]=0<l[1]?b.ymax:b.ymin;r[2]=0<l[2]?b.zmax:b.zmin;g.subtract(r,a.eye);g.normalize(l);a=g.dot(r,l);a=1.1*a*c;z=h+n.earthRadius;z=Math.sqrt(z*z-n.earthRadius*n.earthRadius);b=Math.max(b.xmax-b.xmin,b.ymax-b.ymin);var w=1E-4*b*c;c=q.clamp((h-w)/(0.0010*b*c-w),0,1);f.distance=
q.lerp(z,a,c*c*c);f.maxFarNearRatio=q.clamp(2E6-2E6*((Math.log(Math.abs(e))-9.55)/(11.27-9.55)),2E4,2E6);f.distance*=Math.max(100*Math.log(Math.abs(e)),1);f.distance=Math.min(f.distance,Math.max(34064E4,s));return f},intersectManifold:function(b,e,h,l){var k=this.renderCoordsHelper.worldUp;f.set4(k[0],k[1],k[2],h,a);return!c.rayPlane(b,e,a,l)||0>g.dot(g.subtract(l,b,r),e)?!1:!0},getCenterIntersectTerrainFallback:function(a,b,c){g.set(b,c)}})})},"esri/views/3d/navigation/planar/AnimationPlanar":function(){define(["../mixins/AnimationMixin",
"../../lib/glMatrix","../../support/mathUtils"],function(s,q,n){function k(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f}function h(a,b){return Math.sqrt(k(a,b))}function e(a){this.interpolate=function(a,c,d){d=Math.min(5*d,0.3);b.lerp(a.eye,c.eye,d);b.lerp(a.center,c.center,d);b.lerp(a.up,c.up,d);a.fov=n.lerp(a.fov,c.fov,d);a.padding=g.lerp(a.padding,c.padding,d,f)}}function c(a,c,e){c=c||250;e=e||c;var d=0,m=0,k=0,q=0,s=0;this.interpolate=function(v,u,z){d=a.easeInOutInterpLinear(e,
c,v.eye,u.eye,z,d,b);m=a.easeInOutInterpLinear(e,c,v.center,u.center,z,m,b);k=a.easeInOutInterpLinear(e,c,v.up,u.up,z,k,b);s=a.easeInOutInterpLinear(e,c,v.padding,u.padding,z,s,{dist:h,lerp:function(a,b,c){return g.lerp(a,b,c,f)},set:function(a){v.padding=a}});q=a.easeInOutInterpLinear(e,c,v.fov,u.fov,z,q,{dist:function(a,b){return Math.abs(b-a)},lerp:n.lerp,set:function(a){v.fov=a}})}}var b=q.vec3d,g=q.vec4d,f=g.create();return s.createSubclass({declaredClass:"esri.views.3d.navigation.planar.AnimationPlanar",
constructor:function(){this.interpolationTypes={linear:e,easeInOut:c}}})})},"esri/views/3d/navigation/planar/actions/PanPlanar":function(){define(["./ActionPlanar","../../mixins/PanMixin","../../../lib/glMatrix","../../../webgl-engine/lib/Util"],function(s,q,n,k){var h=n.vec2d,e=n.vec3d,c=e.create(),b=e.create(),g=e.create(),f=e.create(),a=e.create(),r=e.create(),l=Math.PI/9,d=e.create(),m=e.create();return s.createSubclass([q],{declaredClass:"esri.views.3d.navigation.planar.actions.PanPlanar",begin:function(a){this.inherited(arguments);
this.pickPointInScreen(a,c)||this.pickFreePointInScreen(a,c);e.normalize(e.subtract(this.targetCamera.eye,this.targetCamera.center,b));this.renderCoordsHelper.worldUpAtPosition(a,r);var d=e.dot(b,r);0>d&&(e.negate(b),d=-d);var f=Math.asin(d);f>=l?e.set(r,b):(e.subtract(b,e.scale(r,d,g)),e.normalize(b),f>l&&(e.lerp(b,r,(f-l)/(l-l)),e.normalize(b)));this.updatePlane(c,b);h.set(a,this._dragLastPoint);h.set(a,this._dragBeginPoint)},update:function(a){this._intersectPanPlane(this._dragLastPoint,this._dragBeginPoint,
d)&&this._intersectPanPlane(a,this._dragBeginPoint,m)&&(e.subtract(m,d),e.subtract(this.targetCamera.eye,m),e.subtract(this.targetCamera.center,m),h.set(a,this._dragLastPoint),this.constrainTargetEyeByElevationAndMoveLookAt(),this.targetAndCurrentChanged())},_intersectPanPlane:function(b,c,d){this.createPickRay(b,c,this.currentCamera.viewMatrix,f,a);e.subtract(a,f);return k.rayPlane(f,a,this._plane,d)},end:function(a){this.setPoiAuto(a,!0);this._navSphereRadius=0;this.inherited(arguments)}})})},"esri/views/3d/navigation/planar/actions/ActionPlanar":function(){define(["../../Action",
"../../../lib/glMatrix"],function(s,q){var n=q.vec3d,k=q.vec4d;return s.createSubclass({declaredClass:"esri.views.3d.navigation.planar.actions.ActionPlanar",constructor:function(){this._plane=k.create()},updatePlane:function(h,e){k.set4(e[0],e[1],e[2],-n.dot(e,h),this._plane)}})})},"esri/views/3d/navigation/planar/actions/RotatePlanar":function(){define(["./ActionPlanar","../../mixins/RotateMixin"],function(s,q){return s.createSubclass([q],{declaredClass:"esri.views.3d.navigation.planar.actions.RotatePlanar"})})},
"esri/views/3d/navigation/planar/actions/ZoomPlanar":function(){define(["./ActionPlanar","../../mixins/ZoomMixin","../../../lib/glMatrix","../../../webgl-engine/lib/Util"],function(s,q,n,k){var h=n.vec2d,e=n.vec3d,c=e.create(),b=e.create(),g=e.create(),f=e.create(),a=e.create(),r=e.create();return s.createSubclass([q],{declaredClass:"esri.views.3d.navigation.planar.actions.ZoomPlanar",begin:function(b){this.inherited(arguments);this.pickPointInScreen(b,a)||this.pickFreePointInScreen(b,a);e.normalize(e.subtract(this.targetCamera.eye,
this.targetCamera.center,f));0>f[1]&&e.negate(f);this.updatePlane(a,f)},update:function(a){e.set(this.targetCamera.center,r);this.createPickRay(this._dragBeginPoint,this._dragBeginPoint,this.currentCamera.viewMatrix,c,b);e.subtract(b,c);k.rayPlane(c,b,this._plane,r);this.normalizeCoordinate(a,c);a=4*(this.normalizedAnchorPoint[1]-c[1]);h.set(c,this.normalizedAnchorPoint);this._applyZoom(r,a);a=this._toYDownCoord(this._dragLastPoint);this.emit("update",a[0],a[1])},_applyZoom:function(a,b){e.subtract(a,
this.targetCamera.eye,g);var c=e.length(g),f=c*(1-b);0<=b&&f<this.minPoiDist&&(f=this.minPoiDist);f=this.limitAltitude(f,a,g,c,0<=b?-1:1);1E-6>Math.abs(c-f)||(e.scale(g,b),e.add(this.targetCamera.eye,g),e.lerp(this.targetCamera.center,a,b),this.fixTargetUpVector(),this.targetAndCurrentChanged())},stepAtPoint:function(a,b,c,f){e.set(b,r);e.subtract(r,this.targetCamera.eye,g);b=e.length(g);c=b*a;if((a=1>=a)&&c<this.minPoiDist)c=this.minPoiDist;c=this.limitAltitude(c,r,g,b,a?-1:1);a=c/b;1E-6<=Math.abs(b-
c)&&(e.scale(g,c/b),e.subtract(r,g,this.targetCamera.eye),e.lerp(this.targetCamera.center,r,1-a),this.constrainTargetEyeByElevation(),this.fixTargetUpVector(),this.targetAnimatedChanged())}})})},"esri/views/3d/navigation/EventController":function(){define("dojo/_base/array dojo/sniff ../lib/glMatrix ../../../core/watchUtils ../webgl-engine/lib/Util ./NavigationConstants".split(" "),function(s,q,n,k,h,e){var c=function(b,g){function f(a){if(!N||a.isPrimary)if(a.preventDefault(),0!==Y&&!(void 0===a.originalTouchEvent&&
void 0!==typeof a.movementX&&void 0!==typeof a.movementY&&0===a.movementX&&0===a.movementY)){var b=x(a,T),c=Y-1;switch(E){case 1:v("mouseDragLeft",b,c);break;case 2:v("mouseDragMiddle",b,c);break;case 3:case 0:v("mouseDragRight",b,c)}1===Y&&!(0===Math.abs(b[0]-W[0])&&0===Math.abs(b[1]-W[1]))?Y=2:3===Y&&(R&&window.clearTimeout(R),E=Y=0,Z(a))}}function a(a){if(!N||a.isPrimary)a.preventDefault(),I.focus(),W=x(a),R&&window.clearTimeout(R),L.stop(),Y=1,E=a.which,1===E&&(0<ba?(v("mouseClickDouble",x(a,
T),2),ba=0):ba=Date.now()),N?(I.setPointerCapture(a.pointerId),I.addEventListener(O.move,f,!0),I.addEventListener(O.up,r,!0)):(document.addEventListener(O.move,f,!0),document.addEventListener(O.up,r,!0))}function r(a){if(!N||a.isPrimary){a.preventDefault();var b=x(a,T);1===Y&&1===E?0<ba&&setTimeout(function(){0<ba&&(v("mouseClick",x(a,T)),ba=0)},Math.max(u-(Date.now()-ba),0)):ba=0;2===Y?(Y=3,R=setTimeout(function(){if(3===Y)switch(E){case 1:v("mouseDragLeft",b,2);break;case 2:v("mouseDragMiddle",
b,2);break;case 3:case 0:v("mouseDragRight",b,2)}Z(a);E=Y=0},z)):(Z(a),E=Y=0)}}function l(a){a.preventDefault();var b=a.deltaY;switch(a.deltaMode){case 0:if(F||H)b=600*(b/document.documentElement.clientHeight);break;case 1:b*=30;break;case 2:b*=900}0!==b&&v("mouseWheel",b,x(a,J))}function d(a){a.stopPropagation();var b=a.changedTouches[0],c="";if(!(1<a.touches.length)){var d;switch(a.type){case "touchstart":c="mousedown";break;case "touchmove":c="mousemove";break;case "touchend":c="mouseup";d=document.createEvent("MouseEvent");
d.initMouseEvent("click",!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(d);a.preventDefault();break;default:return}d=document.createEvent("MouseEvent");d.initMouseEvent(c,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);d.originalTouchEvent=a;b.target.dispatchEvent(d);a.preventDefault()}}function m(a){a.preventDefault()}function p(a){if(!a.shiftKey&&!a.ctrlKey&&!a.altKey&&!a.metaKey){var b=w[a.keyCode];void 0!==b&&(Q[b](),
a.preventDefault())}}function t(a){var b=w[a.keyCode];void 0!==b&&(b=U[b],void 0!==b&&b(),a.preventDefault())}function x(a,b){b||(b=A.create());var c=I.getBoundingClientRect();b[0]=a.clientX-Math.round(c.left);b[1]=Math.round(c.height)-(a.clientY-Math.round(c.top));return b}function v(a,b,c){a=g[a];if(void 0!==a)S[a](b,c)}var u=200,z=100,w={37:"panLeft",38:"panForward",39:"panRight",40:"panBackward",66:"lookAround",74:"panDown",78:"lookNorth",80:"lookDown",85:"panUp"},C,A=n.vec2d,y=h.assert,B={down:"mousedown",
move:"mousemove",up:"mouseup"},D={down:"pointerdown",move:"pointermove",up:"pointerup"},F=q("trident"),H=parseFloat(navigator.appVersion.split("Edge/")[1])||void 0,N=!!window.PointerEvent&&(F||H),G=!N,O=N?D:B,M=["touchmove","touchstart","touchend","touchcancel"],I=null,Z=function(a){N?(I.releasePointerCapture(a.pointerId),I.removeEventListener(O.move,f,!0),I.removeEventListener(O.up,r,!0)):(document.removeEventListener(O.move,f,!0),document.removeEventListener(O.up,r,!0))};this.connect=function(){if(I=
b.get("canvas"))I.style.touchAction="none",G&&s.forEach(M,function(a){I.addEventListener(a,d,!0)}),I.addEventListener(O.down,a,!1),I.addEventListener("wheel",l,!1),I.addEventListener("contextmenu",m,!1),I.setAttribute("tabindex","1"),I.addEventListener("keydown",p,!1),I.addEventListener("keyup",t,!1)};this.disconnect=function(){I&&(G&&s.forEach(M,function(a){I.removeEventListener(a,d,!0)}),I.removeEventListener(O.down,a,!1),I.removeEventListener("wheel",l,!1),I.removeEventListener("contextmenu",m,
!1),I.removeEventListener("keydown",p,!1),I.removeEventListener("keyup",t,!1),I=null)};var V=k.init(b,"canvas",function(){this.disconnect();this.connect()}.bind(this)),L=b.navigation;this.destroy=function(){this.disconnect();V.remove()};this.setControls=function(a){C?C=a:g=a};this.getControls=function(){return g};var Y=0,E=0,ba=0,W=null,R,T=A.create(),J=A.create(),S={select:function(a){b.get("ready")&&b._stage.select(a)},clickStep:function(a,c){b.get("ready")&&L.zoom.stepScreen(Math.log(0.5)/Math.log(0.6),
a)},pan:function(a,b){switch(b){case 0:L.pan.begin(a);break;case 1:L.pan.update(a);break;case 2:L.pan.end(a);break;default:y(!1)}},tumble:function(a,b){switch(b){case 0:L.rotate.begin(a,e.Rotate.PivotPoint.POI);break;case 1:L.rotate.update(a,e.Rotate.PivotPoint.POI);break;case 2:L.rotate.end(a);break;default:y(!1)}},zoom:function(a,b){switch(b){case 0:L.zoom.begin(a);break;case 1:L.zoom.update(a);break;case 2:L.zoom.end(a);break;default:y(!1)}},zoomStep:function(a,b){L.zoom.stepScreen(-a/60,b)},lookAround:function(a,
b){switch(b){case 0:L.rotate.begin(a,e.Rotate.PivotPoint.EYE);break;case 1:L.rotate.update(a,e.Rotate.PivotPoint.EYE);break;case 2:L.rotate.end(a);break;default:y(!1)}}},K=e.Pan.Direction,Q={panLeft:function(){L.pan.beginContinuous(K.LEFT)},panRight:function(){L.pan.beginContinuous(K.RIGHT)},panForward:function(){L.pan.beginContinuous(K.FORWARD)},panBackward:function(){L.pan.beginContinuous(K.BACKWARD)},panUp:function(){L.pan.beginContinuous(K.UP)},panDown:function(){L.pan.beginContinuous(K.DOWN)},
lookAround:function(){C||(C=g,g=c.LOOK_AROUND)},lookNorth:function(){b.goTo({heading:0})},lookDown:function(){b.goTo({tilt:0})}},U={panLeft:function(){L.pan.endContinuous(K.LEFT)},panRight:function(){L.pan.endContinuous(K.RIGHT)},panForward:function(){L.pan.endContinuous(K.FORWARD)},panBackward:function(){L.pan.endContinuous(K.BACKWARD)},panUp:function(){L.pan.endContinuous(K.UP)},panDown:function(){L.pan.endContinuous(K.DOWN)},lookAround:function(){C&&(g=C,C=void 0)}}};c.PAN={mouseClick:"select",
mouseClickDouble:"clickStep",mouseDragLeft:"pan",mouseDragRight:"tumble",mouseDragMiddle:"zoom",mouseWheel:"zoomStep"};c.TUMBLE={mouseClick:"select",mouseClickDouble:"clickStep",mouseDragLeft:"tumble",mouseDragRight:"pan",mouseDragMiddle:"zoom",mouseWheel:"zoomStep"};c.LOOK_AROUND={mouseClick:"select",mouseClickDouble:"clickStep",mouseDragLeft:"lookAround",mouseDragRight:"tumble",mouseDragMiddle:"pan",mouseWheel:"zoomStep"};c.OLD={mouseClick:"select",mouseClickDouble:"clickStep",mouseDragMiddle:"tumble",
mouseDragRight:"pan",mouseWheel:"zoomStep"};c.PRO_PAN={mouseClick:"select",mouseClickDouble:"clickStep",mouseDragLeft:"pan",mouseDragMiddle:"tumble",mouseDragRight:"zoom",mouseWheel:"zoomStep"};c.PRO_TUMBLE={mouseClick:"select",mouseClickDouble:"clickStep",mouseDragLeft:"tumble",mouseDragMiddle:"pan",mouseDragRight:"zoom",mouseWheel:"zoomStep"};return c})},"esri/views/3d/support/Frustum":function(){define(["../../../core/declare","../lib/glMatrix","../support/earthUtils","../webgl-engine/lib/Util"],
function(s,q,n,k){var h=q.vec3d,e=q.vec4d;return s([],{constructor:function(){this.planes=Array(6);this.points=Array(8);this.lines=Array(12);this.origin=h.create();this.direction=h.create();this.dirty=!1;this._altitude=null;for(var c=0;6>c;c++)this.planes[c]=e.create();for(c=0;8>c;c++)this.points[c]=h.create();for(c=0;12>c;c++)this.lines[c]={origin:null,direction:h.create(),endpoint:null}},_makeLine:function(c,b,e){c.origin=b;c.endpoint=e;h.direction(e,b,c.direction)},update:function(c){if(this.dirty){k.matrix2frustumPlanes(c.viewMatrix,
c.projectionMatrix,this.points,this.planes);for(var b=0;4>b;b++){var e=b,f=b+4;this._makeLine(this.lines[b],this.points[e],this.points[f]);this._makeLine(this.lines[b+4],this.points[e],3===b?this.points[0]:this.points[e+1]);this._makeLine(this.lines[b+8],this.points[f],3===b?this.points[4]:this.points[f+1])}h.set(c.eye,this.origin);c.computeDirection(this.direction);this._altitude=null;this.dirty=!1}},altitude:function(){return null!=this._altitude?this._altitude:this._altitude=h.length(this.origin)-
n.earthRadius}})})},"esri/views/ui/3d/DefaultUI3D":function(){define(["../DefaultUI","dojo/_base/lang"],function(s,q){return s.createSubclass({declaredClass:"esri.views.ui.3d.DefaultUI3D",getDefaults:function(){return q.mixin(this.inherited(arguments),{components:["attribution","zoom","compass"]})}})})},"esri/layers/graphics/controllers/I3SOnDemandController":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessoireSupport/typescript dojo/promise/all ../../../views/3d/support/ResourceController ../../../geometry/SpatialReference ../../../views/3d/layers/i3s/I3SNodeLoader ../../../views/3d/layers/i3s/I3SIndexTraversal ../../../views/3d/layers/i3s/I3SUtil ../../../views/3d/layers/i3s/I3SLodHandling ../../../views/3d/layers/i3s/I3SViewportQueries ../../../core/Accessoire ../../../core/Evented ../../../core/AccessoirePromise ../../../views/3d/support/PromiseLightweight ../../../views/3d/support/projectionUtils ../../../views/3d/lib/glMatrix".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v){function u(a,b){for(var c=0;c<a.length;c++)if(a[c].name===b)return[c,a[c]];return[-1,void 0]}var z=v.vec3d;return function(d){function q(a){d.call(this)}n(q,d);q.prototype.initialize=function(){var a=this;this.screenSizeFactor=0;this._animFrameFunctionQueue=[[],[]];this._numNodesLoading=0;this._progressMaxNumNodes=1;this._layerViewHandles=[];this._requiredAttributesChangedHandles=[];this._qualityChangedHandles=[];this._restartNodeLoading=this._updatesDisabled=
!1;this.updateEventListener={needsUpdate:function(){return a._needsAnimationFrameHandler()},idleFrame:function(b){return a._animationFrameHandler(b)},idleBegin:function(){return a._startNodeLoading()},idleEnd:function(){return a.cancelNodeLoading()}};this.updateEventListenerWhileSuspended={idleBegin:function(){return a._startNodeLoadingWhileSuspended()}};this._lodHandling=new r(this.layerViewRequiredFunctions,this.layerViewOptionalFunctions);this.layerView._controller=this;var b=this.layer;this._defaultGeometrySchema=
b.store.defaultGeometrySchema;this._fields=b.fields;this._attributeStorageInfo=b.attributeStorageInfo;this._rootNodeUrl=b.store.rootNode;null==b.store.indexCRS&&null==b.store.geographicCRS&&this.warningEvent("Input data invalid: layer.store.indexCRS is undefined.",1);null==b.store.vertexCRS&&null==b.store.projectedCRS&&this.warningEvent("Input data invalid: layer.store.vertexCRS is undefined.",1);b=e([this.layer,this.layerView]).then(function(){a.setClippingArea(a.layerView.view.clippingArea);a._layerViewHandles=
[a.layerView.on("suspend",function(b){b.target.view.resourceController.deregisterIdleFrameWorker(a);a.updateEventListener.idleEnd();b.target.view.resourceController.registerIdleFrameWorker(a,a.updateEventListenerWhileSuspended);null!=b.target.setVisibility&&b.target.setVisibility(!1)}),a.layerView.on("resume",function(b){null!=b.target.setVisibility&&b.target.setVisibility(!0);b.target.view.resourceController.deregisterIdleFrameWorker(a);b.target.view.resourceController.registerIdleFrameWorker(a,
a.updateEventListener);a.updateEventListener.idleBegin()})];a.layerView.suspended?a.layerView.view.resourceController.registerIdleFrameWorker(a,a.updateEventListenerWhileSuspended):(null!=a.layerView.setVisibility&&a.layerView.setVisibility(!0),a.layerView.view.resourceController.registerIdleFrameWorker(a,a.updateEventListener));a._qualityChangedHandles=[a.layerView.watch("view.qualitySettings.sceneLayer.lodFactor",function(){return a._qualityChanged()})]});this.addResolvingPromise(b)};q.prototype.destroy=
function(){this.layerView.view.resourceController.deregisterIdleFrameWorker(this);this.layerView.view.resourceController.deregisterClient(this.layerView);this._removeHandles(this._layerViewHandles);this._removeHandles(this._requiredAttributesChangedHandles);this._removeHandles(this._qualityChangedHandles);this._nodeLoader=null};q.prototype._removeHandles=function(a){a&&(a.forEach(function(a){a.remove()}),a.length=0)};q.prototype._modifyNumNodesLoading=function(a){this._numNodesLoading+=a};q.prototype._getRequiredAttributes=
function(){if(null==this._attributeStorageInfo||!this._fields)return[];var a=Object.create(null);this.layer.renderer&&this.layer.renderer.collectRequiredFields(a);this.layer.labelsVisible&&this.layer.labelingInfo&&this.layer.labelingInfo.forEach(function(b){b._collectRequiredFields(a)});var b=this._attributeStorageInfo,c=this._fields;return Object.keys(a).map(function(a){var d=u(b,a)[0],e=u(c,a)[1];return{index:d,name:a,field:e,attributeStorageInfo:b[d]}}).filter(function(a){return-1!==a.index&&null!=
a.field})};q.prototype._rendererChanged=function(){var a=this._getRequiredAttributes();this.cancelNodeLoading();this._requiredAttributes=a;this._startNodeLoading()};q.prototype._labelsVisibleChanged=function(){var a=this._getRequiredAttributes(),b=!0;a.length===this._requiredAttributes.length&&(b=this._requiredAttributes.every(function(b){return-1!==u(a,b.name)[0]}));b&&(this.cancelNodeLoading(),this._requiredAttributes=a,this._startNodeLoading())};q.prototype._labelingInfoChanged=function(){};q.prototype.setClippingArea=
function(a){var b=[];x.extentToBoundingBox(a,b,this.layerView.view.renderSpatialReference)?this._clippingArea=b:this._clippingArea=null};q.prototype._qualityChanged=function(){this.cancelNodeLoading();this._startNodeLoading()};q.prototype.updateClippingArea=function(a){this.setClippingArea(a);this.cancelNodeLoading();this._startNodeLoading()};q.prototype.queueAnimationFrameFunctionCall=function(a,b,c,d,e){null!=this._nodeLoader&&this._animFrameFunctionQueue[e||0].push({fct:a,that:b,args:c,cancelFunc:d})};
q.prototype.getBaseUrl=function(){return a.addTrailingSlash(this.layer.parsedUrl.path)};q.prototype.updateElevationChanged=function(b,c,d){a.findIntersectingNodes(b,c,this.nodeIndex.root,this.crsIndex,this.nodeIndex,d);for(b=0;b<d.length;b++)c=d.data[b],c.computedMbs&&(c.computedMbs[3]=-1);d.length&&(this._restartNodeLoading=!0)};q.prototype._needsAnimationFrameHandler=function(){return!0};q.prototype._animationFrameHandler=function(a){this._restartNodeLoading&&(this.cancelNodeLoading(),this._startNodeLoading());
if(null!=this._nodeLoader){for(var b;0<this._animFrameFunctionQueue[0].length&&!a.done();)b=this._animFrameFunctionQueue[0].shift(),b.fct.apply(b.that,b.args);b=5-this._numNodesLoading;for(null!=this._indexLoader&&0<b&&this._indexLoader.continueTraversal(b);0<this._animFrameFunctionQueue[1].length&&!a.done();)b=this._animFrameFunctionQueue[1].shift(),b.fct.apply(b.that,b.args);this._evaluateUpdating();this._lodHandling.lodGlobalHandling()}};q.prototype._evaluateUpdating=function(){var a=null!=this._indexLoader?
this._indexLoader.getQueueSize()+3*this._numNodesLoading:0,b=0<a;0===a&&(this._progressMaxNumNodes=1);this._progressMaxNumNodes=Math.max(a,this._progressMaxNumNodes);this.layerView.updating!==b&&(this.layerView.updating=b);a=100*a/this._progressMaxNumNodes;this.layerView.updatingPercentage!==a&&(this.layerView.updatingPercentage=a)};q.prototype._initViewData=function(){var a=this.layerView.view,b=a.navigation.targetCamera,c=a.renderCoordsHelper;this.camPos=b.eye;this.screenSizeFactor=1/b.perPixelRatio;
this._poi=z.create();var d=z.create(),e=z.create();z.subtract(b.center,b.eye,d);z.normalize(d);c.worldUpAtPosition(b.center,e);d=Math.acos(z.dot(e,d))-0.5*Math.PI;z.lerp(b.eye,b.center,Math.max(0,Math.min(1,d/(0.5*Math.PI))),this._poi);d=a.qualitySettings.sceneLayer.lodFactor;e=this.layerViewOptionalFunctions.traversalOptions.elevationInfo;this._viewportQueries=new l(this.crsIndex,c,b,this._clippingArea,null!=this.layerViewOptionalFunctions.traversalOptions?this.layerViewOptionalFunctions.traversalOptions.errorMetricToUse:
null,e?a.basemapTerrain:null,e,{screenspaceErrorBias:d,maxDistance:25E7,angleDependentLoD:1>d})};q.prototype._startNodeLoadingWhileSuspended=function(){this._initViewData();this._removeInvisibleNodes()};q.prototype.warningEvent=function(a,b){this.emit("i3s-load-log",{type:1===b?"fatal":"warning",msg:a});console.warn("i3s-load-log warningEvent severity "+b," message "+a)};q.prototype._startNodeLoading=function(){var a=this;this._restartNodeLoading=!1;if(!this._updatesDisabled&&null!=this.streamDataSupplier){this._initViewData();
var b=null!=this.layerViewOptionalFunctions.getTexturePrefetchFunctions?this.layerViewOptionalFunctions.getTexturePrefetchFunctions():void 0,c=this.isMeshPyramid&&null!=this._defaultGeometrySchema&&null!=this._defaultGeometrySchema.ordering;null!=this.layerViewOptionalFunctions.getLoadedAttributes&&null==this._requiredAttributes&&(this._requiredAttributes=this._getRequiredAttributes(),this._requiredAttributesChangedHandles=[this.layer.watch("renderer",function(){return a._rendererChanged()}),this.layer.watch("labelsVisible",
function(){return a._labelsVisibleChanged()}),this.layer.watch("labelingInfo",function(){return a._labelingInfoChanged()})]);this._nodeLoader=new g(this.streamDataSupplier,this._bundleLoadedCallback.bind(this),this.queueAnimationFrameFunctionCall.bind(this),void 0,this.layerView.view.renderCoordsHelper,this.crsIndex,b?b._calcDesiredTextureLOD:void 0,b?b._imageIsPartOfTextureBundle:void 0,b?b._matId2Meta:void 0,b?b._texId2Meta:void 0,b?b.useCompressedTextures:void 0,this.warningEvent,this._defaultGeometrySchema,
this._requiredAttributes,c);b=this._rootNodeUrl.split("/");b=b[b.length-1];this._indexLoader=new f(this.getBaseUrl(),this._rootNodeUrl,b,this._poi,this.nodeIndex,this.streamDataSupplier,this._viewportQueries,this._processNodeIndexDocument.bind(this),this._lodHandling.finishedLevel.bind(this._lodHandling),this.layerViewOptionalFunctions._nodeDebugVisualizer,this.warningEvent,this.layer._addTrailingSlash,this.layerViewOptionalFunctions.traversalOptions);this._indexLoader.start();var c=this._removeInvisibleNodes(),
d=null!=this.layerViewOptionalFunctions.traversalOptions&&!0===this.layerViewOptionalFunctions.traversalOptions.perLevelTraversal?"perLevel":this.isMeshPyramid?"global":"swap";this._lodHandling.startNodeLoading(this._indexLoader.nodeIsVisible.bind(this._indexLoader),this._indexLoader.nodeTraversalState.bind(this._indexLoader),d,this.nodeIndex,c,b);this.layerViewOptionalFunctions.additionalStartNodeLoadingHandler&&this.layerViewOptionalFunctions.additionalStartNodeLoadingHandler();this._evaluateUpdating()}};
q.prototype.isNodeLoading=function(){return null!=this._nodeLoader&&null!=this._indexLoader};q.prototype.cancelNodeLoading=function(){if(this.isNodeLoading()){this._indexLoader.cancel();this._nodeLoader.cancel();this.streamDataSupplier.cancelRequestsBulk(this.streamDataSupplier.getRequestedURLs());for(var a=0;a<this._animFrameFunctionQueue.length;a++)for(var b=0;b<this._animFrameFunctionQueue[a].length;b++)void 0!==this._animFrameFunctionQueue[a][b].cancelFunc&&this._animFrameFunctionQueue[a][b].cancelFunc();
this._numNodesLoading=0;this._animFrameFunctionQueue=[[],[]];this._indexLoader=this._nodeLoader=void 0;this._lodHandling.cancelNodeLoading();this.layerViewOptionalFunctions.additionalCancelNodeLoadingHandler&&this.layerViewOptionalFunctions.additionalCancelNodeLoadingHandler();this._evaluateUpdating()}};q.prototype._removeInvisibleNodes=function(){var a={},b;for(b in this.nodeIndex)if(this.nodeIndex.hasOwnProperty(b)){var c=this.nodeIndex[b];null!=this.layerViewRequiredFunctions.getAddedFeatures(c.id)&&
(!1===this._viewportQueries.isNodeVisible(c)?this._removeNodeData(c):a[b]=c)}return a};q.prototype._removeNodeData=function(a){this._lodHandling.setLodGlobalDirty();this.layerViewRequiredFunctions.removeNodeData(a);delete this.nodeIndex[a.id]};q.prototype._processNodeIndexDocument=function(a,b){var c=this,d=new t.Promise;if(null!=a.featureData&&0<a.featureData.length)if(this.layerViewRequiredFunctions.areAllBundlesLoaded(a,!0)){var e=this.layerViewOptionalFunctions.getLoadedAttributes,e=null!=e?e(a):
void 0;null!=e&&e!==this._requiredAttributes&&this._nodeLoader.loadAttributes(a,a.baseUrl,this._requiredAttributes).then(function(b){c.layerViewOptionalFunctions.setAttributeData(a,c._requiredAttributes,b)}).catch(function(b){c.layerViewOptionalFunctions.setAttributeData(a,c._requiredAttributes,{})});this._lodHandling.shouldLoadNode(a,b)&&(e=this._lodHandling.lodSwapBuildInfoForNode(a))&&null==e.swapPairs&&this._lodHandling.lodSwapBundleLoaded(a,null,e)}else if(this._lodHandling.shouldLoadNode(a,
b)){e=this._lodHandling.lodSwapBuildInfoForNode(a);if(this.layerViewRequiredFunctions.isOverMemory())return d.done(),d;this._modifyNumNodesLoading(1);for(var f=[],g=0;g<a.featureData.length;g++){var h=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(a,g),m=h.wasPartiallyHidden;(!h.alreadyLoaded||m)&&f.push(g)}this.queueAnimationFrameFunctionCall(this._nodeLoader.loadNodeData,this._nodeLoader,[a,f,d,null!=this.layerViewOptionalFunctions.getTexturePrefetchFunctions,e],void 0,1);d.then(function(){return c._modifyNumNodesLoading(-1)},
function(){return c._modifyNumNodesLoading(-1)});return d}d.done();return d};q.prototype._bundleLoadedCallback=function(a,b,c,d,e,f,g,h){this._lodHandling.lodSwapBundleLoaded(a,b,h);this.layerViewRequiredFunctions.addBundle(a,b,c,d,e,f,g);null!=this.layerViewOptionalFunctions.setPolygonOffset&&(b=this._lodHandling.shouldSetPolygonOffset(a))&&this.layerViewOptionalFunctions.setPolygonOffset(a,b)};k([h.shared("esri.layers.graphics.controllers.I3SOnDemandController")],q.prototype,"declaredClass",void 0);
k([h.shared({properties:{isMeshPyramid:{readOnly:!0,getter:function(){return"meshpyramids"===this.layer.store.profile||"MeshPyramid"===this.layer.store.lodType}},streamDataSupplier:{readOnly:!0,getter:function(){return this.layerView.view.resourceController.registerClient(this.layerView,c.ClientType.SCENE,this.addUrlTokenFunction)}},crsVertex:{readOnly:!0,type:b,getter:function(){var c=new b(a.extractWkid(this.layer.store.indexCRS||this.layer.store.geographicCRS));return c.equals(this.layer.spatialReference)?
this.layer.spatialReference:c}},crsIndex:{readOnly:!0,type:b,getter:function(){var c=new b(a.extractWkid(this.layer.store.vertexCRS||this.layer.store.projectedCRS));return c.equals(this.layer.spatialReference)?this.layer.spatialReference:c}},nodeIndex:{readOnly:!0,getter:function(){return{}}},camPos:{},screenSizeFactor:{},layerView:{},layerViewRequiredFunctions:{},layerViewOptionalFunctions:{},layer:{},addUrlTokenFunction:{},warningEvent:{}}})],q.prototype,"classMetadata",void 0);return q=k([h.subclass([m,
p])],q)}(d)})},"esri/views/3d/layers/i3s/I3SNodeLoader":function(){define("require exports dojo/_base/lang ../../webgl-engine/lib/Util ./I3SUtil ./I3SBinaryReader ../../support/PromiseLightweight ../../support/projectionUtils ../../lib/glMatrix ../../support/PromiseNativeOrShim".split(" "),function(s,q,n,k,h,e,c,b,g,f){var a=k.assert,r=g.vec4d,l={};return function(){function d(a,b,c,e,g,l,k,n,r,q,s,B,D,F,H){this.bundleLoadedCallback=b;this.queueFunctionCall=c;this.debugVis=e;this.renderCoordsHelper=
g;this.indexSR=l;this.calcDesiredTextureLOD=k;this.imageIsPartOfTextureBundle=n;this.matId2Meta=r;this.texId2Meta=q;this.useCompressedTextures=s;this.warningEvent=B;this.defaultGeometrySchema=D;this.requiredAttributes=F;this.bypassFeatureData=H;this.texIdToPromises={};this.loadShared=function(a){if(null==a.sharedResource)return f.resolve({});var b=h.concatUrl(a.baseUrl,a.sharedResource.href)+"/";a.sharedResource.hrefConcat=b;return this.loadJSON(b).then(function(a){d.fixTextureEncodings(a);d.addAbsoluteHrefTexture(a,
b);return a})};this.loader=a;this.cancelled=!1}d.prototype.waitForAnimationFrame=function(){var a=this;return new f(function(b,c){a.queueFunctionCall(b,null,[],c)})};d.prototype.cancel=function(){this.cancelled=!0};d.prototype.loadJSON=function(a){var b=this.loader.request(a,"json");return new f(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};d.prototype.loadBinary=function(a){var b=this.loader.request(a,"binary");return new f(function(c,d){b.then(function(a,
b){c(b)},function(b){d(Error("Failed to load: "+a))})})};d.prototype.loadImage=function(a){var b=this.loader.request(a,"image");return new f(function(c,d){b.then(function(a,b){c(b)},function(b){d(Error("Failed to load: "+a))})})};d.prototype.loadAttribute=function(a,b,c){a=h.addTrailingSlash(h.concatUrl(a,c));return this.loadBinary(a).then(function(a){return e.readBinaryAttribute(b,a)})};d.prototype.loadAttributes=function(a,b,c){var d=this,e=c.map(function(c){return d.loadAttribute(b,c.attributeStorageInfo,
a.attributeData[c.index].href)});return f.all(e).then(function(a){for(var b={},d=0;d<c.length;++d)a[d]&&(b[c[d].name]=a[d]);return b})};d.prototype.prepareBinaryGeometryData=function(a,b,c,d){n.mixin(a.geometries[0].params,c);a.faceRanges[0][0]=0;a.faceRanges[0][1]=c.header.fields.vertexCount/3-1;!d&&null==c.vertexAttributes.region&&delete c.vertexAttributes.region;if(null!=c.featureAttributes){d=c.featureAttributes;if(d.faceRange){a.faceRanges=[];for(var f=e.createTypedView(b,d.faceRange),g=d.faceRange.valuesPerElement,
l=0;l<c.header.fields.featureCount;l++)a.faceRanges[l]=[f[l*g],f[l*g+1]]}if(d.id){a.featureIds=[];f=1;l=h.valueType2TypedArrayClassMap[d.id.valueType];"UInt64"===d.id.valueType&&(l=Uint32Array,f=2);b=new l(b,d.id.byteOffset,d.id.count*d.id.valuesPerElement*f);for(l=0;l<c.header.fields.featureCount;l++)if(a.featureIds[l]=b[l*d.id.valuesPerElement*f],2===f){g=b[l*d.id.valuesPerElement*f+1];if(2097150<=g)throw Error("ID exceeded maximum range supported by javascript (max \x3d 53bit-1 \x3d 9007199254740991)");
a.featureIds[l]+=4294967296*g}}}};d.prototype.loadNodeData=function(a,b,c,g,l){var k=this,r=null==a.features,q=a.baseUrl,s={},A=this.loadShared(a),y=A.then(function(a){return k.loadReferencedShared(a,q)}),B=null;null!=this.requiredAttributes&&(B=this.loadAttributes(a,q,this.requiredAttributes));var D=null;null!=a.geometryData&&(D=a.geometryData.map(function(a,c){if(-1===b.indexOf(c))return null;var d=h.concatUrl(q,a.href);a.hrefConcat=d;return k.loadBinary(d)}));f.all([A,y]).then(function(c){var h=
c[0];c=c[1];k.handleCancelled();a.sharedResource&&(s[a.sharedResource.hrefConcat]=h,n.mixin(s,c));c=b.map(function(b){return k.loadFeatureData(a,b,h).then(function(c){k.handleCancelled();r&&d.buildNodeFeatures(a,b,c);var l=k.collectGeometries(a,b,c,h);c=null;c=null!=D&&null!=D[b]?D[b].then(function(c){s[a.geometryData[b].hrefConcat]=c;var d=Object.keys(h.materialDefinitions)[0],d=h.materialDefinitions[d].params.vertexRegions,f=e.createGeometryDataIndex(c,k.defaultGeometrySchema,d);k.prepareBinaryGeometryData(l[0],
c,f,d);return l}):f.resolve(l);var p=g?k.loadTextures(l,h,k.matId2Meta,k.texId2Meta).then(function(a){var b={};a.forEach(function(a){var c=a.i3sTexId;b[c]={i3sTexId:c,data:a.data,encoding:a.encoding,desiredLOD:a.desiredLOD,createdTextureForDomImage:function(){k.texIdToPromises[c]&&delete k.texIdToPromises[c]}}});return b}):null;return f.all([p,c,B])}).then(function(c){var d=c[0],e=c[1];c=c[2];k.handleCancelled();void 0!==k.debugVis&&k.debugVis.show(a,k.indexSR,"green");var f=null;c&&(f={attributeData:c,
loadedAttributes:k.requiredAttributes});return k.callbackWrapped(a,e,f,s,d,b,l)}).catch(function(c){k.handleCancelled();return k.callbackWrapped(a,null,null,s,null,b,l)})});return f.all(c)}).catch(function(c){if(!k.cancelled)return c=b.map(function(b){return k.callbackWrapped(a,null,null,s,null,b,l)}),f.all(c)}).then(function(){c.done()})};d.prototype.callbackWrapped=function(a,b,d,e,g,h,l){var k=this;return this.waitForAnimationFrame().then(function(){return new f(function(f,n){var r=new c.Promise,
q=k.bundleLoadedCallback;q(a,b,d,e,r,g,h,l);r.then(f,n)})})};d.addAbsoluteHrefTexture=function(a,b){var c=a.textureDefinitions;if(void 0!==c)for(var d in c)if(c.hasOwnProperty(d))for(var e=c[d],f=0;f<e.images.length;f++){var g=e.images[f];Array.isArray(e.encoding)?g.hrefConcat=g.href.map(function(a){return h.concatUrl(b,a)}):g.hrefConcat=h.concatUrl(b,g.href)}};d.fixTextureEncodings=function(a){a=a.textureDefinitions;if(null!=a)for(var b in a){var c=a[b];if(Array.isArray(c.encoding))for(var d=0;d<
c.encoding.length;d++){var e=c.encoding[d];"data:"===e.substring(0,5)&&(c.encoding[d]=e.substring(5))}else e=c.encoding,"data:"===e.substring(0,5)&&(c.encoding=e.substring(5))}};d.prototype.loadReferencedShared=function(a,b){var c=this;if(null==a||null==a.materialDefinitions)return f.resolve({});var e=Object.keys(a.materialDefinitions).filter(function(b){return a.materialDefinitions[b]&&null!=a.materialDefinitions[b].href}).map(function(c){return h.concatUrl(b,a.materialDefinitions[c].href)+"/"});
return f.all(e.map(function(a){return c.loadJSON(a).then(function(b){return[a,b]})})).then(function(a){for(var b={},c=0;c<a.length;c++){var e=a[c],f=e[0],e=e[1];d.fixTextureEncodings(e);d.addAbsoluteHrefTexture(e,f);b[f]=e}return b})};d.prototype.loadTexture=function(b,c,d,e,g,l){var k=this,n=-1<l?d.encoding[l]:d.encoding;d=n===h.DDS_ENCODING_STRING;var r=this.imageIsPartOfTextureBundle(e);a(!(d&&r),"DDS in multi texture bundles not supported at the moment");return d?this.loadBinary(b).then(function(a){return k.cancelled?
f.reject():{i3sTexId:c,data:a,encoding:n,desiredLOD:g}}):r?this.loadBinary(b).then(function(d){var h;try{var r=void 0,q;-1<l?(a(Array.isArray(e.byteOffset)&&Array.isArray(e.length),"texture encoding is array, but image byteOffset/length isn't"),r=e.byteOffset[l],q=e.length[l]):(r=e.byteOffset,q=e.length);var s=new Uint8Array(d,r,q),t=new Blob([s],{type:n});h=window.URL.createObjectURL(t)}catch(C){h="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIElEQVQ4T2P8zyD6n4ECwDhqAMNoGDCMhgEwDw2DdAAAdzkhQdS8dl8AAAAASUVORK5CYII\x3d",
console.error("error loading texture "+b+" "+C)}var G=new Image;d=new f(function(a,b){var d=function(){window.URL.revokeObjectURL(h);G.onerror=void 0;G.onload=void 0};G.onerror=function(a){d();b(a)};G.onload=function(){d();k.cancelled?b():a({i3sTexId:c,data:G,encoding:n,desiredLOD:g})}});G.src=h;return d}):this.loadImage(b).then(function(a){return k.cancelled?f.reject():{i3sTexId:c,data:a,encoding:n,desiredLOD:g}})};d.getAllEngineMBS=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].engineMBS);
return b};d.prototype.loadTextures=function(b,c,e,g){for(var l=[],k=0;k<b.length;k++)for(var n=b[k].geometries,r=d.getAllEngineMBS(b[k].features),q=0;q<n.length;++q)for(var s=n[q],y=s.params.components.length,B=0;B<y;B++){var D=s.params.components[B],F=D.materialID,D=D.textureID||"none";if(!(e[F]&&null!=e[F][D])&&null==g[D]&&"none"!==D)if(null!=this.texIdToPromises[D])l.push(this.texIdToPromises[D]);else{(null==c.textureDefinitions||null==c.textureDefinitions[D])&&this.warningEvent("textureDefinitions missing in shared resource. i3sTexId: "+
D,1);F=c.textureDefinitions[D];a(void 0!==F,"geometry wants unknown texture "+D);var H=this.calcDesiredTextureLOD(r,F.images);if(0!==F.images.length){var N=F.images[H],G=h.getAppropriateTextureEncoding(F.encoding,this.useCompressedTextures()),F=this.loadTexture(-1<G?N.hrefConcat[G]:N.hrefConcat,D,F,N,H,G);l.push(F);this.texIdToPromises[D]=F}}}return f.all(l)};d.getIdFromJsonPointer=function(a){a=a.split("/");return a[a.length-1]};d.buildNodeFeatures=function(a,b,c){null==a.features&&(a.features=[]);
for(var d in c.featureData)a.features.push({id:c.featureData[d].id,mbs:a.mbs,block:b})};d.prototype.collectGeometries=function(c,e,f,g){var h=[],l=!1,k=0,n=c.features.length-1;null==c.featureData[e].featureRange?l=!0:(k=c.featureData[e].featureRange[0],n=c.featureData[e].featureRange[1]);for(;k<=n;++k){var q=c.features[k];if(!q.engineMBS){var s=r.create();b.mbsToMbs(q.mbs,this.indexSR,s,this.renderCoordsHelper.spatialReference);s[3]=q.mbs[3];q.engineMBS=s}if(!(l&&q.block!==e)){for(var y=f.featureData,
s=void 0,B=0;B<y.length;B++)if(y[B].id===q.id){s=y[B];break}a(null!=s,"I3S: unable to find feature data in specified block in node.id "+c.id+" feature.id "+q.id);var y=s.geometries,B=[],D=[];if(null!=y)for(var F=0;F<y.length;F++){var H=s.geometries[F];if("GeometryReference"===H.type){for(var N=d.getIdFromJsonPointer(H.params.$ref),G=void 0,O=0;O<f.geometryData.length;O++){var M=f.geometryData[O];if(M.id+""===N){G=M;break}}a(null!=G,"I3S: Unable to find referenced geometry");null==G.params.material&&
(this.warningEvent("material definition is missing in featureData, node: "+c.id,1),O=Object.keys(g.materialDefinitions)[0],G.params.material="/materialDefinitions/"+O);null==G.params.components&&(G.params.components=null!=G.params.texture?[{material:G.params.material,materialID:d.getIdFromJsonPointer(G.params.material),texture:G.params.texture,textureID:d.getIdFromJsonPointer(G.params.texture),id:1}]:[{material:G.params.material,materialID:d.getIdFromJsonPointer(G.params.material),id:1}],null!=G.params.faces&&
null!=G.params.faces.position&&(G.params.faces.position.componentIndices=[0]));M=void 0;M=null;for(O=0;O<h.length;O++)if(1===h[O].geometries.length&&h[O].geometries[0].id+""===N){M=h[O];break}null===M&&(M={features:[],featureDataPositions:[],featureDataAttributes:[],faceRanges:[],geometries:[G]},h.push(M));M.features.push(q);M.featureDataAttributes.push(s.attributes);M.featureDataPositions.push(s.position);M.faceRanges.push(H.params.faceRange)}else B.push(H),null!=H.params.faceRange&&D.push(H.params.faceRange)}else null!=
s.position&&B.push({id:q.id,type:"Embedded",transformation:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],params:{type:"points",vertexAttributes:{position:[0,0,0]}}});0===D.length&&(D=null);0<B.length&&h.push({features:[q],featureDataAttributes:[s.attributes],featureDataPositions:[s.position],geometries:B,faceRanges:D})}}return h};d.prototype.loadFeatureData=function(a,b,c){if(this.bypassFeatureData&&this.defaultGeometrySchema){a=a.id;var e=b=void 0;null!=c.materialDefinitions&&(b=Object.keys(c.materialDefinitions)[0]);
null!=c.textureDefinitions&&(e=Object.keys(c.textureDefinitions)[0]);c=d.buildDefaultFeatureData(a,b,e,null);return f.resolve(c)}c=h.concatUrl(a.baseUrl,a.featureData[b].href);a.featureData[b].hrefConcat=c;return this.loadJSON(c)};d.buildDefaultFeatureData=function(a,b,c,d){return{featureData:[{id:a,position:[0,0,0],pivotOffset:[0,0,0],mbb:d,layer:"Default",geometries:[{id:"1",type:"GeometryReference",params:{$ref:"/geometryData/0",faceRange:[0,0]}}]}],geometryData:[{id:"0",type:"ArrayBufferView",
transformation:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],params:{type:"triangles",material:"/materialDefinitions/"+b,texture:null!=c?"/textureDefinitions/"+c:void 0}}]}};d.prototype.handleCancelled=function(){if(this.cancelled)throw l;};return d}()})},"esri/views/3d/layers/i3s/I3SUtil":function(){define("require exports ../../lib/glMatrix ../../support/earthUtils ../../support/projectionUtils ../../../../core/urlUtils ../../../../core/requireUtils ../../../../core/promiseUtils dojo/_base/lang dojo/promise/all ../../../../request ../../webgl-engine/Stage ../../webgl-engine/materials/Material ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Layer ../../webgl-engine/lib/BufferVectorMath ../../webgl-engine/lib/Util ./I3SBinaryReader".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u){function z(a,b){return e.isAbsoluteUrl(b)?b:e.join(a,b)}function w(a,d,e){void 0===e&&(e=["*"]);return a?c.when(s,["../../../../tasks/support/Query","../../../../tasks/QueryTask"]).then(function(b){var c=b[1];b=new b[0]({objectIds:[d],outFields:e});return(new c(a.parsedUrl.path)).execute(b)}).then(function(a){return a&&a.features&&0<a.features.length?a.features[0].attributes:b.reject(Error("Feature not found in companion feature layer."))}):b.reject(Error("Companion feature layer not present."))}
function C(c,d,e,g){void 0===g&&(g=["*"]);var h=g.some(function(a){return"*"===a});return f(d.attributeData.map(function(e,f){if(!h&&!g.some(function(a){return c[f].name===a}))return b.resolve(null);var l=z(d.baseUrl,e.href);return a(l,{responseType:"array-buffer"}).then(function(a){return u.readBinaryAttribute(c[f],a.data)}).otherwise(function(){return null})})).then(function(a){for(var b={},d=0;d<a.length;d++)null!=a[d]&&(b[c[d].name]=a[d][e]);return b})}function A(a){return q.valueType2TypedArrayClassMap.hasOwnProperty(a)}
var y=n.vec4d,B=n.vec3d,D=n.mat4d,F=v.assert,H=B.create(),N=B.create(),G=y.create();q.DDS_ENCODING_STRING="image/vnd-ms.dds";q.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS=["image/jpeg","image/png"];q.addTrailingSlash=function(a){"/"!==a[a.length-1]&&(a+="/");return a};q.concatUrl=z;q.extractWkid=function(a){return a&&parseInt(a.substring(a.lastIndexOf("/")+1,a.length),10)};q.getAppropriateTextureEncoding=function(a,b){if(Array.isArray(a)){if(b){var c=a.indexOf(q.DDS_ENCODING_STRING);if(-1<c)return c}for(c=
0;c<a.length;c++)if(-1<q.BROWSER_SUPPORTED_IMAGE_ENCODING_STRINGS.indexOf(a[c]))return c;throw Error("Could not find appropriate texture encoding (among "+a.toString()+")");}return-1};q.findIntersectingNodes=function(a,b,c,d,e,f){if(null!=c&&(h.mbsToMbs(c.mbs,d,G,b),0!==this.intersectBoundingBoxWithMbs(a,G))){f.push(c);for(var g=null!=c.children?c.children.length:0,l=0;l<g;l++)this.findIntersectingNodes(a,b,e[c.children[l].id],d,e,f)}};q.intersectBoundingBoxWithMbs=function(a,b){var c=b[0],d=b[1],
e=b[2],f=b[3],g=0;if(c<a[0])var h=a[0]-c,g=g+h*h;d<a[1]&&(h=a[1]-d,g+=h*h);e<a[2]&&(h=a[2]-e,g+=h*h);c>a[3]&&(h=c-a[3],g+=h*h);d>a[4]&&(h=d-a[4],g+=h*h);e>a[5]&&(h=e-a[5],g+=h*h);if(g>f*f)return 0;if(0<g)return 1;g=Infinity;c-a[0]<g&&(g=c-a[0]);d-a[1]<g&&(g=d-a[1]);e-a[2]<g&&(g=e-a[2]);a[3]-c<g&&(g=a[3]-c);a[4]-d<g&&(g=a[4]-d);a[5]-e<g&&(g=a[5]-e);return g>f?2:1};q.recomputeNormals=function(a,b){for(var c=x.Vec3Compact.subtract,d=a.map(function(a){return a.indices.position.length/3}).reduce(function(a,
b){return a+b}),d=new Float32Array(3*d),e=b.position.data,f=0,g=0;g<a.length;g++){for(var h=a[g].indices.position,l=new Uint32Array(h.length),k=0;k<h.length;k+=3){c(e,3*h[k],e,3*h[k+1],N,0);c(e,3*h[k],e,3*h[k+2],H,0);B.cross(H,N);B.normalize(H);var m=f/3;d[f++]=H[0];d[f++]=H[1];d[f++]=H[2];l[k]=m;l[k+1]=m;l[k+2]=m}a[g].indices.normal=l}b.normal.data=d};q.makeNodeDebugVisualizer=function(a,b,c){function e(a){return{ambient:a,diffuse:[0,0,0],transparent:!0,opacity:0.5,blendModeOneOne:!1}}var f=new d(m.createCylinderGeometry(1,
1,64,[0,0,1],[0,0,0],!1),"debugCylinder"),g=new d(m.createSphereGeometry(1),"debugSphere"),n={red:new l(e([0.8,0,0]),"debugMaterialRed"),grey:new l(e([0.4,0.4,0.4]),"debugMaterialGrey"),brown:new l(e([0.2,0.1,0]),"debugMaterialBrown"),green:new l(e([0,0.8,0]),"debugMaterialGreen"),blue:new l(e([0,0,0.8]),"debugMaterialBlue"),yellow:new l(e([0.8,0.8,0]),"debugMaterialYellow"),magenta:new l(e([0.8,0,0.8]),"debugMaterialMagenta")},q;for(q in n)a.add(r.ModelContentType.MATERIAL,n[q]);a.add(r.ModelContentType.GEOMETRY,
f);c=new t(c+"_debug",{interaction:"IGNORED"},c+"_debug");a.add(r.ModelContentType.LAYER,c);a.addToViewContent([c.getId()]);var s=B.create(),u=D.create();return{engineLayer:c,added:{},show:function(a,c,d){var e=a.computedMbs;e||(e=y.create(),h.mbsToMbs(a.mbs,c,e,b.spatialReference));var g="node"+a.id+"dbg";B.set(e,s);var l=e[3];if(l>k.earthRadius/10&&b.spatialReference===h.SphericalRenderSpatialReference){this.showWS(s,Math.max(0.01*l,1E4),d,g+"_center");var e=B.length(s),m=k.earthRadius;m+l>e&&(l=
(e*e+m*m-l*l)/(2*e),B.scale(s,l/e),l=Math.sqrt(m*m-l*l))}D.identity(u);D.scale(u,[l,l,0.05*l]);d=n[d];F(d);d=new p({name:g,geometries:[f],materials:[[d]],transformations:[u],castShadow:!1,idHint:g});h.computeLinearTransformation(c,a.mbs,u,b.spatialReference);null!=s&&(u[12]=s[0],u[13]=s[1],u[14]=s[2]);d.setObjectTransformation(u);this._addToStage(d,g)},showWS:function(a,b,c,d){var e=D.identity();D.scale(e,[b,b,b]);b=n[c];F(b);e=new p({name:d,geometries:[g],materials:[[b]],transformations:[e],castShadow:!1,
idHint:d});b=D.identity();D.translate(b,a);e.setObjectTransformation(b);this._addToStage(e,d)},_addToStage:function(b,c){a.add(r.ModelContentType.OBJECT,b);this.engineLayer.addObject(b);var d=this.added[c];void 0!==d&&(a.remove(r.ModelContentType.OBJECT,d.getId()),this.engineLayer.removeObject(d));this.added[c]=b},clear:function(){for(var b in this.added){var c=this.added[b];a.remove(r.ModelContentType.OBJECT,c.getId());this.engineLayer.removeObject(c)}this.added={}},dispose:function(){this.clear();
for(var b in n)a.remove(r.ModelContentType.MATERIAL,n[b].getId());a.remove(r.ModelContentType.GEOMETRY,f.getId());a.remove(r.ModelContentType.LAYER,this.engineLayer.getId())}}};q.postData=function(a,b,c){var d=new XMLHttpRequest;d.open("PUT","/put.php"+a,!0);d.setRequestHeader("Content-type",c);d.send(b)};q.whenGraphicAttributes=function(a,c,d,e,f){e=e.filter(function(a){return!c.attributes.hasOwnProperty(a)});if(0===e.length)return b.resolve(c);var h=function(a){g.mixin(c.attributes,a);return c},
l=a.companionFeatureLayer;a=a.attributeStorageInfo;return l?w(l,d,e).then(h):a&&(d=f(),null!=d)?C(a,d.node,d.index,e).then(h):b.reject()};q.queryAttributesFromFeatureLayer=w;q.queryAttributesFromCachedAttributes=C;q.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array};q.isValueType=A;q.getBytesPerValue=function(a){return A(a)&&q.valueType2TypedArrayClassMap[a].BYTES_PER_ELEMENT}})},
"esri/views/3d/layers/i3s/I3SBinaryReader":function(){define(["require","exports","dojo/_base/lang","./I3SUtil"],function(s,q,n,k){function h(a,b,c){for(var d="",e=0,f=0,g=0,h=0;e<c;)if(f=a[b+e],128>f)d+=String.fromCharCode(f),e++;else if(191<f&&224>f){if(e+1>=c)throw Error("UTF-8 Decode failed. Two byte character was truncated.");g=a[b+e+1];d+=String.fromCharCode((f&31)<<6|g&63);e+=2}else{if(e+2>=c)throw Error("UTF-8 Decode failed. Multi byte character was truncated.");g=a[b+e+1];h=a[b+e+2];d+=String.fromCharCode((f&
15)<<12|(g&63)<<6|h&63);e+=3}return d}function e(a,b){for(var c={byteOffset:0,byteCount:0,fields:Object.create(null)},d=0,e=0;e<b.length;e++){var f=b[e],g=new k.valueType2TypedArrayClassMap[f.valueType||f.type](a,d,1);c.fields[f.property]=g[0];d+=g.byteLength}c.byteCount=d;return c}function c(a,b,c){var d=[],e,f=0,g;for(g=0;g<a;g+=1){e=b[g];if(0<e){if(d.push(h(c,f,e-1)),0!==c[f+e-1])throw Error("invalid string array: missing null termination.");}else d.push(null);f+=e}return d}function b(a,b){return new k.valueType2TypedArrayClassMap[b.valueType](a,
b.byteOffset,b.count*b.valuesPerElement)}function g(a,b){return new Uint8Array(a,b.byteOffset,b.byteCount)}function f(a,b){for(var c=e(a,b.header),d={header:c,byteOffset:c.byteCount,byteCount:0,entries:Object.create(null)},f=c.byteCount,g=0;g<b.ordering.length;g++){var h=b.ordering[g],q=n.clone(b[h]);q.count=c.fields.count;if("String"===q.valueType){if(q.byteOffset=f,q.byteCount=c.fields[h+"ByteCount"],"UTF-8"!==q.encoding)throw Error("Unsupported String encoding: '"+q.encoding+"'.");}else if(k.isValueType(q.valueType)){var s=
k.getBytesPerValue(q.valueType),f=f+(0!==f%s?s-f%s:0);q.byteOffset=f;q.byteCount=s*q.valuesPerElement*q.count}else throw Error("Unsupported valueType: '"+q.valueType+"'.");f+=q.byteCount;d.entries[h]=q}d.byteCount=f-d.byteOffset;return d}q.readHeader=e;q.readStringArray=c;q.createTypedView=b;q.createRawView=g;q.createAttributeDataIndex=f;q.createGeometryDataIndex=function(a,b,c){var d=e(a,b.header),f=d.byteCount,g={header:d,byteOffset:d.byteCount,byteCount:0,vertexAttributes:n.clone(b.vertexAttributes)},
h=g.vertexAttributes;!c&&null!=h.region&&delete h.region;for(c=0;c<b.ordering.length;c++){var q=b.ordering[c];null!=h[q]&&(h[q].byteOffset=f,h[q].count=d.fields.vertexCount,f+=k.getBytesPerValue(h[q].valueType)*h[q].valuesPerElement*d.fields.vertexCount)}if(b.faces){g.faces=n.clone(b.faces);h=g.faces;for(c=0;c<b.ordering.length;c++)name=b.ordering[c],h[name].byteOffset=f,h[name].count=d.fields.vertexCount;f+=k.getBytesPerValue(h[name].valueType)*h[name].valuesPerElement*d.fields.vertexCount}if(b.featureAttributes&&
b.featureAttributeOrder&&d.fields.featureCount){g.featureAttributes=n.clone(b.featureAttributes);h=g.featureAttributes;for(c=0;c<b.featureAttributeOrder.length;c++)name=b.featureAttributeOrder[c],h[name].byteOffset=f,h[name].count=d.fields.featureCount,q=k.getBytesPerValue(h[name].valueType),"UInt64"===h[name].valueType&&(q=8),f+=q*h[name].valuesPerElement*d.fields.featureCount}if(a.byteLength<f)throw Error("Invalid geometry size ( expected: "+f+", actual: "+a.byteLength+")");a.byteLength>f&&console.warn("Invalid geometry size ( expected: "+
f+", actual: "+a.byteLength+")");g.byteCount=f-g.byteOffset;return g};q.readBinaryAttribute=function(a,e){a["attributeByteCounts "]&&!a.attributeByteCounts&&(console.error("Warning: Trailing space in 'attributeByteCounts '."),a.attributeByteCounts=a["attributeByteCounts "]);"ObjectIds"===a.ordering[0]&&a.hasOwnProperty("objectIds")&&(console.error("Warning: Case error in objectIds"),a.ordering[0]="objectIds");var h=f(e,a),d=h.byteOffset+h.byteCount;if(d>e.byteLength)throw Error("invalid attribute array length\n(expected: "+
d+" bytes, got: "+e.byteLength+" bytes).");d<e.byteLength&&console.error("Warning: attribute array too long\n(expected: "+d+" bytes, got: "+e.byteLength+" bytes).");if(d=h.entries.attributeValues||h.entries.objectIds){if("String"===d.valueType){var h=h.entries.attributeByteCounts,k=b(e,h),d=g(e,d);return c(h.count,k,d)}return b(e,d)}throw Error("Bad attributeStorageInfo specification.");}})},"esri/views/3d/support/PromiseNativeOrShim":function(){define(["./PromiseShim"],function(s){return null!=window.Promise&&
"function"===typeof window.Promise?window.Promise:s})},"esri/views/3d/support/PromiseShim":function(){define(["require","exports"],function(s,q){function n(e,c,b){setTimeout(e,0,c,b)}function k(e){return null!=e&&"object"===typeof e&&"then"in e&&"function"===typeof e.then}var h;(function(e){e[e.Pending=0]="Pending";e[e.Rejected=1]="Rejected";e[e.Resolved=2]="Resolved"})(h||(h={}));return function(){function e(c){var b=this;this.init(h.Pending);c(function(c){return b.resolve(c)},function(c){return b.reject(c)})}
e.prototype.then=function(c,b){if(this.state===h.Pending){var g=e.pending(c,b);this._addToChain(g);return g}if(this.state===h.Resolved)return null!=c?e.tryResolveAsync(c,this.value):e.resolve(this.value);if(this.state===h.Rejected)return null!=b?e.tryResolveAsync(b,this.error):e.reject(this.error)};e.prototype.catch=function(c){return this.then(null,c)};e.resolve=function(c){if(c instanceof e)return c;if(k(c)){var b=Object.create(e.prototype);b.init(h.Pending);c.then(function(c){b.resolve(c)},function(c){b.reject(c)});
return b}var g=Object.create(e.prototype);g.init(h.Resolved,c);return g};e.reject=function(c){var b=Object.create(e.prototype);b.init(h.Rejected,null,c);return b};e.all=function(c){var b=c.length;if(0===b)return e.resolve([]);var g=c.map(e.resolve),f=e.pending();c=function(){0===--b&&f.resolve(g.map(e.getValue))};for(var a=function(a){f.reject(a)},h=0;h<g.length;h++)g[h].then(c,a);return f};e.prototype.init=function(c,b,e,f,a){void 0===b&&(b=null);void 0===e&&(e=null);void 0===f&&(f=null);void 0===
a&&(a=null);this.state=c;this.value=b;this.error=e;this.callback=f;this.errback=a;this.chainedPromise=this.firstPromise=null};e.pending=function(c,b){var g=Object.create(e.prototype);g.init(h.Pending,null,null,c,b);return g};e.getValue=function(c){return c.value};e.prototype._unchain=function(){this.errback=this.callback=this.chainedPromise=null};e.prototype._addToChain=function(c){c.chainedPromise=this.firstPromise;this.firstPromise=c};e.tryResolveAsync=function(c,b){var g=Object.create(e.prototype);
g.init(h.Pending);n(function(){g.tryResolve(c,b)});return g};e.prototype.tryResolve=function(c,b){try{var e=c(b);this.resolve(e)}catch(f){console.error(f.stack instanceof Error?f.stack:f),this.reject(f)}};e.prototype.resolve=function(c){var b=this;this.state===h.Pending?c instanceof e?c.state===h.Pending?(this._unchain(),c._addToChain(this)):c.state===h.Resolved?this.resolve(c.value):c.state===h.Rejected&&this.reject(c.error):k(c)?c.then(function(c){b.resolve(c)},function(c){b.reject(c)}):(this.state=
h.Resolved,this.value=c,this.resolveHandlers()):console.error("Error: Promise is already resolved")};e.prototype.reject=function(c){this.state===h.Pending?(this.state=h.Rejected,this.error=c,this.rejectHandlers()):console.error("Error: Promise is already resolved")};e.prototype.resolveHandlers=function(){this.callResolveHandlers(this.firstPromise);this.firstPromise=null};e.prototype.callResolveHandlers=function(c){null!=c&&(this.callResolveHandlers(c.chainedPromise),null!=c.callback?c.tryResolve(c.callback,
this.value):c.resolve(this.value))};e.prototype.rejectHandlers=function(){this.callRejectHandlers(this.firstPromise);this.firstPromise=null};e.prototype.callRejectHandlers=function(c){null!=c&&(this.callRejectHandlers(c.chainedPromise),null!=c.errback?c.tryResolve(c.errback,this.error):c.reject(this.error))};return e}()})},"esri/views/3d/layers/i3s/I3SIndexTraversal":function(){define(["require","exports","../../support/PromiseLightweight","./GoogPriorityQueue","./I3SUtil"],function(s,q,n,k,h){return function(){function e(c,
b,e,f,a,h,k,d,m,p,n,q,s){void 0===s&&(s={initDepthFirst:!0,neighborhood:!0,perLevelTraversal:!1});this.baseURL=c;this.startNodeUrl=b;this.rootId=e;this.poi=f;this.nodeIndex=a;this.streamDataSupplier=h;this.viewportQueries=k;this.processNodeIndexDocument=d;this.finishedLevelCallback=m;this.debugVis=p;this.warningEvent=n;this._addTrailingSlash=q;this.traversalOptions=s;this.queues=[];this.knownNodes=new Set;this.dataLoadingPerLevel=[];this.numIndicesLoading=this.currentLevel=0;this.cancelled=this.queueTraversalEnabled=
!1}e.prototype.start=function(){var c=this;this._nodeTraversalState={};this._nodeIsVisibleCached={};this.dataLoadingPerLevel=[];this.currentLevel=0;this.rootUrl=h.concatUrl(this.baseURL,this.startNodeUrl);this._addTrailingSlash&&(this.rootUrl=h.addTrailingSlash(this.rootUrl));this.traversalOptions.initDepthFirst?(this.initPromise=new n.Promise,this.getNode(this.rootUrl,this.rootId,this.initQueryCallback.bind(this),this.initQueryErrback.bind(this)),this.initPromise.then(function(){c.cancelled||(c.queueTraversalEnabled=
!0)})):(this.enqueue(0,{id:this.rootId,hrefConcat:this.rootUrl},0),this.queueTraversalEnabled=!0)};e.prototype.initQueryErrback=function(){this.initPromise.done()};e.prototype.continueTraversal=function(c){var b=this;if(this.queueTraversalEnabled){c=null==c?5:c;for(var e=0;e<this.queues.length;e++)if(!(this.traversalOptions.perLevelTraversal&&this.currentLevel!==e)){for(var f=this.queues[e];0<c--&&!f.isEmpty();)(function(a){var c=b.queues[a].dequeue();b.dataLoadingPerLevel[a]++;var e=function(){b.dataLoadingPerLevel[a]--};
b.getNode(c.hrefConcat,c.id,function(c,f){null==f.parentNode?(b.nodeTraversalState(f.id),b.enqueueConnected(c,f,a),b.processNodeIndexDocument(f,void 0).then(e,e)):b.getNode(b.concatHref(f.parentNode,c),f.parentNode.id,function(g,h){b.nodeTraversalState(f.id);b.enqueueConnected(c,f,a);b.processNodeIndexDocument(f,h).then(e,e)})},e)})(e);this.traversalOptions.perLevelTraversal&&(f.isEmpty()&&0===this.dataLoadingPerLevel[e])&&(this.finishedLevelCallback.call(null,this.currentLevel),this.currentLevel++)}}};
e.prototype.isQueueTraversalEnabled=function(){return this.queueTraversalEnabled};e.prototype.getQueueSize=function(){for(var c=0,b=0;b<this.queues.length;b++)c+=this.queues[b].getCount();return c};e.prototype.cancel=function(){this.queueTraversalEnabled=!1;for(var c=0;c<this.queues.length;c++)this.queues[c].clear();this.cancelled=!0};e.prototype.isLoading=function(){return 0<this.numIndicesLoading||0<this.getQueueSize()};e.prototype.nodeIsVisible=function(c){if(null!=this._nodeIsVisibleCached[c.id])return this._nodeIsVisibleCached[c.id];
this._nodeIsVisibleCached[c.id]=this.viewportQueries.isNodeVisible(c);return this._nodeIsVisibleCached[c.id]};e.prototype.nodeTraversalState=function(c){if(null!=this._nodeTraversalState[c])return this._nodeTraversalState[c];var b=this.nodeIndex[c];if(null==b)return null;var e=null,f=!1;if(null!=b.parentNode){e=this.nodeIndex[b.parentNode.id];if(null==e)return null;var a=this._nodeTraversalState[e.id];null!=a&&(f=a.nodeIsTooHighLOD)}var a=this.viewportQueries.hasLOD(b),h=this.viewportQueries.isTooHighLOD(b),
e=this.viewportQueries.isChosenLOD(b,e,h,f);this._nodeTraversalState[b.id]={visited:!0,nodeHasLOD:a,nodeIsTooHighLOD:h,isChosenLOD:e};return this._nodeTraversalState[c]};e.prototype.getNode=function(c,b,e,f){var a=this;this.numIndicesLoading++;this.nodeIndex[b]?(e(c,this.nodeIndex[b]),this.numIndicesLoading--):this.streamDataSupplier.request(c,"json").then(function(b,c){a.nodeIndex[c.id]=c;c.baseUrl=b;e(b,c);a.numIndicesLoading--},function(b){null!=f&&f(b);a.loadErrorCallback(c);a.numIndicesLoading--})};
e.prototype.initQueryCallback=function(c,b){if(this.cancelled)this.initPromise.done();else if(this.nodeTraversalState(b.id),this.enqueueConnected(c,b,0),this.isLeafNode(b))this.initPromise.done();else{for(var e=1E9,f=void 0,a=0;a<b.children.length;++a){var k=b.children[a];if(this.nodeIsVisible(k)&&(!this.viewportQueries.hasLOD(b)||!this.viewportQueries.isTooHighLOD(b))){var l=this.viewportQueries.distToPOI(k,this.poi);l<e&&(e=l,f=k)}}f?(e=h.concatUrl(c,f.href),this._addTrailingSlash&&(e=h.addTrailingSlash(e)),
this.getNode(e,f.id,this.initQueryCallback.bind(this),this.initQueryErrback.bind(this))):this.initPromise.done()}};e.prototype.isLeafNode=function(c){return null==c.children};e.prototype.concatHref=function(c,b){var e=h.concatUrl(b,c.href);this._addTrailingSlash&&(e=h.addTrailingSlash(e));return e};e.prototype.enqueue=function(c,b,e){this.traversalOptions.perLevelTraversal||(e=0);for(this.knownNodes.add(b.id);this.queues.length<=e;)this.queues.push(new k.goog.structs.PriorityQueue),this.dataLoadingPerLevel.push(0);
this.queues[e].enqueue(c,b)};e.prototype.enqueueConnected=function(c,b,e){if(!this.cancelled&&null!=b){var f=this.nodeTraversalState(b.id);if(b.id!==this.rootId&&null!=b.parentNode&&!this.knownNodes.has(b.parentNode.id)){var a={id:b.parentNode.id,hrefConcat:this.concatHref(b.parentNode,c)};this.enqueue(this.viewportQueries.distToPOI(b.parentNode,this.poi),a,e-1)}else b.id===this.rootId&&(!this.knownNodes.has(b.id)&&this.nodeIsVisible(b))&&this.enqueue(this.viewportQueries.distToPOI(b,this.poi),{id:b.id,
hrefConcat:c},e);if(b.children)for(var h=0,k=b.children;h<k.length;h++){var d=k[h],a=this.nodeIsVisible(d);if(!this.knownNodes.has(d.id)&&(!f.nodeHasLOD||!f.nodeIsTooHighLOD)&&a)a={id:d.id,hrefConcat:this.concatHref(d,c)},this.enqueue(this.viewportQueries.distToPOI(d,this.poi),a,e+1)}if(this.traversalOptions.neighborhood&&b.neighbors){f=0;for(b=b.neighbors;f<b.length;f++)h=b[f],a=this.nodeIsVisible(h),!this.knownNodes.has(h.id)&&a&&(a={id:h.id,hrefConcat:this.concatHref(h,c)},this.enqueue(this.viewportQueries.distToPOI(h,
this.poi),a,e))}}};e.prototype.loadErrorCallback=function(c){console.log("Error loading "+c);this.rootUrl===c&&this.warningEvent("Error loading root node "+c,1)};return e}()})},"esri/views/3d/layers/i3s/GoogPriorityQueue":function(){define([],function(){var s={};(function(){function q(b){var a=typeof b;if("object"==a)if(b){if(b instanceof Array)return"array";if(b instanceof Object)return a;var c=Object.prototype.toString.call(b);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==
typeof b.length&&"undefined"!=typeof b.splice&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof b.call&&"undefined"!=typeof b.propertyIsEnumerable&&!b.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==a&&"undefined"==typeof b.call)return"object";return a}function n(b,a){var c=b.split("."),e=g;c[0]in e||!e.execScript||e.execScript("var "+c[0]);for(var d;c.length&&(d=c.shift());)c.length||
void 0===a?e=e[d]?e[d]:e[d]={}:e[d]=a}function k(b,a){this.d=b;this.b=a}function h(b){if("array"!=q(b))for(var a=b.length-1;0<=a;a--)delete b[a];b.length=0}function e(b){this.a=[];if(b)a:{var a,g;if(b instanceof e){a=b.a;g=[];for(var h=a.length,d=0;d<h;d++)g.push(a[d].getKey());a=g;g=b.a;for(var h=[],d=g.length,m=0;m<d;m++)h.push(g[m].b);g=h;if(0>=b.a.length){b=this.a;for(h=0;h<a.length;h++)b.push(new k(a[h],g[h]));break a}}else{a=[];h=0;for(d in b)a[h++]=d;h=[];d=0;for(g in b)h[d++]=b[g];g=h}for(h=
0;h<a.length;h++)c(this,a[h],g[h])}}function c(b,a,c){var e=b.a;e.push(new k(a,c));a=e.length-1;b=b.a;for(c=b[a];0<a;)if(e=a-1>>1,b[e].getKey()>c.getKey())b[a]=b[e],a=e;else break;b[a]=c}function b(){e.call(this)}var g=this;k.prototype.getKey=function(){return this.d};k.prototype.c=function(){return new k(this.d,this.b)};e.prototype.remove=function(){var b=this.a,a=b.length,c=b[0];if(!(0>=a)){if(1==a)h(b);else{b[0]=b.pop();for(var b=0,a=this.a,e=a.length,d=a[b];b<e>>1;){var g=2*b+1,k=2*b+2,g=k<e&&
a[k].getKey()<a[g].getKey()?k:g;if(a[g].getKey()>d.getKey())break;a[b]=a[g];b=g}a[b]=d}return c.b}};e.prototype.c=function(){return new e(this)};e.prototype.g=function(){return this.a.length};e.prototype.h=function(){return 0==this.a.length};e.prototype.clear=function(){h(this.a)};(function(){function c(){}var a=e;c.prototype=a.prototype;b.i=a.prototype;b.prototype=new c})();b.prototype.f=function(b,a){c(this,b,a)};b.prototype.e=function(){return this.remove()};n("goog.structs.PriorityQueue",b);n("goog.structs.PriorityQueue.prototype.enqueue",
b.prototype.f);n("goog.structs.PriorityQueue.prototype.dequeue",b.prototype.e);n("goog.structs.PriorityQueue.prototype.isEmpty",b.prototype.h);n("goog.structs.PriorityQueue.prototype.clear",b.prototype.clear);n("goog.structs.PriorityQueue.prototype.clone",b.prototype.c);n("goog.structs.PriorityQueue.prototype.getCount",b.prototype.g)}).call(s);return s})},"esri/views/3d/layers/i3s/I3SLodHandling":function(){define(["require","exports"],function(s,q){return function(){function n(k,h){this.layerViewRequiredFunctions=
k;this.layerViewOptionalFunctions=h;this._lodSwapNodeIndex={};this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={}}n.prototype.startNodeLoading=function(k,h,e,c,b,g){this._lodGlobalDirty=!1;this._lodMode=e;this._lodSwapNodeIndex={};this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={};this._nodeIndex=c;this._rootId=g;this._nodeTraversalState=h;this._nodeIsVisible=k;if("swap"===this._lodMode){for(var f in b)k=b[f],this._nodeTraversalState(k.id).nodeHasLOD&&!this._nodeTraversalState(k.id).isChosenLOD&&
(this._lodSwapNodeIndex[f]=k);this._lodSwapBuildUnmatchingFeatureLookups()}};n.prototype.cancelNodeLoading=function(){this._lodSwapNodeIndex={}};n.prototype.shouldLoadNode=function(k,h){var e=this._nodeTraversalState(k.id),c=e.nodeHasLOD,e=e.isChosenLOD;return"perLevel"!==this._lodMode?e||!c:e||!c?!0:this.layerViewOptionalFunctions.traversalOptions.allowPartialOverlaps?this._someSubtreesIncomplete(k):this._allSubtreesIncomplete(k)};n.prototype.shouldSetPolygonOffset=function(k){return"perLevel"===
this._lodMode?!this._nodeTraversalState(k.id).isChosenLOD:!1};n.prototype._allSubtreesIncomplete=function(k){if(this.layerViewRequiredFunctions.areAllBundlesLoaded(k))return!1;var h=!0;if(null!=k.children)for(var e=0;e<k.children.length;++e){var c=k.children[e];this._nodeIsVisible(c)&&(c=this._nodeIndex[c.id],h=h&&(null==c||this._allSubtreesIncomplete(c)))}return h};n.prototype._someSubtreesIncomplete=function(k){if(this.layerViewRequiredFunctions.areAllBundlesLoaded(k))return!1;var h=!1;if(null!=
k.children)for(var e=0;e<k.children.length;++e){var c=k.children[e];this._nodeIsVisible(c)&&(c=this._nodeIndex[c.id],h=h||null==c||this._allSubtreesIncomplete(c))}return h};n.prototype.setLodGlobalDirty=function(){this._lodGlobalDirty=!0};n.prototype.finishedLevel=function(k){"perLevel"===this._lodMode&&this._deleteUpToLevelRecurse(k-1,0,this._nodeIndex[this._rootId])};n.prototype._deleteUpToLevelRecurse=function(k,h,e){if(null!=e&&!(h>k)&&(this._nodeTraversalState(e.id).isChosenLOD||this.layerViewRequiredFunctions.removeNodeData(e),
null!=e.children))for(var c=0;c<e.children.length;++c)this._deleteUpToLevelRecurse(k,h+1,this._nodeIndex[e.children[c].id])};n.prototype.lodSwapBundleLoaded=function(k,h,e){if(null!=e)if(null!=e.swapPairs&&0<Object.keys(e.swapPairs).length){if(null!=h){k=e.swapPairs;e={};for(var c=0;c<h.length;c++)for(var b=h[c].features,g=0;g<b.length;g++)e[b[g].id]=!0;for(var f in k){h=k[f];c=[];b=h.features;for(g=0;g<b.length;g++)null!=e[b[g]]&&c.push(b[g]);this.layerViewRequiredFunctions.removeFeatures(h.node,
h.features)}}}else{for(c in e.nodesHigherInTree)this.layerViewRequiredFunctions.removeNodeData(e.nodesHigherInTree[c]);for(c in e.nodesDeeperInTree)this.layerViewRequiredFunctions.removeNodeData(e.nodesDeeperInTree[c])}this._lodGlobalDirty=!0};n.prototype.lodGlobalHandling=function(){if("global"===this._lodMode&&(!0===this._lodGlobalDirty||this.layerViewRequiredFunctions.isOverMemory())){var k=this._rootId;null!=k&&(this._lodGlobalHandlingRecursion({id:k,mbs:null},this._nodeIndex,!1,!1,0),this._lodGlobalHandlingRecursionRemoveIntermediate(k,
this._nodeIndex,!1,0),this._lodGlobalDirty=!1)}};n.prototype.lodSwapBuildInfoForNode=function(k){if(!this._nodeTraversalState(k.id).nodeHasLOD)return null;if("swap"===this._lodMode){var h={},e={},c=!1,b=!1,g=k.id+"",f;for(f in this._lodSwapNodeIndex){var a=this._lodSwapNodeIndex[f];null!=this.layerViewRequiredFunctions.getAddedFeatures(a.id)&&(c=null===k.parentNode||0===(a.id+"").indexOf(g),b=null==a.parentNode||0===g.indexOf(a.id+""),!0===b&&(e[a.id]=a),!0===c&&(h[a.id]=a))}return{nodesHigherInTree:e,
nodesDeeperInTree:h}}if("perLevel"===this._lodMode&&this._nodeTraversalState(k.id).isChosenLOD)return h={},this._getNodesRecurse(k,h),{nodesHigherInTree:null,nodesDeeperInTree:h}};n.prototype._getNodesRecurse=function(k,h){if(null!=k.children)for(var e=0;e<k.children.length;++e){var c=k.children[e],b=this._nodeIndex[c.id];null!=b&&(h[c.id]=b,this._getNodesRecurse(b,h))}};n.prototype._lodSwapBuildUnmatchingFeatureLookups=function(){this._lodSwapFeatureLookup={};this._lodSwapRootFeatureLookup={};for(var k in this._lodSwapNodeIndex){var h=
this._lodSwapNodeIndex[k],e=this.layerViewRequiredFunctions.getAddedFeatures(h.id);if(null!=e)for(var c=0;c<e.length;c++){var b=e[c];this._lodSwapFeatureLookup[b.id]=h;null!=b.rootFeature&&(null==this._lodSwapRootFeatureLookup[b.rootFeature]&&(this._lodSwapRootFeatureLookup[b.rootFeature]=[]),this._lodSwapRootFeatureLookup[b.rootFeature].push({node:h,featureId:b.id}))}}};n.prototype._validateLodTreeVisibilities=function(){if(null!=this.layerViewOptionalFunctions.getAllAddedFeatures){var k=this.layerViewOptionalFunctions.getAllAddedFeatures();
console.debug("validating lod tree: ");var h={},e={},c=!0,b;for(b in k)for(var g=k[b],f=0;f<g.length;f++){var a=g[f];null!=h[a.id]&&h[a.id]!==b&&(console.debug("node "+b+" !! encountered feature "+a.id+" already in node "+h[a.id]),c=!1);null!=e[a.id]&&e[a.id]!==b&&(console.debug("node "+b+" !! encountered feature "+a.id+" already as rootFeature in node "+e[a.id]),c=!1);h[a.id]=b;null!=a.rootFeature&&e[a.rootFeature]!==b&&(null!=e[a.rootFeature]&&(console.debug("node "+b+" !! encountered rootFeature "+
a.rootFeature+" already in node "+e[a.rootFeature]),c=!1),null!=h[a.rootFeature]&&(console.debug("node "+b+" !! encountered rootFeature "+a.rootFeature+" already as feature"),c=!1),e[a.rootFeature]=b)}return c}};n.prototype._lodGlobalHandlingRecursion=function(k,h,e,c,b){var g=k.id,f=h[g];if(null==f)return e=null!=k.mbs?this._nodeIsVisible(k):!1,c||!e;g=this._nodeTraversalState(g);k=this._nodeIsVisible(f);var g=g.isChosenLOD,a=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(f,0).alreadyLoaded,
n=!0;if(null!=f.children)for(var l=0;l<f.children.length;++l)this._lodGlobalHandlingRecursion(f.children[l],h,a&&g||e,g||c,b+1)||(n=!1);h=this.layerViewRequiredFunctions.isOverMemory();if(a&&!g&&((c?e:n)||h))this.setLodGlobalDirty(),this.layerViewRequiredFunctions.removeNodeData(f),a=!1;a&&this.layerViewOptionalFunctions.setPolygonOffset&&this.layerViewOptionalFunctions.setPolygonOffset(f,!(g&&!c));e=n||a;if(g&&a||!k||c)e=!0;g&&(!a&&k)&&(e=!1);return e};n.prototype._lodGlobalHandlingRecursionRemoveIntermediate=
function(k,h,e,c){var b=h[k];if(null!=b){var g=this.layerViewRequiredFunctions.isBundleAlreadyAddedToStage(b,0).alreadyLoaded;k=this._nodeTraversalState(k).isChosenLOD;if(null!=b.children)for(var f=0;f<b.children.length;++f)this._lodGlobalHandlingRecursionRemoveIntermediate(b.children[f].id,h,g||e,c+1);e&&(!k&&g)&&(this.layerViewRequiredFunctions.removeNodeData(b),this.setLodGlobalDirty())}};return n}()})},"esri/views/3d/layers/i3s/I3SViewportQueries":function(){define("require exports ../../lib/glMatrix ./I3SUtil ../../webgl-engine/lib/Util ../../support/projectionUtils ../graphics/Graphics3DSymbolCommonCode ../../../../geometry/Point".split(" "),
function(s,q,n,k,h,e,c,b){var g=n.vec3d,f=n.vec4d;return function(){function a(a,c,d,e,k,n,q,s){void 0===s&&(s={});this.indexSR=a;this.renderCoordsHelper=c;this.extent=e;this.errorMetric=k;this.elevationProvider=n;this.elevationInfo=q;this.options=s;this.fp=[];this._tmp1=[0,0,0];this._tmp2=[0,0,0];this._tmp3=[0,0,0];this._tmp0=[0,0,0];this.maxDistance=s.maxDistance||Number.MAX_VALUE;this.screenspaceErrorBias=s.screenspaceErrorBias||1;this.enableLoD=!1!==s.disableLod;for(e=0;8>e;++e)this.fp[e]=f.create();
h.matrix2frustumPlanes(d.viewMatrix,d.projectionMatrix,this.fp);this.engineSR=c.spatialReference;this._screenSizeFactor=1/d.perPixelRatio;this._camPos=d.eye;this._center=d.center;this._camDir=g.subtract(this._center,this._camPos,[0,0,0]);g.normalize(this._camDir);this.tmpPoint=new b({x:0,y:0,z:0,spatialReference:a})}a.prototype.computedMbs=function(a){a.computedMbs||(a.computedMbs=f.create(),a.computedMbs[3]=-1);var b=a.computedMbs;0>b[3]&&(b[0]=a.mbs[0],b[1]=a.mbs[1],b[2]=a.mbs[2],b[3]=a.mbs[3],
this.elevationProvider&&(this.tmpPoint.x=b[0],this.tmpPoint.y=b[1],this.tmpPoint.z=b[2],b[2]=c.computeElevation(this.elevationProvider,this.tmpPoint,this.elevationInfo)),e.mbsToMbs(b,this.indexSR,b,this.engineSR));return b};a.prototype.isNodeVisible=function(a){a=this.computedMbs(a);return this.isMBSinExtent(a)&&this.isMBSVisible(a)};a.prototype.isMBSinExtent=function(a){return!this.extent?!0:0!==k.intersectBoundingBoxWithMbs(this.extent,a)};a.prototype.isMBSVisible=function(a){var b=a[0],c=a[1],
e=a[2];a=a[3];var f=this.fp;return f[0][0]*b+f[0][1]*c+f[0][2]*e+f[0][3]<=a&&f[1][0]*b+f[1][1]*c+f[1][2]*e+f[1][3]<=a&&f[2][0]*b+f[2][1]*c+f[2][2]*e+f[2][3]<=a&&f[3][0]*b+f[3][1]*c+f[3][2]*e+f[3][3]<=a&&f[4][0]*b+f[4][1]*c+f[4][2]*e+f[4][3]<=a&&f[5][0]*b+f[5][1]*c+f[5][2]*e+f[5][3]<=a};a.prototype.calcScreenSpaceSize=function(a,b){var c=this.computedMbs(a),e=c[3],c=g.dist2(c,this._camPos)-e*e;return 0>c?0.5*Number.MAX_VALUE:b/Math.sqrt(c)*this._screenSizeFactor};a.prototype.calcAngleDependentLoD=
function(a){a=this.computedMbs(a);var b=a[3];a=(Math.abs(a[0]*(a[0]-this._camPos[0])+a[1]*(a[1]-this._camPos[1])+a[2]*(a[2]-this._camPos[2]))/g.length(a)+b)/g.dist(a,this._camPos);return Math.min(1,a)};a.prototype.hasLOD=function(a){return this.enableLoD&&void 0!==a.lodSelection||void 0!==a.precision};a.prototype.hasFeatures=function(a){return null!=a.features&&0<a.features.length||null!=a.featureData};a.prototype.getDistancePlanarMode=function(a,b,c){var e=a[0]-b[0],f=a[1]-b[1];a=a[2]-b[2];e=e+e+
f*f;if(e<=c*c)return Math.abs(a);c=Math.sqrt(e)-c;return Math.sqrt(a*a+c*c)};a.prototype.getDistanceGlobeMode=function(a,b,c){var e=g.length(b),f=g.length(a)-e;g.scale(a,g.dot(a,b)/g.length2(a),this._tmp0);if(g.dist2(b,this._tmp0)<=c*c)return Math.abs(f);b=g.scale(b,1/e,this._tmp0);var e=g.scale(b,e-c*c/2/e,this._tmp1),h=g.subtract(a,e,this._tmp2),h=g.subtract(h,g.scale(b,g.dot(b,h),this._tmp3),this._tmp2),e=g.add(e,g.scale(h,c/g.length(h),this._tmp2),this._tmp2);c=g.dist(a,e);2E5<=f&&(a=g.subtract(a,
e,this._tmp1),a=g.dot(a,b)/g.length(a),0.08>a&&(a=1E-4),c/=a);return c};a.prototype.getDistance=function(a,b,c){return this.engineSR===e.SphericalRenderSpatialReference?this.getDistanceGlobeMode(a,b,c):this.getDistancePlanarMode(a,b,c)};a.prototype.isTooHighLOD=function(a){if(a.lodSelection&&0<a.lodSelection.length){if(!1===this.hasFeatures(a))return!1;for(var b=0;b<a.lodSelection.length;b++){var c=a.lodSelection[b];if(!(null!=this.errorMetric&&c.metricType!==this.errorMetric)){if("screenSpaceRelative"===
c.metricType)return a=this.computedMbs(a),a=2*this.getDistance(this._camPos,a,a[3])/this._screenSizeFactor,c.maxError<=a;if("maxScreenThreshold"===c.metricType)return b=this.calcScreenSpaceSize(a,a.mbs[3]),this.options.angleDependentLoD&&(b*=this.calcAngleDependentLoD(a)),b*this.screenspaceErrorBias<c.maxError;if("removedFeatureDiameter"===c.metricType)return 10>this.calcScreenSpaceSize(a,c.maxError)*this.screenspaceErrorBias}}}return!1};a.prototype.isChosenLOD=function(a,b,c,e){return a.lodSelection&&
0<a.lodSelection.length?(c=null!=c?c:this.isTooHighLOD(a),b=!b?!1:null!=e?e:this.isTooHighLOD(b),(c||!a.children)&&!b):!0};a.prototype.distToPOI=function(a,b){var c=this.computedMbs(a);return g.dist(c,b)-c[3]};return a}()})},"esri/layers/SceneLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/declare ./Layer ./FeatureLayer ./support/Field ./support/LabelClass ./mixins/PortalLayer ../PopupTemplate ../request ../core/lang ../core/jsonDictionary ../core/MultiOriginJSONSupport ../core/urlUtils ../core/requireUtils ../core/promiseUtils ../core/Error ../geometry/Extent ../geometry/SpatialReference ../renderers/support/jsonUtils ../portal/PortalItem dojo/_base/lang dojo/io-query dojo/promise/all ./support/arcgisLayerURL".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u,z,w,C,A,y,B,D){var F=d({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",absoluteHeight:"absolute-height"}),H={"features-points":"esriGeometryPoint","features-lines":"esriGeometryPolyline","features-polygons":"esriGeometryPolygon"};return function(d){function e(a,b){d.call(this);this.copyright=null;this.popupEnabled=!0;this.layerId=null;this.version={major:0,minor:0,versionString:""};this.elevationInfo=this.fullExtent=this.fields=null;
this.labelsVisible=!1;this.labelingInfo=null;this.legendEnabled=!0;this.renderer=null;this.cachedDrawingInfo={color:!1};this.objectIdField=this.popupTemplate=this.spatialReference=null;this.titleIncludesUrl=!0;this.blendMode=this.title=null;this._alreadyIssuedWarnings={};this._canUseXhr=null;this._addTrailingSlash=!1;this._popupSource={popupEnabled:"none",popupTemplate:"none"}}n(e,d);e.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?A.mixin({},{url:a},b):a};e.prototype.readCopyright=
function(a,b){return b.copyrightText};e.prototype.readPopupEnabled=function(a,b){return null!=b.disablePopup?(this._popupSource.popupEnabled="service",!b.disablePopup):!0};e.prototype.readLayerId=function(a,b){return b.id};e.prototype.readVersion=function(a,b){var c=b.store;if("string"===typeof c.version){var c={major:0,minor:0,versionString:c.version},d=c.versionString.split(".");2<=d.length&&(c.major=parseInt(d[0],10),c.minor=parseInt(d[1],10));return c}return null};e.prototype.readFields=function(a){this._fieldsSource=
"service";return a.map(b.fromJSON)};e.prototype.readFullExtent=function(a,b){var c=b.store,d=c.indexCRS||c.geographicCRS,d=d&&parseInt(d.substring(d.lastIndexOf("/")+1,d.length),10);return null==c||null==c.extent?null:new u({xmin:c.extent[0],ymin:c.extent[1],xmax:c.extent[2],ymax:c.extent[3],spatialReference:d})};e.prototype.readElevationInfo=function(a){a=l.clone(a);a.mode=F.fromJSON(a.mode);return a};Object.defineProperty(e.prototype,"geometryType",{get:function(){return H[this.profile]||"esriGeometryMesh"},
enumerable:!0,configurable:!0});e.prototype.readLabelsVisible=function(a,b){return b.showLabels};e.prototype.readLabelingInfo=function(a,b){var c=this;a=b.drawingInfo.labelingInfo;if(!a)return null;var d=/\[([^\[\]]+)\]/ig;return a.map(function(a){a=g.fromJSON(a);var b=a.labelExpression;b&&(a.labelExpression=b.replace(d,function(a,b){var d=c.getField(b);return"["+(d&&d.name||b)+"]"}));return a})};e.prototype.readLegendEnabled=function(a,b){return null!=b.showLegend?b.showLegend:!0};e.prototype.readRenderer=
function(a,b){(a=b.drawingInfo.renderer)&&(a=w.fromJSON(a));return a};e.prototype.readCachedDrawingInfo=function(a,b){if(null==a||"object"!==typeof a)a={};null==a.color&&(a.color=!1);return a};e.prototype.readSpatialReference=function(a,b){if(null!=b.spatialReference)return z.fromJSON(b.spatialReference);var c=b.store,c=(c=c.indexCRS||c.geographicCRS)&&parseInt(c.substring(c.lastIndexOf("/")+1,c.length),10);return null!=c?new z(c):null};Object.defineProperty(e.prototype,"url",{set:function(a){var b=
p.urlToObject(a),c=D.parse(b.path);c&&null!=c.sublayer&&(this.layerId=c.sublayer,b=y.objectToQuery(b.query),a=c.url.path,b&&(a=a+"?"+b));this._set("url",a)},enumerable:!0,configurable:!0});e.prototype.readPopupTemplate=function(b,c){c.popupInfo&&(this._popupSource.popupTemplate="service");return c.popupInfo&&a.fromJSON(c.popupInfo)};e.prototype.readObjectIdField=function(a,b){!a&&b.fields&&b.fields.some(function(b){"esriFieldTypeOID"===b.type&&(a=b.name);return!!a});return a};e.prototype.readProfile=
function(a,b){return b.store.profile};e.prototype.readRootNode=function(a,b){return b.store.rootNode};e.prototype.readTitle=function(a,b){if(null!=a)return a;var c=[];if(this.titleIncludesUrl){var d=D.parse(this.parsedUrl.path);d&&d.title&&c.push(d.title)}b.name&&(d=D.cleanTitle(b.name),(0===c.length||-1===c[0].toLowerCase().indexOf(d.toLowerCase()))&&c.push(d));return c.join(" - ")};Object.defineProperty(e.prototype,"parsedUrl",{get:function(){var a=this._get("url");if(!a)return null;a=p.urlToObject(a);
null!=this.layerId&&D.match.test(a.path)&&(a.path=a.path+"/layers/"+this.layerId);return a},enumerable:!0,configurable:!0});e.prototype.load=function(){var a=this,b=this.loadFromPortal(function(){return a._fetchService()}).then(function(){return B([a._verifyRootNode(),a._setCompanionFeatureLayer()])});this.addResolvingPromise(b);return this};e.prototype.createGraphicsController=function(a){var b=this;a.layer=this;a.addUrlTokenFunction=this._addUrlToken.bind(this);a.warningEvent=this.warningEvent.bind(this);
var c=t.when(s,"./graphics/controllers/I3SOnDemandController").then(function(b){return new b(a)});c.then(function(a){b.emit("graphics-controller-create",{graphicsController:a})});return c};e.prototype.createLayerView=function(a){var b=this,c=this.profile||"features-meshes";return t.when(s,"features-meshes"===c||"meshpyramids"===c?"../views/3d/layers/SceneLayerView3D":"../views/3d/layers/SceneLayerGraphicsView3D").then(function(c){return new c({view:a,layer:b})})};e.prototype.getField=function(a){return!this.companionFeatureLayer?
void 0:this.companionFeatureLayer.getField(a)};e.prototype.warningEvent=function(a,b){null==this._alreadyIssuedWarnings[a]&&(this._alreadyIssuedWarnings[a]=!0,this.emit("i3s-load-log",{type:1===b?"fatal":"warning",msg:a}),console.warn("i3s-load-log warningEvent severity "+b," message "+a))};e.prototype._readExtent=function(a){a=a.store;var b=a.indexCRS||a.geographicCRS,b=b&&parseInt(b.substring(b.lastIndexOf("/")+1,b.length),10);return null==a||null==a.extent?new u:new u({xmin:a.extent[0],ymin:a.extent[1],
xmax:a.extent[2],ymax:a.extent[3],spatialReference:b})};e.prototype._addUrlToken=function(a){var b=A.mixin({},this.parsedUrl.query,{token:this.token}),b=y.objectToQuery(b);a+=b?"?"+b:"";null==this._canUseXhr&&(this._canUseXhr=p.canUseXhr(a));return!this._canUseXhr?p.addProxy(a):a};e.prototype._fetchService=function(){var a=this;return null==this.layerId&&/SceneServer\/*$/i.test(this.url)?r(this._addUrlToken(this.url),{query:{f:"json"},responseType:"json"}).then(function(b){b.data&&(Array.isArray(b.data.layers)&&
0<b.data.layers.length)&&(a.layerId=b.data.layers[0].id);return a._fetchServiceLayer()}):this._fetchServiceLayer()};e.prototype._fetchServiceLayer=function(){var a=this;return r(this._addUrlToken(this.parsedUrl.path),{responseType:"json"}).then(function(b){b.ssl&&(a.url=a.url.replace(/^http:/i,"https:"));b=b.data;var c=b.store;null==c.indexCRS&&null==c.geographicCRS&&a.warningEvent("Input data invalid: layer.layerInfo.indexCRS is undefined.",1);a.read(b);if(1!==a.version.major)throw new v("scenelayer:version-not-supported",
"SceneLayer version is not supported.",{serviceVersion:c.serviceVersion,url:a.parsedUrl.path});})};e.prototype._verifyRootNode=function(){if(-1!==["meshpyramids","features-points"].indexOf(this.profile)){var a=p.join(this.parsedUrl.path,this.rootNode);return r(this._addUrlToken(a),{query:{f:"json"},responseType:"json"}).then(function(a){return a.data}).otherwise(function(b){throw new v("scenelayer:root-node-missing","Root node missing.",{error:b,url:a});})}};e.prototype._setCompanionFeatureLayer=
function(){var a=this;return this._fetchCompanionFeatureLayer().then(function(b){if(a.companionFeatureLayer=b)b.fields&&!a.fields&&a.__accessor__.setDefault("fields",b.fields.slice()),null!=b.popupTemplate&&("portal"!==a._popupSource.popupTemplate&&("portal"===b._popupSource.popupTemplate||"service"!==a._popupSource.popupTemplate))&&a.__accessor__.setDefault("popupTemplate",b.popupTemplate),null!=b.popupEnabled&&("portal"!==a._popupSource.popupEnabled&&("portal"===b._popupSource.popupEnabled||"service"!==
a._popupSource.popupEnabled))&&a.__accessor__.setDefault("popupEnabled",!!b.popupEnabled)})};e.prototype._fetchCompanionFeatureLayer=function(){var a=this;return-1===["meshpyramids","features-points"].indexOf(this.profile)?x.resolve(null):(this.portalItem&&this.portalItem.isResolved()?this._fetchCompanionFeatureLayerFromRelatedItems(this.portalItem):this._fetchCompanionFeatureLayerFromUrl()).then(function(a){a._popupSource={popupEnabled:null,popupTemplate:null};return a.load()}).otherwise(function(b){console.warn("Companion FeatureLayer could not be loaded. Popups will not work for this SceneLayer: "+
a.title);return null})};e.prototype._fetchCompanionFeatureLayerFromRelatedItems=function(a){var b=this;return a.fetchRelatedItems({relationshipType:"Service2Data",direction:"forward"}).then(function(a){return(a=a.filter(function(a){return"Feature Service"===a.type})[0])?b._fetchCompanionFeatureLayerFromPortalItem(new C({id:a.id,portal:a.portal})):b._fetchCompanionFeatureLayerFromUrl()})};e.prototype._fetchCompanionFeatureLayerFromPortalItem=function(a){var b=this;return a.load().then(function(a){return b._findMatchingCompanionSublayerUrl(a.url)}).then(function(b){return x.resolve(new c({url:b,
portalItem:a}))})};e.prototype._fetchCompanionFeatureLayerFromUrl=function(){return this._findMatchingCompanionSublayerUrl().then(function(a){return x.resolve(new c({url:a}))})};e.prototype._findMatchingCompanionSublayerUrl=function(a){var b=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);if(!b)return x.reject();null==a&&(a=b[1]+"/FeatureServer");var c=a.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1");a={query:{f:"json"},responseType:"json"};var d=b[1]+"/SceneServer",e=parseInt(b[2],
10),b=r(this._addUrlToken(d),a).otherwise(function(a){return{layers:null}});a=r(this._addUrlToken(c),a);return B([a,b]).then(function(a){var b=a[0];a=a[1];a=a.data&&a.data.layers;b=b.data&&b.data.layers;if(!Array.isArray(b))throw Error("expected layers array");if(Array.isArray(a))for(var d=0;d<Math.min(a.length,b.length);d++){if(a[d].id===e)return c+"/"+b[d].id}else if(e<b.length)return c+"/"+b[e].id;throw Error("could not find matching companion sublayer");})};k([h.shared("esri.layers.SceneLayer")],
e.prototype,"declaredClass",void 0);k([h.shared("portal/loaders/SceneLayerLoader")],e.prototype,"portalLoaderModule",void 0);k([h.shared({id:{json:{ignore:!0}}})],e.prototype,"properties",void 0);k([h.property({type:String})],e.prototype,"copyright",void 0);k([h.read("copyright",["copyrightText"])],e.prototype,"readCopyright",null);k([h.property({type:Boolean})],e.prototype,"popupEnabled",void 0);k([h.read("popupEnabled",["disablePopup"])],e.prototype,"readPopupEnabled",null);k([h.property({type:Number})],
e.prototype,"layerId",void 0);k([h.read("layerId",["id"])],e.prototype,"readLayerId",null);k([h.property({readOnly:!0})],e.prototype,"version",void 0);k([h.read("version",["store.version"])],e.prototype,"readVersion",null);k([h.property()],e.prototype,"fields",void 0);k([h.read("fields")],e.prototype,"readFields",null);k([h.property({readOnly:!0})],e.prototype,"attributeStorageInfo",void 0);k([h.property({type:u})],e.prototype,"fullExtent",void 0);k([h.read("fullExtent",["store.indexCRS","store.geographicCRS"])],
e.prototype,"readFullExtent",null);k([h.property()],e.prototype,"elevationInfo",void 0);k([h.read("elevationInfo")],e.prototype,"readElevationInfo",null);k([h.property({type:String,dependsOn:["profile"]})],e.prototype,"geometryType",null);k([h.property({type:Boolean})],e.prototype,"labelsVisible",void 0);k([h.read("labelsVisible",["showLabels"])],e.prototype,"readLabelsVisible",null);k([h.property()],e.prototype,"labelingInfo",void 0);k([h.read("labelingInfo",["drawingInfo.labelingInfo"])],e.prototype,
"readLabelingInfo",null);k([h.property({type:Boolean})],e.prototype,"legendEnabled",void 0);k([h.read("legendEnabled",["showLegend"])],e.prototype,"readLegendEnabled",null);k([h.property()],e.prototype,"renderer",void 0);k([h.read("renderer",["drawingInfo.renderer"])],e.prototype,"readRenderer",null);k([h.property()],e.prototype,"cachedDrawingInfo",void 0);k([h.read("cachedDrawingInfo")],e.prototype,"readCachedDrawingInfo",null);k([h.property({type:z})],e.prototype,"spatialReference",void 0);k([h.read("spatialReference",
["spatialReference","store.indexCRS","store.geographicCRS"])],e.prototype,"readSpatialReference",null);k([h.property()],e.prototype,"url",null);k([h.property()],e.prototype,"popupTemplate",void 0);k([h.read("popupTemplate",["popupInfo"])],e.prototype,"readPopupTemplate",null);k([h.property({type:String})],e.prototype,"objectIdField",void 0);k([h.read("objectIdField",["fields"])],e.prototype,"readObjectIdField",null);k([h.property({type:String})],e.prototype,"profile",void 0);k([h.read("profile",["store.profile"])],
e.prototype,"readProfile",null);k([h.property({type:String})],e.prototype,"rootNode",void 0);k([h.read("rootNode",["store.rootNode"])],e.prototype,"readRootNode",null);k([h.property({type:Boolean})],e.prototype,"titleIncludesUrl",void 0);k([h.property({type:String})],e.prototype,"title",void 0);k([h.read("title",["title","name"])],e.prototype,"readTitle",null);k([h.property({dependsOn:["layerId"]})],e.prototype,"parsedUrl",null);k([h.property()],e.prototype,"store",void 0);return e=k([h.subclass()],
e)}(h.declared(e,m,f))})},"esri/views/3d/layers/ElevationLayerView3D":function(){define(["../../../core/declare","../../../core/promiseUtils","../../../core/Error","./TiledLayerView3D"],function(s,q,n,k){return s(k,{declaredClass:"esri.views.3d.layers.ElevationLayerView3D",initialize:function(){var h=this.get("view.map.ground.layers");(!h||-1===h.indexOf(this.layer))&&this.addResolvingPromise(q.reject(new n("layerview:elevation-layer-only","3D elevation layer '"+this.layer.id+"' can only be added in the map ground")))},
isTransparent:function(){return!0}})})},"esri/views/3d/layers/TiledLayerView3D":function(){define("dojo/request/xhr ../../../core/declare ../../../core/watchUtils ../../../core/promiseUtils ../../../core/Error ../../layers/LayerView ../terrain/TilingScheme ../terrain/terrainUtils ./support/LayerViewUpdatingPercentage".split(" "),function(s,q,n,k,h,e,c,b,g){function f(a){if(!a)return!1;var b=-1!==a.indexOf(".arcgis.com/")||-1!==a.indexOf(".arcgisonline.com/");a=-1!==a.indexOf("//services")||-1!==a.indexOf("//tiles")||
-1!==a.indexOf("//features");return b&&a}function a(a){var b=null,c=a.search(/\/rest\/services\//i);0<c&&(b=a.substring(0,c+6));return b}return q([e,g],{declaredClass:"esri.views.3d.layers.TiledLayerView3D",_numUpdating:0,_maxNumUpdating:0,minDataLevel:0,maxDataLevel:Infinity,initialize:function(){var a=this.layer.tileInfo,e=c.checkUnsupported(a);e&&this.addResolvingPromise(k.reject(e));e=n.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){if(!this.view.basemapTerrain.tilingScheme.compatibleWith(a)){var b=
new h("tiledlayerview3d:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface");return k.reject(b)}}.bind(this));this.addResolvingPromise(e);var d=Infinity,f=0;a.lods.forEach(function(a){d=Math.min(a.level,d);f=Math.max(a.level,f)});f=Math.min(f,b.getKnownTiledServiceLevelCap(this.layer.url));this.minDataLevel=d;this.maxDataLevel=f},getTileUrl:function(a,b,c){return this.layer.getTileUrl(a,b,c)},isTransparent:function(){return this.layer.tileInfo&&
"JPEG"!==this.layer.tileInfo.format},_checkServiceVersionCompatibility:function(){if(!f(this.layer.url))if(10.22>this.layer.version){var b=new h("tiledlayerview3d:service-version-not-supported","Tiled Map Layers on servers prior to 10.2.2 are not supported. Detected version: "+this.layer.version,"service-too-old");this.addResolvingPromise(k.reject(b))}else if(10.22===this.layer.version){var b=a(this.layer.url),c=new h("tiledlayerview3d:service-version-not-supported","Tiled Map Layers from 10.2.2 servers are only supported if all server updates have been applied.",
"cors-patch-missing"),b=s(b+"self?f\x3djson",{headers:{"X-Requested-With":null},timeout:1E4,handleAs:"json"}).then(function(a){if(!a||a.error)throw c;}).otherwise(function(){throw c;});this.addResolvingPromise(b)}}})})},"esri/views/3d/layers/support/LayerViewUpdatingPercentage":function(){define(["../../../../core/declare"],function(s){return s([],{classMetadata:{properties:{updatingPercentage:{dependsOn:["updating"]}}},constructor:function(){this._updatingPercentage=0},_updatingPercentageGetter:function(){return this.updating?
this._updatingPercentage:0},_updatingPercentageSetter:function(q){this._updatingPercentage=q}})})},"esri/views/3d/layers/GraphicsLayerView3D":function(){define("../../../core/declare dojo/promise/all dojo/Deferred dojo/_base/lang dojo/io-query ../../../config ../../../layers/support/LabelClass ../../../core/urlUtils ../../../core/watchUtils ../../../geometry/support/webMercatorUtils ../../../geometry/support/scaleUtils ../../layers/GraphicsLayerView ../../../layers/graphics/controllers/SnapshotController ../../../geometry/SpatialReference ../../../geometry/Extent ../../../processors/SpatialIndex ./graphics/SymbolConverter ./graphics/TextureCollection ./graphics/Graphics3DSymbol ./graphics/Graphics3DGraphic ./graphics/graphicUtils ./support/LayerViewUpdatingPercentage ../support/ResourceController ../lib/glMatrix ../support/earthUtils ../support/projectionUtils ../support/intersectionUtils ../webgl-engine/Stage ../webgl-engine/lib/Util ../webgl-engine/lib/Layer ../webgl-engine/lib/FloatingBoxLocalOriginFactory ../webgl-engine/materials/HUDMaterial ../support/PromiseLightweight ../webgl-engine/lib/TextTextureAtlas ../webgl-engine/lib/MaterialCollection ../../../core/arrayUtils".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u,z,w,C,A,y,B,D,F,H,N,G,O,M,I,Z,V){var L=function(a){a.remove()},Y=-0.3*y.earthRadius,E=0.5*y.earthRadius*Math.PI,ba=0.9*y.earthRadius,W=A.vec4d,R=A.vec3d,T=R.create();s=s([r,w],{declaredClass:"esri.views.3d.layers.GraphicsLayerView3D",supportsDraping:!0,hasDraped:!1,drawingOrder:0,"symbols-updating":!1,_progressMaxNumNodes:1,updateElevation:!0,_overlayUpdating:!1,initialize:function(){this._stage=this.view._stage;this._stageLayer=new N(this.layer.id,
{state:this.suspended?"HIDDEN":"VISIBLE"},this.layer.id);this._stage.add(F.ModelContentType.LAYER,this._stageLayer);this._labelStageLayer=new N(this.layer.id,{state:this.suspended?"HIDDEN":"IGNORED"},this.layer.id+"_labels");this._stage.add(F.ModelContentType.LAYER,this._labelStageLayer);this._stage.addToViewContent([this._stageLayer.getId(),this._labelStageLayer.getId()]);this.view.labelManager.addSceneServiceLayerView(this);this._streamDataSupplier=this.view.resourceController.registerClient(this,
C.ClientType.SYMBOLOGY,this._addUrlToken.bind(this));this._symbols={};this._graphics={};this._graphicsKeys={};this._graphicsBySymbol={};this._elevationDirtyGraphicsQueue=[];this._elevationDirtyGraphicsSet={};this._updatingGraphicIds={};this._graphicsDrapedIds={};this.hudMaterialCollection=this.textTextureAtlas=null;this._sharedResources={textures:new x(this._streamDataSupplier,this._stage,{wrapClamp:!0})};this._symbolCreationContext={sharedResources:this._sharedResources,renderer:this.layer.renderer,
stage:this._stage,streamDataSupplier:this._streamDataSupplier,elevationProvider:null,renderSpatialReference:this.view.renderSpatialReference,renderCoordsHelper:this.view.renderCoordsHelper,overlaySR:null,layer:this.layer,layerOrder:this.view.getDrawingOrder(this.layer.uid)||0,localOriginFactory:new G(5E6,16),clippingExtent:null};this._graphicsController=null;this._graphicsControllerClientSideFiltering=!1;this._graphicsCollectionEventHandle=this._graphicsCollection=null;this._graphicsControllerEventHandles=
[];this._graphicsControllerLoading=!0;this._initGraphicsController();this._spatialIndex=new p;this._spatialIndexNumPendingQueries=this._spatialIndexNumGraphics=0;this.view.resourceController.registerIdleFrameWorker(this,{needsUpdate:this._needsIdleUpdate,idleFrame:this._idleUpdate});this._viewChangeListenerHandles=[];this._viewChangeUpdate=this._viewChangeUpdate.bind(this);this._viewChangeListenerHandles.push(this.view.on("resize",this._viewChangeUpdate));this._viewChangeListenerHandles.push(this.view.navigation.on("currentViewChanged",
this._viewChangeUpdate));this._scaleVisibility=this._scaleVisibilityDirty=this._frustumVisibility=this._frustumVisibilityDirty=!0;this._scaleVisibilityQuery=!1;this._clippingChangedHandle=this.view.watch("clippingArea",this._updateClippingExtent.bind(this));this._updateClippingExtent();this._updateSuspendScaleVisibleFinish=this._updateSuspendScaleVisibleFinish.bind(this);this._viewChangeUpdate();this._suspendResumeExtent=this.computedExtent=null;this._suspendResumeExtentEngine={extent:Array(4),planes:Array(4),
maxSpan:0,center:{origin:R.create(),direction:R.create()}};this._suspendResumeExtentEngineDirty=!0;for(var a=0;4>a;a++)this._suspendResumeExtentEngine.extent[a]={origin:R.create(),direction:R.create(),cap:{next:null,direction:R.create()}},this._suspendResumeExtentEngine.planes[a]=W.create();this._suspendResumeExtentEngine.planes[4]=W.create();this.on("suspend",function(){this._stageLayer.setState("HIDDEN");this._labelStageLayer.setState("HIDDEN");this._hideAllGraphics();this.updateElevation=!1}.bind(this));
this.on("resume",function(){this._stageLayer.setState("VISIBLE");this._labelStageLayer.setState("IGNORED");this.updateElevation&&this._markAllGraphicsElevationDirty();this._showLabelsChangeOnResume&&this._showLabelsChange();this.view.basemapTerrain&&this._updateGraphicsVisibility()});this._layerEventHandles=[this.layer.watch("renderer",this._rendererChange.bind(this)),this.layer.watch("opacity",this._opacityChange.bind(this)),this.layer.watch("elevationInfo",this._elevationInfoChange.bind(this)),
this.layer.watch("showLabels",this._showLabelsChange.bind(this)),this.layer.watch("minScale",this._layerMinMaxScaleChangeHandler.bind(this)),this.layer.watch("maxScale",this._layerMinMaxScaleChangeHandler.bind(this)),this.layer.on("graphic-update",this._graphicUpdateHandler.bind(this))];this._elevationUpdateEventHandle=this._scaleChangeEventHandle=null;this._showLabelsChangeOnResume=!1;this._labelClasses=[];this.addResolvingPromise(this._initLabelingInfo());this._basemapTerrainEventHandle=this.view.watch("basemapTerrain",
this._basemapTerrainChanged.bind(this));this._basemapTerrainChanged(this.view.basemapTerrain);this._viewIsSpherical="global"===this.view.viewingMode;var b=new n;this.fullExtentInViewSpatialReference=this._renderSREqualsViewSR=this._viewSR=null;g.whenOnce(this,"view.spatialReference",function(a){this._viewSR=a;this._renderSREqualsViewSR=this.view.renderSpatialReference.equals(a);this._symbolCreationContext.overlaySR=a;var c=this.get("layer.fullExtent.spatialReference");c&&!c.equals(a)&&"local"===this.view.viewingMode&&
e.geometryService?e.geometryService.project([this.layer.fullExtent],a).then(function(a){a&&(Array.isArray(a)&&1===a.length)&&(this.fullExtentInViewSpatialReference=a[0])}.bind(this)).always(function(){b.resolve()}):b.resolve()}.bind(this));this.addResolvingPromise(b.promise)},_addUrlToken:function(a){if(-1!==a.indexOf("?token\x3d")||0===a.indexOf("data:"))return a;var c=k.mixin({token:this.layer.token}),c=h.objectToQuery(c);a+=c?"?"+c:"";null==this._canUseXhr&&(this._canUseXhr=b.canUseXhr(a));return!this._canUseXhr?
b.addProxy(a):a},_updateClippingExtent:function(){var a=this._symbolCreationContext.clippingExtent,b=[];B.extentToBoundingRect(this.view.clippingArea,b,this.view.spatialReference)?this._symbolCreationContext.clippingExtent=[b[0],b[1],-Infinity,b[2],b[3],Infinity]:this._symbolCreationContext.clippingExtent=null;!V.equals(this._symbolCreationContext.clippingExtent,a)&&this._graphicsController&&(this._graphicsControllerClientSideFiltering?this._recreateAllGraphics():this._graphicsController.extent?(this._graphicsController.extent=
null,this._graphicsControllerClientSideFiltering=!0):this._graphicsController.extent=this.view.clippingArea)},_basemapTerrainChanged:function(a){this._symbolCreationContext.elevationProvider=a;this._tilingSchemeHandle&&this._tilingSchemeHandle.remove();a?this._tilingSchemeHandle=g.whenOnce(a,"tilingScheme",this._recreateAllGraphics.bind(this)):this._recreateAllGraphics();a?(this._elevationUpdateEventHandle=a.on("elevation-change",this._elevationUpdateHandler.bind(this)),this.updateElevation=!1,this._layerMinMaxScaleChangeHandler()):
(this._elevationUpdateEventHandle&&(this._elevationUpdateEventHandle.remove(),this._elevationUpdateEventHandle=null),this._scaleChangeEventHandle&&(this._scaleChangeEventHandle.remove(),this._scaleChangeEventHandle=null))},_getVerticalUnitValueForSR:function(b){b=a.getUnitValueForSR(b);return 1E5<b?1:b},_scaleVerticalUnits:function(a,b){function c(a,b){for(var d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.length;++f)e[f][2]*=b}for(var d=0;d<a.length;++d){var e=a[d].geometry;if(e.hasZ)e.z?e.z*=b:e.paths?
c(e.paths,b):e.rings&&c(e.rings,b);else break}},_getVerticalUnitScale:function(){if("esri.layers.FeatureLayer"===this.layer.declaredClass){var a=this.layer.spatialReference,b=this.view.spatialReference;if(a.equals(b))return 1;a=this._getVerticalUnitValueForSR(a);b=this._getVerticalUnitValueForSR(b);return a/b}return 1},_initGraphicsController:function(){var a=this.layer.createGraphicsController({layerView:this,options:{maxPageSize:300,extent:this.view.clippingArea}});g.whenTrueOnce(this.view,"basemapTerrain.ready",
function(){q([this,a]).then(function(a){this._graphicsController=a[1];this._graphicsController instanceof l?(a=this._graphicsController.on("query-end",function(a){this._graphicsControllerLoading=!1;this._evaluateUpdatingState()}.bind(this)),this._graphicsControllerEventHandles.push(a)):this._graphicsControllerLoading=!1;this._graphicsCollection=this._graphicsController.graphics;this._graphicsCollectionEventHandle=this._graphicsCollection.on("change",this._collectionChangeHandler.bind(this));0<this._graphicsCollection.length&&
this.add(this._graphicsCollection.toArray());this._evaluateUpdatingState()}.bind(this))}.bind(this))},_viewChangeUpdate:function(){this._frustumVisibilityDirty=!0},destroy:function(){this._graphicsCollection=null;this._graphicsCollectionEventHandle&&this._graphicsCollectionEventHandle.remove();this._graphicsControllerEventHandles.forEach(L);this._elevationUpdateEventHandle&&(this._elevationUpdateEventHandle.remove(),this._elevationUpdateEventHandle=null);this._tilingSchemeHandle&&this._tilingSchemeHandle.remove();
this._layerEventHandles.forEach(L);this._scaleChangeEventHandle&&(this._scaleChangeEventHandle.remove(),this._scaleChangeEventHandle=null);this._basemapTerrainEventHandle.remove();this._basemapTerrainEventHandle=null;var a=[this._stageLayer.getId(),this._labelStageLayer.getId()];this._stage.removeFromViewContent(a);this._stage.remove(F.ModelContentType.LAYER,a[0]);this._stage.remove(F.ModelContentType.LAYER,a[1]);this.view.resourceController.deregisterIdleFrameWorker(this);this.view.labelManager.removeSceneServiceLayerView(this);
var a=!1,b;for(b in this._graphics)a=a||this._graphics[b].isDraped(),this._graphics[b].destroy();this._graphics={};this._graphicsKeys=null;for(var c in this._symbols)this._symbols[c].destroy();this._graphicsDrapedIds={};this.hasDraped=!1;this._viewChangeListenerHandles.forEach(L);this._clippingChangedHandle.remove();null!=this._controller&&this._controller.destroy();a&&this.emit("draped-data-change");this._spatialIndex&&this._spatialIndex.destroy()},add:function(a){this.isResolved()?this._add(a):
this.then(function(){this._add(a)}.bind(this))},remove:function(a){for(var b=!1,c=a.length,d=0;d<c;d++){var e=a[d].id,f=this._graphics[e];if(f){f.isDraped()&&(delete this._graphicsDrapedIds[e],b=!0);var g=f.graphics3DSymbol.symbol.id;f.destroy();delete this._graphics[e];delete this._graphicsBySymbol[g][e];this._graphicsKeys=null}}this._updateHasDraped();b&&this.emit("draped-data-change");this.view.labelManager.setDirty()},getRenderingInfo:function(a){var b=this.inherited(arguments);if(b&&b.color){var c=
b.color;b.color=[c.r/255,c.g/255,c.b/255,c.a]}return b},_drawingOrderSetter:function(a){this._symbolCreationContext.layerOrder=a;var b={},c={},d;for(d in this._graphics)this._graphics[d].setDrawOrder(a,b,c);for(var e in c)this._symbols[e].setDrawOrder(a,b);H.objectEmpty(b)||(this.view._stage.getTextureGraphicsRenderer().updateRenderOrder(b),this.emit("draped-data-change"));return a},getGraphicsFromStageObject:function(a,b){var c=null;if(this._graphicsCollection){var d=a.getMetadata();this._graphicsCollection.some(function(a){return a.id===
d.graphicId?c=a:!1})}var e=new M.Promise;null!=c?e.done(c):e.reject();return e},getGraphics3DGraphics:function(){return this._graphics},getGraphics3DGraphicsKeys:function(){null==this._graphicsKeys&&(this._graphicsKeys=Object.keys(this._graphics));return this._graphicsKeys},_collectionChangeHandler:function(a){var b=this._getVerticalUnitScale();if(1!==b){var c=a.added.slice();this._scaleVerticalUnits(c,b);this.add(c)}else this.add(a.added);this.remove(a.removed)},_needsIdleUpdate:function(){return this._frustumVisibilityDirty||
this.view.basemapTerrain&&(this._scaleVisibilityDirty||0<this._elevationDirtyGraphicsQueue.length)},_idleUpdate:function(a){if(this._frustumVisibilityDirty&&(this._updateSuspendFrustumVisible(),this._frustumVisibilityDirty=!1,a.done()))return;if(this.view.basemapTerrain){if(this._scaleVisibilityDirty&&(this._updateSuspendScaleVisible(),this._scaleVisibilityDirty=!1,a.done()))return;var b=this._elevationDirtyGraphicsQueue.length;if(0<b){for(var c=this._stageLayer.getId(),d=this._labelStageLayer.getId(),
e=0,f=0;f<b;f++){var g=this._elevationDirtyGraphicsQueue[f],h=this._graphics[g];h&&h.alignWithElevation(this.view.basemapTerrain,this.view.renderCoordsHelper);delete this._elevationDirtyGraphicsSet[g];e++;if(20<=e){this.view._stage.processDirtyLayer(c);this.view._stage.processDirtyLayer(d);if(a.done())break;e=0}}this.view._stage.processDirtyLayer(c);this.view._stage.processDirtyLayer(d);this._elevationDirtyGraphicsQueue.splice(0,f+1);this.view.labelManager.setDirty()}this._evaluateUpdatingState()}},
_add:function(a){if(this.view.basemapTerrain.tilingScheme){for(var b=a.length,c=this._scaleRangeEnabled(),d=Array(b),e=Array(b),f=Array(b),g=0;g<b;g++){var h=a[g],k=h.geometry;if(null!=k&&(this._expandComputedExtent(k),k=this.getRenderingInfo(h)))if(e[g]=k.symbol,f[g]=k,k=this._getOrCreateGraphics3DSymbol(e[g],k.renderer))d[g]=k,this._beginGraphicUpdate(h)}for(g=0;g<b;g++)(h=d[g])&&h.then(function(a,b,d,e){this._graphicsBySymbol[b.id]||(this._graphicsBySymbol[b.id]={});this._createCanvas3DGraphic(d,
a,e,c);this._endGraphicUpdate(a);this.view.labelManager.setDirty()}.bind(this,a[g],e[g],h,f[g]),function(a){this._endGraphicUpdate(a)}.bind(this,a[g]))}},_getOrCreateGraphics3DSymbol:function(a,b){var c=this._symbols[a.id];if(!c){var d=t.toWeb3DSymbol(a,!0,!1);if(d){var e;if(b&&b.backgroundFillSymbol&&(c=t.toWeb3DSymbol(b.backgroundFillSymbol,!1,!0)))e=c.symbolLayers;c=new v(d,this._symbolCreationContext,e);this._symbols[a.id]=c}}return c},_createCanvas3DGraphic:function(a,b,c,d){if(!this._graphics[b.id]){var e=
a.createGraphics3DGraphic(b,c);this.layerLabelsEnabled()&&(e=this._createLabelsForGraphic(b,e,c));this._graphics[b.id]=e;this._graphicsKeys=null;this._graphicsBySymbol[a.symbol.id][b.id]=e;e.initialize(this._stageLayer,this._labelStageLayer,this._stage);if(a=e.isDraped())this.hasDraped=this._graphicsDrapedIds[b.id]=!0;e.centroid=null;"point"!==b.geometry.type&&e instanceof u&&(e.centroid=z.computeCentroid(b.geometry,this._viewSR));c=!this.suspended;if(this._shouldAddToSpatialIndex(b,e,d)){var f=this._addGraphicToSpatialIndex(b,
e);d&&f&&(c=c&&this._graphicVisibleAtScale(b,e))}d=e.setVisibilityFlag("VISIBILITY_SCALERANGE",c);b=e.setVisibilityFlag("VISIBILITY_GRAPHIC",b.visible);d!==b&&a&&this.emit("draped-data-change")}},_shouldAddToSpatialIndex:function(a,b,c){return c||b.mustAlignToTerrain()},_addGraphicsToSpatialIndex:function(){if(this._graphicsCollection)for(var a=this._graphicsCollection.toArray(),b=a.length,c=this._scaleRangeEnabled(),d=0;d<b;d++){var e=a[d],f=this._graphics[e.id];f&&!f.addedToSpatialIndex&&this._shouldAddToSpatialIndex(e,
f,c)&&this._addGraphicToSpatialIndex(e,f)}},_addGraphicToSpatialIndex:function(a,b){var c=a.geometry.spatialReference,e=this._viewSR,g={id:a.id};if(c.equals(e))g.geometry=a.geometry.toJSON(!0);else{if(c.wkid===d.WGS84.wkid&&e.isWebMercator)c=f.geographicToWebMercator(a.geometry);else if(c.isWebMercator&&e.wkid===d.WGS84.wkid)c=f.webMercatorToGeographic(a.geometry);else return console.warn("Cannot convert graphic geometry to map spatial reference, elevation and scale updates are disabled"),!1;g.geometry=
c.toJSON(!0)}this._spatialIndexNumGraphics++;this._spatialIndex.runProcess([g],this.layer.id);b.addedToSpatialIndex=!0},_recreateSymbol:function(a){var b=this._graphicsBySymbol[a],c=[],d=!1,e;for(e in b){var f=b[e];f.isDraped()&&(delete this._graphicsDrapedIds[e],d=!0);c.push(f.graphic);f.destroy();this._graphics[e]=null}this._graphicsBySymbol[a]={};this._symbols[a].destroy();this._symbols[a]=null;this._updateHasDraped();d&&this.emit("draped-data-change");this.add(c)},_clearSymbolsAndGraphics:function(){var a=
!1,b;for(b in this._graphics)a=a||this._graphics[b].isDraped(),this._graphics[b].destroy();this._graphics={};this._graphicsKeys=null;for(var c in this._symbols)this._symbols[c].destroy();this._symbols={};this._graphicsBySymbol={};this._elevationDirtyGraphicsSet={};this._elevationDirtyGraphicsQueue=[];this._updatingGraphicIds={};this._graphicsDrapedIds={};this.hasDraped=!1;a&&this.emit("draped-data-change");this.view.labelManager.setDirty();this.textTextureAtlas&&(this.textTextureAtlas.dispose(),this.textTextureAtlas=
null);this.hudMaterialCollection&&(this.hudMaterialCollection.dispose(),this.hudMaterialCollection=null)},_initLabelingInfo:function(){var a=new n;this.layer.then(function(){var b=this.layer.labelingInfo;if(b){this._labelClasses=Array(b.length);for(var c=[],d=0;d<b.length;d++){var e=this._getOrCreateGraphics3DSymbol(b[d].symbol);e.then(function(a,c){this._labelClasses[a]={labelClass:b[a],graphics3DSymbolLayer:c,graphics3DGraphics:[]}}.bind(this,d,e));c.push(e)}q(c).then(function(){a.resolve()})}else a.resolve()}.bind(this));
return a.promise},_createLabelsForGraphic:function(a,b,d){if(this._labelClasses&&0<this._labelClasses.length)for(var e=0;e<this._labelClasses.length;e++){var f=this._labelClasses[e];if(c.evaluateWhere(f.labelClass.where,a.attributes)){var g=f.labelClass.getLabelExpression();if(g&&(g=c.buildLabelText(g,a.attributes,this.layer.fields))){e=f.graphics3DSymbolLayer.childGraphics3DSymbols[0];d=this._evalLabelPlacementParams(a,b,d);null==this.textTextureAtlas&&(this.textTextureAtlas=new I(this.layer.id,
this._stage),this.hudMaterialCollection=new Z(this._stage));if(a=e.createGraphics3DGraphic(a,{text:g,centerOffset:d.centerOffset,translation:d.translation,screenOffset:d.screenOffset,anchor:d.anchor},this.hudMaterialCollection,this.textTextureAtlas))a._labelClass=f.labelClass,b.addLabelGraphic(a),f.graphics3DGraphics.push(b),a.setVisibilityFlag("VISIBILITY_LABEL_SHOW",this.layerLabelsEnabled()),this.view.labelManager.setInitialLabelGraphicState(a);break}}}return b},_evalLabelPlacementParams:function(a,
b,c){c=J[this.layer.labelingInfo[0].labelPlacement]||J["default"];if("polygon"===a.geometry.type||"polyline"===a.geometry.type||"extent"===a.geometry.type)return{anchor:"center"};if("point"!==a.geometry.type)return{anchor:c.anchor};var d=b.graphics3DSymbolLayer.symbol.symbolLayers[0];a={screenOffset:[0,0],centerOffset:[0,0,0,-1],translation:b.getCenterObjectSpace(),anchor:c.anchor};"Icon"===d.type?(d=b._graphics[0].getScreenSize(),b.isDraped()?a.anchor="center":(b=b._graphics[0].stageObject.getGeometryRecords()[0].materials[0],
b instanceof O?(b=b.getParams(),a.screenOffset=[d[0]/2*(c.normalizedOffset[0]-2*(b.anchorPos[0]-0.5)),d[1]/2*(c.normalizedOffset[1]-2*(b.anchorPos[1]-0.5))]):a.screenOffset=[d[0]/2*c.normalizedOffset[0],d[1]/2*c.normalizedOffset[1]])):"Object"===d.type&&(b=b._graphics[0].getBoundingBoxObjectSpace(),d=[b[3]-b[0],b[4]-b[1],b[5]-b[2]],b=Math.max(d[0],d[1]),a.centerOffset[0]=1.1*b/2*c.normalizedOffset[0],a.translation[2]+=1.1*d[2]/2*c.normalizedOffset[1],b=R.length(d),a.centerOffset[2]=1.1*b/2*c.normalizedOffset[2]);
return a},_recreateAllGraphics:function(){this._clearSymbolsAndGraphics();this.computedExtent=null;this._updateSuspendResumeExtent();this._graphicsCollection&&this.view.basemapTerrain.tilingScheme&&this.add(this._graphicsCollection.toArray())},_rendererChange:function(a,b,c,d){this._symbolCreationContext.renderer=a;this._recreateAllGraphics()},_opacityChange:function(a){a=!1;for(var b in this._graphicsBySymbol){var c=this._graphicsBySymbol[b];this._symbols[b].layerPropertyChanged("opacity");if(!a)for(var d in c)if(c[d].isDraped()){this.emit("draped-data-change");
a=!0;break}}},layerLabelsEnabled:function(){return this.layer.get("labelsVisible")},_showLabelsChange:function(a){if(this.get("suspended"))this._showLabelsChangeOnResume=!0;else if(this._graphicsCollection){var b=this.layerLabelsEnabled();this._graphicsCollection.forEach(function(a){var c=this._graphics[a.id];if(c){if(b&&0===c._labelGraphics.length){var d=this.getRenderingInfo(a),c=this._createLabelsForGraphic(a,c,d);for(a=0;a<c._labelGraphics.length;a++)d=c._labelGraphics[a],d.initialize(this._labelStageLayer,
this._stage)}for(a=0;a<c._labelGraphics.length;a++)d=c._labelGraphics[a],d.setVisibilityFlag("VISIBILITY_LABEL_SHOW",b)}}.bind(this));this.view.labelManager.setDirty();this._showLabelsChangeOnResume=!1}},_elevationInfoChange:function(a){this._labelClasses&&this._labelClasses.forEach(function(a){a.graphics3DSymbolLayer.layerPropertyChanged("elevationInfo",{})});for(var b in this._graphicsBySymbol)if(a=this._graphicsBySymbol[b],this._symbols[b].layerPropertyChanged("elevationInfo",a))for(var c in a)for(var d=
a[c],e=d.graphic,d=d._labelGraphics,f=0;f<d.length;f++){var g=d[f];g.graphics3DSymbolLayer.updateGraphicElevationInfo(e,g)}else this._recreateSymbol(b)},_scaleUpdateHandler:function(a){if(!this.suspended&&0<this._spatialIndexNumGraphics){var b=a.extent,c=a.scale;this._spatialIndexNumPendingQueries++;this._spatialIndex.intersects(b,void 0,void 0,!0).then(function(a){this._spatialIndexNumPendingQueries--;for(var d=this._visibleAtScale(c),e=!1,f=a.results.length,g=0;g<f;g++){var h=this._graphics[a.results[g]];
if(h){var k=h.centroid;if(!k||!(b[0]>k.x||b[1]>k.y||b[2]<k.x||b[3]<k.y)){for(var k=h.setVisibilityFlag("VISIBILITY_SCALERANGE",d),l=0;l<h._labelGraphics.length;l++){var m=h._labelGraphics[l];if(m._labelClass&&null!=m._labelClass.minScale&&null!=m._labelClass.maxScale)var n=this._visibleAtScaleLabel(c,m._labelClass),k=k||m.setVisibilityFlag("VISIBILITY_SCALERANGE_LABEL",n)}k&&this.view.labelManager.setDirty();k&&h.isDraped()&&(e=!0)}}}e&&this.emit("draped-data-change")}.bind(this))}this._scaleVisibilityDirty=
!0},_visibleAtScaleLabel:function(a,b){return a>b.maxScale&&(!b.minScale||a<b.minScale)},_visibleAtScale:function(a){var b=this.layer.get("minScale"),c=this.layer.get("maxScale");return a>c&&(!b||a<b)},_graphicVisibleAtScale:function(a,b){var c;b.centroid?c=b.centroid:"point"===a.geometry.type&&(c=a.geometry);return c?(c=this.view.basemapTerrain?this.view.basemapTerrain.getScale(c):1,this._visibleAtScale(c)):!0},_scaleRangeEnabled:function(){var a=this.layer.get("minScale");return null!==a&&0<a&&
8E7>a||1E3<this.layer.get("maxScale")},_layerMinMaxScaleChangeHandler:function(){if(this.view.basemapTerrain){var a=this._scaleRangeEnabled();a&&!this._scaleChangeEventHandle?(this._scaleChangeEventHandle=this.view.basemapTerrain.on("scale-change",this._scaleUpdateHandler.bind(this)),this.suspended||this._addGraphicsToSpatialIndex()):!a&&this._scaleChangeEventHandle&&(this._scaleChangeEventHandle.remove(),this._scaleChangeEventHandle=null);this.suspended||this._updateGraphicsVisibility();this._scaleVisibilityDirty=
!0}},_graphicUpdateHandler:function(a){var b=this._graphics[a.graphic.id];if(b)switch(a.property){case "visible":b.setVisibilityFlag("VISIBILITY_GRAPHIC",a.newValue)&&(b.isDraped()&&this.emit("draped-data-change"),this.view.labelManager.setDirty())}},_updateGraphicsVisibility:function(){if(null!=this._graphicsCollection){var a=!1;this._graphicsCollection.forEach(function(b){var c=this._graphics[b.id];c&&(b=this._graphicVisibleAtScale(b,c),c.setVisibilityFlag("VISIBILITY_SCALERANGE",b)&&c.isDraped()&&
(a=!0))}.bind(this));a&&this.emit("draped-data-change");this.view.labelManager.setDirty()}},_hideAllGraphics:function(){if(this._graphicsCollection){var a=!1;this._graphicsCollection.forEach(function(b){(b=this._graphics[b.id])&&b.setVisibilityFlag("VISIBILITY_SCALERANGE",!1)&&b.isDraped()&&(a=!0)}.bind(this));a&&this.emit("draped-data-change");this.view.labelManager.setDirty()}},_updateSuspendResumeExtentEngine:function(){if(this._suspendResumeExtentEngineDirty){this._suspendResumeExtentEngineDirty=
!1;var a,b=this._suspendResumeExtent,c=this._suspendResumeExtentEngine,d=this.view.renderCoordsHelper.worldUpAtPosition;R.set3(b[0],b[1],Y,c.extent[0].origin);R.set3(b[2],b[1],Y,c.extent[1].origin);R.set3(b[2],b[3],Y,c.extent[2].origin);R.set3(b[0],b[3],Y,c.extent[3].origin);if(!this._renderSREqualsViewSR){var e=this._viewSR,f=this.view.renderSpatialReference;for(a=0;4>a;a++)B.vectorToVector(c.extent[a].origin,e,c.extent[a].origin,f)}R.add(c.extent[0].origin,c.extent[2].origin,c.center.origin);R.scale(c.center.origin,
0.5);d(c.center.origin,c.center.direction);for(a=0;4>a;a++)e=c.extent[a],d(e.origin,e.direction),f=c.extent[3==a?0:a+1],e.cap.next=f.origin,R.direction(f.origin,e.origin,e.cap.direction),R.cross(c.extent[a].cap.direction,c.extent[a].direction,c.planes[a]),c.planes[a][3]=-R.dot(c.planes[a],c.extent[a].origin);c.maxSpan=Math.max(Math.abs(b[0]-b[2]),Math.abs(b[1]-b[3]))}},_isVisibleInFrustumGlobal:function(){var a=this._suspendResumeExtentEngine,b=this.view.getFrustum();if(0>R.dot(a.center.direction,
b.direction))return!0;for(var c=0;4>c;c++)if(0>R.dot(a.extent[c].direction,b.direction))return!0;return!1},_isVisibleInFrustum:function(){var a=this.view.getFrustum();this._updateSuspendResumeExtentEngine();if(this._viewIsSpherical){if(this._suspendResumeExtentEngine.maxSpan>E)return!0;if(a.altitude()>=ba)return this._isVisibleInFrustumGlobal()}for(var b=0;b<this._suspendResumeExtentEngine.extent.length;b++){var c=this._suspendResumeExtentEngine.extent[b];if(D.frustumRay(a.planes,c.origin,null,c.direction)||
D.frustumLineSegment(a.planes,c.origin,c.cap.next,c.cap.direction))return!0}for(b=0;b<a.lines.length;b++)if(c=a.lines[b],D.frustumLineSegment(this._suspendResumeExtentEngine.planes,c.origin,c.endpoint,c.direction))return!0;return!1},_updateSuspendFrustumVisible:function(){if(this._suspendResumeExtent){var a=this._isVisibleInFrustum();a!==this._frustumVisibility&&(this._frustumVisibility=a,this.notifyChange("suspended"))}},_updateSuspendScaleVisibleFinish:function(a){this._scaleVisibilityQuery=!1;
this._scaleVisibility!==a&&(this._scaleVisibility=a,this.notifyChange("suspended"))},_updateSuspendScaleVisible:function(){var a=this.view.basemapTerrain;!this._suspendResumeExtent||!a||!this._scaleRangeEnabled()?this._updateSuspendScaleVisibleFinish(!0):this._scaleVisibilityQuery||(this._scaleVisibilityQuery=!0,a.queryVisibleScaleRange(this._suspendResumeExtent,this.layer.minScale,this.layer.maxScale,this._updateSuspendScaleVisibleFinish))},canResume:function(){return!this.inherited(arguments)||
!this._frustumVisibility||!this._scaleVisibility?!1:!0},_elevationUpdateHandler:function(a){a=a.extent;if(this.suspended){if(!this.updateElevation){var b=this.computedExtent;b&&(a[2]>b.xmin&&a[0]<b.xmax&&a[3]>b.ymin&&a[1]<b.ymax)&&(this.updateElevation=!0)}}else-Infinity===a[0]?this._markAllGraphicsElevationDirty():0<this._spatialIndexNumGraphics&&(this._spatialIndexNumPendingQueries++,this._spatialIndex.intersects(a,void 0,void 0,!0).then(function(a){this._spatialIndexNumPendingQueries--;a=a.results;
for(var b=a.length,c=0;c<b;c++){var d=a[c],e=this._graphics[d];e&&e.mustAlignToTerrain()&&this._markGraphicElevationDirty(d)}this._evaluateUpdatingState()}.bind(this)))},_markGraphicElevationDirty:function(a){this._elevationDirtyGraphicsSet[a]||(this._elevationDirtyGraphicsSet[a]=!0,this._elevationDirtyGraphicsQueue.push(a))},_markAllGraphicsElevationDirty:function(){for(var a in this._graphics)this._markGraphicElevationDirty(a);this._evaluateUpdatingState()},_evaluateUpdatingState:function(){var a=
this._elevationDirtyGraphicsQueue.length+Object.keys(this._updatingGraphicIds).length;this._progressMaxNumNodes=Math.max(a,this._progressMaxNumNodes);0===a&&(this._progressMaxNumNodes=1);this.updatingPercentage=this._graphicsControllerLoading||this._overlayUpdating?100:100*a/this._progressMaxNumNodes;this.updating=0<a||0<this._spatialIndexNumPendingQueries||this._graphicsControllerLoading||this._overlayUpdating},_beginGraphicUpdate:function(a){this._updatingGraphicIds[a.id]=!0;this.get("symbols-updating")||
this.set("symbols-updating",!0);this._evaluateUpdatingState()},_endGraphicUpdate:function(a){a&&delete this._updatingGraphicIds[a.id];this.get("symbols-updating")&&H.objectEmpty(this._updatingGraphicIds)&&(this.view.flushDisplayModifications(),this.set("symbols-updating",!1));this._evaluateUpdatingState()},_expandComputedExtent:function(a){var b,c,d,e,f,g;if("point"===a.type)b=c=a.x,d=e=a.y,a.z&&(f=g=a.z);else{g=a.extent;if(!g)return;b=g.xmin;c=g.xmax;d=g.ymin;e=g.ymax;f=g.zmin;g=g.zmax}var h=this._viewSR;
!a.spatialReference.equals(h)&&B.xyzToVector(b,d,0,a.spatialReference,T,h)&&(b=T[0],d=T[1],B.xyzToVector(c,e,0,a.spatialReference,T,h),c=T[0],e=T[1]);!isNaN(b)&&(!isNaN(c)&&!isNaN(d)&&!isNaN(e)&&!isNaN(f)&&!isNaN(g))&&((h=this.computedExtent)?(h.xmin=Math.min(b,h.xmin),h.xmax=Math.max(c,h.xmax),h.ymin=Math.min(d,h.ymin),h.ymax=Math.max(e,h.ymax)):this.computedExtent=h=new m(b,d,c,e,a.spatialReference),null!=f&&null!=g&&(h.zmin=null!=h.zmin?Math.min(f,h.zmin):f,h.zmax=null!=h.zmax?Math.max(g,h.zmax):
g),this._updateSuspendResumeExtent())},_updateSuspendResumeExtent:function(){if(this.computedExtent){this._suspendResumeExtent||(this._suspendResumeExtent=W.create());var a=this.computedExtent,b=this._suspendResumeExtent,c=0.5*a.width*(1.2-1),d=0.5*a.height*(1.2-1);a.width<1E-7*a.height?c+=d/20:a.height<1E-7*a.width&&(d+=c/20);W.set4(a.xmin-c,a.ymin-d,a.xmax+c,a.ymax+d,b)}else this._suspendResumeExtent=null;this._suspendResumeExtentEngineDirty=this._scaleVisibilityDirty=this._frustumVisibilityDirty=
!0},_updateHasDraped:function(){this.hasDraped=!1;for(var a in this._graphicsDrapedIds)if(this._graphicsDrapedIds.hasOwnProperty(a)){this.hasDraped=!0;break}},getStats:function(){var a=0,b=0,c=0,d=0,e;for(e in this._graphics){var f=this._graphics[e];f&&f.areVisibilityFlagsSet("VISIBILITY_SCALERANGE",null)&&a++;f&&f.areVisibilityFlagsSet("VISIBILITY_GRAPHIC",null)&&b++;f&&f.areVisibilityFlagsSet("VISIBILITY_SCALERANGE_LABEL",null)&&c++;f&&f.areVisibilityFlagsSet("VISIBILITY_LABEL_SHOW",null)&&d++}e=
"null";this._suspendResumeExtent&&(e=this._suspendResumeExtent.map(function(a){return a.toPrecision(4)}).join(", "));f="null";this.computedExtent&&(f=[this.computedExtent.xmin,this.computedExtent.ymin,this.computedExtent.xmax,this.computedExtent.ymax].map(function(a){return a.toPrecision(4)}).join(", "));return{numCollection:this._graphicsCollection&&this._graphicsCollection.toArray().length||null,numGraphics:this._graphics&&Object.keys(this._graphics).length||null,numDraped:this._graphicsDrapedIds&&
Object.keys(this._graphicsDrapedIds).length||null,numUpdatingGraphics:this._updatingGraphicIds&&Object.keys(this._updatingGraphicIds).length||null,numVisibleScale:a,numVisibleGraphic:b,numVisibleLabelScale:c,numVisibleShowLabels:d,numElevationDirty:this._elevationDirtyGraphicsQueue&&this._elevationDirtyGraphicsQueue.length||null,visibilityFrustum:this._frustumVisibility,resumeExtent:e,computedExtent:f,suspended:this.suspended}}});var J={"above-center":{normalizedOffset:[0,1,0],anchor:"bottom"},"above-left":{normalizedOffset:[-1,
1,0],anchor:"bottom-right"},"above-right":{normalizedOffset:[1,1,0],anchor:"bottom-left"},"below-center":{normalizedOffset:[0,-1,2],anchor:"top"},"below-left":{normalizedOffset:[-1,-1,0],anchor:"top-right"},"below-right":{normalizedOffset:[1,-1,0],anchor:"top-left"},"center-center":{normalizedOffset:[0,0,1],anchor:"center"},"center-left":{normalizedOffset:[-1,0,0],anchor:"right"},"center-right":{normalizedOffset:[1,0,0],anchor:"left"}};r={"above-center":["default","esriServerPointLabelPlacementAboveCenter"],
"above-left":["esriServerPointLabelPlacementAboveLeft"],"above-right":["esriServerPointLabelPlacementAboveRight"],"below-center":["esriServerPointLabelPlacementBelowCenter"],"below-left":["esriServerPointLabelPlacementBelowLeft"],"below-right":["esriServerPointLabelPlacementBelowRight"],"center-center":["esriServerPointLabelPlacementCenterCenter"],"center-left":["esriServerPointLabelPlacementCenterLeft"],"center-right":["esriServerPointLabelPlacementCenterRight"]};for(var S in r){var K=J[S];r[S].forEach(function(a){J[a]=
K})}Object.freeze&&(Object.freeze(J),Object.keys(J).forEach(function(a){Object.freeze(J[a]);Object.freeze(J[a].normalizedOffset)}));return s})},"esri/views/3d/webgl-engine/lib/TextTextureAtlas":function(){define(["require","exports","./Texture","./ModelContentType"],function(s,q,n,k){var h=function(){function e(c){this.textTextures={};this.id=n.idGen.gen(c)}e.prototype.getId=function(){return this.id};e.prototype.dispose=function(){};e.prototype.deferredLoading=function(){return!1};e.prototype.getWidth=
function(){return 512};e.prototype.getHeight=function(){return 512};e.prototype.renderGl=function(c,b){this._createTextTexture(c,b);b._isTracingEnabled&&(c._debugTracingType="TextTextureAtlas")};e.prototype._createTextTexture=function(c,b){var g=e._create2Dcanvas(),f=g.getContext("2d");f.save();f.clearRect(0,0,512,512);b.bindTexture(b.TEXTURE_2D,c);for(var a in this.textTextures){var h=this.textTextures[a];h.textTexture.renderText(1,h.placement.width,h.placement.height,f,h.placement.atlasOffX,h.placement.atlasOffY)}b.texImage2D(b.TEXTURE_2D,
0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,g);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.bindTexture(b.TEXTURE_2D,null);f.restore()};e.prototype.setUnloadFunc=function(c){this._unloadFunc=c};e.prototype.unload=function(){null!=this._unloadFunc&&(this._unloadFunc(this.id),this._unloadFunc=null)};e._create2Dcanvas=
function(){e._textCanvas2D||(e._textCanvas2D=document.createElement("canvas"),e._textCanvas2D.setAttribute("id","canvas2d"),e._textCanvas2D.setAttribute("width",(512).toString()),e._textCanvas2D.setAttribute("height",(512).toString()),e._textCanvas2D.setAttribute("style","display:none"));return e._textCanvas2D};return e}();return function(){function e(c,b){this._textureAtlasSubtextures=[];this._curLineHeight=this._curY=this._curX=0;this._idHint=c;this._stage=b}e.prototype.dispose=function(){for(var c=
0;c<this._textureAtlasSubtextures.length;c++)this._stage.remove(k.TEXTURE,this._textureAtlasSubtextures[c].getId());this._textureAtlasSubtextures=[]};e.prototype.addTextTexture=function(c){for(var b=JSON.stringify(c.getParams())+"_"+c.getString(),e=0;e<this._textureAtlasSubtextures.length;e++){var f=this._textureAtlasSubtextures[e].textTextures[b];if(null!=f)return f.placement}var a=null;0===this._textureAtlasSubtextures.length&&(a=new h(this._idHint),this._textureAtlasSubtextures.push(a));var e=
c.getTextWidth(),f=c.getTextHeight(),n,l;this._curLineHeight=Math.max(this._curLineHeight,f);512>this._curX+e&&512>this._curY+this._curLineHeight||(512>this._curY+this._curLineHeight+f?(this._curX=0,this._curY+=this._curLineHeight):(a=new h(this._idHint),this._textureAtlasSubtextures.push(a),this._curY=this._curX=0),this._curLineHeight=f);n=this._curX;l=this._curY;this._curX+=e;null!=a&&this._stage.add(k.TEXTURE,a);a=this._textureAtlasSubtextures[this._textureAtlasSubtextures.length-1];e={uvMinMax:[n/
512,1-(l+f)/512,(n+e)/512,1-l/512],atlasOffX:n,atlasOffY:l,width:e,height:f,texture:a};a.textTextures[b]={placement:e,textTexture:c};return e};return e}()})},"esri/views/3d/webgl-engine/lib/MaterialCollection":function(){define(["require","exports","./ModelContentType"],function(s,q,n){return function(){function k(h){this.materials={};this.stage=h}k.prototype.getMaterial=function(h){return this.materials[h]};k.prototype.addMaterial=function(h,e){this.materials[h]=e;this.stage.add(n.MATERIAL,e)};k.prototype.dispose=
function(){for(var h in this.materials)this.stage.remove(n.MATERIAL,this.materials[h].getId());this.materials={}};return k}()})},"esri/views/3d/layers/SceneLayerView3D":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/typescript ../../../core/watchUtils ../../../core/promiseUtils ../../../core/lang dojo/_base/lang dojox/color dojo/has ../../layers/LayerView ../../../Graphic ../../../symbols/Symbol3D ./i3s/I3SUtil ./i3s/I3SProjectionUtil ./support/LayerViewUpdatingPercentage ../support/projectionUtils ../support/aaBoundingBox ../webgl-engine/Stage ../webgl-engine/lib/Layer ../webgl-engine/lib/Geometry ../webgl-engine/lib/GeometryData ../webgl-engine/lib/Object3D ../webgl-engine/lib/Texture ../webgl-engine/materials/Material ../webgl-engine/lib/Util ../webgl-engine/lib/base64Binary ../lib/glMatrix".split(" "),
function(s,q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u,z,w,C,A,y,B,D,F,H){function N(a,b){var c=!1,d;b.encoding===m.DDS_ENCODING_STRING?d=y.DDS_ENCODING:c=!(I(a.width)&&I(a.height));var e=b.usedByEngineMats.some(function(a){return a.getParams().atlasRegions});return{mipmap:!e&&!b.atlas&&!c,wrapClamp:e||b.atlas||!b.wrap,encoding:d,noUnpackFlip:!0}}function G(a,b){for(var c=b.toLowerCase(),d=0,e=Object.keys(a);d<e.length;d++){var f=e[d];if(f.toLowerCase()===c)return a[f]}return null}var O=D.assert,M=D.clamp,
I=D.isPowerOfTwo,Z=D.fallbackIfUndefined,V=D.objectEmpty,L=D.VertexAttrConstants,Y=u.ModelContentType,E=[0.8,0.8,0.8],ba=[0.5,0.5,0.5],W=1,R=null;return function(r){function q(){r.apply(this,arguments)}n(q,r);q.prototype.initialize=function(){var b=this.layer.version,b=!a("trident")||1<b.major||1===b.major&&3<b.minor;this.useCompressedTextures=this.view.has("s3tc")&&b;this._initGraphicsController();this.dbg=!1;this.maxGpuMemory=1E3;this.geoMemoryEstimate=this.texMemoryEstimate=this.gpuMemoryEstimate=
0;this._stage=this.view._stage;this._matId2Meta={};this._texId2Meta={};this._requestedTexImageIds={};this._nodeId2Meta={};this._colorOverride=null;for(var b=new Uint8Array(256),c=0;c<b.length;c++)b[c]=255;this._whiteTexture=new y(b,"white",{width:8,height:8});this._stage.add(u.ModelContentType.TEXTURE,this._whiteTexture);this._layerEventHandles=[e.init(this.layer,"renderer",this._rendererChange.bind(this)),e.watch(this.layer,"opacity",this._opacityChange.bind(this)),e.init(this.view,"clippingArea",
this._clippingAreaChanged.bind(this))];this._addThisLayerToStage();this.setVisibility(!this.suspended);this.debugLODVis=this.debugNodeVis=!1};q.prototype.destroy=function(){this._stage.remove(u.ModelContentType.TEXTURE,this._whiteTexture.getId());this._removeThisLayerFromStage();this._layerEventHandles.forEach(function(a){a.remove()});this._stage=null;this._controller.destroy();this._nodeId2Meta=this._texId2Meta=this._matId2Meta=null};q.prototype.memEstimateTextureAdded=function(a){a=a.getEstimatedTexMemRequiredMB();
this.gpuMemoryEstimate+=a;this.texMemoryEstimate+=a};q.prototype.memEstimateTextureRemoved=function(a){a=a.getEstimatedTexMemRequiredMB();this.gpuMemoryEstimate-=a;this.texMemoryEstimate-=a};q.prototype.memEstimateGeometryAdded=function(a){a=a.estimateGpuMemoryUsage()/1E6;this.gpuMemoryEstimate+=a;this.geoMemoryEstimate+=a};q.prototype.memEstimateGeometryRemoved=function(a){a=a.estimateGpuMemoryUsage()/1E6;this.gpuMemoryEstimate-=a;this.geoMemoryEstimate-=a};q.prototype.isBundleAlreadyAddedToStage=
function(a,b){var c=!1,d=!1;if(null!=this._nodeId2Meta[a.id]&&this._nodeId2Meta[a.id].engineObjectsPerBundle&&this._nodeId2Meta[a.id].engineObjectsPerBundle[b])for(var d=!0,e=this._nodeId2Meta[a.id].engineObjectsPerBundle[b],f=0;f<e.length&&!(c=e[f].isPartiallyHidden());f++);return{wasPartiallyHidden:c,alreadyLoaded:d}};q.prototype._initGraphicsController=function(){var a=this,b={addBundle:this._addBundle.bind(this),isBundleAlreadyAddedToStage:this.isBundleAlreadyAddedToStage.bind(this),isOverMemory:this.isOverMemory.bind(this),
removeNodeData:this._removeNodeDataFromStage.bind(this),removeFeatures:this._removeFeatures.bind(this),getAddedFeatures:this._getAddedFeatures.bind(this),areAllBundlesLoaded:this._areAllBundlesLoaded.bind(this),wholeNodeSwitchEnabled:!0},c={additionalStartNodeLoadingHandler:this._startNodeLoading.bind(this),additionalCancelNodeLoadingHandler:this.cancelNodeLoading.bind(this),getTexturePrefetchFunctions:function(){return{_calcDesiredTextureLOD:a._calcDesiredTextureLOD.bind(a),_imageIsPartOfTextureBundle:a._imageIsPartOfTextureBundle.bind(a),
_matId2Meta:a._matId2Meta,_texId2Meta:a._texId2Meta,useCompressedTextures:function(){return a.useCompressedTextures}}},_nodeDebugVisualizer:this._nodeDebugVisualizer,setPolygonOffset:this._setPolygonOffset.bind(this),traversalOptions:{initDepthFirst:!0,neighborhood:!0,perLevelTraversal:!1,allowPartialOverlaps:!1},getLoadedAttributes:this.getLoadedAttributes.bind(this),setAttributeData:this.setAttributeData.bind(this)};this.layer.createGraphicsController({layerView:this,layerViewRequiredFunctions:b,
layerViewOptionalFunctions:c})};q.prototype.setMaxGpuMemory=function(a){this.maxGpuMemory=a};q.prototype.setVisibility=function(a){if(this._stage&&this._engineLayer){var b=this._engineLayer.getId(),c=0<=this._stage.getViewContent().indexOf(b);!!a!==c&&(b=[b],null!=this._nodeDebugVisualizer&&b.push(this._nodeDebugVisualizer.engineLayer.getId()),a?this._stage.addToViewContent(b):this._stage.removeFromViewContent(b))}};q.prototype.getEngineLayer=function(){return this._engineLayer};q.prototype.getStats=
function(){var a={nodesInIndex:0,knownFeatures:0,displayedFeatures:0,displayedGeometries:0,displayedComponents:0,geometryDataSize:0,activeMaterials:0};if(!this._controller)return a;for(var b in this._controller.nodeIndex)if(this._controller.nodeIndex.hasOwnProperty(b)){a.nodesInIndex++;var c=this._controller.nodeIndex[b];if(null!=c.features)for(var d=0;d<c.features.length;d++)a.knownFeatures++}a.activeMaterials=Object.keys(this._matId2Meta).length;return a};q.prototype._addThisLayerToStage=function(){var a=
this._stage;this._initTexture=new y(null,"i3sInitTexture");a.add(Y.TEXTURE,this._initTexture);var b=this.layer.id;this._engineLayer=b=new z(b,{},b);a.add(Y.LAYER,b);null!=this._nodeDebugVisualizer&&this._nodeDebugVisualizer.dispose()};q.prototype._removeThisLayerFromStage=function(){this.cancelNodeLoading();if(null!=this._engineLayer){var a=this._stage;a.remove(Y.TEXTURE,this._initTexture.getId());for(var b in this._controller.nodeIndex)this._controller.nodeIndex.hasOwnProperty(b)&&(this._removeNodeDataFromStage(this._controller.nodeIndex[b]),
delete this._controller.nodeIndex[b]);O(V(this._nodeId2Meta));O(V(this._matId2Meta));O(V(this._texId2Meta));a.remove(Y.LAYER,this._engineLayer.getId());null!=this._nodeDebugVisualizer&&this._nodeDebugVisualizer.dispose();this._nodeDebugVisualizer=void 0;this._matId2Meta={};this._texId2Meta={};this._requestedTexImageIds={};this._nodeId2Meta={};this._engineLayer=void 0;this.gpuMemoryEstimate=0}};q.prototype._startNodeLoading=function(){this._updateAllTextureLOD()};q.prototype.cancelNodeLoading=function(){null!=
this._nodeDebugVisualizer&&this._nodeDebugVisualizer.clear();this._requestedTexImageIds={}};q.prototype._isAllHidden=function(a){a=this._nodeId2Meta[a.id].engineObjects;for(var b=0;b<a.length;b++)if(!a[b].isAllHidden())return!1;return!0};q.prototype.getLoadedAttributes=function(a){if((a=this._nodeId2Meta[a.id])&&1===a.engineObjects.length)return a.engineObjects[0].getMetadata().loadedAttributes};q.prototype.setAttributeData=function(a,b,c){if((a=this._nodeId2Meta[a.id])&&1===a.engineObjects.length){a=
a.engineObjects[0];var d=a.getMetadata();d.loadedAttributes=b;d.attributeData=c;this._setObjectSymbology(a)}};q.prototype._createUnitTestData=function(a){var b=this.view.navigation.targetCamera,b={viewParams:{eye:b.eye,center:b.center,up:b.up,viewMatrix:b.viewMatrix,projectionMatrix:b.projectionMatrix,fovX:b.fovX,viewport:b.viewport,perPixelRatio:b.perPixelRatio},visibleObjects:[]};a=a.getAll("objects");for(var c in a){var d=a[c];if(d.getParentLayer()===this._engineLayer){var e=d.getMetadata(),d=
e.i3sNode,e=e.features.map(function(a){return a.id});e.sort();b.visibleObjects.push({featureIDs:e,nodeId:d})}}console.debug(""+b.visibleObjects.length);return JSON.stringify(b)};q.prototype.isOverMemory=function(){return this.gpuMemoryEstimate>this.maxGpuMemory?(console.warn("over memory: "+this.gpuMemoryEstimate+" tex "+this.texMemoryEstimate+" geom "+this.geoMemoryEstimate),!0):!1};q.prototype._getAddedFeatures=function(a){if(null==this._nodeId2Meta[a])return null;var b=[];a=this._nodeId2Meta[a].engineObjects;
for(var c=0;c<a.length;c++)b=b.concat(a[c].getMetadata().features);return b};q.prototype._calcEngineMaterialTransparencyParams=function(a,c,d){var e=this.layer.opacity;null==e&&(e=1);var f=1-M(Z(c.transparency,0),0,1),e=e*f;a=1>e||a&&b.endsWith(a.channels,"a")||!0===c.useVertexColorAlpha||d;return{opacity:e,transparent:a}};q.prototype._calcEngineMaterialDoubleSidedParams=function(a){return null!=a.doubleSided?a.doubleSided:!0};q.prototype._calcEngineMaterialCullFaceParams=function(a){return a.cullFace?
a.cullFace:null!=a.doubleSided?a.doubleSided?"none":"back":"none"};q.prototype._createEngineMaterial=function(a,b,c,d,e,f){var h,k;null!=a&&(h=(k=this._texId2Meta[b])&&k.engineTex?k.engineTex.getId():this._initTexture.getId());var l=c.params,n=Z(l.diffuse,E),p,q;null!=a&&(q=m.getAppropriateTextureEncoding(a.encoding,this.useCompressedTextures),p=-1<q?a.encoding[q]:a.encoding);var r="";"standard"!==c.type&&(r+="Unknown material type '"+c.type+"', must be 'standard'");void 0===l.reflectivity&&(r+="Material parameter 'reflectivity' is missing.");
0<r.length&&this.layer.warningEvent(r,1);c={ambient:this._colorOverride||n,diffuse:this._colorOverride||n,specular:Z(l.specular,ba),shininess:Z(l.shininess,64),atlasRegions:l.vertexRegions,textureId:h&&this._colorOverride?this._whiteTexture.getId():h,vertexColors:!0,flipV:!1,doubleSided:this._calcEngineMaterialDoubleSidedParams(l),cullFace:this._calcEngineMaterialCullFaceParams(l)};h=this._calcEngineMaterialTransparencyParams(a,l);g.mixin(c,h);c=new B(c,d);c.metadata={i3sMatId:d,i3sTexId:b,i3sTex:a,
i3sMatParams:l};if(null!=a){k?k.usedByEngineMats.push(c):(k={id:b,featureMBS:{},usedByEngineMats:[c],images:a.images,encoding:p,encodingIdx:q,atlas:!0===a.atlas,wrap:"none"!==a.wrap[0]||"none"!==a.wrap[1]},this._texId2Meta[b]=k);for(a=0;a<e.length;a++)l=e[a],k.featureMBS[l.id]=l.engineMBS;if(void 0!==f[b]){null==k.engineTex&&(e=f[b].data,a=N(e,k),k.engineTex=new y(e,k.id,a),this._stage.add(Y.TEXTURE,k.engineTex),k.desiredLOD=f[b].desiredLOD,k.curLOD=k.desiredLOD,this.memEstimateTextureAdded(k.engineTex));
e=k.engineTex.getId();for(a=0;a<k.usedByEngineMats.length;a++)l=k.usedByEngineMats[a],null==this._colorOverride&&l.setParameterValues({textureId:e}),l.metadata.originalTextureId=e;f[b].createdTextureForDomImage();delete f[b]}else this._updateTextureLOD(k)}this._matId2Meta[d]||(this._matId2Meta[d]={});this._matId2Meta[d][b]={engineMat:c,refCount:1};return c};q.prototype._createVertexAndIndexArrays=function(a,b,c){var d,e=a.params.vertexAttributes,f={},g;for(g in e)if(e.hasOwnProperty(g)&&"classification"!==
g){var h=e[g];d=m.valueType2TypedArrayClassMap[h.valueType];O(null!=d,"unsupported vertex attribute value type: "+h.valueType);f[g]={data:new d(b,h.byteOffset,h.count*h.valuesPerElement),size:h.valuesPerElement}}if(null==f[L.COLOR]){d=m.valueType2TypedArrayClassMap.UInt8;f[L.COLOR]={data:new d(4*e.position.count),size:4};for(var k=0;k<f[L.COLOR].data.length;k++)f[L.COLOR].data[k]=0===k%3?255:0}g=!1;null==f[L.NORMAL]&&(g=!0,d=m.valueType2TypedArrayClassMap.Float32,f[L.NORMAL]={data:new d(3*e.position.count),
size:3});var e=[],h=a.params.faces,l;if(null!=h&&"PerAttributeArray"!==a.params.topology){var n={};for(name in h)h.hasOwnProperty(name)&&(d=h[name],O(0===d.count%3),O(d.count===h.position.count),O("UInt32"===d.valueType),n[name]=d.byteOffset);var p=a.params.components.length;l=Array(p);for(var q=h.position.componentIndices||[0],r=0;r<p;r++){var s=a.params.components[r],t=r<p-1?q[r+1]-q[r]:h.position.count-q[r];d={type:"triangle",positionKey:"position",indices:{},componentRange:[q[r],q[r]+t]};for(name in h)h.hasOwnProperty(name)&&
(d.indices[name]=new Uint32Array(b,n[name],t),n[name]+=4*t);if(null==d.indices[L.COLOR]){d.indices[L.COLOR]=new Uint32Array(t);for(k=0;k<t;k++)d.indices[L.COLOR][k]=k}if(g&&null==d.indices[L.NORMAL]){d.indices[L.NORMAL]=new Uint32Array(t);for(k=0;k<t;k++)d.indices[L.NORMAL][k]=k}l[r]=d;var k=s.textureID||"none",u=void 0;"none"!==k&&(u=c.textureDefinitions[k],O(void 0!==u,"geometry wants unknown texture "+k));if(u&&!0===u.atlas&&null!=u.regions){O(0<u.regions.length,"texture marked as atlas carries no region definition");
k=u.regions[s.regionID].subimageRegion;e=e.concat([65536*k[0],65536*(k[2]-k[0]),65536*(1-k[3]),65536*(k[3]-k[1])]);k=new Uint32Array(t);for(s=0;s<t;s++)k[s]=e.length/4-1;d.indices[L.REGION]=k}}}else{d={type:"triangle",positionKey:"position",indices:{}};a=f.position.data.length/f.position.size;if(a>W||null==R){for(;a>W;)W*=2;R=new Uint32Array(W);for(k=0;k<W;k++)R[k]=k}a=new Uint32Array(R.buffer,0,a);for(l in f)d.indices[l]=a;a=d.indices[d.positionKey];d.componentRange=[0,null!=a?a.length-1:0];l=[d]}0<
e.length&&(a=new Uint16Array(e),f[L.REGION]={data:a,size:4});return{indexArrays:l,vertexArrays:f}};q.prototype._createEngineMats=function(a,b,c,d,e){for(var f=a.params.components.length,g=Array(f),h=0;h<f;h++){var k=a.params.components[h],l=k.materialID,m=c.materialDefinitions[l];null!=m.href&&(m=d[m.hrefConcat].materialDefinitions[l]);O(void 0!==m,"geometry wants unknown material "+l);var n=k.textureID||"none",p=void 0;"none"!==n&&((null==c.textureDefinitions||null==c.textureDefinitions[n])&&this.layer.warningEvent("textureDefinitions missing in shared resource",
1),p=c.textureDefinitions[n]);k=void 0;this._matId2Meta[l]&&this._matId2Meta[l][n]?(l=this._matId2Meta[l][n],k=l.engineMat,l.refCount++):k=this._createEngineMaterial(p,n,m,l,b,e);g[h]=k}return g};q.prototype._areAllBundlesLoaded=function(a,b){if(null==this._nodeId2Meta[a.id]||null==this._nodeId2Meta[a.id].engineObjectsPerBundle)return!1;for(var c=0;c<a.featureData.length;c++){if(null==this._nodeId2Meta[a.id].engineObjectsPerBundle[c])return!1;if(!b)for(var d=this._nodeId2Meta[a.id].engineObjectsPerBundle[c],
e=0;e<d.length;e++)if(d[e].isPartiallyHidden())return!1}return!0};q.prototype._getObjectIdField=function(){return this.layer.objectIdField||"OBJECTID"};q.prototype._findGraphic=function(a){a=G(a.attributes,this._getObjectIdField());for(var b=0,c=Object.keys(this._nodeId2Meta);b<c.length;b++)for(var d=c[b],e=this._nodeId2Meta[d].engineObjects,f=0;f<e.length;f++){var g=e[f].getMetadata().featureIds.indexOf(a);if(-1!==g)return{node:this._controller.nodeIndex[d],nodeId:d,bundleNr:f,index:g}}return null};
q.prototype.whenGraphicBounds=function(a){var b=this._findGraphic(a);if(null!=b){a=this._nodeId2Meta[b.nodeId].engineObjects[b.bundleNr];for(var b=a.getMetadata().faceRanges[b.index],b=a.geometries[0].calculateBoundingInfo(0,b),d=b.bbMin,e=b.bbMax,b=[],f=0;8>f;++f){var g=[f&1?d[0]:e[0],f&2?d[1]:e[1],f&4?d[2]:e[2]];H.mat4d.multiplyVec3(a.objectTransformation,g);b[3*f]=g[0];b[3*f+1]=g[1];b[3*f+2]=g[2]}if(x.bufferToBuffer(b,this.view.renderSpatialReference,0,b,this.view.spatialReference,0,8)){a=v.create(v.NEGATIVE_INFINITY);
for(d=0;d<b.length;d+=3)for(e=0;3>e;e++)a[e]=Math.min(a[e],b[d+e]),a[e+3]=Math.max(a[e+3],b[d+e]);return c.resolve(a)}}return c.reject()};q.prototype.whenGraphicAttributes=function(a,b){var c=this,d=G(a.attributes,this._getObjectIdField());return m.whenGraphicAttributes(this.layer,a,d,b,function(){return c._findGraphic(a)})};q.prototype.getGraphicsFromStageObject=function(a,b){var d=a.getMetadata(),e=a.getFaceRangeIndexFromTriangleNr(b);if(null!=e&&null!=d.graphics&&null!=d.graphics[0].attributes)return c.resolve(d.graphics[e]);
if(null!=e&&null!=d.featureIds&&null!=d.featureIds[e]){var f={};f[this._getObjectIdField()]=d.featureIds[e];for(var g=0,h=Object.keys(d.attributeData);g<h.length;g++){var k=h[g];f[k]=d.attributeData[k][e]}d=new l(null,null,f);d.layer=this.layer;return c.resolve(d)}return c.reject()};q.prototype._calculateNormals=function(a,b){var c=b.normal,d=b.position,e=a[0].indices.normal,f=a[0].indices.position;O(e.length===f.length);for(var g=H.vec3.create(),h=H.vec3.create(),k=0;k<f.length;k+=3){var l=3*f[k],
m=d.data[l],n=d.data[l+1],p=d.data[l+2],l=3*f[k+1];g[0]=d.data[l]-m;g[1]=d.data[l+1]-n;g[2]=d.data[l+2]-p;l=3*f[k+2];h[0]=d.data[l]-m;h[1]=d.data[l+1]-n;h[2]=d.data[l+2]-p;H.vec3.cross(g,h,g);H.vec3.normalize(g);for(l=0;3>l;l++)m=3*e[k+l],c.data[m]=g[0],c.data[m+1]=g[1],c.data[m+2]=g[2]}};q.prototype._addBundle=function(a,b,c,d,e,f,g){if(!0===this.debugNodeVis&&null!=this._nodeDebugVisualizer){var h="grey";switch(a.level){case 1:h="red";break;case 2:h="green";break;case 3:h="blue";break;case 4:h=
"yellow";break;case 5:h="magenta";break;case 6:h="brown"}this._nodeDebugVisualizer.show(a,this._controller.crsIndex,h)}var h=this._stage,k={};k[Y.OBJECT]={};k[Y.GEOMETRY]={};k[Y.MATERIAL]={};k[Y.TEXTURE]={};var m=this._engineLayer,n=m.getId(),q=d[a.sharedResource.hrefConcat];if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle&&this._nodeId2Meta[a.id].engineObjectsPerBundle[g])this._hideFaceRangesOutsideBoundingBox(a,this._clippingArea),null!=e&&e.done();else if(!this.isOverMemory()){null==
this._nodeId2Meta[a.id]&&(this._nodeId2Meta[a.id]={engineObjects:[],engineObjectsPerBundle:[]});this._nodeId2Meta[a.id].engineObjectsPerBundle[g]=[];if(null!=b){for(var r=0;r<b.length;r++){var s=b[r].geometries,t=b[r].features,u=b[r].featureDataAttributes,v=d[a.geometryData[g].hrefConcat];O(v instanceof ArrayBuffer,"I3S: geometry data is not an ArrayBuffer");null==v._isReprojected&&(v._isReprojected={});for(var x=t[0].id.toString(),y=[],z=[],B=[],D=void 0,E=0;E<s.length;++E){var F=s[E],G=this._createVertexAndIndexArrays(F,
v,q);if(0!==G.indexArrays.length){var I=this._createEngineMats(F,t,q,d,f),D=p.reprojectPoints(this._controller.isMeshPyramid?p.ReprojectionTypes.PER_VERTEX:p.ReprojectionTypes.BOUNDINGBOX,G.vertexArrays.position.data,G.vertexArrays.normal.data,a.mbs,v._isReprojected[F.id],this._controller.crsIndex,this._controller.crsVertex,this.view.renderSpatialReference);v._isReprojected[F.id]=!0;this._controller.isMeshPyramid&&this._calculateNormals(G.indexArrays,G.vertexArrays);F=H.mat4d.create(F.transformation);
H.mat4d.multiply(D.localTrafo,F,F);for(var J=0;J<I.length;J++){var L=I[J];k[Y.MATERIAL][L.getId()]=L}G=new w(new C(G.indexArrays,G.vertexArrays),x+"_"+E);this.memEstimateGeometryAdded(G.getData());k[Y.GEOMETRY][G.getId()]=G;y[E]=G;z[E]=F;B[E]=I}}s=[];for(v=0;v<t.length;v++)E=new l(void 0,void 0,u[v]),E.set("layer",this.layer),s.push(E);t=new A({idHint:a.id,name:x,geometries:y,materials:B,transformations:z,castShadow:!0,metadata:{graphics:s,i3sNode:a.id,ceLayer:n,features:t,faceRanges:b[r].faceRanges,
featureIds:b[r].featureIds,attributeData:c?c.attributeData:null,loadedAttributes:c?c.loadedAttributes:null,layerId:this.layer.id}});u=H.mat4d.create();H.mat4d.identity(u);H.mat4d.multiply(u,D.globalTrafo,u);t.setObjectTransformation(u);this._nodeId2Meta[a.id].engineObjectsPerBundle[g].push(t);this._nodeId2Meta[a.id].engineObjects.push(t);k[Y.OBJECT][t.getId()]=t;this._setObjectSymbology(t);null!=this._clippingArea&&this._hideFaceRangesOutsideBoundingBox(a,this._clippingArea)}h.beginMod();a=k[Y.OBJECT];
for(var M in a)a.hasOwnProperty(M)&&m.addObject(a[M]);for(var N in k)if(k.hasOwnProperty(N))for(name in M=k[N],M)M.hasOwnProperty(name)&&null==h.get(N,name)&&h.add(N,M[name]);h.endMod()}null!=e&&e.done()}};q.prototype._clippingAreaChanged=function(){var a=this,b=[];x.extentToBoundingBox(this.view.clippingArea,b,this.view.renderSpatialReference)?this._clippingArea=b:this._clippingArea=null;if(this._controller){var c=this._controller.nodeIndex;c&&Object.keys(this._nodeId2Meta).forEach(function(b){return a._hideFaceRangesOutsideBoundingBox(c[b],
a._clippingArea)});this._controller.updateClippingArea(this.view.clippingArea)}};q.prototype._hideFaceRangesOutsideBoundingBox=function(a,b){if(this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjects){var c=[0,0,0,0];x.mbsToMbs(a.mbs,this._controller.crsIndex,c,this.view.renderSpatialReference);for(var c=null!=b?m.intersectBoundingBoxWithMbs(b,c):2,d=this._nodeId2Meta[a.id].engineObjects,e=0;e<d.length;e++){var f=d[e];if(0===c)f.hideAllFaceRanges();else if(f.unhideAllFaceRange(),2!==
c){var g=f.getObjectTransformation(),h=f.getGeometryRecords()[0].transformation;H.mat4d.multiply(g,h);if(!(0!==g[1]||0!==g[2]||0!==g[3]||0!==g[4]||0!==g[6]||0!==g[7]||0!==g[8]||0!==g[9]||0!==g[11]||1!==g[15])){for(var h=(b[0]-g[12])/g[0],k=(b[1]-g[13])/g[5],l=(b[2]-g[14])/g[10],n=(b[3]-g[12])/g[0],p=(b[4]-g[13])/g[5],g=(b[5]-g[14])/g[10],q=f.getGeometryRecords()[0].geometry.getData(),r=q.getFaces()[0].indices.position,q=q.getVertexAttr().position.data,s=[],t=f.getMetadata().faceRanges,u=void 0,v=
void 0,w=void 0,y=void 0,z=void 0,A=void 0,B=0;B<t.length;B+=1){for(var C=t[B],D=C[0],E=C[1],u=v=w=Number.MAX_VALUE,y=z=A=-Number.MAX_VALUE;D<=E;D+=1)for(var F=0;3>F;F+=1)var G=3*r[3*D+F],I=q[G],J=q[G+1],G=q[G+2],u=Math.min(I,u),v=Math.min(J,v),w=Math.min(G,w),y=Math.max(I,y),z=Math.max(J,z),A=Math.max(G,A);(u>n||y<h||v>p||z<k||w>g||A<l)&&s.push(C)}0<s.length&&f.hideFaceRange(f.getGeometryRecords()[0],s)}}}}};q.prototype._hideFeatures=function(a,b){for(var c=this._nodeId2Meta[a.id].engineObjects,
d=0;d<c.length;d++){for(var e=c[d],f=[],g=e.getMetadata().features,h=e.getMetadata().faceRanges,k=0;k<b.length;k++)for(var l=b[k],m=0;m<g.length;m++)l===g[m].id&&(null!=h&&1===e.getGeometryRecords().length?f.push(h[m]):e.hideAllFaceRanges());0<f.length&&e.hideFaceRange(e.getGeometryRecords()[0],f)}};q.prototype._removeFeatures=function(a,b){null!=this._nodeId2Meta[a.id]&&(this._hideFeatures(a,b),!0===this._isAllHidden(a)&&this._removeNodeDataFromStage(a))};q.prototype._removeNodeDataFromStage=function(a){if(!(null==
this._nodeId2Meta[a.id]||null==this._nodeId2Meta[a.id].engineObjects)){for(var b=this._stage,c=this._engineLayer,d=this._nodeId2Meta[a.id].engineObjects,e=0;e<d.length;++e){var f=d[e];c.removeObject(f);for(var g=f.getGeometryRecords(),h=0;h<g.length;h++){var k=g[h];this.memEstimateGeometryRemoved(k.geometry.getData());b.remove(Y.GEOMETRY,k.geometry.getId());for(var l=0;l<k.materials.length;l++){var m=k.materials[l],n=m.getId(),p=m.metadata.i3sMatId,q=m.metadata.i3sTexId||"none",r=this._matId2Meta[p][q];
O(0<r.refCount);r.refCount--;0===r.refCount&&this._removeMaterial(n,q,p,m,b)}}b.remove(Y.OBJECT,f.getId())}delete this._nodeId2Meta[a.id]}};q.prototype._removeMaterial=function(a,b,c,d,e){e.remove(Y.MATERIAL,a);if("none"!==b){a=this._texId2Meta[b];var f=a.usedByEngineMats;d=f.indexOf(d);O(-1<d);f[d]=f[f.length-1];f.pop();if(1>f.length){if((d=a.engineTex)&&d!==this._initTexture)this.memEstimateTextureRemoved(d),e.remove(Y.TEXTURE,a.engineTex.getId());a.engineTex=void 0;a.desiredLOD=-1;a.curLOD=-1;
delete this._texId2Meta[b]}}delete this._matId2Meta[c][b];V(this._matId2Meta[c])&&delete this._matId2Meta[c]};q.prototype._updateAllTextureLOD=function(){for(var a in this._texId2Meta)this._texId2Meta.hasOwnProperty(a)&&this._updateTextureLOD(this._texId2Meta[a])};q.prototype._calcDesiredTextureLOD=function(a,b){var c,d=0;for(c in a)if(a.hasOwnProperty(c)){var e=a[c],e=2*e[3]/H.vec3.dist(e,this._controller.camPos)*this._controller.screenSizeFactor;e>d&&(d=e)}d/=9;for(c=b.length-1;0<c&&b[c].size<d;)c--;
return c};q.prototype._updateTextureLOD=function(a){var b=this;a.desiredLOD=this._calcDesiredTextureLOD(a.featureMBS,a.images);if(a.curLOD!==a.desiredLOD&&(0>a.curLOD||!a.curLOD||0===a.desiredLOD||a.desiredLOD>a.curLOD||a.desiredLOD<a.curLOD-1)){if(0===a.images.length)return;var c=a.images[a.desiredLOD],d=-1<a.encodingIdx?c.hrefConcat[a.encodingIdx]:c.hrefConcat;if(!this._requestedTexImageIds[c.id]){var e={metadata:{texMeta:a,image:c}};this._requestedTexImageIds[c.id]=!0;this._imageIsPartOfTextureBundle(c)?
this._controller.streamDataSupplier.request(d,"binary",e).then(this._extractTextureImageFromBlob.bind(this)):this._controller.streamDataSupplier.request(d,"image",e).then(function(a,c,d,e){b._textureImageLoaded(a,c,e.image,e.texMeta)})}}a.engineTex||(a.engineTex=this._initTexture,a.curLOD=-1);if(this.debugLODVis){c=f.fromHsv(270*(a.desiredLOD/a.images.length),100,100).toRgb().map(function(a){return a/255});for(d=0;d<a.usedByEngineMats.length;d++)a.usedByEngineMats[d].setParameterValues({ambient:c,
diffuse:c})}};q.prototype._extractTextureImageFromBlob=function(a,b,c,d){var e=d.texMeta;if(0>e.desiredLOD||d.image.size>e.images[e.desiredLOD].size)delete this._requestedTexImageIds[d.image.id];else{var f=this;O("binary"===c);var g="";try{var h=c=0;-1<e.encodingIdx?(c=d.image.byteOffset[e.encodingIdx],h=d.image.length[e.encodingIdx]):(c=d.image.byteOffset,h=d.image.length);var k=new Uint8Array(b,c,h),l=new Blob([k],{type:e.encoding}),g=window.URL.createObjectURL(l)}catch(m){g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIElEQVQ4T2P8zyD6n4ECwDhqAMNoGDCMhgEwDw2DdAAAdzkhQdS8dl8AAAAASUVORK5CYII\x3d",
console.error("error loading texture "+a+" "+m)}var n=new Image;n.onerror=function(){window.URL.revokeObjectURL(g);n.src="";n.onerror=void 0;n.onload=void 0};n.onload=function(){f._controller.queueAnimationFrameFunctionCall(f._textureImageLoaded,f,[a,n,d.image,d.texMeta,g],void 0,1);window.URL.revokeObjectURL(g);n.src="";n.onerror=void 0;n.onload=void 0};n.src=g}};q.prototype._textureImageLoaded=function(a,b,c,d){delete this._requestedTexImageIds[c.id];if(!(0>d.desiredLOD)){a=d.images[d.desiredLOD];
var e=d.images[d.curLOD];if(!this.isOverMemory()||!(null==e||c.size>e.size))if(!e||c.size>e.size&&c.size<=a.size||c.size<e.size&&c.size>=a.size){if((e=d.engineTex)&&e!==this._initTexture)this.memEstimateTextureRemoved(e),this._stage.remove(Y.TEXTURE,d.engineTex.getId());e=N(b,d);d.engineTex=new y(b,d.id,e);this._stage.add(Y.TEXTURE,d.engineTex);d.curLOD=d.desiredLOD;this.memEstimateTextureAdded(d.engineTex);b=d.engineTex.getId();for(e=0;e<d.usedByEngineMats.length;e++){var f=d.usedByEngineMats[e];
null==this._colorOverride&&f.setParameterValues({textureId:b});f.metadata.originalTextureId=b}c!==a&&(d.curLOD=d.images.indexOf(c),O(-1<d.curLOD),this._requestedTexImageIds[a.id]||(c={metadata:{texMeta:d,image:a}},this._requestedTexImageIds[a.id]=!0,this._controller.streamDataSupplier.request(a.hrefConcat,"binary",c).then(this._extractTextureImageFromBlob.bind(this))))}}};q.prototype._imageIsPartOfTextureBundle=function(a){return!this._controller.isMeshPyramid};q.prototype._setPolygonOffset=function(a,
b){if(null!=this._nodeId2Meta[a.id]&&null!=this._nodeId2Meta[a.id].engineObjectsPerBundle)for(var c={polygonOffset:b},d=0;d<this._nodeId2Meta[a.id].engineObjectsPerBundle.length;d++)for(var e=this._nodeId2Meta[a.id].engineObjectsPerBundle[d],f=0;f<e.length;f++)for(var g=e[f].getGeometryRecords(),h=0;h<g.length;h++)for(var k=g[h].materials,l=0;l<k.length;l++)k[l].setParameterValues(c)};q.prototype._rendererChange=function(a){(this._currentRenderer=a)&&(a.colorInfo||a.sizeInfo)&&console.warn("renderer.colorInfo and renderer.sizeInfo are not supported for Scene Services. Use visualVariables instead.")};
q.prototype._getRenderer=function(a){return!a||a.symbol?null:this._rndForScale||this._currentRenderer};q.prototype._getSymbol=function(a){if(a.symbol)return a.symbol;var b=this._getRenderer(a);return b&&b.getSymbol(a)};q.prototype._getRenderingInfo=function(a){var b=this._getRenderer(a),c=this._getSymbol(a);if(!c||!(c instanceof d))return null;var c={symbol:c},e;if(b&&b.visualVariables){a=b.getVisualVariableValues(a);for(b=0;b<a.length;b++){var f=a[b];"color"===f.variable.type&&(e=f.value)}}e&&(c.color=
[e.r/255,e.g/255,e.b/255,e.a]);return c};q.prototype._getSymbolFillColor=function(a){a=a.symbolLayers;for(var b=0;b<a.length;b++){var c=a.getItemAt(b);if("Fill"===c.type&&c.material&&c.material.color)return a=c.material.color,[a.r/255,a.g/255,a.b/255,a.a]}};q.prototype._setObjectSymbology=function(a){for(var b=a.getMetadata(),c=[],d=b.graphics,e=!1,f=d.length,g=b.faceRanges?b.faceRanges.length:f,h={attributes:{}},k=function(a){g===f&&null==b.attributeData?h=d[a]:Object.keys(b.attributeData).forEach(function(c){h.attributes[c]=
b.attributeData[c][a]});var k=l._getRenderingInfo(h),m=null!=b.faceRanges?b.faceRanges[a]:null;if(k){var n=k.color;null==n&&k.symbol&&(n=l._getSymbolFillColor(k.symbol));n&&1>n[3]&&(e=!0);c.push({faceRanges:m,color:n})}else c.push({faceRanges:m,color:void 0})},l=this,m=0;m<g;m++)k(m);this.layer.cachedDrawingInfo.color?a.setFacerangeColors(c,"replace"):a.setFacerangeColors(c,"blend");a=a.getGeometryRecords();for(k=0;k<a.length;k++)for(var m=a[k],n=0;n<m.materials.length;n++){var p=m.materials[n],q=
p.getParams().transparent,r=p.getParams().opacity;p.metadata.symbolIsTransparent=e;var s=this._calcEngineMaterialTransparencyParams(p.metadata.i3sTex,p.metadata.i3sMatParams,p.metadata.symbolIsTransparent);(q!==s.transparent||r!==s.opacity)&&p.setParameterValues({transparent:s.transparent,opacity:s.opacity})}};q.prototype._opacityChange=function(a){for(var b in this._matId2Meta)for(var c in this._matId2Meta[b]){a=this._matId2Meta[b][c].engineMat;var d=a.getParams().transparent,e=a.getParams().opacity,
f=this._calcEngineMaterialTransparencyParams(a.metadata.i3sTex,a.metadata.i3sMatParams,a.metadata.symbolIsTransparent);(d!==f.transparent||e!==f.opacity)&&a.setParameterValues({transparent:f.transparent,opacity:f.opacity})}};k([h.shared("esri.views.3d.layers.SceneLayerView3D")],q.prototype,"declaredClass",void 0);k([h.property()],q.prototype,"layer",void 0);k([h.property()],q.prototype,"view",void 0);return q=k([h.subclass([t])],q)}(r)})},"dojox/color":function(){define(["./color/_base"],function(s){return s})},
"dojox/color/_base":function(){define(["../main","dojo/_base/lang","dojo/_base/Color","dojo/colors"],function(s,q,n,k){s=q.getObject("color",!0,s);s.Color=n;s.blend=n.blendColors;s.fromRgb=n.fromRgb;s.fromHex=n.fromHex;s.fromArray=n.fromArray;s.fromString=n.fromString;s.greyscale=k.makeGrey;q.mixin(s,{fromCmy:function(h,e,c){q.isArray(h)?(e=h[1],c=h[2],h=h[0]):q.isObject(h)&&(e=h.m,c=h.y,h=h.c);e=1-e/100;c=1-c/100;return new n({r:Math.round(255*(1-h/100)),g:Math.round(255*e),b:Math.round(255*c)})},
fromCmyk:function(h,e,c,b){q.isArray(h)?(e=h[1],c=h[2],b=h[3],h=h[0]):q.isObject(h)&&(e=h.m,c=h.y,b=h.b,h=h.c);e/=100;c/=100;b/=100;h=1-Math.min(1,h/100*(1-b)+b);e=1-Math.min(1,e*(1-b)+b);c=1-Math.min(1,c*(1-b)+b);return new n({r:Math.round(255*h),g:Math.round(255*e),b:Math.round(255*c)})},fromHsl:function(h,e,c){q.isArray(h)?(e=h[1],c=h[2],h=h[0]):q.isObject(h)&&(e=h.s,c=h.l,h=h.h);e/=100;for(c/=100;0>h;)h+=360;for(;360<=h;)h-=360;var b,g;120>h?(b=(120-h)/60,g=h/60,h=0):240>h?(b=0,g=(240-h)/60,h=
(h-120)/60):(b=(h-240)/60,g=0,h=(360-h)/60);b=2*e*Math.min(b,1)+(1-e);g=2*e*Math.min(g,1)+(1-e);h=2*e*Math.min(h,1)+(1-e);0.5>c?(b*=c,g*=c,h*=c):(b=(1-c)*b+2*c-1,g=(1-c)*g+2*c-1,h=(1-c)*h+2*c-1);return new n({r:Math.round(255*b),g:Math.round(255*g),b:Math.round(255*h)})}});s.fromHsv=function(h,e,c){q.isArray(h)?(e=h[1],c=h[2],h=h[0]):q.isObject(h)&&(e=h.s,c=h.v,h=h.h);360==h&&(h=0);e/=100;c/=100;var b,g,f;if(0==e)g=f=b=c;else{var a=h/60;h=Math.floor(a);var k=a-h,a=c*(1-e),l=c*(1-e*k);e=c*(1-e*(1-
k));switch(h){case 0:b=c;g=e;f=a;break;case 1:b=l;g=c;f=a;break;case 2:b=a;g=c;f=e;break;case 3:b=a;g=l;f=c;break;case 4:b=e;g=a;f=c;break;case 5:b=c,g=a,f=l}}return new n({r:Math.round(255*b),g:Math.round(255*g),b:Math.round(255*f)})};q.extend(n,{toCmy:function(){var h=1-this.g/255,e=1-this.b/255;return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*h),y:Math.round(100*e)}},toCmyk:function(){var h,e,c,b=this.r/255;h=this.g/255;e=this.b/255;c=Math.min(1-b,1-h,1-e);h=(1-h-c)/(1-c);e=(1-e-c)/(1-
c);return{c:Math.round(100*((1-b-c)/(1-c))),m:Math.round(100*h),y:Math.round(100*e),b:Math.round(100*c)}},toHsl:function(){var h=this.r/255,e=this.g/255,c=this.b/255,b=Math.min(h,c,e),g=Math.max(h,e,c),f=g-b,a=0,k=0,b=(b+g)/2;0<b&&1>b&&(k=f/(0.5>b?2*b:2-2*b));0<f&&(g==h&&g!=e&&(a+=(e-c)/f),g==e&&g!=c&&(a+=2+(c-h)/f),g==c&&g!=h&&(a+=4+(h-e)/f),a*=60);return{h:a,s:Math.round(100*k),l:Math.round(100*b)}},toHsv:function(){var h=this.r/255,e=this.g/255,c=this.b/255,b=Math.min(h,c,e),g=Math.max(h,e,c),
b=g-b,f=null,a=0==g?0:b/g;0==a?f=0:(f=h==g?60*(e-c)/b:e==g?120+60*(c-h)/b:240+60*(h-e)/b,0>f&&(f+=360));return{h:f,s:Math.round(100*a),v:Math.round(100*g)}}});return s})},"dojox/main":function(){define(["dojo/_base/kernel"],function(s){return s.dojox})},"esri/views/3d/layers/i3s/I3SProjectionUtil":function(){define(["../../support/projectionUtils","../../lib/glMatrix"],function(s,q){var n=q.vec3d,k=q.mat4d,h={PER_VERTEX:"perVertex",BOUNDINGBOX:"boundingBox",NO_REPROJECTION:"noReprojection"},e=new Float64Array(3E3);
return{ReprojectionTypes:h,reprojectPoints:function(c,b,e,f,a,n,l,d){c===h.PER_VERTEX?f=this.reprojectPointsPerVertex(b,e,f,n,l,d,a):c===h.BOUNDINGBOX?f=this.reprojectBoundingBox(b,f,n,l,d):(c=k.create(),k.identity(c),b=k.create(),s.computeLinearTransformation(n,f,b,d),f={localTrafo:c,globalTrafo:b});return f},reprojectPointsPerVertex:function(c,b,g,f,a,h,l){b=k.create();s.computeLinearTransformation(f,g,b,h);var d=k.create(),d=k.inverse(b,d),m=k.create();k.identity(m);if(!l){l=[0,0,0];var n=c.length/
3;s.vectorToVector(g,f,l,a);for(f=g=0;f<n;f+=1E3){var q=Math.min(1E3,n-f);for(g=0;g<q;g++)e[3*g]=c[3*(f+g)]+l[0],e[3*g+1]=c[3*(f+g)+1]+l[1],e[3*g+2]=c[3*(f+g)+2]+l[2];s.bufferToBuffer(e,a,0,e,h,0,q);var x,v,u;for(g=0;g<q;g++)x=e[3*g],v=e[3*g+1],u=e[3*g+2],c[3*(f+g)]=d[0]*x+d[4]*v+d[8]*u+d[12],c[3*(f+g)+1]=d[1]*x+d[5]*v+d[9]*u+d[13],c[3*(f+g)+2]=d[2]*x+d[6]*v+d[10]*u+d[14]}}return{localTrafo:m,globalTrafo:b}},reprojectBoundingBox:function(c,b,e,f,a){for(var h=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],
l=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],d=0;d<c.length/3;d++)for(var m=[c[3*d],c[3*d+1],c[3*d+2]],p=0;3>p;p++)h[p]=Math.min(h[p],m[p]),l[p]=Math.max(l[p],m[p]);d=this.geographicToProjected(b,e,f);n.add(d,h,h);n.add(d,l,l);for(d=0;3>d;d++)l[d]==h[d]&&(l[d]+=1);d=[[h[0],h[1],h[2]],[l[0],h[1],h[2]],[h[0],l[1],h[2]],[h[0],h[1],l[2]]];for(m=0;4>m;m++)p=d[m],s.vectorToVector(p,f,p,a);f=n.subtract(d[1],d[0],n.create());m=n.subtract(d[2],d[0],n.create());p=n.subtract(d[3],d[0],n.create());
n.scale(f,1/(l[0]-h[0]));n.scale(m,1/(l[1]-h[1]));n.scale(p,1/(l[2]-h[2]));var h=n.length(f),l=n.length(m),q=n.length(p);if(3<Math.abs(h-l)||3<Math.abs(h-q)||3<Math.abs(l-q)){for(d=0;d<c.length/3;d++)c[3*d]*=h,c[3*d+1]*=l,c[3*d+2]*=q;n.normalize(f);n.normalize(m);n.normalize(p)}c=k.createFromMatrixRowMajor([f[0],m[0],p[0],0,f[1],m[1],p[1],0,f[2],m[2],p[2],0,0,0,0,1]);h=[0,0,0,0];s.vectorToVector(b,e,h,a);return{globalTrafo:k.createFromMatrixRowMajor([1,0,0,h[0],0,1,0,h[1],0,0,1,h[2],0,0,0,1]),localTrafo:c}},
geographicToProjected:function(c,b,e){return 4326===e.wkid?[c[0],c[1],c[2]]:c}}})},"esri/views/3d/webgl-engine/lib/base64Binary":function(){define(["require","exports"],function(s,q){function n(e){var c=k[e.charAt(e.length-1)],b=k[e.charAt(e.length-2)],g=3*(e.length/4);64===c&&g--;64===b&&g--;c=new ArrayBuffer(g);b=new Uint8Array(c);e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var f=0,a=0;a<g;a+=3){var h=k[e.charAt(f++)],l=k[e.charAt(f++)],d=k[e.charAt(f++)],m=k[e.charAt(f++)],n=(l&15)<<4|d>>2,q=(d&
3)<<6|m;b[a]=h<<2|l>>4;64!==d&&(b[a+1]=n);64!==m&&(b[a+2]=q)}return c}for(var k={},h=0;65>h;h++)k["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[h]]=h;q.decode=n;q.decodeFloat32=function(e){return new Float32Array(n(e))};q.decodeUint32=function(e){return new Uint32Array(n(e))};q.decodeInt32=function(e){return new Int32Array(n(e))};q.encode=function(e){var c;c=e instanceof Uint8Array?e:new Uint8Array(c.buffer,c.byteOffset,c.byteLength);e=c.length%3;for(var b="",g,f=0,a=c.length-
e;f<a;f+=3)g=(c[f]<<16)+(c[f+1]<<8)+c[f+2],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[g>>18&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[g>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[g>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[g&63];switch(e){case 1:g=c[c.length-1];b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[g>>2];b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[g<<
4&63];b+="\x3d\x3d";break;case 2:g=(c[c.length-2]<<8)+c[c.length-1],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[g>>10],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[g>>4&63],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"[g<<2&63],b+="\x3d"}return b}})},"url:esri/views/3d/environment/materials/RealisticAtmosphereMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3c!--Vertex Shader for Atmosphere--\x3e\r\n\x3csnippet name\x3d"vsRealisticAtmosphere"\x3e\x3c![CDATA[\r\n//\r\n// Based on Atmospheric scattering vertex shader by Sean O\'Neil from GPU Gems 2 Chapter 16.\r\n//\r\n// Link:                   http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter16.html\r\n// Download Portal:        http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Index.html\r\n// Unmodified Source Code: http://http.download.nvidia.com/developer/GPU_Gems_2/CD/Content/16.zip\r\n//\r\n// Adapted for WebGIS by Jascha Gr\u00fcbel (jgruebel@esri.com), Z\u00fcrich 2015\r\n//\r\n\r\n  precision mediump  float;\r\n\r\n  //Camera\r\n  uniform vec2 halfSizeNearPlane;\r\n  uniform vec3 v3CameraUp;\r\n  uniform vec3 v3CameraRight;\r\n  uniform vec3 v3CameraDir;\r\n  uniform vec2 v2CameraCenterOffset;\r\n\r\n  //Attributes\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  //Varyings\r\n  varying vec3 v3WorldRay;\r\n  varying vec2 vtc;\r\n\r\n#ifdef HAZE\r\n  varying vec3 v3EyeDir;\r\n#endif\r\n\r\n  void main(void) {\r\n    vec3 v3Pos \x3d $position;\r\n    vtc \x3d $uv0;\r\n    vec2 rayvtc \x3d $uv0 - v2CameraCenterOffset;\r\n\r\n#ifdef HAZE\r\n    v3EyeDir \x3d vec3((2.0*halfSizeNearPlane *rayvtc)-halfSizeNearPlane,-1.0);\r\n#else\r\n    vec3 v3EyeDir \x3d vec3((2.0*halfSizeNearPlane *rayvtc)-halfSizeNearPlane,-1.0);\r\n#endif\r\n    v3WorldRay \x3d v3EyeDir.z*v3CameraDir + v3EyeDir.y*v3CameraUp + v3EyeDir.x*v3CameraRight;\r\n    gl_Position \x3d vec4(v3Pos, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereScaleFunction"\x3e\x3c![CDATA[\r\n  //Approximation for inner integral based on a radii ratio of 10.25:10\r\n  float scale(float fCos){\r\n    float x \x3d 1.0 - fCos;\r\n    return exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"toneMapperConstants"\x3e\x3c![CDATA[\r\n#ifdef HAZE\r\n  const float fOneOverGamma \x3d 1.0;//Gamma \x3d 1.0\r\n#else\r\n  const float fOneOverGamma \x3d 0.454545; // Gamma \x3d 2.2\r\n#endif\r\n  const vec3 v3OneOverGamma \x3d vec3(fOneOverGamma);\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"exponentialToneMapper"\x3e\x3c![CDATA[\r\n  //ToneMapping operators\r\n  vec3 expTM(vec3 inputColor,float exposure){\r\n      return pow(1.0 - exp(inputColor * -exposure), v3OneOverGamma);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"reinhardToneMapper"\x3e\x3c![CDATA[\r\n  vec3 reinhardTM(vec3 inputColor, float exposure){\r\n      vec3 intermediate \x3d inputColor *exposure;\r\n      intermediate /\x3d (1.0+intermediate);\r\n      return pow(intermediate, v3OneOverGamma);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"HSVColorSpace"\x3e\x3c![CDATA[\r\n//based on http://gamedev.stackexchange.com/a/59808\r\n// Hue in range [0,1] instead of 360\u00b0\r\nvec3 rgb2hsv(vec3 c)\r\n{\r\n    vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\r\n    vec4 p \x3d mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\r\n    vec4 q \x3d mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\r\n\r\n    float d \x3d q.x - min(q.w, q.y);\r\n    float e \x3d 1.0e-10;\r\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\r\n}\r\n\r\nvec3 hsv2rgb(vec3 c)\r\n{\r\n    vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\r\n    vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\r\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereUniformsConstantsVaryings"\x3e\x3c![CDATA[\r\n\r\n  //Light\r\n  uniform vec3 v3LightDir;      // The direction vector to the light source\r\n  uniform vec3 v3InvWavelength; // 1 / pow(wavelength, 4) for the red, green, and blue channels\r\n  uniform vec3 v3InvWavelengthScaled; //v3InvWavelength * fKr4PI + fKm4PI\r\n\r\n  //Radii\r\n  uniform vec4 v4Radii; // inner, inner^2, outer, outer^2,\r\n\r\n  //Atmosphere\r\n  const float fKrESun \x3d 0.075;        // Kr * ESun \x3d 0.005 * 15.0\r\n  const float fKmESun \x3d 0.015;        // Km * ESun \x3d 0.005 * 15\r\n  //uniform float fScale;         // 1 / (fOuterRadius - fInnerRadius)\r\n  //uniform float fScaleDepth;    // The scale depth (i.e. the altitude at which the atmosphere\'s average density is found)\r\n  //uniform float fScaleOverScaleDepth; // fScale / fScaleDepth\r\n  //uniform float fOneOverScaleDepth; // 1.0 / fScaleDepth\r\n\r\n  //uniform float fScaleDepthBlue;    // The scale depth (i.e. the altitude at which the atmosphere\'s average density is found)\r\n  //uniform float fScaleOverScaleDepthBlue; // fScale / fScaleDepth\r\n  //uniform float fOneOverScaleDepthBlue; // 1.0 / fScaleDepth\r\n\r\n  uniform vec4 v4AtmosParams1; //(fScale,fScaleDepth,fScaleOverScaleDepth,fOneOverScaleDepth)\r\n  uniform vec4 v4AtmosParams2; //(g,fScaleDepthBlue,fScaleOverScaleDepthBlue,fOneOverScaleDepthBlue)\r\n#ifndef HAZE\r\n  uniform vec4 v4AtmosParams3; //(g2,fMiePhaseCoefficients,fLowerAlphaBlendBound,fOneOverOuterRadiusMinusAlphaBlendBound)\r\n#endif\r\n\r\n  //Camera\r\n  uniform vec3 v3CameraPos;     // The camera\'s current position\r\n  //uniform float fCameraHeight;  // The camera\'s current height\r\n  //uniform float fCameraHeight2; // fCameraHeight^2\r\n  //uniform float fC; //fCameraHeight2 - fOuterRadius2; // C \x3d ||o-c||^2 - r^2\r\n  //uniform float fCSur; //fCameraHeight2 - (fInnerRadius2 - 63756370000.0); // C \x3d ||o-c||^2 - r^2\r\n  uniform vec4 v4SphereComp; //The camera\'s current height, CameraHeight^2,fC,fCSur\r\n  uniform vec2 nearFar;\r\n#ifdef HAZE\r\n  uniform vec4 v4Viewport;\r\n#endif\r\n\r\n  //Camera HDR\r\n#ifdef HAZE\r\n  const float fExposure \x3d 1.5;\r\n#else\r\n  const float fExposure \x3d 2.0;\r\n#endif\r\n\r\n#ifdef HAZE\r\n  //Depth texture\r\n  uniform sampler2D tDepth;\r\n  uniform sampler2D tColor;\r\n#endif\r\n\r\n  //Testing variables\r\n  uniform float showTest;\r\n\r\n  //Varyings\r\n  varying vec3 v3EyeDir;\r\n  varying vec3 v3WorldRay;\r\n  varying vec2 vtc;\r\n\r\n  //Loop constants for integral approximation\r\n  const float fSamples \x3d 5.0;\r\n  const int maxSamples \x3d 5;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmospherePrecomputation"\x3e\x3c![CDATA[\r\n    float fInnerRadius \x3d v4Radii[0];   // The inner (planetary) radius\r\n    float fInnerRadius2 \x3d v4Radii[1];  // fInnerRadius^2\r\n    float fOuterRadius \x3d v4Radii[2];   // The outer (atmosphere) radius\r\n    float fOuterRadius2 \x3d v4Radii[3];  // fOuterRadius^2\r\n\r\n    float fCameraHeight \x3d v4SphereComp[0];\r\n    float fCameraHeight2 \x3d v4SphereComp[1];\r\n    float fC \x3d v4SphereComp[2];\r\n    float fCSur \x3d v4SphereComp[3];\r\n\r\n#ifdef PLANAR\r\n    vec3 cameraPosition \x3d vec3(0.0,0.0,fCameraHeight);\r\n#else\r\n    vec3 cameraPosition \x3d v3CameraPos;\r\n#endif\r\n\r\n    //Debug variables\r\n    vec3 test \x3d vec3(0.0,0.0,0.0);\r\n\r\n    //Obtain ray from Camera\r\n    vec3 worldSpaceRay \x3d normalize(v3WorldRay);\r\n\r\n    //Compute Atmosphere intersection; i.e. ray/sphere intersection\r\n    float B \x3d 2.0 * dot(cameraPosition, worldSpaceRay); // B \x3d 2(l * (o-c))\r\n    float det \x3d B*B - 4.0 * fC; // det \x3d B^2 - 4.0* C\r\n\r\n    //idealized sphere intersection to discard early some pixels\r\n    float detSur \x3d B*B - 4.0 * fCSur; // det \x3d B^2 - 4.0* C\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereDiscardPixels"\x3e\x3c![CDATA[\r\n#ifdef HAZE\r\n      //load texture value early\r\n      float cameraSpaceZ \x3d rgba2float(texture2D(tDepth, vtc));\r\n      test \x3d vec3(cameraSpaceZ,0.0,0.0);\r\n\r\n      bool continueComputation \x3d false;\r\n      float nearSurfaceT;\r\n      if (detSur\x3e0.0){\r\n        nearSurfaceT \x3d 0.5 *(-B - sqrt(detSur));\r\n      }\r\n\r\n      float rayEndT;\r\n\r\n      //Find intersections with ground\r\n\r\n      //Sample Pixel below actual pixel to get rid of aliasing effects: IMPORT is based on view constrains in WSV3.8, changing the view constrains will\r\n      //cause aliasing. Proper implemenation would average between neighboring pixels!\r\n      vec2 vtc_below \x3d vec2(vtc.x,vtc.y - 1.0/v4Viewport[3]);\r\n      float cameraSpaceZ_below \x3d rgba2float(texture2D(tDepth, vtc_below));\r\n      if (cameraSpaceZ \x3c 1.00 \x26\x26 cameraSpaceZ \x3e 0.0){ // not behind the far clipping plane or in front of the near\r\n        float linDepth \x3d cameraSpaceZ*(nearFar[1] - nearFar[0] ) + nearFar[0];\r\n\r\n        vec3 cameraSpaceRay \x3d normalize(v3EyeDir);\r\n        cameraSpaceRay /\x3d cameraSpaceRay.z;\r\n        cameraSpaceRay *\x3d linDepth;\r\n#ifndef PLANAR\r\n        if((fCameraHeight-fInnerRadius)\x3e8000000.0 \x26\x26 detSur\x3e0.0){\r\n          rayEndT \x3d nearSurfaceT;\r\n        } else  if ((fCameraHeight-fInnerRadius)\x3e2000000.0 \x26\x26 detSur\x3e0.0){\r\n          rayEndT \x3d mix(length(cameraSpaceRay),nearSurfaceT,((fCameraHeight-fInnerRadius)-2000000.0)/6000000.0);\r\n        } else {\r\n          rayEndT \x3d length(cameraSpaceRay);\r\n        }\r\n#else\r\n        rayEndT \x3d length(cameraSpaceRay);\r\n#endif\r\n        continueComputation \x3d true;\r\n      } else if (cameraSpaceZ \x3d\x3d 0.0 \x26\x26 cameraSpaceZ_below \x3c 1.00 \x26\x26 cameraSpaceZ_below \x3e 0.0){\r\n        float linDepth \x3d cameraSpaceZ_below*(nearFar[1] - nearFar[0] ) + nearFar[0];\r\n\r\n        vec3 cameraSpaceRay \x3d normalize(v3EyeDir);\r\n        cameraSpaceRay /\x3d cameraSpaceRay.z;\r\n        cameraSpaceRay *\x3d linDepth;\r\n        rayEndT \x3d length(cameraSpaceRay);\r\n        continueComputation \x3d true;\r\n      }\r\n#ifdef PLANAR\r\n      if (16500.0+ fInnerRadius \x3c fCameraHeight){\r\n        continueComputation \x3d false;\r\n      }\r\n#endif\r\n#else\r\n      bool continueComputation \x3d true;\r\n      if (detSur\x3e0.0){\r\n        float nearSurfaceT \x3d 0.5 *(-B - sqrt(detSur));\r\n        if (nearSurfaceT \x3e 0.0){\r\n          continueComputation \x3d false;\r\n        }\r\n      }\r\n#endif\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"atmosphereUnpackAddUniforms"\x3e\x3c![CDATA[\r\n        float fScale \x3d v4AtmosParams1.x;\r\n        vec2 v2ScaleDepth \x3d vec2(v4AtmosParams1.y,v4AtmosParams2.y);//fScaleDepth, fScaleDepthBlue\r\n        vec2 v2ScaleOverScaleDepth \x3d vec2(v4AtmosParams1.z,v4AtmosParams2.z);//fScaleOverScaleDepth, fScaleOverScaleDepthBlue\r\n        vec2 v2OneOverScaleDepth \x3d vec2(v4AtmosParams1.w,v4AtmosParams2.w);//fOneOverScaleDepth, fOneOverScaleDepthBlue\r\n\r\n#ifndef HAZE\r\n        float g \x3d v4AtmosParams2.x;\r\n        float g2 \x3d v4AtmosParams3.x;\r\n        float fMiePhaseCoefficients \x3d v4AtmosParams3.y;\r\n        float fLowerAlphaBlendBound \x3d v4AtmosParams3.z;\r\n        float fOneOverOuterRadiusMinusAlphaBlendBound \x3d v4AtmosParams3.w;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeRayAndLoopSetup"\x3e\x3c![CDATA[\r\n        float rayStartT \x3d 0.5 *(-B - sqrt(det)); //near intersection with atmosphere\r\n#ifdef HAZE\r\n        float nearT \x3d abs(rayStartT);\r\n        float farT \x3d abs(rayEndT);\r\n#else\r\n        float rayEndT \x3d 0.5 *(-B + sqrt(det)); //far intersection with atmosphere\r\n\r\n#endif\r\n\r\n        float fDistance;//calculate its scattering offset\r\n        // Calculate the ray\'s starting position\r\n        if (rayStartT \x3c 0.0)\r\n        { //ray starts from camera to far\r\n          rayStartT \x3d 0.0;\r\n#ifndef HAZE\r\n          fDistance \x3d fScale*(fInnerRadius - fCameraHeight);\r\n#endif\r\n        }\r\n#ifndef HAZE\r\n        else\r\n        {//outside atmosphere\r\n          fDistance \x3d -1.0;\r\n        }\r\n#endif\r\n\r\n        // Initialize the scattering loop variables\r\n        vec3 v3Start \x3d cameraPosition + worldSpaceRay * rayStartT;\r\n\r\n#ifdef HAZE\r\n        vec3 v3End \x3d cameraPosition + worldSpaceRay * rayEndT;\r\n\r\n        float fEndLength \x3d length(v3End);\r\n        float fLocalCameraHeight \x3d length(v3Start);\r\n\r\n        //computed for the original end point to get consistent light angles after possible inversions\r\n        float fLightAngle \x3d dot(v3LightDir, v3End) / fEndLength;\r\n\r\n        if (nearT \x3e farT)\r\n        {\r\n          if (fLocalCameraHeight \x3c fEndLength)\r\n          {\r\n            //Switch positive slopes for flipped rays\r\n            v3End \x3d cameraPosition + worldSpaceRay * rayStartT;\r\n            v3Start \x3d cameraPosition + worldSpaceRay * rayEndT;\r\n            worldSpaceRay *\x3d -1.0;\r\n            fEndLength \x3d length(v3End);\r\n            fLocalCameraHeight \x3d length(v3Start);\r\n          }\r\n          else if (fLocalCameraHeight \x3d\x3d fEndLength)\r\n          {// create minuscule fake slope for integration if the slope is zero\r\n            fLocalCameraHeight +\x3d 1.0; //BUGFIX, if the height of camera and ground is equal the equation breaks, add fake meter to camera height to get\r\n            //slope for the camera function\r\n          }\r\n        }\r\n\r\n        //Calculate its scattering offset\r\n        // Assumes camera constrains of WSV 3.8\r\n        float fCameraDepth;\r\n        float fCameraDepthBlue;\r\n        if (fLocalCameraHeight \x3e fOuterRadius)\r\n        {\r\n          fDistance \x3d fInnerRadius - fOuterRadius;\r\n        } else\r\n        {//outside atmosphere\r\n          fDistance \x3d fEndLength - fLocalCameraHeight;\r\n        }\r\n\r\n#endif\r\n        vec2 v2OpticalStartDepth \x3d exp(fDistance * v2OneOverScaleDepth);\r\n\r\n        float fRayLength \x3d rayEndT - rayStartT;\r\n        float fSampleLength \x3d fRayLength / fSamples;\r\n        float fScaledLength \x3d fSampleLength * fScale;\r\n        vec3 v3SampleRay \x3d worldSpaceRay * fSampleLength;\r\n        vec3 v3SamplePoint \x3d v3Start + v3SampleRay * 0.5;\r\n\r\n#ifdef HAZE\r\n        float fCameraAngle \x3d dot(-worldSpaceRay, v3End) / fEndLength;\r\n        float fScaleCameraAngle \x3d scale(fCameraAngle);\r\n        vec2 v2CameraOffset \x3d fScaleCameraAngle*v2OpticalStartDepth;\r\n\r\n        float scaledValues \x3d scale(fLightAngle) + fScaleCameraAngle;\r\n        vec2 v2ScaledValuesDepth \x3d scaledValues * v2ScaleDepth;\r\n#else\r\n        float fCameraAngle \x3d dot(worldSpaceRay, v3Start / length(v3Start));\r\n        float angleMultiplier \x3d fCameraAngle\x3e0.0?fCameraAngle:0.0;\r\n\r\n        float fScaleCameraAngle \x3d scale(fCameraAngle);\r\n        vec2 v2CameraOffset \x3d fScaleCameraAngle*v2OpticalStartDepth * v2ScaleDepth;\r\n#endif\r\n\r\n        //Loop variables\r\n        vec3 v3FrontColor \x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3FrontColorBlue \x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3Attenuate\x3d vec3(0.0, 0.0, 0.0);\r\n        vec3 v3AttenuateBlue \x3d vec3(0.0, 0.0, 0.0);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeSampleContribution"\x3e\x3c![CDATA[\r\n          float fHeight \x3d length(v3SamplePoint);\r\n          vec2 v2Depth \x3d exp(v2ScaleOverScaleDepth * (fInnerRadius - fHeight));\r\n#ifdef HAZE\r\n          vec2 v2Scatter \x3d v2Depth*v2ScaledValuesDepth-v2CameraOffset;\r\n#else\r\n          float fLightAngle \x3d dot(v3LightDir, v3SamplePoint) / fHeight;\r\n          float fCameraAngle \x3d dot(worldSpaceRay, v3SamplePoint) / fHeight;\r\n          float fTempScaledValues \x3d scale(fLightAngle) - scale(fCameraAngle);\r\n          vec2 v2Scatter \x3d v2CameraOffset + fTempScaledValues*v2Depth* v2ScaleDepth;\r\n#endif\r\n          v3Attenuate \x3d exp(-v2Scatter.x * v3InvWavelengthScaled);\r\n          v3AttenuateBlue \x3d exp(-v2Scatter.y * v3InvWavelengthScaled);\r\n\r\n          v3FrontColor +\x3d v3Attenuate * v2Depth.x;\r\n          v3FrontColorBlue +\x3d v3AttenuateBlue * v2Depth.y;\r\n\r\n          v3SamplePoint +\x3d v3SampleRay;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputeHDRColors"\x3e\x3c![CDATA[\r\n        //Phase computation\r\n        //clamp to avoid numerical instability at fCos \x3d\x3d -1.0 (and close values) to display fake sun\r\n        float fCos \x3d clamp(dot(v3LightDir, -worldSpaceRay ),-0.9999999,1.0);\r\n        float fOnePlusCos2 \x3d fCos*fCos + 1.0;\r\n#ifdef HAZE\r\n        // Finally, scale the Rayleigh colors and set up the varying variables for the pixel shader\r\n        vec3 colorCoefficients \x3d (fScaledLength* 0.75 * fOnePlusCos2)*(fKrESun*v3InvWavelength+fKmESun);\r\n\r\n        //Scaled Length is only applied afterwards to save multiplications\r\n        vec3 v3Color \x3d colorCoefficients *v3FrontColor;\r\n        vec3 v3ColorBlue \x3d colorCoefficients *v3FrontColorBlue;\r\n#else\r\n        vec3 v3RayleighCoefficients \x3d (fScaledLength*0.75 * fOnePlusCos2*fKrESun)*v3InvWavelength;\r\n        float fMieCoefficients \x3d fScaledLength*fKmESun * fMiePhaseCoefficients * fOnePlusCos2 / pow(1.0 + g2 - 2.0*g*fCos, 1.5);\r\n\r\n        // Calculate the attenuation factor for the ground\r\n        vec3 v3Color \x3d v3RayleighCoefficients * v3FrontColor + fMieCoefficients * v3FrontColor;\r\n        vec3 v3ColorBlue \x3d v3RayleighCoefficients * v3FrontColorBlue + fMieCoefficients * v3FrontColorBlue;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"atmosphereComputePixelColor"\x3e\x3c![CDATA[\r\n\r\n\r\n        //HDR to LDR conversion\r\n        vec3 ldrBlue \x3d expTM(v3ColorBlue,2.0*fExposure);\r\n        vec3 ldrRed \x3d expTM(v3Color,fExposure);\r\n\r\n        //mix reddish and blueish atmosphere\r\n        vec3 LDR \x3d mix(ldrBlue,ldrRed,0.2);\r\n#ifdef HAZE\r\n        vec3 groundColor \x3d texture2D(tColor, vtc).xyz;\r\n        LDR *\x3d (1.0-fCameraAngle);\r\n        vec3 hsv \x3d rgb2hsv(LDR);\r\n        hsv.y \x3d clamp(hsv.y*1.5,0.0,1.0);//boost haze saturation by 50%\r\n        LDR \x3d hsv2rgb(hsv);\r\n        vec3 finalColor \x3d groundColor*(1.0-LDR)+LDR;\r\n#else\r\n        //reinhard tonemapper for looking upwards\r\n        vec3 ldrReinhard \x3d reinhardTM(v3Color,fExposure);\r\n        LDR +\x3d angleMultiplier*ldrReinhard;\r\n\r\n        //height dependent parameter to smooth out reddish atmosphere\r\n        float side \x3d (rayEndT+rayStartT)*0.5;\r\n        float atmoHeight \x3d sqrt(fCameraHeight2 - side*side);\r\n        float h2 \x3d clamp(1.0-(atmoHeight-fLowerAlphaBlendBound)/(fOuterRadius-fLowerAlphaBlendBound),0.0,1.0);\r\n\r\n        vec3 finalColor \x3d LDR*h2;\r\n        vec3 hsv \x3d rgb2hsv(finalColor);\r\n        hsv.y \x3d clamp(hsv.y*1.5,0.0,1.0);//boost sky saturation by 50%\r\n        finalColor \x3d hsv2rgb(hsv);\r\n#endif\r\n#ifdef PLANAR\r\n#ifndef HAZE\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,7000.0,30000.0);\r\n        alpha \x3d alpha / (30000.0-7000.0);\r\n        gl_FragColor \x3d vec4(finalColor, 1.0-alpha);\r\n#else\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,0.0,16500.0);\r\n        alpha \x3d alpha / (16500.0-0.0);\r\n        gl_FragColor \x3d vec4(finalColor, 1.0-alpha);\r\n#endif\r\n#else\r\n#ifndef HAZE\r\n        float alpha \x3d clamp(fCameraHeight-fInnerRadius,7000.0,30000.0);\r\n        alpha \x3d alpha / (30000.0-7000.0);\r\n        float atmosStrength \x3d clamp((length(ldrRed)-0.05)*1.05,0.0,1.0);\r\n        gl_FragColor \x3d vec4(finalColor, atmosStrength*clamp(1.0-(atmoHeight-fInnerRadius)/(fOuterRadius-fInnerRadius),0.0,1.0));\r\n#else\r\n        gl_FragColor \x3d vec4(finalColor, 1.0);\r\n#endif\r\n#endif\r\n\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--Fragment Shader for Atmosphere--\x3e\r\n\x3csnippet name\x3d"fsRealisticAtmosphere"\x3e\x3c![CDATA[\r\n\r\n  precision mediump  float;\r\n\r\n$atmosphereUniformsConstantsVaryings\r\n\r\n$atmosphereScaleFunction\r\n\r\n  //Conversion implementation found in util.xml\r\n$rgba2float\r\n\r\n\r\n$toneMapperConstants\r\n$exponentialToneMapper\r\n#ifndef HAZE\r\n$reinhardToneMapper\r\n#endif\r\n\r\n$HSVColorSpace\r\n\r\n  void main()\r\n  {\r\n\r\n    $atmospherePrecomputation\r\n\r\n    //Inside Atmosphere\r\n    if (det \x3e\x3d 0.0){\r\n\r\n      $atmosphereDiscardPixels\r\n\r\n      if(continueComputation){\r\n\r\n        $atmosphereUnpackAddUniforms\r\n\r\n        $atmosphereComputeRayAndLoopSetup\r\n\r\n        // Now loop through the sample rays\r\n        for(int i\x3d0; i\x3cmaxSamples; i++)\r\n        {\r\n          $atmosphereComputeSampleContribution\r\n        }\r\n\r\n        $atmosphereComputeHDRColors\r\n\r\n        $atmosphereComputePixelColor\r\n\r\n        //Debug variable overlay\r\n        if(showTest\x3e0.0){\r\n          gl_FragColor \x3d vec4(test,1.0);\r\n        }\r\n\r\n      } else {//Not on surface\r\n        gl_FragColor \x3d vec4(0.0);\r\n      }\r\n    } else {//Outside Atmosphere\r\n      gl_FragColor \x3d vec4(0.0);\r\n    }\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/environment/materials/SimpleAtmosphereMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsSimpleAtmosphere"\x3e\x3c![CDATA[\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n\r\n#ifndef PANORAMIC\r\n\r\n  const float TWICEPI \x3d 2.0*3.14159265;\r\n  const float ATMOSPHERE_RIM_SEGMENTS \x3d 128.0;\r\n\r\n  uniform vec3 silCircleCenter;\r\n  uniform vec3 silCircleV1;\r\n  uniform vec3 silCircleV2;\r\n  uniform vec2 texV;\r\n\r\n#endif\r\n\r\n  uniform vec3 lightDirection;\r\n\r\n  attribute vec3 $position;\r\n  varying vec2 vtc;\r\n  varying float falloff;\r\n\r\n  void main(void) {\r\n\r\n#ifdef PANORAMIC\r\n\r\n    vec3 pos \x3d $position;\r\n    float ndotl \x3d lightDirection.z;\r\n    vtc \x3d vec2(0, $position.z+0.05);\r\n\r\n#else\r\n\r\n    float phi \x3d $position.x * (TWICEPI / ATMOSPHERE_RIM_SEGMENTS) + 1.0;\r\n    vec3 pos \x3d (sin(phi) * silCircleV1 + cos(phi) * silCircleV2 + silCircleCenter) * $position.y;\r\n    float ndotl \x3d dot(normalize(pos), lightDirection);\r\n\r\n    vtc.x \x3d $position.x / ATMOSPHERE_RIM_SEGMENTS;\r\n    vtc.y \x3d texV.x * (1.0 - $position.z) + texV.y * $position.z;\r\n\r\n#endif\r\n\r\n    falloff \x3d max(0.0, (smoothstep(-1.0, 0.8, ndotl + ndotl)));\r\n\r\n    gl_Position \x3d proj * view * vec4(pos, 1.0);\r\n    gl_Position.z \x3d gl_Position.w; // project atmosphere onto the far plane\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsSimpleAtmosphere"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n  uniform vec4 color;\r\n  varying vec2 vtc;\r\n  varying float falloff;\r\n\r\n  void main() {\r\n    vec4 texColor \x3d texture2D(tex, vtc);\r\n    gl_FragColor \x3d texColor * color * falloff;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/environment/materials/StarMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderStar"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform vec4 viewport;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $color;\r\n  attribute float $size;\r\n\r\n\tvarying vec4 vcolor;\r\n\tvarying float vsize;\r\n\r\n\t$matchPixelCenter\r\n\r\n\tvoid main(void) {\r\n\t\tvec4 posProj \x3d proj * view * model*vec4($position*1.0e25,1.0);//move infinitely far away\r\n\t\tgl_Position \x3d matchPixelCenter(posProj, viewport.zw); //pixel align position\r\n    gl_Position.z \x3d gl_Position.w; // project atmosphere onto the far plane\r\n\t\tvcolor \x3d $color/1.2;\r\n\t\tvsize \x3d size*5.0;\r\n\t\tgl_PointSize \x3d vsize;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderStar"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec4 vcolor;\r\n\tvarying float vsize;\r\n\r\n\tvoid main() {\r\n\t\tfloat cap \x3d 0.7;\r\n\t\tfloat scale \x3d 1.0/cap;\r\n\t\tfloat helper \x3d clamp(length(abs(gl_PointCoord-vec2(0.5))),0.0,cap);\r\n\t\tfloat alpha \x3d clamp((cap-helper)*scale,0.0,1.0);\r\n\t\tfloat intensity \x3d alpha*alpha*alpha;\r\n\t\tif (vsize \x3c 3.0)\r\n\t\t\tintensity *\x3d 0.5;\r\n\t\tgl_FragColor \x3d vec4(1.0,1.0,1.0,intensity);\r\n\t\tgl_FragColor.xyz *\x3d vcolor.xyz;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/internal/SimpleGLMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderSimple"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4($position, 1.0)).xyz, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderSimple"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 color;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d color;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/TexOnlyGLMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderTexOnly"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4(position, 1.0)).xyz, 1.0);\r\n\t\tvtc \x3d $uv0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderTexOnly"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform vec4 color;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tgl_FragColor \x3d texColor * color;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/ssao.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\t\x3csnippet name\x3d"createFsSSAOSrc"\x3e\x3c![CDATA[\r\n\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D rnm;\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\tuniform float\t\tssaoAtt;\r\n\tuniform vec2\t\trnmScale;\r\n\tuniform float\t\tradius;\r\n\tuniform vec2\t\tnearFar;\r\n\tuniform vec3\t\tpSphere[64];\r\n\r\n\tvarying vec2\t\tuv;\r\n\r\n\tconst\tint\t\t samples \x3d\t$samples;\r\n\tconst\tfloat\t\tstrength \x3d .07;\r\n\tconst\tfloat\t\tfalloff \x3d .000002;\r\n\r\n\t$rgba2float\r\n\tvoid main(void) {\r\n\t\tvec3 fres \x3d normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\r\n\t\tfloat currentPixelDepth \x3d rgba2float(texture2D(depthMap, uv));\r\n\t\tvec3 ep \x3d vec3(uv.xy, currentPixelDepth);\r\n\t\tvec3 norm \x3d vec3(-1.0) + 2.0 * texture2D(normalMap, uv).xyz;\r\n\t\tfloat bl \x3d .0;\r\n\t\tfloat f \x3d mix(nearFar.x, nearFar.y, currentPixelDepth) / nearFar.x;\r\n\t\tfloat radD \x3d radius / f;\r\n\t\tradD \x3d min(radD, .5);\r\n\t\tfloat depthDifference;\r\n\t\tvec3 ray;\r\n\r\n\t\tfor(int i \x3d 0; i \x3c samples; ++i) {\r\n\t\t\tray \x3d radD*reflect(pSphere[i], fres);\r\n\t\t\tvec2 tc \x3d ep.xy + sign(dot(ray, norm) ) * ray.xy;\r\n\t\t\tif (tc.x \x3e\x3d .0 \x26\x26 tc.y \x3e\x3d .0 \x26\x26 tc.x \x3c\x3d 1.0 \x26\x26 tc.y \x3c\x3d 1.0) {\r\n\t\t\t\tfloat occluderDepth \x3d rgba2float(texture2D(depthMap, tc));\r\n\t\t\t\tvec3 occluderNormal \x3d vec3(-1.0) + 2.0 * texture2D(normalMap, tc).xyz;\r\n\t\t\t\tdepthDifference \x3d currentPixelDepth - occluderDepth;\r\n\t\t\t\tbl +\x3d step(falloff, depthDifference) * (1.0 - dot(occluderNormal, norm)) * (1.0 - smoothstep(falloff, strength, depthDifference));\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tfloat ao \x3d 1.0 + bl * (-1.38 / float(samples)) * ssaoAtt;\r\n\t\tgl_FragColor.a \x3d ao;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"getDepthLinear"\x3e\x3c![CDATA[\r\n\tfloat getDepthLinear(vec2 ssC) {\r\n\t\treturn -(rgba2float(texture2D(depthMap, ssC))*(nearFar[1] - nearFar[0])+nearFar[0]);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"createFsSSAOSrcObscurance"\x3e\x3c![CDATA[\r\n\r\n\tprecision mediump float;\r\n\r\n\tuniform mat4 projMatrixInv;\r\n\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\r\n\tuniform float     intensity;\r\n\r\n\tuniform float projScale;\r\n\tuniform float     radius;\r\n\tuniform vec2      nearFar;\r\n\r\n\tuniform vec4      projInfo;\r\n\r\n\tconst\tint\t\t samples \x3d\t$samples;\r\n\r\n\tuniform vec2\t  screenDimensions;\r\n\r\n\t//noise texture lookup could be replaced with hash function if WebGL gets XOR functionality\r\n\tuniform vec3\t\tpSphere[64]; //tap position\r\n\tuniform vec2\t\trnmScale;\r\n\tuniform sampler2D rnm; //noise texture\r\n\r\n\t//set z scaling, used to prevent division in ortho mode\r\n\tuniform vec2 zScale;\r\n\r\n\tvarying vec2  uv;\r\n\tvarying vec4  camPos;\r\n\r\n\t$rgba2float\r\n\t$getDepthLinear\r\n\r\n\t/** Returns a unit vector and a screen-space radius for the tap on a unit disk (the caller should scale by the actual disk radius) */\r\n\t/*uniform float numSpiralTurns;\r\n\tvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\r\n\t\t// Radius relative to ssR\r\n\t\tfloat alpha \x3d (float(sampleNumber) + 0.5) * (1.0 / float(samples));\r\n\t\tfloat angle \x3d alpha * (numSpiralTurns * 6.28) + spinAngle;\r\n\r\n\t\tssR \x3d alpha;\r\n\t\treturn vec2(cos(angle), sin(angle));\r\n\t}*/\r\n\r\n\r\n\tfloat radius2 \x3d radius * radius;\r\n\r\n\tfloat fallOffFunction(float vv, float vn, float bias) {\r\n\t\t// A: From the HPG12 paper\r\n\t\t// Note large epsilon to avoid overdarkening within cracks\r\n\t\t// return float(vv \x3c radius2) * max((vn - bias) / (epsilon + vv), 0.0) * radius2 * 0.6;\r\n\r\n\t\t// B: Smoother transition to zero (lowers contrast, smoothing out corners). [Recommended]\r\n\t\tfloat f \x3d max(radius2 - vv, 0.0); return f * f * f * max(vn-bias, 0.0);\r\n\r\n\t\t// C: Medium contrast (which looks better at high radii), no division.  Note that the\r\n\t\t// contribution still falls off with radius^2, but we\'ve adjusted the rate in a way that is\r\n\t\t// more computationally efficient and happens to be aesthetically pleasing.\r\n\t\t// return 4.0 * max(1.0 - vv * invRadius2, 0.0) * max(vn - bias, 0.0);\r\n\r\n\t\t// D: Low contrast, no division operation\r\n\t\t// return 2.0 * float(vv \x3c radius * radius) * max(vn - bias, 0.0);\r\n\t}\r\n\r\n\r\n\t/** Compute the occlusion due to sample point \\a Q about camera-space point \\a C with unit normal \\a n_C */\r\n\tfloat aoValueFromPositionsAndNormal(vec3 C, vec3 n_C, vec3 Q) {\r\n\t\tvec3 v \x3d Q - C;\r\n\t\tfloat vv \x3d dot(v, v);\r\n\t\tfloat vn \x3d dot(normalize(v), n_C);\r\n\t\treturn fallOffFunction(vv, vn, 0.1);\r\n\t}\r\n\r\n\r\n\t/** Reconstruct camera-space P.xyz from screen-space S \x3d (x, y) in\r\n\t\tpixels and camera-space z \x3c 0.  Assumes that the upper-left pixel center\r\n\t\tis at (0.5, 0.5) [but that need not be the location at which the sample tap\r\n\t\twas placed!]\r\n\r\n\t\tCosts 3 MADD.  Error is on the order of 10^3 at the far plane, partly due to z precision.\r\n\t  */\r\n\tvec3 reconstructCSPosition(vec2 S, float z) {\r\n\t\treturn vec3(( (S.xy) * projInfo.xy + projInfo.zw)*(z*zScale.x+zScale.y), z);\r\n\t}\r\n\r\n\tvoid main(void)\r\n\t{\r\n\r\n\t\t//Hash function used in the HPG12 AlchemyAO paper\r\n\t\t//Not supported in WebGL -\x3e using texture lookup as in old SSAO shader instead\r\n\t\t//ivec2 ssC \x3d ivec2(gl_FragCoord.xy);\r\n\t\t//float randomPatternRotationAngle \x3d float((3 * ssC.x ^ ssC.y + ssC.x * ssC.y) * 10);\r\n\t\tvec3 fres \x3d normalize((texture2D(rnm, uv * rnmScale).xyz * 2.0) - vec3(1.0));\r\n\r\n\t   float currentPixelDepth \x3d getDepthLinear(uv);\r\n\r\n\t   if (-currentPixelDepth\x3enearFar.y || -currentPixelDepth\x3cnearFar.x) {\r\n\t\tgl_FragColor \x3d vec4(0);\r\n\t\treturn;\r\n\t   }\r\n\r\n\t   vec3 currentPixelPos \x3d reconstructCSPosition(gl_FragCoord.xy,currentPixelDepth);\r\n\r\n\t   // get the normal of current fragment\r\n\t   vec4 norm4 \x3d texture2D(normalMap, uv);\r\n\t   vec3 norm \x3d vec3(-1.0) + 2.0 * norm4.xyz;\r\n\t   bool isTerrain \x3d norm4.w\x3c0.5;\r\n\r\n\t   float sum \x3d .0;\r\n\r\n\t   vec4 occluderFragment;\r\n\t   vec3 ray;\r\n\r\n\t   vec3 tapPixelPos;\r\n\r\n\t\t//TODO the factor 2.0 should not be necessary, but makes ssao much nicer. bug or deviation from CE somewhere else?\r\n\t   float ps \x3d projScale/(2.0*currentPixelPos.z*zScale.x+zScale.y);\r\n\r\n\t   for(int i \x3d 0; i \x3c samples; ++i)\r\n\t   {\r\n\t\t  // get a vector (randomized inside of a sphere with radius 1.0) from a texture and reflect it\r\n\t\t  //float ssR;\r\n\t\t  //vec2 unitOffset \x3d tapLocation(i, randomPatternRotationAngle, ssR);\r\n\t\t  // get the depth of the occluder fragment\r\n\t\t  //vec2 offset \x3d vec2(-unitOffset*radius*ssR*ps);\r\n\r\n\t\t  vec2 unitOffset \x3d reflect(pSphere[i], fres).xy;\r\n\t\t  vec2 offset \x3d vec2(-unitOffset*radius*ps);\r\n\r\n\r\n\t\t  //don\'t use current or very nearby samples\r\n\t\t  if ( abs(offset.x)\x3c2.0 || abs(offset.y)\x3c2.0) continue;\r\n\r\n\r\n\t\t  vec2 tc \x3d vec2(gl_FragCoord.xy + offset);\r\n\t\t  if (tc.x \x3c 0.0 || tc.y \x3c 0.0 || tc.x \x3e screenDimensions.x || tc.y \x3e screenDimensions.y) continue;\r\n\t\t  vec2 tcTap \x3d tc/screenDimensions;\r\n\t\t  float occluderFragmentDepth \x3d getDepthLinear(tcTap);\r\n\r\n\t\t  if (isTerrain) {\r\n\t\t  \tbool isTerrainTap \x3d texture2D(normalMap, tcTap).w\x3c0.5;\r\n\t\t  \tif (isTerrainTap)\r\n\t\t  \t\tcontinue;\r\n\t\t  }\r\n\r\n\t\t  tapPixelPos \x3d reconstructCSPosition(tc, occluderFragmentDepth);\r\n\r\n\t\t  sum+\x3d aoValueFromPositionsAndNormal(currentPixelPos, norm, tapPixelPos);\r\n\t   }\r\n\r\n\t   // output the result\r\n\r\n\t\tfloat A \x3d max(1.0-sum*intensity/float(samples),0.0);\r\n\r\n\t\t// Anti-tone map to reduce contrast and drag dark region farther\r\n\t\t// (x^0.2 + 1.2 * x^4)/2.2\r\n\t\tA \x3d (pow(A, 0.2) + 1.2 * A*A*A*A) / 2.2;\r\n\r\n\r\n\t   //gl_FragColor \x3d vec4(norm/2.0+0.5, 1.0);\r\n\t   //gl_FragColor \x3d vec4(-currentPixelDepth/1000.0);\r\n\t   //gl_FragColor \x3d vec4(tapPixelPos.x/100.0);\r\n\t   gl_FragColor \x3d vec4(A);\r\n\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsBlurEdgeAware"\x3e\x3c![CDATA[\r\n\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D normalMap;\r\n\tuniform sampler2D depthMap;\r\n\tuniform sampler2D tex;\r\n\r\n\r\n\tuniform vec2 blurSize;\r\n\r\n\r\n\tuniform float g_BlurFalloff;\r\n\tuniform float projScale;\r\n\r\n\r\n\tvarying vec2 uv;\r\n\r\n\tuniform vec2\t\tnearFar;\r\n\r\n\t//set z scaling, used to prevent division in ortho mode\r\n\tuniform vec2 zScale;\r\n\r\n\t$rgba2float\r\n\t$getDepthLinear\r\n\r\n\tfloat BlurFunction(vec2 uv, float r, float center_d, inout float w_total, float sharpness)\r\n\t{\r\n\t\tfloat c \x3d texture2D(tex, uv).r;\r\n\t\tfloat d \x3d getDepthLinear(uv);\r\n\r\n\t\tfloat ddiff \x3d d - center_d;\r\n\r\n\t\tfloat w \x3d exp(-r*r*g_BlurFalloff - ddiff*ddiff*sharpness);\r\n\r\n\t\tw_total +\x3d w;\r\n\r\n\t\treturn w*c;\r\n\t}\r\n\r\n\tvoid main(void)\r\n\t{\r\n\r\n\t\tfloat b \x3d 0.0;\r\n\t\tfloat w_total \x3d 0.0;\r\n\r\n\t\tfloat center_d \x3d  getDepthLinear(uv);\r\n\r\n\t\tfloat sharpness \x3d -0.05*projScale/(center_d*zScale.x+zScale.y);\r\n\t\tfor (int r \x3d -RADIUS; r \x3c\x3d RADIUS; ++r)\r\n\t\t{\r\n\t\t\tfloat rf \x3d float(r);\r\n\t\t\tvec2 uvOffset \x3d uv + rf*blurSize;\r\n\t\t\tb +\x3d BlurFunction(uvOffset, rf, center_d, w_total, sharpness);\r\n\t\t}\r\n\r\n\t\tgl_FragColor \x3d vec4(b/w_total);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\t\x3csnippet name\x3d"fsBlurSrc0"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform float blurSize;\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main() {\r\n\t\tint rad \x3d RADIUS - 1;\r\n\r\n\t\tvec4 sum \x3d vec4(0.0);\r\n\t\tfor (int k \x3d -RADIUS; k \x3c\x3d RADIUS; ++k) { \t\t// NOTE for-variable-init must be a const expression\r\n\t\t\tfloat fi \x3d float(k);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurSrc1"\x3e\x3c![CDATA[\r\n\t\t}\r\n\r\n\t\tgl_FragColor \x3d sum / float(RADIUS * RADIUS);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurH"\x3e\x3c![CDATA[\r\n\t$fsBlurSrc0\r\n\t\t\tsum +\x3d texture2D(tex, vec2(uv.x + fi * blurSize, uv.y)) * (float(rad) - abs(fi) + 1.0);\r\n\t$fsBlurSrc1\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fsBlurV"\x3e\x3c![CDATA[\r\n\t$fsBlurSrc0\r\n\t\t\tsum +\x3d texture2D(tex, vec2(uv.x, uv.y + fi * blurSize)) * (float(rad) - abs(fi) + 1.0);\r\n\t$fsBlurSrc1\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/highlight.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n5-tap gaussian blur with linear sampling\r\nThis technique requires linear filtering on source texture\r\nhttp://rastergrid.com/blog/2010/09/efficient-gaussian-blur-with-linear-sampling/\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurL5"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[5];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.407333;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.407333;\r\n    blurCoordinates[3] \x3d uv + blurSize * 3.294215;\r\n    blurCoordinates[4] \x3d uv - blurSize * 3.294215;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurL5"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[5];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    vec4 sum \x3d vec4(0.0);\r\n    sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.204164;\r\n    sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.304005;\r\n    sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.304005;\r\n    sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.093913;\r\n    sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.093913;\r\n    gl_FragColor \x3d sum;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n7-tap gaussian blur with sigma\x3d1.5\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurG7"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[7];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurG7"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[7];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    vec4 sum \x3d vec4(0.0);\r\n    sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.266346;\r\n    sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.215007;\r\n    sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.215007;\r\n    sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.113085;\r\n    sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.113085;\r\n    sum +\x3d texture2D(tex, blurCoordinates[5]) * 0.038735;\r\n    sum +\x3d texture2D(tex, blurCoordinates[6]) * 0.038735;\r\n    gl_FragColor \x3d sum;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n9-tap gaussian blur with sigma\x3d2.0\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurG9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n    blurCoordinates[7] \x3d uv + blurSize * 4.0;\r\n    blurCoordinates[8] \x3d uv - blurSize * 4.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurG9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    vec4 sum \x3d vec4(0.0);\r\n    sum +\x3d texture2D(tex, blurCoordinates[0]) * 0.202360;\r\n    sum +\x3d texture2D(tex, blurCoordinates[1]) * 0.179044;\r\n    sum +\x3d texture2D(tex, blurCoordinates[2]) * 0.179044;\r\n    sum +\x3d texture2D(tex, blurCoordinates[3]) * 0.124009;\r\n    sum +\x3d texture2D(tex, blurCoordinates[4]) * 0.124009;\r\n    sum +\x3d texture2D(tex, blurCoordinates[5]) * 0.067234;\r\n    sum +\x3d texture2D(tex, blurCoordinates[6]) * 0.067234;\r\n    sum +\x3d texture2D(tex, blurCoordinates[7]) * 0.028532;\r\n    sum +\x3d texture2D(tex, blurCoordinates[8]) * 0.028532;\r\n    gl_FragColor \x3d sum;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n9-tap manhattan distance\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurM9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n    blurCoordinates[7] \x3d uv + blurSize * 4.0;\r\n    blurCoordinates[8] \x3d uv - blurSize * 4.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurM9"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[9];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    float f0 \x3d texture2D(tex, blurCoordinates[0]).x;\r\n    float f1 \x3d texture2D(tex, blurCoordinates[1]).x - 1.0 / 5.0;\r\n    float f2 \x3d texture2D(tex, blurCoordinates[2]).x - 1.0 / 5.0;\r\n    float f3 \x3d texture2D(tex, blurCoordinates[3]).x - 2.0 / 5.0;\r\n    float f4 \x3d texture2D(tex, blurCoordinates[4]).x - 2.0 / 5.0;\r\n    float f5 \x3d texture2D(tex, blurCoordinates[5]).x - 3.0 / 5.0;\r\n    float f6 \x3d texture2D(tex, blurCoordinates[6]).x - 3.0 / 5.0;\r\n    float f7 \x3d texture2D(tex, blurCoordinates[7]).x - 4.0 / 5.0;\r\n    float f8 \x3d texture2D(tex, blurCoordinates[8]).x - 4.0 / 5.0;\r\n\r\n    vec4 m1 \x3d max(vec4(f1,f2,f3,f4), vec4(f5,f6,f7,f8));\r\n    vec2 m2 \x3d max(m1.xy, m1.zw);\r\n    float m3 \x3d max(f0, max(m2.x, m2.y));\r\n    gl_FragColor \x3d vec4(m3, 0, 0, 0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n17-tap manhattan+diagonal distance\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurM17"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates[17];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n\r\n    vec2 blurSizeD \x3d vec2(blurSize.x * sign(blurSize.x + blurSize.y), blurSize.y * sign(blurSize.x - blurSize.y));\r\n\r\n    blurCoordinates[0] \x3d uv;\r\n    blurCoordinates[1] \x3d uv + blurSize * 1.0;\r\n    blurCoordinates[2] \x3d uv - blurSize * 1.0;\r\n    blurCoordinates[3] \x3d uv + blurSize * 2.0;\r\n    blurCoordinates[4] \x3d uv - blurSize * 2.0;\r\n    blurCoordinates[5] \x3d uv + blurSize * 3.0;\r\n    blurCoordinates[6] \x3d uv - blurSize * 3.0;\r\n    blurCoordinates[7] \x3d uv + blurSize * 4.0;\r\n    blurCoordinates[8] \x3d uv - blurSize * 4.0;\r\n\r\n    blurCoordinates[ 9] \x3d uv + blurSizeD * 1.0;\r\n    blurCoordinates[10] \x3d uv - blurSizeD * 1.0;\r\n    blurCoordinates[11] \x3d uv + blurSizeD * 2.0;\r\n    blurCoordinates[12] \x3d uv - blurSizeD * 2.0;\r\n    blurCoordinates[13] \x3d uv + blurSizeD * 3.0;\r\n    blurCoordinates[14] \x3d uv - blurSizeD * 3.0;\r\n    blurCoordinates[15] \x3d uv + blurSizeD * 4.0;\r\n    blurCoordinates[16] \x3d uv - blurSizeD * 4.0;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurM17"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates[17];\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    float f0 \x3d texture2D(tex, blurCoordinates[0]).x;\r\n    float f1 \x3d texture2D(tex, blurCoordinates[1]).x - 1.0 / 5.0;\r\n    float f2 \x3d texture2D(tex, blurCoordinates[2]).x - 1.0 / 5.0;\r\n    float f3 \x3d texture2D(tex, blurCoordinates[3]).x - 2.0 / 5.0;\r\n    float f4 \x3d texture2D(tex, blurCoordinates[4]).x - 2.0 / 5.0;\r\n    float f5 \x3d texture2D(tex, blurCoordinates[5]).x - 3.0 / 5.0;\r\n    float f6 \x3d texture2D(tex, blurCoordinates[6]).x - 3.0 / 5.0;\r\n    float f7 \x3d texture2D(tex, blurCoordinates[7]).x - 4.0 / 5.0;\r\n    float f8 \x3d texture2D(tex, blurCoordinates[8]).x - 4.0 / 5.0;\r\n\r\n    float f9 \x3d texture2D(tex, blurCoordinates[ 9]).x - 1.0 * 1.41421356237 / 5.0;\r\n    float f10 \x3d texture2D(tex, blurCoordinates[10]).x - 1.0 * 1.41421356237 / 5.0;\r\n    float f11 \x3d texture2D(tex, blurCoordinates[11]).x - 2.0 * 1.41421356237 / 5.0;\r\n    float f12 \x3d texture2D(tex, blurCoordinates[12]).x - 2.0 * 1.41421356237 / 5.0;\r\n    float f13 \x3d texture2D(tex, blurCoordinates[13]).x - 3.0 * 1.41421356237 / 5.0;\r\n    float f14 \x3d texture2D(tex, blurCoordinates[14]).x - 3.0 * 1.41421356237 / 5.0;\r\n    float f15 \x3d texture2D(tex, blurCoordinates[15]).x - 4.0 * 1.41421356237 / 5.0;\r\n    float f16 \x3d texture2D(tex, blurCoordinates[16]).x - 4.0 * 1.41421356237 / 5.0;\r\n\r\n    vec4 m1 \x3d max(vec4(f1,f2,f3,f4), vec4(f5,f6,f7,f8));\r\n    vec4 m2 \x3d max(vec4(f9,f10,f11,f12), vec4(f13,f14,f15,f16));\r\n    vec4 m3 \x3d max(m1, m2);\r\n    vec2 m4 \x3d max(m3.xy, m3.zw);\r\n    float m6 \x3d max(f0, max(m4.x, m4.y));\r\n    gl_FragColor \x3d vec4(m6, 0, 0, 0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n(2N+1)^2-tap distance field\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightBlurDF"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n\r\n  uniform vec2 blurSize;\r\n\r\n  varying vec2 blurCoordinates;\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0);\r\n    uv \x3d $position.xy * .5 + vec2(.5);\r\n    blurCoordinates \x3d blurSize;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightBlurDF"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n\r\n  varying vec2 blurCoordinates;\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    float result \x3d 0.0;\r\n    for (float x\x3d-5.0; x\x3c\x3d5.0; ++x) {\r\n      for (float y\x3d-5.0; y\x3c\x3d5.0; ++y) {\r\n        vec2 duv \x3d vec2(x, y);\r\n        vec2 uv2 \x3d uv + duv * blurCoordinates;\r\n        result \x3d max(result, texture2D(tex, uv2).x - length(duv) / 5.0);\r\n      }\r\n    }\r\n    gl_FragColor \x3d vec4(result, 0, 0, 0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c!--\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\nMerging blurred halos with source image\r\n\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\r\n--\x3e\r\n\x3csnippet name\x3d"vsHighlightApply"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  attribute vec3 $position;\r\n\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    gl_Position \x3d vec4($position.x, $position.y, .0, 1.0); \r\n    uv \x3d $position.xy * .5 + vec2(.5); \r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightApply"\x3e\x3c![CDATA[\r\n\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n  uniform sampler2D origin;\r\n\r\n  uniform vec4 color;\r\n  uniform float exponent;\r\n  uniform float fill;\r\n\r\n  varying vec2 uv;\r\n\r\n  void main()\r\n  {\r\n    // Read the highlight intensity from the blurred highlight image\r\n    float highlight \x3d texture2D(tex, uv).x;\r\n\r\n    // Discard all pixels which are not affected by highlight\r\n    if (highlight \x3d\x3d 0.0) {\r\n      discard;\r\n    }\r\n\r\n    // Discard the interior of highlighted objects, so that only the halo remain\r\n    vec4 origin_color \x3d texture2D(origin, uv);\r\n    if (any(notEqual(origin_color,vec4(0,0,0,0)))) {\r\n      gl_FragColor \x3d vec4(color.xyz, fill);\r\n      return;\r\n    }\r\n\r\n    // Transfer function\r\n    // highlight \x3d pow(highlight, 0.5); // increase contrast, for gaussian blur\r\n    // highlight \x3d pow(highlight, 2.0); // decrease constrast, for manhattan distance\r\n    // highlight \x3d tanh(10*highlight); // test\r\n    highlight \x3d smoothstep(0.0, exponent, highlight);\r\n    // highlight \x3d pow(highlight, exponent);\r\n\r\n    // Blending equation: gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n    // I.e., color should not be premultiplied with alpha\r\n    gl_FragColor \x3d vec4(color.xyz, highlight);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/offscreen.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsOffscreenRenderer"\x3e\x3c![CDATA[\r\n  attribute vec2 $position;\r\n  attribute vec2 $uv0;\r\n  varying vec2 vtc;\r\n\r\n  void main(void) {\r\n    gl_Position \x3d vec4(position.xy, 0.0, 1.0);\r\n    vtc \x3d $uv0.xy * 0.5 + 0.5;\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsOffscreenRenderer"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform sampler2D tex;\r\n  varying vec2 vtc;\r\n\r\n  void main() {\r\n    vec4 texColor \x3d texture2D(tex, vtc);\r\n    gl_FragColor \x3d texColor;\r\n  }\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/util.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"matchPixelCenter"\x3e\x3c![CDATA[\r\n\tvec4 matchPixelCenter(vec4 clipCoord, vec2 widthHeight) {\r\n\t\tvec2 xy \x3d vec2(.500123) + .5 * clipCoord.xy / clipCoord.w;\r\n\t\tvec2 ij \x3d floor(xy * widthHeight);\r\n\t\tvec2 pixelSz \x3d vec2(1.0) / widthHeight;\r\n\t\tvec2 result \x3d (((vec2(.5) + ij) * pixelSz) * 2.0 - vec2(1.0)) * clipCoord.w;\r\n\t\treturn vec4(result.x, result.y, clipCoord.z, clipCoord.w);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"float2rgba"\x3e\x3c![CDATA[\r\n\tvec4 float2rgba(const in float v) { \r\n\t\tvec4 enc \x3d vec4(1.0, 255.0, 65025.0, 160581375.0) * v; \r\n\t\tenc \x3d fract(enc); \r\n\t\tenc -\x3d enc.yzww * vec4(1.0/255.0, 1.0/255.0, 1.0/255.0, 0.0); \r\n\t\treturn enc; \r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"rgba2float"\x3e\x3c![CDATA[\r\n\tfloat rgba2float(vec4 rgba) { \r\n\t\treturn dot(rgba, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0)); \r\n\t}\r\n]]\x3e\x3c/snippet\x3e\t\r\n\r\n\x3csnippet name\x3d"calcFragDepth"\x3e\x3c![CDATA[\r\n\t#extension GL_OES_standard_derivatives : enable \r\n\r\n\tfloat calcFragDepth(const in float depth) {\r\n\t\t//calc polygon offset\r\n\t\tconst float SLOPE_SCALE \x3d 2.0; \r\n\t\tconst float BIAS \x3d 2.0 * .000015259;\t\t// 1 / (2^16 - 1) \r\n\t\tfloat m \x3d max(abs(dFdx(depth)), abs(dFdy(depth))); \r\n\t\tfloat result \x3d depth + SLOPE_SCALE * m + BIAS; \r\n\t\treturn clamp(result, .0, .999999); \r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"evalShadow"\x3e\x3c![CDATA[\r\n\t$rgba2float\r\n\r\n\t// "matrix" parameter used to have const qualifier as well, but IE11 couldn\'t deal with it at time of writing.\r\n\t// once IE11 is fine with it, const should probably be re-introduced\r\n\tfloat evalShadow(const in vec3 vpos, const in float depth, const in sampler2D depthTex, const int num, const in vec4 distance, in mat4 matrix[4], const in float halfPxSz) {\r\n\t\tif (halfPxSz \x3c .0) return .0;\r\n\t\t\r\n\t\t//choose correct cascade\r\n\t\tint i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\t\t\r\n\r\n\t\tif (i \x3e\x3d num) return .0;\r\n\t\t\r\n\t\tmat4 mat \x3d i \x3d\x3d 0 ? matrix[0] : i \x3d\x3d 1 ? matrix[1] : i \x3d\x3d 2 ? matrix[2] : matrix[3];\r\n\t\t\r\n\t\tvec4 lv \x3d mat * vec4(vpos, 1.0);\r\n\t\tlv.xy /\x3d lv.w;\r\n\t\t\r\n\t\t//vertex completely outside? -\x3e no shadow\r\n\t\tvec3 lvpos \x3d .5 * lv.xyz + vec3(.5);\t\t\r\n\t\tif (lvpos.z \x3e\x3d 1.0) return .0;\t\t\r\n\t\tif (lvpos.x \x3c .0 || lvpos.x \x3e 1.0 || lvpos.y \x3c .0 || lvpos.y \x3e 1.0) return .0;\r\n\t\t\r\n\t\t//calc coord in cascade texture\r\n\t\tvec2 uv \x3d vec2(float(i - 2 * (i / 2)) *.5, float(i / 2) * .5) + .5 * lvpos.xy;\r\n\t\t\r\n\t\tfloat texSize \x3d .5 / halfPxSz; \r\n\r\n\t\t//filter, offset by half pixels\r\n\t\tvec2 st \x3d fract((vec2(halfPxSz) + uv) * texSize);\r\n\t\t\r\n\t\tfloat s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPxSz, -halfPxSz))) \x3c lvpos.z ? 1.0 : .0; \r\n\t\tfloat s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPxSz, -halfPxSz))) \x3c lvpos.z ? 1.0 : .0; \r\n\t\tfloat s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPxSz, halfPxSz))) \x3c lvpos.z ? 1.0 : .0; \r\n\t\tfloat s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPxSz, halfPxSz))) \x3c lvpos.z ? 1.0 : .0; \r\n\r\n\t\treturn mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y); \r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"normal2envTC"\x3e\x3c![CDATA[\r\n\tvec2 normal2envTC(vec3 normal) { \r\n\t\tfloat v \x3d .5 + .5 * asin(normal.y) * 0.63661977; \r\n\t\tfloat u \x3d .5 - .5 * atan(normal.z, normal.x) * 0.31830988; \r\n\t\treturn vec2(u, v);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderShowDepth"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tattribute vec2 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * vec4($position.x, $position.y, .0, 1.0);\r\n\t\tvtc \x3d $uv0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\t\x3csnippet name\x3d"fragmentShaderShowDepth"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D depthTex;\r\n\tvarying vec2 vtc;\r\n\t$rgba2float\r\n\tvoid main() {\r\n\t//\tgl_FragColor \x3d vec4(vec3(texture2D(depthTex, vtc).a), 1.0);\r\n\t\tgl_FragColor \x3d vec4(rgba2float(texture2D(depthTex, vtc)));\r\n\t//\tgl_FragColor \x3d texture2D(depthTex, vtc);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsUVQuad"\x3e\x3c![CDATA[\r\n\tattribute vec2 $position; \r\n\tvarying vec2 uv; \r\n\r\n\tvoid main(void) { \r\n\t\tgl_Position \x3d vec4($position.x, $position.y, .0, 1.0); \r\n\t\tuv \x3d $position * .5 + vec2(.5); \r\n\t}\r\n]]\x3e\x3c/snippet\x3e\t\r\n\r\n\x3csnippet name\x3d"toScreenCoords"\x3e\x3c![CDATA[\r\n\tvec4 toScreenCoords(vec3 vertex) {\r\n\t\tvec4 vClipSpace \x3d proj * view * vec4((model * vec4(vertex, 1.0)).xyz, 1.0);\r\n\t\tvClipSpace.xy *\x3d screenSize;\r\n\t\treturn vClipSpace/abs(vClipSpace.w);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n\t',
"url:esri/views/3d/webgl-engine/materials/BillboardMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBillboard"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tconst float size \x3d 1.05;\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\tvec3 zDir \x3d normalize(-pos);\r\n\t\tvec3 xDir \x3d normalize(cross(vec3(.0, 1.0, .0), zDir));\r\n\t\tvec3 yDir \x3d cross(zDir, xDir);\r\n\t\tpos +\x3d xDir * (uv01.x - .5) * size;\r\n\t\tpos +\x3d yDir * (uv01.y - .5) * size;\r\n\t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\t\tvtc \x3d uv;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal, 1.0)).xyz);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderBillboard"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec3 lightDirection;\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .15) discard;\r\n\t\tgl_FragColor \x3d texColor;\r\n\t\tgl_FragColor.rgb *\x3d lightAmbient.rgb * lightAmbient.w + lightDiffuse.rgb * lightDiffuse.w * dot(lightDirection, vnormal);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBillboardDepth"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform vec2 nearFar;\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying float depth;\r\n\tconst float size \x3d 1.05;\r\n\r\n\tvoid main(void) {\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\tpos.x +\x3d (uv01.x - .5) * size;\r\n\t\tpos.y +\x3d (uv01.y - .5) * size;\r\n\t\tvec4 eye \x3d vec4(pos, 1.0);\r\n\t\tgl_Position \x3d proj * eye;\r\n\t\tdepth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]);\r\n\t\tvtc \x3d uv;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/ColorMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderColorMaterial"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $color;\r\n\r\n\tvarying vec4 vColor; \r\n\r\n\tvoid main(void) {\r\n\t\tvColor \x3d $color * 0.003921568627451; // \x3d 1/255;\r\n\t\tgl_Position \x3d proj * view * vec4((model * vec4($position, 1.0)).xyz, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderColorMaterial"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 eColor;\r\n\tvarying vec4 vColor;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d vColor * eColor;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/HUDMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"HUDMaterialCommonVariables"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tuniform vec4 viewport;\r\n\tuniform vec3 camPos;\r\n\tuniform float pixelRatio;\r\n\tuniform vec2 screenOffset;\r\n\tuniform vec2 anchorPos;\r\n\tuniform float polygonOffset;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tattribute vec2 $uv0;\r\n\tattribute vec4 $color;\r\n  attribute vec2 $size;\r\n  attribute vec4 $auxpos1;\r\n\r\n\tvarying vec4 vcolor;\r\n\t\r\n#ifdef OCCL_PIXELSHADER\r\n \tvarying vec4 vtc;\r\n#else\r\n\tvarying vec2 vtc;\r\n\tvarying vec2 vsize;\r\n\tuniform sampler2D framebufferTex;\r\n\tuniform vec3 markerColor;\r\n#endif\t\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"matchPixelOrigin"\x3e\x3c![CDATA[\r\n\tvec4 matchPixelOrigin(vec4 clipCoord, vec2 widthHeight) {\r\n\t\tvec2 xy \x3d vec2(.5) + .5 * clipCoord.xy / clipCoord.w;\r\n\t\tvec2 pixelSz \x3d vec2(1.0) / widthHeight;\r\n\t\tvec2 ij \x3d floor((xy + .5 * pixelSz) * widthHeight);\r\n\t\tvec2 result \x3d ((ij * pixelSz) * 2.0 - vec2(1.0)) * clipCoord.w;\r\n\t\treturn vec4(result.x, result.y, clipCoord.z, clipCoord.w);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"calcPosMatchPixelCenter"\x3e\x3c![CDATA[\r\n\r\n\t\tvec3 posModel \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tvec3 posView \x3d (view * vec4(posModel, 1.0)).xyz;\r\n\r\n\t\tvec3 vnormal \x3d (modelNormal * vec4($normal, 1.0)).xyz;\r\n\r\n\t\t// view angle dependent part of polygon offset emulation\r\n\t\tfloat cosAlpha \x3d dot(vnormal, normalize(camPos - posModel));\r\n\t\tif (cosAlpha \x3e .01 \x26\x26 polygonOffset \x3e .0) {\r\n\t\t\tfloat tanAlpha \x3d sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;\r\n\t\t\tposView *\x3d 1.0 - tanAlpha / viewport[2];\r\n\t\t}\r\n\r\n\t    if (centerOffset.w\x3c0.0)\r\n            posView+\x3dcenterOffset.xyz;\r\n\r\n\t\tvec4 posProj \x3d proj * vec4(posView, 1.0);\r\n\r\n\t\t// constant part of polygon offset emulation\r\n\t\tif (cosAlpha \x3e .01)\r\n\t\t\tposProj.z -\x3d polygonOffset * posProj.w;\r\n\r\n\t\tposProjCenter \x3d matchPixelCenter(posProj, viewport.zw);\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderHUD"\x3e\x3c![CDATA[\r\n    $HUDMaterialCommonVariables\r\n\r\n\t$matchPixelCenter\r\n\t$matchPixelOrigin\r\n\r\n\tvoid main(void) {\r\n\r\n\t    vec4 centerOffset \x3d $auxpos1;\r\n\r\n\t\tvec2 combinedSize \x3d $size * pixelRatio;\r\n\r\n        vec4 posProjCenter;\r\n\t\t$calcPosMatchPixelCenter\r\n\r\n#ifdef OCCL_TEST\r\n\t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n#endif\r\n\t\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\t\tfloat dist \x3d distance(camPos, posModel);\r\n\t\t\tposProj.xy +\x3d ((uv01 - anchorPos) * 2.0 * combinedSize + screenOffset)/ viewport.zw * posProj.w;\r\n\t\t\tvtc.xy \x3d uv;\r\n\t\t\tvsize \x3d $size;\r\n#ifdef OCCL_TEST\r\n\t\t} else {\r\n\t\t\tvtc \x3d vec2(.0);\r\n\t\t}\r\n#endif\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n\t\tgl_Position \x3d matchPixelOrigin(posProj, viewport.zw);\r\n\t\tvcolor \x3d $color / 255.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderHUDWorldScale"\x3e\x3c![CDATA[\r\n    $HUDMaterialCommonVariables\r\n\r\n\tuniform vec2 minMaxWorldSizeFactor;\r\n\r\n\t$matchPixelCenter\r\n\t$matchPixelOrigin\r\n\r\n\tvoid main(void) {\r\n\t    vec4 centerOffset \x3d $auxpos1;\r\n\t    vec2 combinedSize \x3d $size * pixelRatio;\r\n\t    \r\n\t    vec4 posProjCenter;\r\n\r\n\t\t$calcPosMatchPixelCenter\r\n\r\n#ifdef OCCL_TEST\r\n\t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n#endif\r\n\t\t\tfloat scale \x3d 1.0;\r\n\t\t\tvec2 minMaxWorldSize \x3d distance(camPos, position)*minMaxWorldSizeFactor;\r\n\t\t\tif (minMaxWorldSize.x \x3e combinedSize.y)\r\n\t\t\t\tscale \x3d minMaxWorldSize.x / combinedSize.y;\r\n\t\t\telse if (minMaxWorldSize.y \x3e 0.0)\r\n\t\t\t\tscale \x3d min(1.0, minMaxWorldSize.y / combinedSize.y);\r\n\r\n\t\t\tvec2 uv01 \x3d floor($uv0);\r\n\t\t\tvec2 uv \x3d $uv0 - uv01;\r\n\t\t\tposView.xy +\x3d (uv01 - anchorPos) * combinedSize * scale;\r\n\t\t\tuv.y +\x3d (1.0 - texScale.y);\r\n\t\t\tvtc.xy \x3d uv;\r\n#ifdef OCCL_TEST\r\n\t\t} else {\r\n\t\t\tvtc \x3d vec2(.0);\r\n\t\t}\r\n#endif\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n\t\tposProj \x3d proj * vec4(posView,1.0);\r\n\t\tposProj.xy +\x3d screenOffset / viewport.zw * posProj.w;\r\n\t\tgl_Position \x3d posProj;\r\n\t\tvcolor \x3d $color;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\r\n\x3csnippet name\x3d"calcLabelDirections"\x3e\x3c![CDATA[\r\n\tvec2 uv01 \x3d floor($uv0);\r\n\tvec2 uv \x3d $uv0 - uv01;\r\n\r\n\tvec3 labelDir, labelDirOrtho;\r\n\r\n\tint isUp \x3d 0;\r\n\tvec2 vId \x3d (uv01 - vec2(.5, .5))*2.0;\r\n\r\n\tvec3 viewDirInNormalPlane \x3d normalize(camDir.xyz - dot(camDir.xyz, direction)*direction);\r\n\tfloat angleToNormal \x3d abs(dot(viewDirInNormalPlane,up));\r\n\tfloat angleToDirection \x3d abs(dot(camDir.xyz, direction));\r\n\tif (angleToDirection \x3c 0.985 \x26\x26 angleToNormal \x3c 0.500)\r\n\t{\r\n\t    if (angleToNormal \x3c 0.422) {\r\n\t\t    isUp \x3d 1;\r\n\t\t    labelDir \x3d direction;\r\n\t\t    labelDirOrtho \x3d up;\r\n\t\t    vId.y +\x3d 0.5;\r\n\t\t} else {\r\n\t\t    labelDir \x3d direction;\r\n            labelDirOrtho \x3d cross(viewDirInNormalPlane, direction);\r\n            vId.y +\x3d dot(labelDirOrtho, up)*0.5;\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\tlabelDir \x3d direction;\r\n\t\tlabelDirOrtho \x3d normalize(cross(up,direction));\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderHUDDirection"\x3e\x3c![CDATA[\r\n \tuniform vec3 direction;\r\n \t\r\n\tvoid main(void) {\r\n\t    vec4 centerOffset \x3d $auxpos1;\r\n\t    vec2 combinedSize \x3d $size * pixelRatio;\r\n\r\n        vec4 posProjCenter;\r\n \t\t$calcPosMatchPixelCenter\r\n\r\n \t\tvec3 direction \x3d normalize(direction);\r\n \t\tvec3 up \x3d vnormal;\r\n \t\tvec3 camDir \x3d normalize(vec3(view[0][2],view[1][2],view[2][2]));\r\n\r\n #ifdef OCCL_TEST\r\n \t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n #endif\r\n\r\n \t\t\t$calcLabelDirections\r\n\r\n\t\t    float scale;\r\n\t\t    if (proj[2][3] !\x3d 0.0)  // perspective projection\r\n \t\t\t    scale \x3d posProj.w*0.5/viewport[2];\r\n \t\t\telse                    // othographic projection\r\n \t\t\t    scale \x3d 2.0/proj[0][0]/viewport[2];\r\n\r\n \t\t\tposModel.xyz +\x3d labelDir * vId.x * combinedSize.x * scale ;\r\n \t\t\tposModel.xyz +\x3d labelDirOrtho * vId.y * combinedSize.y * scale;\r\n\r\n \t\t\tvec4 posDirProj \x3d proj*view*model * vec4($position+direction, 1.0);\r\n \t\t\tvec4 posProjUnmodified \x3d proj*view*model * vec4($position, 1.0);\r\n \t\t\tif (posDirProj.x\x3cposProjUnmodified.x)\r\n \t\t\t{\r\n \t\t\t\tif (isUp\x3d\x3d1)\r\n \t\t\t\t\tuv.x \x3d texScale.x-uv.x;\r\n \t\t\t\telse\r\n \t\t\t\t\tuv \x3d texScale-uv;\r\n \t\t\t}\r\n \t\t\tvtc.xy \x3d uv;\r\n #ifdef OCCL_TEST\r\n \t\t} else {\r\n \t\t\tvtc \x3d vec2(.0);\r\n \t\t}\r\n #endif\r\n\r\n #ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n \t\tvec4 pos4 \x3d proj * view * vec4(posModel,1.0);\r\n \t\tgl_Position \x3d pos4;\r\n \t}\r\n ]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderHUDDirectionWorldScale"\x3e\x3c![CDATA[\r\n    $HUDMaterialCommonVariables\r\n    \r\n\tuniform vec2 minMaxWorldSizeFactor;\r\n\tuniform vec3 direction;\r\n\r\n\t$matchPixelCenter\r\n\t$matchPixelOrigin\r\n\r\n\tvoid main(void) {\r\n\t    vec4 centerOffset \x3d $auxpos1;\r\n\t    vec2 combinedSize \x3d $size * pixelRatio;\r\n\r\n        vec4 posProjCenter;\r\n\t\t$calcPosMatchPixelCenter\r\n\r\n\t\tvec3 direction \x3d normalize(direction);\r\n\t\tvec3 up \x3d vnormal;\r\n\t\tvec3 camDir \x3d normalize(vec3(view[0][2],view[1][2],view[2][2]));\r\n\r\n#ifdef OCCL_TEST\r\n\t\tif (texture2D(framebufferTex, .5 + .5 * posProjCenter.xy / posProjCenter.w).rgb \x3d\x3d markerColor) {\r\n#endif\r\n\r\n\t\t\t$calcLabelDirections\r\n\r\n\t\t\tfloat scale \x3d 1.0;\r\n\t\t\tvec2 minMaxWorldSize \x3d minMaxWorldSizeFactor;\r\n\t\t\tif (proj[2][3] !\x3d 0.0)  // perspective projection\r\n\t\t\t\tminMaxWorldSize \x3d distance(camPos, position)*minMaxWorldSizeFactor;\r\n\t\t\tif (minMaxWorldSize.x \x3e combinedSize.y)\r\n\t\t\t\tscale \x3d minMaxWorldSize.x / combinedSize.y;\r\n\t\t\telse if (minMaxWorldSize.y \x3e 0.0)\r\n\t\t\t\tscale \x3d min(1.0, minMaxWorldSize.y / combinedSize.y);\r\n\r\n\t\t\tposModel.xyz +\x3d labelDir*vId.x*combinedSize.x*scale;\r\n\t\t\tposModel.xyz +\x3d labelDirOrtho*vId.y*combinedSize.y*scale;\r\n\r\n\t\t\tvec4 posDirProj \x3d proj*view*model * vec4($position+direction, 1.0);\r\n\t\t\tvec4 posProjUnmodified \x3d proj*view*model * vec4($position, 1.0);\r\n \t\t\tif (posDirProj.x\x3cposProjUnmodified.x)\r\n \t\t\t{\r\n \t\t\t\tif (isUp\x3d\x3d1)\r\n \t\t\t\t\tuv.x \x3d texScale.x-uv.x;\r\n \t\t\t\telse\r\n \t\t\t\t\tuv \x3d texScale-uv;\r\n \t\t\t}\r\n \t\t\tuv.y +\x3d (1.0 - texScale.y);\r\n\t\t\tvtc.xy \x3d uv;\r\n#ifdef OCCL_TEST\r\n\t\t} else {\r\n\t\t\tvtc \x3d vec2(.0);\r\n\t\t}\r\n#endif\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvtc.zw \x3d .5 + .5 * posProjCenter.xy / posProjCenter.w;\r\n#endif\r\n\t\tvec4 pos4 \x3d proj * view * vec4(posModel,1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUDBase"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\t#extension GL_OES_standard_derivatives : require\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform vec4 overrideColor;\r\n\tuniform vec4 outlineColor;\r\n\tuniform float outlineSize;\r\n\r\n\tvarying vec4 vcolor;\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n\tvarying vec4 vtc;\r\n\tuniform vec3 markerColor;\r\n\tuniform sampler2D framebufferTex;\r\n#else\r\n\tvarying vec2 vtc;\r\n\tvarying vec2 vsize;\r\n#endif\r\n\r\n\tvoid main() {\r\n\r\n#ifdef OCCL_PIXELSHADER\r\n   \t\tif (texture2D(framebufferTex, vtc.zw).rgb !\x3d markerColor)\r\n   \t\t\tdiscard;\r\n#endif\r\n\r\n#ifdef SIGNED_DISTANCE_FIELD\r\n\t\tvec4 color \x3d vec4(0.0, 0.0, 0.0, 0.0);\r\n\t\tvec4 fillPixelColor \x3d overrideColor * vcolor;\r\n\r\n\t\t// Distance in [-0.5, 0.5]\r\n\t\tfloat d \x3d dot(texture2D(tex, vtc), vec4(1.0/16777216.0, 1.0/65535.0, 1.0/256.0, 1.0)) - 0.5;\r\n\t\t// Distance in output units\r\n\t\tfloat dist \x3d d * vsize.x;\r\n\r\n\t\tfillPixelColor.a *\x3d clamp(0.5 - dist, 0.0, 1.0);\r\n\r\n\t\tif (outlineSize \x3e 0.25) {\r\n\t\t\tvec4 outlinePixelColor \x3d outlineColor;\r\n\t\t\tfloat clampedOutlineSize \x3d min(outlineSize, 0.5*vsize.x);\r\n\t\t\toutlinePixelColor.a *\x3d clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\r\n\r\n\t\t\t// perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\r\n\t\t\tfloat compositeAlpha \x3d outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\r\n\t\t\tvec3 compositeColor \x3d vec3(outlinePixelColor) * outlinePixelColor.a +\r\n\t\t\t\tvec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\r\n\t\t\tcompositeColor /\x3d compositeAlpha;\r\n\r\n\t\t\tgl_FragColor \x3d vec4(compositeColor, compositeAlpha);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tgl_FragColor \x3d fillPixelColor;\r\n\t\t}\r\n\r\n\t\t// visualize SDF:\r\n\t\t// gl_FragColor \x3d vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d texture2D(tex, vtc, -0.5) * overrideColor * vcolor;\r\n#endif\r\n\r\n\t\tif (gl_FragColor.a \x3c 0.1) {\r\n\t\t\tdiscard;\r\n\t\t}\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUD"\x3e\x3c![CDATA[\r\n$fragmentShaderHUDBase\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderHUDHighlight"\x3e\x3c![CDATA[\r\n$fragmentShaderHUDBase\r\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderOcclusionTestPixel"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tuniform vec4 viewport;\r\n\tuniform vec3 camPos;\r\n\tuniform float polygonOffset;\r\n\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tattribute vec4 $auxpos1;\r\n\r\n\t$matchPixelCenter\r\n\r\n\tvoid main(void) {\r\n\t    vec4 centerOffset \x3d $auxpos1;\r\n\r\n\t    vec4 posProjCenter;\r\n\t    if (dot($position, $position) \x3e 0.0) {\r\n\t\t    $calcPosMatchPixelCenter\r\n\t\t} else {\r\n\t\t    posProjCenter \x3d vec4(1e038, 1e038, 1e038, 1.0);\r\n\t\t}\r\n\r\n\t\tgl_Position \x3d posProjCenter;\r\n\t\tgl_PointSize \x3d 1.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/views/3d/webgl-engine/materials/LeafCardMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderLeafCard"\x3e\r\n\t\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec4 $normal;\r\n\tattribute vec4 $uv0;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tvarying float ambientLeaf;\r\n\r\n\tuniform float trafoScale;\r\n\tvarying vec3 vpos;\r\n\r\n\t// TODO optimize?\r\n\tvec2 rotate(vec2 pos, float angle) {\r\n\t\tfloat c \x3d cos(angle);\r\n\t\tfloat s \x3d sin(angle);\r\n\t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n\t}\r\n\r\n\tvoid main(void) {\r\n\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\r\n\t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n\t\tvec2 uv01 \x3d floor($uv0.xy);\r\n\t\tvec2 uv \x3d $uv0.xy - uv01;\r\n\r\n   \t\tvec2 up \x3d rotate(vec2(1,0), $uv0.z);\r\n   \t\tvec3 xDir \x3d  vec3(up.x,up.y,0.0);\r\n   \t\tvec3 yDir \x3d  vec3(-up.y,up.x,0.0);\r\n\r\n\t\tpos +\x3d xDir * (uv01.x - .5) * $uv0.w *trafoScale;\r\n\t\tpos +\x3d yDir * (uv01.y - .5) * $uv0.w *trafoScale;;\r\n\t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n\t\tgl_Position \x3d pos4;\r\n\t\tvtc \x3d uv;\r\n\t\tambientLeaf \x3d normal.w;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal.xyz, 1.0)).xyz);\r\n\t}\r\n]]\x3e\r\n\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderLeafCard"\x3e\r\n\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec3 camPos;\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec4 lightSpecular;\r\n\tuniform vec3 lightDirection;\r\n\r\n\tuniform vec3 ambient;\r\n\tuniform vec3 diffuse;\r\n\tuniform vec3 specular;\r\n\tuniform float shininess;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\tvarying vec3 vnormal;\r\n\tvarying float ambientLeaf;\r\n\r\n\tvarying vec3 vpos;\r\n\r\n\tvoid main() {\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\r\n\t\tvec3 a \x3d ambient * lightAmbient.rgb * lightAmbient.w;\r\n\t\tvec3 d \x3d diffuse * lightDiffuse.rgb * lightDiffuse.w * clamp(dot(vnormal, lightDirection), .0, 1.0);\r\n\r\n\t\tvec3 reflDir \x3d normalize(reflect(vpos - camPos, vnormal));\r\n\t\tfloat specDot \x3d max(dot(reflDir, lightDirection), .001);\r\n\t\tvec3 s \x3d specular * lightSpecular.rgb * lightSpecular.w * pow(specDot, shininess);\r\n\r\n\t\tgl_FragColor \x3d vec4(ambientLeaf * texColor.rgb * (a + d) + s, texColor.a);\r\n\r\n\t\t//gl_FragColor \x3d vec4(ambient,1.0);\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\r\n\x3csnippet name\x3d"vertexShaderLeafCardDepth"\x3e\x3c![CDATA[\r\n   \tuniform mat4 proj;\r\n   \tuniform mat4 view;\r\n   \tuniform mat4 model;\r\n   \tuniform vec2 nearFar;\r\n\r\n   \tattribute vec3 $position;\r\n   \tattribute vec4 $uv0;\r\n\r\n   \tuniform float trafoScale;\r\n\r\n   \tvarying vec2 vtc;\r\n   \tvarying float depth;\r\n\r\n   \t// TODO optimize?\r\n   \tvec2 rotate(vec2 pos, float angle) {\r\n   \t\tfloat c \x3d cos(angle);\r\n   \t\tfloat s \x3d sin(angle);\r\n   \t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n   \t}\r\n\r\n   \tvoid main(void) {\r\n   \t\tvec3 pos \x3d (view * model * vec4($position, 1.0)).xyz;\r\n   \t\tvec2 uv01 \x3d floor($uv0.xy);\r\n   \t\tvec2 uv \x3d $uv0.xy - uv01;\r\n\r\n   \t\tvec2 up \x3d rotate(vec2(1,0), $uv0.z);\r\n   \t\tvec3 xDir \x3d  vec3(up.x,up.y,0.0);\r\n   \t\tvec3 yDir \x3d  vec3(-up.y,up.x,0.0);\r\n\r\n   \t\tpos +\x3d xDir * (uv01.x - .5) * $uv0.w*trafoScale;\r\n   \t\tpos +\x3d yDir * (uv01.y - .5) * $uv0.w*trafoScale;\r\n   \t\tvec4 pos4 \x3d proj * vec4(pos, 1.0);\r\n   \t\tgl_Position \x3d pos4;\r\n   \t\tvtc \x3d uv;\r\n\r\n   \t\tdepth \x3d (-pos.z - nearFar[0]) / (nearFar[1] - nearFar[0]);\r\n\r\n   \t}\r\n ]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/Material.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n#ifdef INSTANCED\r\n    attribute mat4 model;\r\n    attribute mat4 modelNormal;\r\n#else\r\n\tuniform mat4 model;\r\n\tuniform mat4 modelNormal;\r\n#endif\r\n#ifdef INSTANCEDCOLOR\r\n    attribute vec4 instanceColor;\r\n#endif\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tvarying vec3 vpos;\r\n\tvarying vec3 vnormal;\r\n\r\n#ifdef VERTEXCOLORS\r\n    attribute vec4 $color;\r\n#endif\r\n\r\n#if defined(VERTEXCOLORS) || defined(INSTANCEDCOLOR)\r\n    varying vec4 vcolor;\r\n#endif\r\n\r\n\r\n\tvoid main(void) {\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tvnormal \x3d normalize((modelNormal * vec4($normal, 1.0)).xyz);\r\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n\r\n#if defined(VERTEXCOLORS) || defined(INSTANCEDCOLOR)\r\n        vcolor \x3d vec4(1,1,1,1);\r\n#endif\r\n#ifdef VERTEXCOLORS\r\n        vcolor *\x3d $color * 0.003921568627451; // \x3d 1/255\r\n#endif\r\n#ifdef INSTANCEDCOLOR\r\n        vcolor *\x3d instanceColor;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongSrc"\x3e\x3c![CDATA[\r\n\tuniform vec3 camPos;\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec4 lightSpecular;\r\n\tuniform vec3 lightDirection;\r\n\tuniform vec3 ambient;\r\n\tuniform vec3 diffuse;\r\n\tuniform vec3 specular;\r\n\tuniform float shininess;\r\n\tuniform float opacity;\r\n\tuniform sampler2D depthTex;\r\n\tuniform int shadowMapNum;\r\n\tuniform vec4 shadowMapDistance;\r\n\tuniform mat4 shadowMapMatrix[4];\r\n\tuniform float depthHalfPixelSz;\r\n\tuniform sampler2D ssaoTex;\r\n\tuniform vec4 viewportPixelSz;\r\n\tvarying vec3 vpos;\r\n\tvarying vec3 vnormal;\r\n#if defined(VERTEXCOLORS) || defined(INSTANCEDCOLOR)\r\n    varying vec4 vcolor;\r\n#endif\r\n\r\n\t$evalShadow\r\n\tvoid main() {\r\n\t\tvec3 a \x3d ambient * lightAmbient.rgb * lightAmbient.w;\r\n\r\n\t\tvec3 viewDir \x3d normalize(vpos - camPos);\r\n\r\n#ifndef DOUBLESIDED\r\n\t\tvec3 normal \x3d vnormal;\r\n#else\r\n\t\tvec3 normal \x3d dot(vnormal, viewDir)\x3e0.0?-vnormal:vnormal;\r\n#endif\r\n\r\n    normal \x3d normalize(normal);\r\n    \r\n\t\tfloat shadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n\t\tvec3 d \x3d (1.0 - shadow) * diffuse * lightDiffuse.rgb * lightDiffuse.w * clamp(dot(normal, lightDirection), .0, 1.0);\r\n\r\n\t\tfloat opacity_ \x3d opacity;\r\n#if defined(VERTEXCOLORS) || defined(INSTANCEDCOLOR)\r\n        a *\x3d vcolor.rgb;\r\n        d *\x3d vcolor.rgb;\r\n        opacity_ *\x3d vcolor.a;\r\n#endif\r\n\r\n\t\tvec3 reflDir \x3d normalize(reflect(viewDir, normal));\r\n\t\tfloat specDot \x3d max(dot(reflDir, lightDirection), .001);\r\n\t\tvec3 s \x3d (1.0 - shadow) * specular * lightSpecular.rgb * lightSpecular.w * pow(specDot, shininess);\r\n\r\n\t\tfloat ssao \x3d texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\r\n\t\tssao \x3d viewportPixelSz.z \x3c 0.0 ? 1.0 : ssao;\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhong"\x3e\x3c![CDATA[\r\n\t$vsPhongSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhong"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\t$fsPhongSrc\r\n\t\tgl_FragColor \x3d vec4(ssao * (a + d) + s, opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsPhongSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n    \r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\t$fsPhongSrc\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\t\tgl_FragColor \x3d vec4(ssao * texColor.rgb * (a + d) + s, texColor.a * opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsPhongAtlasTextured"\x3e\x3c![CDATA[\r\n\tattribute vec4 $uv0;\r\n\tattribute vec4 $region;\r\n\tvarying vec2 vtc;\r\n\tvarying vec4 regionV;\r\n\t$vsPhongSrc\r\n#ifndef FLIPV\r\n        vtc \x3d $uv0.xy;\r\n#else\r\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t    regionV \x3d $region/65535.0;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongAtlasTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\tvarying vec4 regionV;\r\n\r\n\t$fsPhongSrc\r\n\t\tvec2 uv \x3d vtc;\r\n\t\tuv \x3d fract(uv);\r\n\t\t//[umin, vmin, umax, vmax]\r\n\r\n\t\tuv \x3d uv.xy*(regionV.zw-regionV.xy)+regionV.xy;\r\n\t\tvec4 texColor \x3d texture2D(tex, uv);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\t\tgl_FragColor \x3d vec4(ssao * texColor.rgb * (a + d) + s, texColor.a * opacity_);\r\n\t\t//gl_FragColor \x3d regionV;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsPhongTexturedRefl"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tuniform sampler2D reflTex;\r\n\tuniform float reflectivity;\r\n\tvarying vec2 vtc;\r\n\r\n\t$normal2envTC\r\n\r\n\t$fsPhongSrc\r\n\t\tvec4 texColor \x3d texture2D(tex, vtc);\r\n\t\tif (texColor.a \x3c .33) discard;\r\n\t\tvec4 reflColor \x3d texture2D(reflTex, normal2envTC(reflDir));\r\n\t\tgl_FragColor \x3d vec4(ssao * mix(texColor.rgb * (a + d), reflColor.rgb * lightAmbient.rgb*lightSpecular.w, reflectivity) + s, texColor.a * opacity_);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepthSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform vec2 nearFar;\r\n\tattribute vec3 $position;\r\n\tvarying float depth;\r\n\r\n\tvoid main(void) {\r\n\t\tvec4 eye \x3d view * model * vec4($position, 1.0);\r\n\t\tgl_Position \x3d proj * eye;\r\n\t\tdepth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepth"\x3e\x3c![CDATA[\r\n\t$vsDepthSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsDepthTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsDepthSrc\r\n#ifndef FLIPV\r\n        vtc \x3d $uv0;\r\n#else\r\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormalSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tuniform mat4 viewNormal;\r\n\tuniform mat4 modelNormal;\r\n\tattribute vec3 $position;\r\n\tattribute vec3 $normal;\r\n\tvarying vec3 vnormal;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * model * vec4($position, 1.0);\r\n\t\tvnormal \x3d normalize((viewNormal * modelNormal * vec4($normal, 1.0)).xyz);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormal"\x3e\x3c![CDATA[\r\n\t$vsNormalSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsNormalTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsNormalSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n        vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlightSrc"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\r\n\tvoid main(void) {\r\n\t\tgl_Position \x3d proj * view * model * vec4($position, 1.0);\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlight"\x3e\x3c![CDATA[\r\n\t$vsHighlightSrc\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsHighlightTextured"\x3e\x3c![CDATA[\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\t$vsHighlightSrc\r\n#ifndef FLIPV\r\n\t\tvtc \x3d $uv0;\r\n#else\r\n    vtc \x3d vec2($uv0.x, 1.0-$uv0.y);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepthSrc"\x3e\x3c![CDATA[\r\n\tvarying float depth;\r\n\r\n\tvoid main() {\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepth"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\t$calcFragDepth\r\n\t$float2rgba\r\n\t$fsDepthSrc\r\n#ifndef BIAS_SHADOWMAP\r\n\t\tgl_FragColor \x3d float2rgba(depth);\r\n#else\r\n\t\tgl_FragColor \x3d float2rgba(calcFragDepth(depth));\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsDepthTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform sampler2D tex;\r\n\tvarying vec2 vtc;\r\n\t$calcFragDepth\r\n\t$float2rgba\r\n\r\n\t$fsDepthSrc\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n#ifndef BIAS_SHADOWMAP\r\n\t\tgl_FragColor \x3d float2rgba(depth);\r\n#else\r\n\t\tgl_FragColor \x3d float2rgba(calcFragDepth(depth));\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsNormal"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec3 vnormal;\r\n\tvoid main() {\r\n\t\tvec3 normal \x3d normalize(vnormal);\r\n\t\tif (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;\r\n\r\n#ifndef ALPHA_ZERO\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 0.0);\r\n#endif\r\n\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsNormalTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec3 vnormal;\r\n\tvarying vec2 vtc;\r\n\tuniform sampler2D tex;\r\n\tvoid main() {\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n\t\tvec3 normal \x3d normalize(vnormal);\r\n\t\tif (gl_FrontFacing \x3d\x3d false) normal \x3d -normal;\r\n#ifndef ALPHA_ZERO\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 1.0);\r\n#else\r\n\t\tgl_FragColor \x3d vec4(vec3(.5) + .5 * normal, 0.0);\r\n#endif\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlight"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsHighlightTextured"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\tvarying vec2 vtc;\r\n\tuniform sampler2D tex;\r\n\tvoid main() {\r\n\t\tif (texture2D(tex, vtc).a \x3c .33) discard;\r\n    gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/RibbonLineMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsRibbonLine"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\r\n\tuniform float extLineWidth;\r\n\tuniform float nearPlane;\r\n\r\n\tattribute vec3 $position;\t\r\n\tattribute vec2 $uv0;\r\n\tvarying vec2 vtc;\r\n\r\n\tattribute vec4 $color;\r\n\tvarying vec4 vColor;\r\n\r\n\tattribute float size;\r\n\r\n#ifndef WALL\r\n\tuniform float miterLimit;\r\n\tattribute vec3 $auxpos1;\r\n\tattribute vec3 $auxpos2;\r\n#endif\r\n\r\n#ifdef SCREENSCALE\r\n\tuniform vec2 screenSize;\r\n\t$toScreenCoords\r\n#define VECTYPE vec2\r\n#define ZEROVEC vec2(0.0, 0.0)\r\n#define PERPENDICULAR(v) vec2(v.y, -v.x);\r\n#define ISOUTSIDE (left.x * right.y - left.y * right.x)*$uv0.y \x3e 0.0\r\n\r\n#else //ifdef SCREENSCALE\r\n\r\n#define VECTYPE vec3\r\n#define ZEROVEC vec3(0.0, 0.0, 0.0)\r\n// these macros are only valid for "strip" type lines:\r\n#define PERPENDICULAR(v) cross(up/*vec3(0.0, 1.0, 0.0)*/, v)\r\n#define ISOUTSIDE dot(cross(left, right), up/*vec3(0.0, 1.0, 0.0)*/)*$uv0.y \x3c 0.0\r\n\r\n#endif //ifdef SCREENSCALE\r\n\r\n\tfloat interp(float ncp, vec4 a, vec4 b) {\r\n\t\treturn (-ncp - a.z) / (b.z - a.z);\r\n\t}\r\n\r\n#ifdef SCREENSCALE\r\n\r\n  void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next) {\r\n\t\tfloat vnp \x3d nearPlane*0.99;\r\n\r\n\t\t//We have four vertices per point on the line. Start and end vertices \r\n\t\t//are treated differently --\x3e d \x3e 0, d \x3c 0\r\n\t\tfloat d \x3d abs($uv0.y) - 1.1;\r\n\r\n\t\t//current pos behind ncp --\x3e we need to clip\r\n\t\tif(pos.z \x3e -nearPlane) {\t\t\t\r\n\t\t\tif (d \x3c 0.0) {\r\n\t\t\t\t//previous in front of ncp\r\n\t\t\t\tif(prev.z \x3c -nearPlane) {\r\n\t\t\t\t\tpos \x3d mix(prev, pos, interp(vnp, prev, pos));\r\n\t\t\t\t\tnext \x3d pos;\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t  pos \x3d vec4(0, 0, 0, 1);\r\n\t\t\t  }\r\n\t\t\t}\r\n\t\t\t//next in front of ncp\r\n\t\t\tif(d \x3e 0.0) {\r\n\t\t\t\tif(next.z \x3c -nearPlane) {\r\n\t\t\t\t\tpos \x3d mix(pos, next, interp(vnp, pos, next));\r\n\t\t\t\t\tprev \x3d pos;\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpos \x3d vec4(0, 0, 0, 1);\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t}\telse { \r\n\t\t\t//current position visible \r\n\t\t\t//previous behind ncp\r\n\t\t\tif (prev.z \x3e -nearPlane) {\t\t\t\t\r\n\t\t\t\tprev \x3d mix(pos, prev, interp(vnp, pos, prev));\t\t\t\t\r\n\t\t\t}\t\t\t\t\t\r\n\t\t\t//next behind ncp\r\n\t\t\tif (next.z \x3e -nearPlane) {\r\n\t\t\t\tnext \x3d mix(next, pos, interp(vnp, next, pos));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpos\x3d proj * pos;\r\n\t\tpos.xy *\x3d screenSize;\r\n\t\tpos /\x3d pos.w;\r\n\r\n\t\tnext \x3d proj * next;\r\n\t\tnext.xy *\x3d screenSize;\r\n\t\tnext /\x3d next.w;\r\n\r\n\t\tprev \x3d proj * prev;\r\n\t\tprev.xy *\x3d screenSize;\r\n\t\tprev /\x3d prev.w;\t\t\r\n  }\r\n\r\n#endif // SCREENSCALE\r\n\r\n\tvoid main(void) {\r\n\r\n\tfloat lineWidth \x3d extLineWidth + $size; \r\n\r\n#ifdef SCREENSCALE\r\n\r\n#if 0\r\n\t\tvec4 pos \x3d toScreenCoords($position.xyz);\r\n\t\tvec2 left \x3d (pos - toScreenCoords($auxpos1)).xy;\r\n\t\tvec2 right \x3d (toScreenCoords($auxpos2) - pos).xy;\r\n#else\r\n\t\tvec4 pos  \x3d view * vec4((model * vec4($position.xyz, 1.0)).xyz, 1.0); \r\n\t\tvec4 prev \x3d view * vec4((model * vec4($auxpos1.xyz, 1.0)).xyz, 1.0); \r\n\t\tvec4 next \x3d view * vec4((model * vec4($auxpos2.xyz, 1.0)).xyz, 1.0); \r\n\r\n\t\tclipAndTransform(pos, prev, next);\r\n\r\n\t\tvec2 left \x3d (pos - prev).xy;\r\n\t\tvec2 right \x3d (next - pos).xy;\r\n#endif\r\n\r\n#else // ifdef SCREENSCALE\r\n\t\tvec4 pos \x3d vec4($position, 1.0);\r\n#ifndef WALL\r\n\t\tvec3 left \x3d $position.xyz - $auxpos1;\r\n\t\tvec3 right \x3d $auxpos2 - $position.xyz;\r\n\t\tvec3 up \x3d normalize($position.xyz);\r\n#endif // ifndef WALL\r\n#endif // ifdef SCREENSCALE\r\n\r\n#ifdef WALL\r\n\t\tfloat displacementLen \x3d lineWidth;\r\n\t\tvec3 displacementDir \x3d normalize($position.xyz);//vec3(0.0, 1.0, 0.0);\r\n#else // ifdef WALL\r\n\r\n\t\tfloat leftLen \x3d length(left);\r\n\t\tleft \x3d (leftLen \x3e 0.001) ? left/leftLen : ZEROVEC;\r\n\r\n\t\tfloat rightLen \x3d length(right);\r\n\t\tright \x3d (rightLen \x3e 0.001) ? right/rightLen : ZEROVEC;\r\n\r\n\t\t// determine if vertex is on the "outside or "inside" of the join\r\n\t\tbool isOutside \x3d ISOUTSIDE;\r\n\r\n\t\t// compute miter join position first\r\n\t\tfloat displacementLen \x3d lineWidth;\r\n\t\tVECTYPE displacementDir \x3d normalize(left + right);\r\n\t\tdisplacementDir \x3d PERPENDICULAR(displacementDir);\r\n\t\tif (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\r\n\t\t\tfloat nDotSeg \x3d dot(displacementDir, left);\r\n\t\t\tdisplacementLen /\x3d length(nDotSeg*left - displacementDir);\r\n\r\n\t\t\t// limit displacement of inner vertices\r\n\t\t\tif (!isOutside)\r\n\t\t\t\tdisplacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\r\n\t\t}\r\n\r\n\t\tif (isOutside \x26\x26 (displacementLen \x3e miterLimit*lineWidth)) {\r\n\t\t\t// convert to bevel join if miterLimit is exceeded\r\n\t\t\tif (leftLen \x3c 0.001)\r\n\t\t\t    displacementDir \x3d right;\r\n\t\t\telse if (rightLen \x3c 0.001)\r\n\t\t\t\tdisplacementDir \x3d left;\r\n\t\t\telse\r\n\t\t\t\tdisplacementDir \x3d (abs($uv0.y) - 1.1 \x3c 0.0) ? left : right;\r\n\t\t\tdisplacementDir \x3d normalize(displacementDir);\r\n\t\t\tdisplacementDir \x3d PERPENDICULAR(displacementDir);\r\n\t\t\tdisplacementLen \x3d lineWidth;\r\n\t\t}\r\n\r\n#endif // ifdef WALL\r\n\r\n#ifdef SCREENSCALE\r\n\t\tpos.xy +\x3d displacementDir * floor($uv0.y + 0.5) * displacementLen;\r\n\t\tpos.xy /\x3d screenSize;\r\n#else\r\n\t\tpos.xyz +\x3d displacementDir * floor($uv0.y + 0.5) * displacementLen;\r\n\t\tpos \x3d proj * view * model * pos;\r\n#endif\r\n\r\n\t\tvtc \x3d $uv0;\r\n\t\tvColor \x3d $color * 0.003921568627451; // \x3d 1/255\r\n\t\tgl_Position \x3d pos;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsRibbonLine"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec4 eColor;\r\n\tvarying vec4 vColor;\r\n\tvarying vec2 vtc;\r\n\r\n\tvoid main() {\r\n\t\tgl_FragColor \x3d eColor * vColor;\r\n\t\t//gl_FragColor.a \x3d 1;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/WaterMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderWater"\x3e\x3c![CDATA[\r\n\tuniform mat4 proj;\r\n\tuniform mat4 view;\r\n\tuniform mat4 model;\r\n\tattribute vec3 $position;\r\n\tvarying vec3 vpos;\r\n\r\n\tvoid main(void) {\r\n\t\tvpos \x3d (model * vec4($position, 1.0)).xyz;\r\n\t\tgl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderWater"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tuniform vec3 color;\r\n\tuniform float scale;\r\n\tuniform float speed;\r\n\r\n\tuniform vec4 lightAmbient;\r\n\tuniform vec4 lightDiffuse;\r\n\tuniform vec4 lightSpecular;\r\n\tuniform vec3 lightDirection;\r\n\r\n\tuniform vec3 camPos;\r\n\r\n\tuniform sampler2D noiseTex;\r\n\tuniform sampler2D reflTex;\r\n\r\n\tuniform sampler2D depthTex;\r\n\tuniform int shadowMapNum;\r\n\tuniform vec4 shadowMapDistance;\r\n\tuniform mat4 shadowMapMatrix[4];\r\n\tuniform float depthHalfPixelSz;\r\n\r\n\tvarying vec3 vpos;\r\n\r\n\t$evalShadow\r\n\r\n\t$normal2envTC\r\n\r\n\t// TODO optimize?\r\n\tvec2 rotate(vec2 pos, float angle) {\r\n\t\tfloat c \x3d cos(angle);\r\n\t\tfloat s \x3d sin(angle);\r\n\t\treturn vec2(c * pos.x - s * pos.y, s * pos.x + c * pos.y);\r\n\t}\r\n\r\n\tfloat compDelta(vec2 pos) {\r\n\t\tconst float PI_THIRD \x3d 1.04719755;\r\n\r\n\t\tfloat result \x3d .0;\r\n\t\tfloat s \x3d 1.0;\r\n\t\tfor (int i \x3d 0; i \x3c 6; ++i) {\r\n\t\t\tvec2 tc \x3d pos / (20.0 * s);\r\n\t\t\ttc +\x3d rotate(vec2(1.0 + speed, .0), PI_THIRD * float(i));\r\n\t\t\tresult +\x3d s * texture2D(noiseTex, tc).r;\r\n\t\t\ts *\x3d 1.5;\r\n\t\t}\r\n\t\treturn result * scale * .2;\r\n\t}\r\n\r\n\tvoid main() {\r\n\t\tvec3 viewVec \x3d normalize(camPos - vpos);\r\n\r\n\t\tfloat d0 \x3d compDelta(vpos.xz);\r\n\t\tfloat dx \x3d compDelta(vpos.xz + vec2(.05, .0));\r\n\t\tfloat dz \x3d compDelta(vpos.xz + vec2(.0, .05));\r\n\r\n\t\tvec3 normal \x3d normalize(vec3(d0 - dx, .05, d0 - dz));\r\n\r\n\t\tfloat fresnel \x3d clamp(1.0 - 1.25 * dot(viewVec, normal), .0, 1.0);\r\n\r\n\t\tfloat shadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n\r\n\t\tvec3 reflDir \x3d reflect(-viewVec, normal);\r\n\t\tif (reflDir.y \x3c .02) reflDir.y \x3d 0.04 - reflDir.y;\r\n\r\n\t\tvec3 reflCol \x3d texture2D(reflTex, normal2envTC(reflDir)).rgb * lightAmbient.rgb*lightSpecular.w;\r\n\t\treflCol *\x3d .5 + max(lightDirection.y, .0) * .5; // ?\t+\r\n\t\tvec3 waterColor \x3d color * (lightAmbient.rgb * lightAmbient.w + (1.0 - shadow) * max(lightDirection.y, .0) * lightDiffuse.rgb * lightDiffuse.w);\r\n\t\tvec3 finalColor \x3d mix(waterColor, reflCol, .15 + .6 * fresnel);\r\n\r\n\t\tvec3 spec \x3d pow(max(dot(reflDir, lightDirection), .001), 80.0) * lightSpecular.rgb * lightSpecular.w * 2.0;\r\n\t\tfinalColor +\x3d (1.0 - shadow) * lightDiffuse.w * spec;\r\n\r\n\t\tgl_FragColor \x3d vec4(finalColor, 1.0);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e',
"url:esri/views/3d/webgl-engine/materials/internal/BlendLayers.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vertexShaderBlendLayers"\x3e\x3c![CDATA[\t\t\r\n\tattribute vec3 $position;\r\n\tattribute vec2 $uv0;\r\n\t\r\n\tuniform float scale;\r\n\tuniform vec2 offset;\r\n\r\n\tvarying vec2 uv;\r\n\r\n\tvoid main(void) {\t\t\r\n\t\tgl_Position \x3d vec4($position, 1.0);\r\n\t\tuv \x3d $uv0 * scale + offset;;\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fragmentShaderBlendLayers"\x3e\x3c![CDATA[\r\n\tprecision mediump float;\r\n\r\n\tvarying vec2 uv;\r\n\t\r\n\tuniform sampler2D tex;\t\r\n\tuniform float opacity;\r\n\r\n\tvoid main() {\r\n\t\tvec4 color \x3d texture2D(tex, uv);\t\t\r\n\t\tgl_FragColor \x3d vec4(color.xyz, color.a * opacity);\r\n\t}\r\n]]\x3e\x3c/snippet\x3e\r\n\x3c/snippets\x3e',
"url:esri/views/3d/terrain/TerrainMaterial.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrain"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n  uniform vec3 origin;\r\n  uniform vec2 texOffset;\r\n  uniform float texScale;\r\n  uniform mat4 viewNormal;\r\n\r\n  attribute vec3 $position;\r\n  attribute vec2 $uv0;\r\n  varying vec2 vtc;\r\n  varying vec3 vpos;\r\n  varying vec3 vnormal;\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n  varying vec2 vuv;\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n  uniform vec3 lightDirection;\r\n  varying vec3 wpos;\r\n  varying vec3 wview;\r\n  varying vec3 wnormal;\r\n  varying vec3 wlight;\r\n#endif    \r\n\r\n#ifdef OVERLAY\r\n  uniform vec2 overlayTexOffset;\r\n  uniform vec2 overlayTexScale;\r\n  varying vec2 vtcOverlay;\r\n#endif\r\n\r\n  void main(void) {\r\n    vpos \x3d $position;\r\n\r\n#ifdef SPHERICAL\r\n    vnormal \x3d normalize(vpos + origin);\r\n#else\r\n    vnormal \x3d vec3(0, 0, 1); // WARNING: up-axis dependent code\r\n#endif\r\n    \r\n#ifdef ATMOSPHERE    \r\n    wpos \x3d (view * vec4(vpos, 1.0)).xyz;\r\n    wnormal \x3d (viewNormal * vec4(normalize(vpos+origin), 1.0)).xyz;\r\n    wlight \x3d (view  * vec4(lightDirection, 1.0)).xyz;\r\n#endif\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n    vuv \x3d $uv0;\r\n#endif\r\n\r\n    gl_Position \x3d proj * view * vec4(vpos, 1.0);\r\n    vtc \x3d $uv0*texScale + texOffset;\r\n\r\n#ifdef OVERLAY\r\n    vtcOverlay \x3d $uv0*overlayTexScale + overlayTexOffset;\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainCommon"\x3e\x3c![CDATA[\r\n  uniform vec3 lightDirection;\r\n  uniform vec3 viewDirection;\r\n  uniform sampler2D depthTex;\r\n  uniform int shadowMapNum;\r\n  uniform vec4 shadowMapDistance;\r\n  uniform mat4 shadowMapMatrix[4];\r\n  uniform float depthHalfPixelSz;\r\n  uniform sampler2D ssaoTex;\r\n  uniform vec4 viewportPixelSz;\r\n  uniform sampler2D tex;\r\n  uniform float opacity;\r\n\r\n  varying vec3 vpos;\r\n  varying vec3 vnormal;\r\n  varying vec2 vtc;\r\n\r\n#if defined(WIREFRAME) || defined(TILE_BORDERS)\r\n  varying vec2 vuv;\r\n#endif\r\n\r\n#ifdef ATMOSPHERE\r\n  varying vec3 wpos;\r\n  varying vec3 wview;\r\n  varying vec3 wnormal;\r\n  varying vec3 wlight;\r\n#endif\r\n\r\n  const vec3 ambient \x3d vec3(0.2,0.2,0.2);\r\n  const vec3 diffuse \x3d vec3(0.8,0.8,0.8);\r\n  const float diffuseHardness \x3d 2.5;\r\n\r\n#ifdef OVERLAY\r\n  uniform sampler2D overlayTex;\r\n  uniform float overlayOpacity;\r\n  varying vec2 vtcOverlay;\r\n#endif\r\n\r\n  $evalShadow\r\n\r\n  float lum(vec3 c) {\r\n    float max \x3d max(max(c.r, c.g), c.b);\r\n    float min \x3d min(min(c.r, c.g), c.b);\r\n    return (min + max) * 0.5;\r\n  }\r\n\r\n#ifdef ATMOSPHERE\r\n  vec3 atmosphere(vec3 lightPos, vec3 normal, vec3 view) {\r\n    vec3 surfaceColor   \x3d vec3(0.0);\r\n    vec3 fuzzySpecColor \x3d vec3(1.0);\r\n    vec3 subColor       \x3d vec3(0.0);\r\n    float rollOff       \x3d 1.0;\r\n\r\n    vec3 Ln \x3d normalize(lightPos);\r\n    vec3 Nn \x3d normalize(normal);\r\n    vec3 Hn \x3d normalize(view + Ln);\r\n    \r\n    float ldn \x3d dot(Ln, Nn);\r\n    float diffComp \x3d max(0.0, ldn);\r\n    float vdn \x3d 1.0 - dot(view, Nn);\r\n    float ndv \x3d dot(view, Ln);\r\n    \r\n    vec3 diffContrib \x3d surfaceColor * diffComp;\r\n    float subLamb \x3d max(0.0, smoothstep(-rollOff, 1.0, ldn) - smoothstep(0.0, 1.0, ldn));     \r\n    \r\n    vec3 subContrib \x3d subLamb * subColor;\r\n    vec3 vecColor \x3d vec3(vdn);\r\n    \r\n    vec3 diffuseContrib \x3d (subContrib + diffContrib);\r\n    vec3 specularContrib \x3d (vecColor * fuzzySpecColor);    \r\n\r\n    return (diffContrib + specularContrib) * rollOff;\r\n  }\r\n#endif\r\n\r\n  void main() {\r\n    vec3 a \x3d ambient;\r\n\r\n    float shadow \x3d evalShadow(vpos, 1.0 / gl_FragCoord.w, depthTex, shadowMapNum, shadowMapDistance, shadowMapMatrix, depthHalfPixelSz);\r\n    float vndl \x3d dot(normalize(vnormal), lightDirection);\r\n    float k \x3d smoothstep(0.0, 1.0, clamp(vndl*diffuseHardness, 0.0, 1.0));\r\n    vec3 d \x3d (1.0 - shadow/1.8) * diffuse * k;\r\n\r\n\r\n    float ssao \x3d viewportPixelSz.w \x3c .0 ? 1.0 : texture2D(ssaoTex, (gl_FragCoord.xy - viewportPixelSz.xy) * viewportPixelSz.zw).a;\r\n    vec4 texVal \x3d texture2D(tex, vtc);\r\n    vec3 texCol \x3d texVal.rgb;\r\n    float texAlpha \x3d texVal.a;\r\n\r\n#ifdef OVERLAY\r\n    if ((vtcOverlay.x \x3e 0.0) \x26\x26 (vtcOverlay.y \x3e 0.0) \x26\x26 (vtcOverlay.x \x3c 1.0) \x26\x26 (vtcOverlay.y \x3c 1.0)) {\r\n      vec4 overlayTexCol \x3d texture2D(overlayTex, vtcOverlay);\r\n      overlayTexCol *\x3d overlayOpacity;\r\n      texCol \x3d texCol*(1.0-overlayTexCol.a) + overlayTexCol.rgb; // overlayTexCol has pre-multiplied alpha\r\n      texAlpha \x3d overlayTexCol.a + (1.0 - overlayTexCol.a) * texAlpha;\r\n    }\r\n#endif\r\n\r\n    vec3 atm \x3d vec3(0.0);\r\n#ifdef ATMOSPHERE  \r\n    float ndotl \x3d max(0.0, min(1.0, vndl));\r\n    atm \x3d atmosphere(wlight, wnormal, -viewDirection);\r\n    atm *\x3d max(0.0, min(1.0, (1.0-lum(texCol)*1.5))); //avoid atmosphere on bright base maps\r\n    atm *\x3d max(0.0, min(1.0, ndotl*2.0)); // avoid atmosphere on dark side of the globe\r\n#endif\r\n    vec3 color \x3d atm + texCol * (a + d) * ssao;\r\n    gl_FragColor \x3d vec4(color, texAlpha * opacity);\r\n\r\n  // closing } is missing here, it\'s in the shaders using this snippet below\r\n\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainWireframe"\x3e\x3c![CDATA[\r\n#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\n\r\n  precision mediump float;\r\n\r\n  struct WireframeSettings {\r\n    float width;\r\n    float falloff;\r\n    float subdivision;\r\n    vec4 color;\r\n    float wireOpacity;\r\n    float surfaceOpacity;\r\n    float near;\r\n    float far;\r\n  };\r\n\r\n  uniform WireframeSettings wireframe;\r\n\r\n    $fsTerrainCommon\r\n\r\n    vec2 dVuv;\r\n    vec2 vuvScaled \x3d vuv * wireframe.subdivision;\r\n    vec2 vuvMod \x3d fract(vuvScaled);\r\n\r\n#ifdef GL_OES_standard_derivatives\r\n    dVuv \x3d fwidth(vuvScaled);\r\n#else\r\n    // Something that reasonably works\r\n    dVuv \x3d vec2(0.05);\r\n#endif\r\n\r\n    vec2 edgeFactors \x3d smoothstep((wireframe.width - wireframe.falloff) * dVuv,\r\n                                  wireframe.width * dVuv, min(vuvMod, 1.0 - vuvMod));\r\n\r\n    float edgeFactor \x3d 1.0 - min(edgeFactors.x, edgeFactors.y);\r\n\r\n#ifdef WIREFRAME\r\n    gl_FragColor \x3d vec4(mix(gl_FragColor.rgb, wireframe.color.rgb, edgeFactor * wireframe.color.a),\r\n                        mix(wireframe.surfaceOpacity, wireframe.wireOpacity, edgeFactor));\r\n#endif\r\n\r\n\r\n#ifdef TILE_BORDERS\r\n    dVuv \x3d fwidth(vuv);\r\n    edgeFactors \x3d smoothstep((wireframe.width - wireframe.falloff) * dVuv,\r\n                              wireframe.width * dVuv, min(vuv, 1.0 - vuv));\r\n    edgeFactor \x3d 1.0 - min(edgeFactors.x, edgeFactors.y);\r\n\r\n    gl_FragColor \x3d mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), edgeFactor);\r\n#endif\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrain"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n    $fsTerrainCommon\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrainNormal"\x3e\x3c![CDATA[\r\n  uniform vec3 origin;\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n  uniform mat4 viewNormal;\r\n  attribute vec3 $position;\r\n  varying vec3 vnormal;\r\n\r\n  void main(void) {\r\n#ifdef SPHERICAL\r\n    vec4 normal \x3d vec4(normalize($position + origin), 1.0);\r\n#else\r\n    vec4 normal \x3d vec4(0.0, 1.0, 0.0, 1.0);\r\n#endif\r\n\r\n    gl_Position \x3d proj * view * vec4($position, 1.0);\r\n    vnormal \x3d normalize((viewNormal * normal).xyz);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"vsTerrainDepthOnly"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  uniform mat4 proj;\r\n  uniform mat4 view;\r\n\r\n  attribute vec3 $position;\r\n\r\n  void main() {\r\n    gl_Position \x3d proj * view * vec4($position, 1.0);\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3csnippet name\x3d"fsTerrainDepthOnly"\x3e\x3c![CDATA[\r\n  precision mediump float;\r\n\r\n  void main() {\r\n  }\r\n]]\x3e\x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"*noref":1}});
define("../core/declare dojo/_base/lang dojo/_base/kernel dojo/dom dojo/Deferred dojo/when ./View ./ViewAnimation ../geometry/SpatialReference ../geometry/support/webMercatorUtils ../geometry/support/scaleUtils ../Camera ../geometry/Point ../geometry/Extent ../geometry/ScreenPoint ../Viewpoint ../core/Scheduler ../core/sniff ../core/watchUtils ../core/promiseUtils ../core/Error ../core/Logger ../webscene/Environment ./3d/environment/SceneViewEnvironment ./3d/environment/SceneViewEnvironmentManager ./3d/constraints/SceneViewConstraints ./3d/lib/glMatrix ./3d/support/cameraUtils ./3d/support/viewpointUtils ./3d/support/eventUtils ./3d/support/projectionUtils ./3d/webgl-engine/Stage ./3d/webgl-engine/lib/Selector ./3d/support/RenderCoordsHelper ./3d/support/MapCoordsHelper ./3d/support/ResourceController ./3d/support/DisplayQualityProfile ./3d/support/QualitySettings ./3d/terrain/TerrainSurface ./3d/layers/graphics/LabelManager ./3d/layers/GraphicsView3D ./3d/navigation/spherical/NavigationSpherical ./3d/navigation/planar/NavigationPlanar ./3d/navigation/EventController ./3d/support/Frustum ./ui/3d/DefaultUI3D".split(" "),function(s,
q,n,k,h,e,c,b,g,f,a,r,l,d,m,p,t,x,v,u,z,w,C,A,y,B,D,F,H,N,G,O,M,I,Z,V,L,Y,E,ba,W,R,T,J,S,K){function Q(a,b){return function(){return!this._internallyReady?this._initialProps&&this._initialProps[a]:b.apply(this,arguments)}}function U(a,b){return function(c){if(this._internallyReady)return b.apply(this,arguments);this._initialProps[a]=c;fa[a]&&this.notifyChange("initialExtentRequired")}}var X=w.getLogger("esri.views.SceneView"),P=D.vec3d,$=P.create();w=new l(0,0,0);var ea=new r(new l(0,0,0)),ca={point:w,
retval:null},ha={heading:0,tilt:0},fa={camera:["viewpoint"],viewpoint:["extent"],extent:["center","scale"],scale:["zoom"],center:[],zoom:[]},da=Object.keys(fa);return s(c,{declaredClass:"esri.views.SceneView",classMetadata:{properties:{camera:{copy:function(a,b){a.position.x=b.position.x;a.position.y=b.position.y;a.position.z=b.position.z;a.position.spatialReference=b.position.spatialReference;a.heading=b.heading;a.tilt=b.tilt},type:r},center:{copy:function(a,b){if(!a)return b.clone();a.x=b.x;a.y=
b.y;a.z=b.z;a.spatialReference=b.spatialReference;return a},type:l},extent:{copy:function(a,b){a.xmin=b.xmin;a.ymin=b.ymin;a.zmin=b.zmin;a.xmax=b.xmax;a.ymax=b.ymax;a.zmax=b.zmax;a.spatialReference=b.spatialReference},type:d},ui:{type:K},viewpoint:{copy:function(a,b){a.rotation=b.rotation;a.scale=b.scale;a.targetGeometry=b.targetGeometry;a.camera=b.camera},dependsOn:["camera"],type:p},viewingMode:{dependsOn:["map.initialViewProperties.viewingMode","spatialReference"],getter:function(){var a=this._viewingMode||
this.get("map.initialViewProperties.viewingMode"),b=this.spatialReference;a||(a=!b||b.isWebMercator||b.isWGS84?"global":"local");return a},setter:function(a){-1!==["local","global"].indexOf(a)&&this._viewingMode!==a&&(this._viewingMode=a,this.get("map.initialViewProperties.viewingMode")||this._internallyReady&&this._initGlobe(this.viewingMode));return this.viewingMode}},globeMode:{dependsOn:["viewingMode"]},groundExtent:{dependsOn:["basemapTerrain.extent"],readOnly:!0,getter:function(){if(this._basemapTerrain&&
this._basemapTerrain.spatialReference){var a=this._basemapTerrain.extent;return new d({xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:this._basemapTerrain.spatialReference})}return new d({spatialReference:this.spatialReference||g.WGS84})}},dataExtent:{dependsOn:["basemapTerrain.extent"],readOnly:!0,getter:function(){if(this._basemapTerrain&&this._basemapTerrain.spatialReference){var a=this._basemapTerrain.extent,b=Math.max(a[2]-a[0],a[3]-a[1]);return new d({xmin:a[0],ymin:a[1],zmin:4*-b,
xmax:a[2],ymax:a[3],zmax:4*b,spatialReference:this._basemapTerrain.spatialReference})}return new d({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0,spatialReference:this.spatialReference||g.WGS84})}},clippingArea:{type:d,dependsOn:["map.clippingArea","map.clippingEnabled","viewingMode"],getter:function(){if("global"===this.viewingMode)return null;if(this._userClippingArea)return this._userClippingArea;var a=this.get("map.clippingEnabled"),b=this.get("map.clippingArea");if(!a||!b)return this._clippingArea=
null;if(!(b instanceof d))return console.error("Only clippingArea geometries of type Extent are supported"),this._clippingArea;if(f.canProject(b.spatialReference,this.spatialReference))b=f.project(b,this.spatialReference);else return console.error("Setting clippingArea with incompatible SpatialReference."),this._clippingArea;return this._clippingArea&&b&&this._clippingArea.equals(b)?this._clippingArea:this._clippingArea=b},setter:function(a,b){return this._userClippingArea=a}},interacting:{dependsOn:["navigation.interacting"],
getter:function(){return this.navigation&&this.navigation.interacting}},ready:{dependsOn:["viewingMode"]},basemapTerrain:{readOnly:!0},canvas:{readOnly:!0},environment:{setter:function(a){a!==this._defaults.environment&&(this._externallySet.environment=!0);if(!a)return new A;if(a instanceof A)return a;if(a instanceof C)this.environment.lighting=a.lighting;else return a.declaredClass?a:new A(a);return this.environment}},constraints:{type:B},animation:{type:b},navigation:{readOnly:!0},scale:{},zoom:{dependsOn:["scale"]},
spatialReference:{dependsOn:["map.initialViewProperties.spatialReference"]},mapCoordsHelper:{},renderCoordsHelper:{},initialExtentRequired:{dependsOn:["map.initialViewProperties.viewpoint"],getter:function(){if(this.get("map.initialViewProperties.viewpoint"))return!1;for(var a=0;a<da.length;a++)if(this._initialProps&&void 0!==this._initialProps[da[a]])return!1;return!0}},qualityProfile:{setter:function(a){return L.isValidProfile(a)?(L.apply(a,this),a):this.qualityProfile}},qualitySettings:{type:Y},
updating:{},updatingPercentage:{}}},getDefaults:function(a){var b=this.inherited(arguments);!b.constraints&&!a.constraints&&(this._defaults.constraints=new B,b.constraints=this._defaults.constraints);!b.environment&&!a.environment&&(this._defaults.environment=new A,b.environment=this._defaults.environment);b.popup.autoPanEnabled=!1;b.qualitySettings=new Y;b.qualityProfile=L.getDefaultProfile();return b},constructor:function(){v.when(this,"ready",this._viewReadyHandler.bind(this));this._internallyReady=
!1;this._initialProps={};this._viewingMode=this._gotoTask=this._userClippingArea=this._basemapTerrain=this._canvas=null;this._initCoordinateSystem();this._frustum=new S;this.navigationController=this._navigation=this._clippingArea=this._constraints=this._animationStateWatcher=this._animation=null;this.navigationControls=J.PAN;this._defaults={};this._externallySet={};this.resourceController=new V(this);this.labelManager=new ba(this);this._evaluateUpdating=this._evaluateUpdating.bind(this);this._layerViewsUpdatingHandles=
{};this._navigationHandles=N.on(this,{navigation:{currentViewChanged:this._navigationCurrentViewChanged,targetViewChanged:{handler:this._navigationTargetViewChanged,pausable:!0},currentViewReachedTarget:this._navigationCurrentViewReachedTarget,animationStarted:{handler:this._navigationAnimationStarted,pausable:!0}}},this);this.watch("map",function(a){a&&a.load&&a.load()})},initialize:function(){this.environmentManager=new y({view:this});this._updateUpdatingMonitorsHandle=this.allLayerViews.on("change",
this._updateUpdatingMonitors.bind(this));this._updateUpdatingMonitors({added:this.allLayerViews.toArray(),removed:[],moved:[]});v.whenNot(this,"ready",this._viewUnreadyHandler.bind(this))},destroy:function(){this._accessorProps.dispatch();this.environmentManager.destroy();this._disposeGraphicsView();this._updateUpdatingMonitorsHandle.remove();this._updateUpdatingMonitorsHandle=null;this._navigationHandles.remove();this._navigationHandles=null},destroyLayerViews:function(){for(var a in this._layerViewsUpdatingHandles)this._layerViewsUpdatingHandles[a].remove();
this._layerViewsUpdatingHandles={};this._disposeSurface();this.inherited(arguments);this._stage&&(this._stage.dispose(),this._stage=null);this._setCanvas(null);this.labelManager.destroy();this.labelManager=null;this.resourceController.destroy();this.resourceController=null},type:"3d",updatingPercentage:0,viewingMode:"global",environment:null,constraints:null,animation:null,camera:null,viewpoint:null,extent:null,clippingArea:null,map:null,scale:0,zoom:0,center:null,qualityProfile:null,toMap:function(a,
b,c){if(!this._internallyReady)return X.error("#toMap()","Scene view cannot be used before it is ready"),null;a=this._normalizePointArgs(a,b,void 0,c);b=this._stage.pick([a.point.x,this.height-a.point.y]).getMinResult();return this._computeMapPointFromIntersectionResult(b,a.retval)},toScreen:function(a,b,c,d){if(!this._internallyReady)return X.error("#toScreen()","Scene view cannot be used before it is ready"),null;a=this._normalizePointArgs(a,b,c,d);G.pointToVector(a.point,$,this.renderSpatialReference);
return this.engineToScreen($,a.retval)},pixelSizeAt:function(a,b,c){if(!this._internallyReady)return X.error("#pixelSizeAt()","Scene view cannot be used before it is ready"),null;if("esri.geometry.ScreenPoint"===a.declaredClass){if(!this._stage.pick([a.x,this.height-a.y]).getMinResult().getIntersectionPoint($))return 0}else a=this._normalizePointArgs(a,b,c,void 0),G.pointToVector(a.point,$,this.renderSpatialReference);return this.navigation.currentCamera.computePixelSizeAt($)},hitTest:function(a,
b){if(!this._internallyReady)return X.error("#hitTest()","Scene view cannot be used before it is ready"),null;var c=this._normalizePointArgs(a,b,void 0,void 0),d=[c.point.x,this.height-c.point.y],c=this._stage.pick(d,null,!0).getMinResult(),f=this._computeMapPointFromIntersectionResult(c);return e(this._getGraphicFromStageObject(c.object,c.triangleNr)).otherwise(function(){return null}).then(function(a){var b=[];(a||f)&&b.push({mapPoint:f,graphic:a});return{screenPoint:d,results:b}})},goTo:function(a,
b){if(this._internallyReady){b=q.mixin({animate:!0},b);var c=H.create(this,a,b);this._gotoTask={};return b.animate?this._gotoAnimated(c,b):this._gotoImmediate(c,b)}X.error("#goTo()","Scene view cannot be used before it is ready")},animateTo:function(a,b){n.deprecated(this.declaredClass+".animateTo is deprecated. Use .goTo instead.","","4.0");return this.goTo(a,b)},takeScreenshot:function(a){if(this._internallyReady){a=q.mixin({format:"png",quality:100},a||{});var b=new h,c,d;a.includePadding||(c=
this.width-this.padding.left-this.padding.right,d=this.height-this.padding.top-this.padding.bottom);var e=c/d;void 0!==a.width&&void 0===a.height?a.height=a.width/e:void 0!==a.height&&void 0===a.width&&(a.width=e*a.height);void 0!==a.height&&(a.height=Math.floor(a.height));void 0!==a.width&&(a.width=Math.floor(a.width));!a.area&&!a.includePadding&&(a.area={x:this.padding.left,y:this.padding.top,width:c,height:d});this._stage.requestScreenCapture(a,function(a){t.schedule(function(){b.resolve(a)})});
return b.promise}X.error("#takeScreenshot()","Scene view cannot be used before it is ready")},engineToScreen:function(a,b){var c=P.create();this._stage.getCamera().projectPoint(a,c);var d=c[0],e=this.height-c[1],c=c[2];return b?(b.x=d,b.y=e,b.z=c,b):new m({x:d,y:e,z:c})},getDefaultSpatialReference:function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")},validate:function(){var a;x("esri-webgl")?x("safari")&&7.1>x("safari")&&(a=new z("sceneview:browser-not-supported",
"This browser is not supported by SceneView (Safari \x3c 7.1)",{type:"safari",requiredVersion:7.1,detectedVersion:x("safari")})):a=new z("sceneview:webgl-required","WebGL is required but not supported");return a?u.reject(a):u.resolve()},isSpatialReferenceSupported:function(b){var c=null==a.getUnitValue(b),d=b.isWebMercator;b=b.isWGS84;var e="local"===this.viewingMode;return e&&c||!e&&!d&&!b?!1:!0},has:function(a){return this._stage.has(a)},flushDisplayModifications:function(){this._stage.processDirty()},
getFrustum:function(){this._frustum.dirty&&this._frustum.update(this.navigation.currentCamera);return this._frustum},getDrawingOrder:function(a){return this.allLayerViews.findIndex(function(b){return b.layer&&b.layer.uid===a})},getViewForGraphic:function(a){return a.layer?this.allLayerViews.find(function(b){return b.layer===a.layer}):this._graphicsView},whenViewForGraphic:function(a){return a.layer?this.whenLayerView(a.layer):u.resolve(this._graphicsView)},renderSpatialReference:null,_graphicsView:null,
_surfaceReadyWatchHandle:null,_gotoImmediate:function(a,b){var c=this._gotoTask;return a.then(function(a){c===this._gotoTask&&(this.viewpoint=a)}.bind(this))},_gotoAnimated:function(a,c){!this.animation||"running"!==this.animation.state&&"waiting-for-target"!==this.animation.state?this.animation=new b({target:a}):this.animation.target=a;var d=this.animation;d.state="waiting-for-target";a.then(function(c){if(!(d.target!==a||this.animation!==d)){d.target=c;d.state="running";c=H.toCamera(this,c);if(!c)throw X.error("#goTo()",
"Invalid target specified for animateTo"),new z("goto:invalid-camera","Invalid camera in conversion from viewpoint");c=F.externalToInternal(this,c);c.almostEquals(this.navigation.targetCamera,5E-4/this.renderCoordsHelper.unitInMeters)?d.finish():(this._navigationHandles.byId("navigation.targetViewChanged").pause(),this._navigationHandles.byId("navigation.animationStarted").pause(),this._setInternalCamera(c,{animate:!0}),d.state===b.State.STOPPED&&d.stop(),this._navigationHandles.byId("navigation.targetViewChanged").resume(),
this._navigationHandles.byId("navigation.animationStarted").resume())}}.bind(this)).otherwise(function(){d.target!==a||this.animation!==d||(this.animation=null,d.finish())});return d},_trackCanvasSize:function(){this.on("resize",function(a){if(this.canvas){this.canvas.width=a.width;this.canvas.height=a.height;var b=this._stage.getCamera();b.width=a.width;b.height=a.height;this._stage.setCamera(b);this.navigation&&(this.navigation.windowSize=[a.width,a.height])}}.bind(this));this.canvas.width=this.width;
this.canvas.height=this.height},_computeMapPointFromIntersectionResult:function(a,b){if(a.getIntersectionPoint($)){var c=this.spatialReference||g.WGS84;G.vectorToVector($,this.renderSpatialReference,$,c)||(c=g.WGS84,G.vectorToVector($,this.renderSpatialReference,$,c));b?(b.x=$[0],b.y=$[1],b.z=$[2],b.spatialReference=c):b=new l($,c);"terrain"===a.intersector&&this.basemapTerrain&&(c=this.basemapTerrain.getElevation(b),null!==c&&(b.z=c));return b}return null},_onGeometryPicked:function(a,b,c){a={screenPoint:{x:b[0],
y:this.height-b[1]}};if(c=this._computeMapPointFromIntersectionResult(c))a.mapPoint=c;this.emit("click",a)},_getGraphicFromStageObject:function(a,b){if(!a)return null;var c=a.getMetadata();if(null!=c&&null!=c.layerId){if(c.layerId===this._graphicsView.mockLayerId)return this._graphicsView.getGraphicsFromStageObject(a,b);if(c=this.map.findLayerById(c.layerId))return this.whenLayerView(c).then(function(c){if(c&&null!=c.getGraphicsFromStageObject&&!c.suspended)return c.getGraphicsFromStageObject(a,b)})}return null},
_viewingModeToManifold:function(a){return{local:"planar",global:"spherical"}[a]},_initBasemapTerrain:function(a){this._disposeBasemapTerrain();this._basemapTerrain=new E(this,this._viewingModeToManifold(a));this.notifyChange("basemapTerrain");this.navigation.elevationProvider=this._basemapTerrain},_initGlobe:function(a){this._initCoordinateSystem();this._initNavigation(a);this._stage.setViewParams({backgroundColor:[0,0,0,0],maxFarNearRatio:0,frustumCullingEnabled:!1});this._initBasemapTerrain(a);
this._navigationCurrentViewChanged({camera:this.navigation.currentCamera})},_initCoordinateSystem:function(){if(this.spatialReference){var a=this.spatialReference;if(!this.mapCoordsHelper||!this.mapCoordsHelper.spatialReference.equals(a))this.mapCoordsHelper=new Z(this.map,a);var b=this.renderCoordsHelper?this.renderCoordsHelper.unitInMeters:1,c="global"===this.viewingMode,a=c?G.SphericalRenderSpatialReference:a;a!==this.renderSpatialReference&&(this.renderSpatialReference=a,this.renderCoordsHelper=
new (c?I.Spherical:I.Planar)(a),this._stage&&this._stage.setIntersectTolerance(M.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters),this._constraints&&this._constraints.scale(b/this.renderCoordsHelper.unitInMeters))}else this.renderSpatialReference=this.renderCoordsHelper=this.mapCoordsHelper=null},_paddingEqualsArray:function(a){var b=this.padding;return!b?!0:b.top===a[0]&&b.right===a[1]&&b.bottom===a[2]&&b.left===a[3]},_navigationCurrentViewChanged:function(a){this._frustum.dirty=!0;a=a.camera;
var b=a.padding;if(!this._paddingEqualsArray(b)){var c=this._padding,b={top:b[0],right:b[1],bottom:b[2],left:b[3]};this._internallyReady?(this._padding=b,this.notifyChange("padding",c,b)):this.padding=b}this._stage.setCamera(a);this.notifyChange("center");this.notifyChange("extent");this.notifyChange("scale");c=this.camera;a=F.internalToExternal(this,a,ea);(!c||!this._cameraAlmostEquals(c,a))&&this.notifyChange("camera")},_cameraAlmostEquals:function(a,b){return 1E-5>Math.abs(a.tilt-b.tilt)&&1E-5>
Math.abs(a.heading-b.heading)&&1E-5>Math.abs(a.fov-b.fov)&&a.position.equals(b.position)},_navigationAnimationStarted:function(a){a=H.fromInternalCamera(this,this.navigation.targetCamera);this.animation?this.animation.target=a:this.animation=new b({target:a})},_navigationTargetViewChanged:function(a){if(this.animation&&"waiting-for-target"!==this.animation.state){a=a.camera;var b=this.spatialReference||g.WGS84,c=F.internalToExternal(this,a);a=new p({camera:c,targetGeometry:G.vectorToPoint(a.center,
b,this.renderSpatialReference),scale:F.computeScale(this,a),rotation:H.headingToRotation(c.heading)});this.animation.target=a}},_navigationCurrentViewReachedTarget:function(a){if(a.interruptedAnimation||a.finishedAnimation)this._gotoTask=null;if(this.animation&&(a.interruptedAnimation||a.finishedAnimation)){this._animationStateWatcher&&(this._animationStateWatcher.remove(),this._animationStateWatcher=null);var b=this.animation;this.animation=null;a.finishedAnimation?b.finish():b.stop();this.notifyChange("animation")}},
_setInternalCamera:function(a,b){a&&(this.navigation.setCamera(a,b),this._externallySet.camera=!0);return!!a},_setCamera:function(a,b){return this._setInternalCamera(F.externalToInternal(this,a),b)},_evaluateUpdating:function(){var a=0,b=0,c=!1;this.allLayerViews.forEach(function(d){d.updating&&(c=!0,d=d.updatingPercentage,null!=d&&(++b,a+=d))});this._graphicsView&&this._graphicsView.updating&&(c=!0);c!==this.updating&&(this.updating=c);a=0!==b?a/b:c?100:0;this.updatingPercentage!==a&&(this.updatingPercentage=
a)},_updateUpdatingMonitors:function(a){for(var b=0;b<a.removed.length;b++){var c=a.removed[b],d=this._layerViewsUpdatingHandles[c.id];d&&(delete this._layerViewsUpdatingHandles[c.id],d.remove())}for(b=0;b<a.added.length;b++)c=a.added[b],c.layer&&null!=c.updating&&(d=c.watch(["updating","updatingPercentage"],this._evaluateUpdating),this._layerViewsUpdatingHandles[c.id]=d);this._evaluateUpdating()},_spatialReferenceSetter:function(a){this.inherited(arguments);this._initCoordinateSystem()},_setInitialView:function(a){if(a&&
!this._externallySet.camera)if(a instanceof p)this.viewpoint=a;else if(a instanceof r)this.camera=a;else{var b=this._getDesiredHeadingTilt();H.create(this,{target:a,heading:b.heading,tilt:b.tilt}).then(function(a){this.navigation._dataExtentChanged();this.viewpoint=a}.bind(this))}},_pickRay:function(){return this._stage?this._stage.pickRay.apply(this._stage,arguments):null},_pickRayWithBeginPoint:function(){return this._stage?this._stage.pickRayWithBeginPoint.apply(this._stage,arguments):null},_removeHandles:function(a){for(var b=
0;b<a.length;b++){var c=a[b];this[c]&&(this[c].remove(),this[c]=null)}},_setCanvas:function(a){if(a!==this._canvas){var b=this._canvas;this._canvas=a;this.notifyChange("canvas",b,a)}},_disposeSurface:function(){this._removeHandles(["_stageFrameTask","_updateDrawingOrderHandle","onViewExtentUpdateHandle"]);this._disposeBasemapTerrain();this._setNavigation(null);this.environmentManager&&this.environmentManager.disposeRendering()},_disposeBasemapTerrain:function(){this._basemapTerrain&&(this._basemapTerrain.destroy(),
this._basemapTerrain=null)},_disposeNavigation:function(){this._navigation&&(this._navigation.destroy(),this._navigation=this._navigation.elevationProvider=null);this.navigationController&&(this.navigationControls=this.navigationController.getControls(),this.navigationController.destroy(),this.navigationController=null)},_setNavigation:function(a){if(this._navigation!==a){this._disposeNavigation();if(this._navigation=a)a.windowSize=[this.width,this.height],a.userConstraints=this.constraints;this.notifyChange("navigation");
this._accessorProps.dispatch()}},_initNavigation:function(a){a=a||this.viewingMode;var b={view:this};"global"===a?this._setNavigation(new R(b)):this._setNavigation(new T(b));this.navigationController=new J(this,this.navigationControls)},_initSurface:function(){var a={};a.antialias=this.qualitySettings.antialiasingEnabled;this.renderCanvas&&(a.canvas=this.renderCanvas);this._stage=new O(k.byId(this.surface),a);this._stage.selectionState=!1;this._stage.onGeometryPicked=this._onGeometryPicked.bind(this);
this.renderCoordsHelper&&this._stage.setIntersectTolerance(M.DEFAULT_TOLERANCE/this.renderCoordsHelper.unitInMeters);this._setCanvas(this._stage.getCanvas());this._stageFrameTask=t.addFrameTask(this._stage.getFrameTask());this._trackCanvasSize();this._initGlobe(this.viewingMode)},_initGraphicsView:function(){this._surfaceReadyWatchHandle=v.whenTrueOnce(this,"basemapTerrain.ready",function(){this._graphicsView=new W({view:this,graphics:this.graphics});this._surfaceReadyWatchHandle=null;this._layerViewsUpdatingHandles[this._graphicsView.mockLayerId]=
this._graphicsView.watch("updating",this._evaluateUpdating)}.bind(this))},_disposeGraphicsView:function(){this._surfaceReadyWatchHandle&&(this._surfaceReadyWatchHandle.remove(),this._surfaceReadyWatchHandle=null);if(this._graphicsView){var a=this._graphicsView.mockLayerId;this._layerViewsUpdatingHandles[a].remove();delete this._layerViewsUpdatingHandles[a];this._graphicsView.destroy();this._graphicsView=null}},_normalizePointArgs:function(a,b,c,d,e){e=e||ca;var f=e.point;f.spatialReference=void 0;
"object"===typeof a?(f.x=a.x,f.y=a.y,f.z=a.z,a.spatialReference&&(f.spatialReference=a.spatialReference),e.retval=b):(f.x=a,f.y=b,"number"!==typeof c&&void 0!==c?(f.z=void 0,e.retval=c):(f.z=c,e.retval=d));f.spatialReference||(f.spatialReference=this.spatialReference||g.WGS84);return e},_separateInitialProperties:function(){var a={},b={},c={},d=function(a){if(a=fa[a])for(var b=0;b<a.length;b++)c[a[b]]=!0,d(a[b])},e;for(e in this._initialProps){var f=this._initialProps[e];fa[e]?(d(e),a[e]=f):b[e]=
f}for(e in c)delete a[e];return{view:a,other:b}},_viewReadyHandler:function(a,b){if(!b){"global"===this.viewingMode&&(this._clippingArea=null);this._internallyReady=!0;this._initSurface();this._initGraphicsView();var c=this._separateInitialProperties(),d;for(d in c.other)this.set(d,c.other[d]);for(d in c.view)this.set(d,c.view[d]);c=this.get("map.initialViewProperties.viewpoint");d=this.get("initialExtent");if(c)this._setInitialView(c);else if(d&&d.spatialReference.equals(this.spatialReference))this._setInitialView(d);
else v.once(this._basemapTerrain,"extent",function(){this._setInitialView(this.groundExtent)}.bind(this));if(!this._externallySet.environment&&(c=this.get("map.initialViewProperties.environment")))this.environment=c;this._initialProps={};this.notifyChange("initialExtentRequired");this._updateDrawingOrderHandle=this.allLayerViews.on("change",this._updateDrawingOrder.bind(this));this._updateDrawingOrder({added:this.allLayerViews.toArray(),removed:[],moved:[]});this.environmentManager.updateReadyChange(!0)}},
_viewUnreadyHandler:function(a,b){b&&(this.environmentManager.updateReadyChange(!1),this._disposeGraphicsView(),this._internallyReady=!1,this._disposeSurface(),this._stage&&(this._stage.dispose(),this._stage=null),this._setCanvas(null))},_getDesiredHeadingTilt:function(){if(this._externallySet.camera){var a=this.camera;ha.heading=a.heading;ha.tilt=a.tilt}else ha.heading=0,ha.tilt=0.5;return ha},_cameraSetter:U("camera",function(a){this._setCamera(a,{animate:!1})||X.error("#camera\x3d","Invalid camera",
a)}),_cameraGetter:Q("camera",function(a){return F.internalToExternal(this,this.navigation.currentCamera,a)}),_externalExtent:function(){this._cachedExtentDirty&&(F.toExtent(this,null,null,this._cachedExtent,ea),this._cachedExtentDirty=!1);return this._cachedExtent},_extentGetter:Q("extent",function(a){return F.toExtent(this,null,null,a,ea)}),_extentSetter:U("extent",function(a){var b=F.fromExtent(this,a,this._getDesiredHeadingTilt(),ea);b?this.camera=b:this._isIncompatibleSpatialReference(a.spatialReference)?
X.error("#extent\x3d","Extent has an incompatible spatial reference (extent: "+a.spatialReference.wkid+", view: "+this.spatialReference.wkid+")",a):X.error("#extent\x3d","Invalid extent",a)}),_isIncompatibleSpatialReference:function(a){return a&&!a.equals(this.spatialReference)&&!f.canProject(a,this.spatialReference)},_scaleGetter:Q("scale",function(){return null!=this.navigation?F.computeScale(this,this.navigation.currentCamera):0}),_scaleSetter:U("scale",function(a){var b=this._getDesiredHeadingTilt(),
c=this.navigation.currentCamera.center,d=P.create();G.vectorToVector(c,this.renderSpatialReference,d,g.WGS84);a=F.scaleToDistance(this,a,d[1]);b=F.eyeHeadingTiltForCenterPointAtDistance(this,b.heading,b.tilt,c,a);this._externallySet.camera=!0;this.navigation.setCameraFromEyeCenterAndUp(b.eye,b.center,b.up,{animate:!1})}),_zoomGetter:Q("zoom",function(){return F.scaleToZoom(this,this.scale)}),_zoomSetter:U("zoom",function(a){this.scale=F.zoomToScale(this,a)}),_centerGetter:Q("center",function(a){var b=
this.spatialReference||g.WGS84;return G.vectorToPoint(this.navigation.currentCamera.center,this.renderSpatialReference,a||b,b)}),_centerSetter:U("center",function(a){if(this._isIncompatibleSpatialReference(a&&a.spatialReference))X.error("#center\x3d","Center has an incompatible spatial reference (center: "+a.spatialReference.wkid+", view: "+this.spatialReference.wkid+")",a);else{var b=this._getDesiredHeadingTilt();(b=F.eyeHeadingTiltForCenterPointAtDistance(this,b.heading,b.tilt,a,this.navigation.currentCamera.distance))||
X.error("#center\x3d","Invalid center",a);this._externallySet.camera=!0;this.navigation.setCameraFromEyeCenterAndUp(b.eye,b.center,b.up,{animate:!1})}}),_viewpointGetter:Q("viewpoint",function(){return H.fromCamera(this,this.camera)}),_viewpointSetter:U("viewpoint",function(a){var b=H.toCamera(this,a);b?this._setCamera(b,{animate:!1}):X.error("#viewpoint\x3d","Invalid viewpoint",a)}),_globeModeSetter:function(a){n.deprecated(this.declaredClass+"::globeMode is deprecated. Use viewingMode instead.",
"","4.0");this.viewingMode={planar:"local",spherical:"global"}[a]},_globeModeGetter:function(){n.deprecated(this.declaredClass+"::globeMode is deprecated. Use viewingMode instead.","","4.0");return this._viewingModeToManifold(this.viewingMode)},_screenCenterGetter:function(){var a=this.padding;return new m((this.size[0]-(a.left+a.right))/2+a.left,(this.size[1]-(a.top+a.bottom))/2+a.top)},_updateDrawingOrder:function(){var a=this.allLayerViews.length-1;this.allLayerViews.forEach(function(b,c){null!=
b.drawingOrder&&(b.drawingOrder=a-c)},this)},_paddingGetter:Q("padding",function(){return this._padding}),_paddingSetter:U("padding",function(a){this._padding={top:a&&a.top||0,right:a&&a.right||0,bottom:a&&a.bottom||0,left:a&&a.left||0};this.navigation&&(this.navigation.padding=this._padding)}),_constraintsGetter:Q("constraints",function(){return this._constraints}),_constraintsSetter:U("constraints",function(a){this._constraints=a;this._constraints===this._defaults.constraints&&(this._defaults.constraints=
null,this._constraints.scale(1/this.renderCoordsHelper.unitInMeters));this.navigation.userConstraints=a}),_animationSetter:function(a){if(a!==this._animation)if(this._internallyReady){if(this._animationStateWatcher&&(this._animationStateWatcher.remove(),this._animationStateWatcher=null),this._animation=a)this._animationStateWatcher=a.watch("state",function(a){a!==b.State.FINISHED&&a!==b.State.STOPPED||(this.animation=null,a===b.State.FINISHED?this.navigation.setCurrentToTarget():this.navigation.setCamera(this.navigation.currentCamera,
{animate:!1}))}.bind(this))}else X.error("#animation\x3d","Scene view cannot be used before it is ready")},_animationGetter:function(){return this._animation},_canvasGetter:function(){return this._canvas},_basemapTerrainGetter:function(){return this._basemapTerrain},_navigationGetter:function(){return this._navigation},_mapSetter:function(a){if(a===this.map)return a;delete this._externallySet.camera;return this.inherited(arguments)}})});