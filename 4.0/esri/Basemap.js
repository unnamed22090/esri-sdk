// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
define("require exports ./core/tsSupport/extendsHelper ./core/tsSupport/decorateHelper ./core/accessoireSupport/typescript ./support/basemapDefinitions ./core/Collection ./core/collectionUtils ./core/Error ./core/Evented ./core/JSONSupporter ./core/LoadableAccessoire ./core/promiseUtils ./core/requireUtils ./portal/PortalItem".split(" "),function(m,x,n,c,b,p,d,h,q,r,s,t,k,u,v){var w=0;return function(l){function a(a){l.call(this);this.title=this.thumbnailUrl=this.resourceInfo=this.referenceLayers=
this.portalItem=this.id=this.baseLayers=null}n(a,l);a.prototype.getDefaults=function(){return{id:Date.now().toString(16)+"-basemap-"+w++,baseLayers:new d,referenceLayers:new d}};a.prototype.initialize=function(){this.resourceInfo&&this.read(this.resourceInfo)};a.prototype.load=function(){this.addResolvingPromise(this._loadFromSource());return this};a.prototype.clone=function(){var e={id:this.id,title:this.title};this.resourceInfo||this.portalItem?(e.portalItem=this.portalItem,e.resourceInfo=this.resourceInfo):
(e.baseLayers=this.baseLayers.clone(),e.referenceLayers=this.referenceLayers.clone());return new a(e)};a.prototype.toJSON=function(){throw new q("internal:not-yet-implemented","Basemap.toJSON is not yet implemented");};a.prototype._loadFromSource=function(){var a=this.resourceInfo,f=this.portalItem;return a?this._loadFromJSON(a):f?this._loadFromItem(f):k.resolve(null)};a.prototype._loadFromJSON=function(a){var f=this,c=this.portalItem&&this.portalItem.portal;return u.when(m,"./portal/creators/layersCreator").then(function(b){var g=
[];if(a.baseMapLayers&&Array.isArray(a.baseMapLayers)){var d={defaultLayerType:"DefaultTiledLayer",portal:c},h=b.populateOperationalLayers(f.baseLayers,a.baseMapLayers.filter(function(a){return!a.isReference}),d);g.push.apply(g,h);b=b.populateOperationalLayers(f.referenceLayers,a.baseMapLayers.filter(function(a){return a.isReference}),d);g.push.apply(g,b)}return k.eachAlways(g)}).then(function(){})};a.prototype._loadFromItem=function(a){var b=this;return a.load().then(function(a){return a.fetchData()}).then(function(a){b.resourceInfo=
a.baseMap;b.read(b.resourceInfo);return b._loadFromJSON(b.resourceInfo)})};a.fromJSON=function(b){return!b?null:new a({resourceInfo:b})};a.fromId=function(b){return(b=p[b])?a.fromJSON(b):null};c([b.shared("esri.Basemap")],a.prototype,"declaredClass",void 0);c([b.shared({reader:{exclude:["baseMapLayers"]}})],a.prototype,"classMetadata",void 0);c([b.property({setter:h.referenceSetter})],a.prototype,"baseLayers",void 0);c([b.property()],a.prototype,"id",void 0);c([b.property({type:v})],a.prototype,"portalItem",
void 0);c([b.property({setter:h.referenceSetter})],a.prototype,"referenceLayers",void 0);c([b.property()],a.prototype,"resourceInfo",void 0);c([b.property({value:null})],a.prototype,"thumbnailUrl",void 0);c([b.property({value:""})],a.prototype,"title",void 0);return a=c([b.subclass([r,t])],a)}(s)});