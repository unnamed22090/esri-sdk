// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
define("require exports ../Scheduler ../ArrayPool ../lang ./utils ./get ./whenMayChange".split(" "),function(z,h,w,r,m,l,g,s){function t(a){var b=a.callback,e=a.name,d=a.oldValue,c=a.target,f=g.valueOf(c,e,!0);m.equals(d,f)||(b.call(c,f,d,e,c),a.oldValue=f)}function u(){if(q){q=null;var a=c;f={};k={};c=r.acquire();for(var b=0;b<a.length;b++)t(a[b]);r.release(a)}}function x(a,b,e){return l.parse(a,b,e,function(a,b,e){var h=g.valueOf(a,b,!0),n,p=s.whenMayChange(a,b,function(a,b){n||(n={uid:l.uid(),
target:b,name:a,oldValue:h,callback:e});var d=n,g=d.uid,p=l.uid(d.target),m=f[g];m?c.splice(c.indexOf(m),1):(f[g]=d,k[p]||(k[p]=r.acquire()),k[p].push(g));c.push(d);q||(q=w.schedule(u))});return{remove:l.once(function(){p.remove();var a=n&&f[n.uid];a&&c.splice(c.indexOf(a),1)})}})}function y(a,b,e){return l.parse(a,b,e,function(a,b,e){var c=g.valueOf(a,b,!0),f=!1;return s.whenMayChange(a,b,function(a,b){if(!f){f=!0;var d=g.valueOf(b,a,!0);m.equals(c,d)||e.call(b,d,c,a,b);c=g.valueOf(b,a,!0);f=!1}})})}
function v(a,b,c,d){void 0===d&&(d=!1);return d?y(a,b,c):x(a,b,c)}var f={},k={},c=[],q;h.dispatchTarget=function(a){var b="string"!==typeof a?l.uid(a):a;if(a=k[b]){delete k[b];for(b=0;b<a.length;b++){var e=a[b],d=f[e];delete f[e];c.splice(c.indexOf(d),1);t(d)}}};h.removeTarget=function(a){var b="string"!==typeof a?l.uid(a):a;if(a=k[b]){delete k[b];for(b=0;b<a.length;b++){var e=a[b],d=f[e];delete f[e];c.splice(c.indexOf(d),1)}}};h.dispatch=u;h.watch=v;Object.defineProperty(h,"__esModule",{value:!0});
h.default=v});