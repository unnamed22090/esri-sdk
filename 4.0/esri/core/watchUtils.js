// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.0/esri/copyright.txt for details.
//>>built
define(["dojo/Deferred","dojo/promise/Promise"],function(u,v){function e(a,b,c,f){var k=a.watch(b,function(b,d,k,e){(!f||f(b))&&c.call(a,b,d,k,e)}),d=a.get(b);f&&f(d)&&c.call(a,d,d,b,a);return k}function w(a,b){var c=new v;c.cancel=a.cancel;c.isCanceled=a.isCanceled;c.isFulfilled=a.isFulfilled;c.isRejected=a.isRejected;c.isResolved=a.isResolved;c.then=a.then;c.remove=b;return Object.freeze(c)}function g(a,b,c,f){var k=!1,d,p=new u(function(){d&&(d.remove(),d=null)}),h=w(p,function(){d&&(d.remove(),
d=null)});d=e(a,b,function(b,f,e,h){k=!0;d&&(d.remove(),d=null);c&&c.call(a,b,f,e,h);p.resolve({value:b,oldValue:f,propertyName:e,target:h})},f);k&&d.remove();return h}function l(a){return!!a}function m(a){return!a}function q(a){return!0===a}function r(a){return!1===a}function s(a){return void 0!==a}function t(a){return void 0===a}var n={init:function(a,b,c){(Array.isArray(b)?b:-1<b.indexOf(",")?b.split(","):[b]).forEach(function(b){b=b.trim();var k=a.get(b);c.call(a,k,k,b,a)});return n.watch(a,b,
c)},watch:function(a,b,c){return a.watch(b,c)},once:function(a,b,c){return g(a,b,c)},when:function(a,b,c){return e(a,b,c,l)},whenOnce:function(a,b,c){return g(a,b,c,l)},whenNot:function(a,b,c){return e(a,b,c,m)},whenNotOnce:function(a,b,c){return g(a,b,c,m)},whenTrue:function(a,b,c){return e(a,b,c,q)},whenTrueOnce:function(a,b,c){return g(a,b,c,q)},whenFalse:function(a,b,c){return e(a,b,c,r)},whenFalseOnce:function(a,b,c){return g(a,b,c,r)},whenDefined:function(a,b,c){return e(a,b,c,s)},whenDefinedOnce:function(a,
b,c){return g(a,b,c,s)},whenUndefined:function(a,b,c){return e(a,b,c,t)},whenUndefinedOnce:function(a,b,c){return g(a,b,c,t)},pausable:function(a,b,c){!c&&"function"===typeof b&&(c=b,b="*");var f=!1;return{remove:a.watch(b,function(b,d,e,h){f||c.call(a,b,d,e,h)}).remove,pause:function(){f=!0},resume:function(){f=!1}}},on:function(a,b,c,f,e,d){var g=null,h=null,l=function(){h&&(d&&d(g,a,b,c),h.remove(),g=h=null)},m=n.init(a,b,function(d){l();d&&d.on&&(g=d,h=d.on(c,f),e&&e(g,a,b,c))});return{remove:function(){m.remove();
l()}}}};return n});