/*! ArcGIS API for JavaScript 4.1 | Copyright (c) 2016 Esri. All rights reserved. | http://www.esri.com/legal/privacy | https://developers.arcgis.com/terms/faq */
require(["SessionManager","esri/request","dojo/query","esri/core/urlUtils","dojo/_base/event","dojo/NodeList-manipulate"],function(e,a,t,o,n){function s(e){t("body").append('<iframe src="'+e+'" style="display:none;"></iframe>')}function r(a,t){return esri.request({url:SiteConfig.download_server+"/dms/rest/download/secured/"+a,content:{token:e.token(),folder:t}}).then(function(e){if(200===e.code)return e.url},function(e){})}function i(a,t){if(e.loggedIn()){var o=e.organization&&e.organization.subscriptionInfo?e.organization.subscriptionInfo.type:"Public";r(a,t).then(s),ga("send","event","SDK Downloads","File Download",a),ga("send","event","SDK Downloads","Account Type",o)}else e.redirect("/sign-in",{redirect_uri:window.location.href.replace(window.location.search,"")+"?filename="+a+"&folder="+t})}function l(e){var a=o.urlToObject(window.location.href).query;a&&a.filename&&a.folder&&(i(a.filename,a.folder),history.replaceState({},"",location.pathname))}t(".download-link").on("click",function(e){n.stop(e);var a=t(this),o=a.attr("data-filename")[0],s=a.attr("data-folder")[0];i(o,s)}),l()});